
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>4.2 Programación lineal (PL) y método símplex</title>
    
  <link rel="stylesheet" href="../../_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe,.cell"
        const thebe_selector_input = "pre,.cell_input div.highlight"
        const thebe_selector_output = ".output,.cell_output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="4.3 Método símplex" href="../4.3/Metodo_simplex.html" />
    <link rel="prev" title="4.1 Definiciones generales de flujo en redes" href="../4.1/Definiciones_generales_de_flujo_en_redes.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../../index.html">
  
  <img src="../../_static/logo.png" class="logo" alt="logo">
  
  
</a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../README.html">
   Optimización
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  I. Cómputo científico
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../I.computo_cientifico/1.1/Analisis_numerico_y_computo_cientifico.html">
   1.1 Análisis numérico y cómputo científico
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../I.computo_cientifico/1.2/Sistema_de_punto_flotante.html">
   1.2 Sistema de punto flotante
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../I.computo_cientifico/1.3/Normas_vectoriales_y_matriciales.html">
   1.3 Normas vectoriales y matriciales
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../I.computo_cientifico/1.4/Condicion_de_un_problema_y_estabilidad_de_un_algoritmo.html">
   1.4 Condición de un problema y estabilidad de un algoritmo
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../I.computo_cientifico/1.5/Definicion_de_funcion_continuidad_derivada.html">
   1.5 Definición de función, continuidad y derivada
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../I.computo_cientifico/1.6/Polinomios_de_Taylor_y_diferenciacion_numerica.html">
   1.6 Polinomios de Taylor y diferenciación numérica
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../I.computo_cientifico/1.7/Integracion_numerica.html">
   1.7 Integración Numérica
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  II. Cómputo matricial
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../II.computo_matricial/2.1/Operaciones_y_transformaciones_basicas_del_Algebra_Lineal_Numerica.html">
   2.1 Operaciones y transformaciones básicas del Álgebra Lineal Numérica
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../II.computo_matricial/2.2/Eigenvalores_y_eigenvectores.html">
   2.2 Eigenvalores y eigenvectores
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../II.computo_matricial/2.3/Algoritmos_y_aplicaciones_de_eigenvalores_eigenvectores_de_una_matriz.html">
   2.3 Algoritmos y aplicaciones de eigenvalores y eigenvectores de una matriz
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../II.computo_matricial/2.4/Valores_vectores_singulares_y_algoritmos_para_calcular_la_SVD.html">
   2.4 Valores, vectores singulares y algoritmos para calcular la SVD
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  III. Optimización convexa
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../III.optimizacion_convexa/3.1/Definicion_de_problema_optimizacion_conjuntos_y_funciones_convexas.html">
   3.1 Definición de problemas de optimización, conjuntos y funciones convexas
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../III.optimizacion_convexa/3.2/Algoritmos_de_descenso_y_busqueda_de_linea_en_uco.html">
   3.2 Algoritmos de descenso y búsqueda de línea en
   <em>
    Unconstrained Convex Optimization
   </em>
   (UCO)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../III.optimizacion_convexa/3.3/Ejemplos_problemas_UCO_e_intro_CIEO_y_PI.html">
   3.3 Ejemplos de problemas UCO, introducción a
   <em>
    Constrained Inequality and Equality Optimization
   </em>
   (CIEO) y puntos interiores
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../III.optimizacion_convexa/3.4/Ecuaciones_no_lineales.html">
   3.4 Ecuaciones no lineales
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  IV. Optimización en redes y programación lineal
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../4.1/Definiciones_generales_de_flujo_en_redes.html">
   4.1 Definiciones generales de flujo en redes
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   4.2 Programación lineal (PL) y método símplex
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../4.3/Metodo_simplex.html">
   4.3 Método símplex
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  V. Algoritmos de optimizacion convexa
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../V.algoritmos_optimizacion_convexa/5.1/Puntos_interiores.html">
   5.1 Puntos interiores
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../V.algoritmos_optimizacion_convexa/5.2/Problemas_CECO.html">
   5.2 Problemas tipo
   <em>
    Constrained Equality Convex Optimization
   </em>
   (CECO)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../V.algoritmos_optimizacion_convexa/5.3/Problemas_CIECO.html">
   5.2 Problemas tipo
   <em>
    Constrained Equality and Inequality Convex Optimization
   </em>
   (CIECO)
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/IV.optimizacion_en_redes_y_prog_lineal/4.2/Programacion_lineal_y_metodo_simplex.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/palmoreck/dockerfiles-for-binder/jupyterlab_optimizacion_2?urlpath=lab/tree/analisis-numerico-computo-cientifico/libro_optimizacion/temas/IV.optimizacion_en_redes_y_prog_lineal/4.2/Programacion_lineal_y_metodo_simplex.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <button type="button" class="btn btn-secondary topbarbtn"
            onclick="initThebeSBT()" title="Launch Thebe" data-toggle="tooltip" data-placement="left"><i
                class="fas fa-play"></i><span style="margin-left: .4em;">Live Code</span></button>
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#ejemplo-flujo-en-redes">
   Ejemplo: flujo en redes
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#modelo-de-pl">
   Modelo de PL
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#terminologia-en-pl">
     Terminología en PL
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#formas-de-un-pl">
     Formas de un PL
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#ejemplo-metodo-grafico">
   Ejemplo: método gráfico
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#tipo-de-soluciones-en-un-pl">
   Tipo de soluciones en un PL
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-que-le-llamamos-solucion-en-un-pl">
     ¿A qué le llamamos solución en un PL?
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#ejemplo-mas-de-una-solucion-optima">
     Ejemplo: más de una solución óptima
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#ejemplo-pl-s-sin-solucion">
     Ejemplo: PL’s sin solución
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#metodo-simplex">
   Método símplex
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#soluciones-fev-y-nfev">
     Soluciones FEV y NFEV
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#fev-adyacentes">
     FEV adyacentes
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#pasos-que-sigue-el-metodo-simplex">
     Pasos que sigue el método símplex
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#forma-aumentada-de-un-pl">
     Forma aumentada de un PL
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#soluciones-bf-adyacentes">
     Soluciones BF adyacentes
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#variables-basicas-y-no-basicas">
     Variables básicas y no básicas
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#variables-basicas-no-degeneradas-y-degeneradas">
     Variables básicas no degeneradas y degeneradas
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#ejemplo-del-metodo-simplex">
   Ejemplo del método símplex
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#paso-inicial">
     Paso inicial
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#prueba-de-optimalidad">
     Prueba de optimalidad
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#prueba-del-cociente-minimo">
     Prueba del cociente mínimo
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#prueba-del-cociente-minimo-forma-general-y-con-notacion-matricial-y-vectorial">
     Prueba del cociente mínimo: forma general y con notación matricial y vectorial
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#actualizacion-del-vector-x-b">
     Actualización del vector
     <span class="math notranslate nohighlight">
      \(x_B\)
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#iteracion-1">
     Iteración 1
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Prueba de optimalidad
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id2">
     Prueba del cociente mínimo
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#iteracion-2">
     Iteración 2
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id3">
     Prueba de optimalidad
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#consideraciones-sobre-el-metodo-simplex">
   Consideraciones sobre el método símplex
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#metodo-simplex-en-redes">
   Método símplex en redes
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#revision-de-cual-variable-no-basica-sustituye-a-una-variable-basica">
     Revisión de cuál variable no básica sustituye a una variable básica
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#revision-de-cual-arco-basico-es-sustituido">
     Revisión de cuál arco básico es sustituido
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#iteracion-siguiente">
     Iteración siguiente
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id4">
     Revisión de cuál variable no básica sustituye a una variable básica
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id5">
     Revisión de cuál arco básico es sustituido
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#tecnica-de-la-cota-superior">
     Técnica de la cota superior
    </a>
   </li>
  </ul>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="programacion-lineal-pl-y-metodo-simplex">
<span id="proglineal"></span><h1>4.2 Programación lineal (PL) y método símplex<a class="headerlink" href="#programacion-lineal-pl-y-metodo-simplex" title="Permalink to this headline">¶</a></h1>
<div class="admonition-notas-para-contenedor-de-docker admonition">
<p class="admonition-title">Notas para contenedor de docker:</p>
<p>Comando de docker para ejecución de la nota de forma local:</p>
<p>nota: cambiar <code class="docutils literal notranslate"><span class="pre">&lt;ruta</span> <span class="pre">a</span> <span class="pre">mi</span> <span class="pre">directorio&gt;</span></code> por la ruta de directorio que se desea mapear a <code class="docutils literal notranslate"><span class="pre">/datos</span></code> dentro del contenedor de docker.</p>
<p><code class="docutils literal notranslate"><span class="pre">docker</span> <span class="pre">run</span> <span class="pre">--rm</span> <span class="pre">-v</span> <span class="pre">&lt;ruta</span> <span class="pre">a</span> <span class="pre">mi</span> <span class="pre">directorio&gt;:/datos</span> <span class="pre">--name</span> <span class="pre">jupyterlab_optimizacion</span> <span class="pre">-p</span> <span class="pre">8888:8888</span> <span class="pre">-p</span> <span class="pre">8787:8787</span> <span class="pre">-d</span> <span class="pre">palmoreck/jupyterlab_optimizacion_2:3.0.0</span></code></p>
<p>password para jupyterlab: <code class="docutils literal notranslate"><span class="pre">qwerty</span></code></p>
<p>Detener el contenedor de docker:</p>
<p><code class="docutils literal notranslate"><span class="pre">docker</span> <span class="pre">stop</span> <span class="pre">jupyterlab_optimizacion_2</span></code></p>
<p>Documentación de la imagen de docker <code class="docutils literal notranslate"><span class="pre">palmoreck/jupyterlab_optimizacion_2:3.0.0</span></code> en <a class="reference external" href="https://github.com/palmoreck/dockerfiles/tree/master/jupyterlab/optimizacion_2">liga</a>.</p>
</div>
<hr class="docutils" />
<div class="tip admonition">
<p class="admonition-title">Al final de esta nota el y la lectora:</p>
<ul class="simple">
<li></li>
</ul>
</div>
<div class="sidebar">
<p class="sidebar-title">Un poco de historia …</p>
<p>El desarrollo de la programación lineal (PL) ha sido clasificado como uno de los avances científicos más importantes de mediados del siglo XX. Es quizás el modelo prototipo de la optimización con restricciones. El efecto que ha tenido en la práctica y en áreas del conocimiento desde 1950 es en verdad grande. El tipo más común de aplicación abarca el problema general de asignar de la mejor manera posible, esto es, de forma óptima, recursos limitados a actividades que compiten entre sí por ellos. Con más precisión, se desea elegir el nivel de ciertas actividades que compiten por recursos escasos necesarios para realizarlas y se puedan asignar recursos a tales actividades. El desarrollo por Dantzig del método símplex para resolver programas lineales en los <span class="math notranslate nohighlight">\(40\)</span>’s marcó el inicio de la era moderna en optimización.</p>
<p>La PL utiliza un modelo matemático para describir el problema. El adjetivo lineal significa que todas las funciones del modelo deben ser funciones lineales. En este caso, la palabra programación no se refiere a términos computacionales; en esencia es sinónimo de planeación. Por lo tanto, la PL involucra la planeación de actividades para obtener un resultado óptimo; esto es, el resultado que mejor alcance la meta establecida, de acuerdo con el modelo matemático, entre todas las alternativas factibles.</p>
<p>Aunque la asignación de recursos a las actividades es la aplicación más frecuente en PL, cualquier problema cuyo  modelo se ajuste al formato general del modelo de PL, es un problema de PL.</p>
</div>
<p>Un programa lineal (PL) <strong>en su forma estándar</strong> es un problema de optimización con una función lineal objetivo, un conjunto de restricciones lineales y un conjunto de restricciones no negativas impuestas a las variables. Es un <strong>modelo de optimización</strong> de la forma:</p>
<div class="math notranslate nohighlight">
\[\min c^Tx\]</div>
<div class="math notranslate nohighlight">
\[\text{sujeto a:}\]</div>
<div class="math notranslate nohighlight">
\[Ax=b\]</div>
<div class="math notranslate nohighlight">
\[x \geq 0\]</div>
<p>donde: <span class="math notranslate nohighlight">\(A \in \mathbb{R}^{m \times n}\)</span>, se <strong>asume</strong> <span class="math notranslate nohighlight">\(m \leq n\)</span> y tiene <em>rank</em> completo por renglones y la última desigualdad se refiere a que todas las componentes del vector <span class="math notranslate nohighlight">\(x\)</span> son mayores o iguales a cero.</p>
<div class="admonition-comentario admonition">
<p class="admonition-title">Comentario</p>
<p>El PL es un problema convexo, una función lineal es convexa y cóncava al mismo tiempo, ver <a class="reference internal" href="../../III.optimizacion_convexa/3.1/Definicion_de_problema_optimizacion_conjuntos_y_funciones_convexas.html#proboptconvest"><span class="std std-ref">problemas de optimización convexa en su forma estándar o canónica</span></a>.</p>
</div>
<div class="section" id="ejemplo-flujo-en-redes">
<span id="ejflujoenredesypl"></span><h2>Ejemplo: flujo en redes<a class="headerlink" href="#ejemplo-flujo-en-redes" title="Permalink to this headline">¶</a></h2>
<p>Considérese el problema de satisfacer el flujo neto de todos los nodos con etiquetas “A, B, C, D” y “E” de la siguiente red de acuerdo a las capacidades de cada uno de ellos al menor costo posible:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">import</span> <span class="nn">pprint</span>

<span class="kn">import</span> <span class="nn">networkx</span> <span class="k">as</span> <span class="nn">nx</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nodes_pos</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.18181818181818182</span><span class="p">,</span> <span class="mf">0.7272727272727273</span><span class="p">],</span>
             <span class="p">[</span><span class="mf">0.18181818181818182</span><span class="p">,</span> <span class="mf">0.2727272727272727</span><span class="p">],</span>
             <span class="p">[</span><span class="mf">0.5454545454545454</span><span class="p">,</span> <span class="mf">0.2727272727272727</span><span class="p">],</span>
             <span class="p">[</span><span class="mf">0.5454545454545454</span><span class="p">,</span> <span class="mf">0.7272727272727273</span><span class="p">],</span>
             <span class="p">[</span><span class="mf">0.36363636363636365</span><span class="p">,</span> <span class="mf">0.5454545454545454</span><span class="p">]]</span>

<span class="n">nodes</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">]</span>

<span class="n">nodes_and_pos</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">nodes</span><span class="p">,</span> <span class="n">nodes_pos</span><span class="p">))</span>

<span class="n">G_min_cost_flow</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">()</span>

<span class="n">G_min_cost_flow</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="n">demand</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="n">node_and_demand</span><span class="o">=</span><span class="s2">&quot;A [50]&quot;</span><span class="p">)</span>
<span class="n">G_min_cost_flow</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="n">demand</span> <span class="o">=</span> <span class="mi">40</span><span class="p">,</span> <span class="n">node_and_demand</span><span class="o">=</span><span class="s2">&quot;B [40]&quot;</span><span class="p">)</span>
<span class="n">G_min_cost_flow</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="n">demand</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">node_and_demand</span><span class="o">=</span><span class="s2">&quot;C [0]&quot;</span><span class="p">)</span>
<span class="n">G_min_cost_flow</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="n">demand</span> <span class="o">=</span> <span class="o">-</span><span class="mi">30</span><span class="p">,</span> <span class="n">node_and_demand</span><span class="o">=</span><span class="s2">&quot;D [-30]&quot;</span><span class="p">)</span>
<span class="n">G_min_cost_flow</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="s1">&#39;E&#39;</span><span class="p">,</span> <span class="n">demand</span> <span class="o">=</span> <span class="o">-</span><span class="mi">60</span><span class="p">,</span> <span class="n">node_and_demand</span><span class="o">=</span><span class="s2">&quot;E [-60]&quot;</span><span class="p">)</span>

<span class="n">edge_labels_min_cost_flow</span> <span class="o">=</span> <span class="p">{(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">):</span> <span class="p">{</span><span class="s2">&quot;weight&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span>
                             <span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">):</span> <span class="p">{</span><span class="s2">&quot;weight&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">},</span>
                             <span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">):</span> <span class="p">{</span><span class="s2">&quot;weight&quot;</span><span class="p">:</span> <span class="mi">9</span><span class="p">},</span>
                             <span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">):</span> <span class="p">{</span><span class="s2">&quot;weight&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">},</span>
                             <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">):</span> <span class="p">{</span><span class="s2">&quot;weight&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span>
                             <span class="p">(</span><span class="s1">&#39;E&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">):</span> <span class="p">{</span><span class="s2">&quot;weight&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span>
                             <span class="p">(</span><span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">):</span> <span class="p">{</span><span class="s2">&quot;weight&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">}</span>
                            <span class="p">}</span>


<span class="n">G_min_cost_flow</span><span class="o">.</span><span class="n">add_edges_from</span><span class="p">(</span><span class="n">edge_labels_min_cost_flow</span><span class="p">)</span>
<span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">G_min_cost_flow</span><span class="o">.</span><span class="n">edges</span><span class="p">():</span>
        <span class="n">G_min_cost_flow</span><span class="p">[</span><span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s2">&quot;weight&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">edge_labels_min_cost_flow</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s2">&quot;weight&quot;</span><span class="p">]</span>
        
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_edges</span><span class="p">(</span><span class="n">G_min_cost_flow</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nodes_and_pos</span><span class="p">,</span> 
                       <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
                       <span class="n">min_target_margin</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">connectionstyle</span><span class="o">=</span><span class="s2">&quot;arc3, rad = 0.1&quot;</span><span class="p">)</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_edge_labels</span><span class="p">(</span><span class="n">G_min_cost_flow</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nodes_and_pos</span><span class="p">,</span> 
                             <span class="n">edge_labels</span><span class="o">=</span><span class="n">edge_labels_min_cost_flow</span><span class="p">,</span> <span class="n">label_pos</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span>
                             <span class="n">font_size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">nodes_pos_modified</span> <span class="o">=</span> <span class="p">{}</span>

<span class="n">y_off</span> <span class="o">=</span> <span class="mf">0.03</span>

<span class="n">nodes_and_pos_modified</span> <span class="o">=</span> <span class="n">nodes_and_pos</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">G_min_cost_flow</span><span class="o">.</span><span class="n">nodes</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">node</span> <span class="o">==</span> <span class="s1">&#39;B&#39;</span> <span class="ow">or</span> <span class="n">node</span> <span class="o">==</span> <span class="s1">&#39;E&#39;</span><span class="p">:</span>
        <span class="n">nodes_and_pos_modified</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="o">=</span>  <span class="p">[</span><span class="n">nodes_and_pos_modified</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> 
                                         <span class="n">nodes_and_pos_modified</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">y_off</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">nodes_and_pos_modified</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="o">=</span>  <span class="p">[</span><span class="n">nodes_and_pos_modified</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> 
                                         <span class="n">nodes_and_pos_modified</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">y_off</span><span class="p">]</span>
        
    
<span class="n">labels</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">get_node_attributes</span><span class="p">(</span><span class="n">G_min_cost_flow</span><span class="p">,</span> <span class="s2">&quot;node_and_demand&quot;</span><span class="p">)</span>

<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_labels</span><span class="p">(</span><span class="n">G_min_cost_flow</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nodes_and_pos_modified</span><span class="p">,</span> 
                        <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">)</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_nodes</span><span class="p">(</span><span class="n">G_min_cost_flow</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nodes_and_pos</span><span class="p">,</span> 
                       <span class="n">node_size</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>        
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Programacion_lineal_y_metodo_simplex_14_0.png" src="../../_images/Programacion_lineal_y_metodo_simplex_14_0.png" />
</div>
</div>
<p>En la red anterior el arco <span class="math notranslate nohighlight">\((D, E)\)</span> tiene costo igual a <span class="math notranslate nohighlight">\(3\)</span> y el arco <span class="math notranslate nohighlight">\((E, D)\)</span> tiene costo igual a <span class="math notranslate nohighlight">\(2\)</span>.</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Obsérvese que es ligeramente distinta la nomenclatura de este problema en cuanto a los términos de flujo neto y demanda que tiene un nodo de acuerdo a lo que se describió en el <a class="reference internal" href="../4.1/Definiciones_generales_de_flujo_en_redes.html#ejredflujocostomin"><span class="std std-ref">ejemplo de flujo de costo mínimo</span></a></p>
</div>
<p>Al lado de cada nodo en corchetes se presenta el flujo neto generado por el nodo. Los nodos origen tienen un flujo neto positivo y en la red son los nodos “A” y “B” (por ejemplo fábricas). Los nodos destino tienen un flujo neto negativo que en la red son los nodos “D” y “E” (por ejemplo clientes). El único nodo de transbordo es el nodo “C” que tiene flujo neto igual a cero (centro de distribución por ejemplo). Los valores de los costos se muestran en los arcos. Es una red sin capacidades.</p>
<p>Entonces el modelo de PL que minimiza el costo de transferencia de flujo de modo que el <strong>flujo neto</strong> satisfaga lo representado en la red, considerando el flujo neto como el flujo total que sale del nodo menos el flujo total que entra al nodo es:</p>
<div class="math notranslate nohighlight">
\[\displaystyle \min 2 x_{AB} + 4 x_{AC} + 9 x_{AD} + 3 x_{BC} + x_{CE} + 3 x_{DE} + 2x_{ED}\]</div>
<div class="math notranslate nohighlight">
\[\text{sujeto a: }\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
&amp;x_{AB}&amp;  + &amp;x_{AC}&amp; + &amp;x_{AD}&amp;   &amp;&amp;         &amp;&amp;         &amp;&amp;         &amp;&amp;       &amp;=&amp; 50 \nonumber \\
&amp;-x_{AB}&amp;   &amp;&amp;         &amp;&amp;       + &amp;x_{BC}&amp;   &amp;&amp;         &amp;&amp;         &amp;&amp;       &amp;=&amp; 40 \nonumber \\
&amp;&amp;        - &amp;x_{AC}&amp;   &amp;&amp;       - &amp;x_{BC}&amp; + &amp;x_{CE}&amp;   &amp;&amp;         &amp;&amp;       &amp;=&amp; 0 \nonumber \\
&amp;&amp;          &amp;&amp;       - &amp;x_{AD}&amp;   &amp;&amp;         &amp;&amp;       + &amp;x_{DE}&amp; - &amp;x_{ED}&amp; &amp;=&amp; -30 \nonumber \\
&amp;&amp;          &amp;&amp;         &amp;&amp;         &amp;&amp;       - &amp;x_{CE}&amp; - &amp;x_{DE}&amp; + &amp;x_{ED}&amp; &amp;=&amp; -60 \nonumber
\end{eqnarray}
\end{split}\]</div>
<div class="math notranslate nohighlight">
\[x_{ij} \geq 0 \forall i,j\]</div>
<p>La primer restricción de igualdad representa el flujo neto para el nodo <span class="math notranslate nohighlight">\(A\)</span> y la última el flujo neto para el nodo <span class="math notranslate nohighlight">\(E\)</span>.</p>
<div class="tip admonition">
<p class="admonition-title">Observación</p>
<p>Obsérvese que la matriz que representa a las restricciones de igualdad es la matriz de incidencia nodo-arco.</p>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Multiplicamos por <span class="math notranslate nohighlight">\(-1\)</span> pues el resultado de la función <code class="docutils literal notranslate"><span class="pre">incidence_matrix</span></code> está volteado respecto a la definición de la matriz de incidencia nodo-arco.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="n">nx</span><span class="o">.</span><span class="n">incidence_matrix</span><span class="p">(</span><span class="n">G_min_cost_flow</span><span class="p">,</span> <span class="n">oriented</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">todense</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[ 1.  1.  1.  0.  0.  0.  0.]
 [-1.  0.  0.  1.  0.  0.  0.]
 [ 0. -1.  0. -1.  1.  0.  0.]
 [ 0.  0. -1.  0.  0.  1. -1.]
 [ 0.  0.  0.  0. -1. -1.  1.]]
</pre></div>
</div>
</div>
</div>
<p>El problema anterior lo podemos resolver directamente con <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.linprog.html#scipy-optimize-linprog">scipy-optimize-linprog</a>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">linprog</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>

<span class="n">A_eq</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="n">nx</span><span class="o">.</span><span class="n">incidence_matrix</span><span class="p">(</span><span class="n">G_min_cost_flow</span><span class="p">,</span> <span class="n">oriented</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">todense</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">A_eq</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[ 1.  1.  1.  0.  0.  0.  0.]
 [-1.  0.  0.  1.  0.  0.  0.]
 [ 0. -1.  0. -1.  1.  0.  0.]
 [ 0.  0. -1.  0.  0.  1. -1.]
 [ 0.  0.  0.  0. -1. -1.  1.]]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">b</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">nx</span><span class="o">.</span><span class="n">get_node_attributes</span><span class="p">(</span><span class="n">G_min_cost_flow</span><span class="p">,</span> 
                             <span class="s2">&quot;demand&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Cada tupla hace referencia a las cotas inferiores y superiores que tiene cada variable.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bounds</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="kc">None</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="kc">None</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="kc">None</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="kc">None</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">)]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">linprog</span><span class="p">(</span><span class="n">c</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">A_eq</span><span class="o">=</span><span class="n">A_eq</span><span class="p">,</span> <span class="n">b_eq</span><span class="o">=</span><span class="n">b</span><span class="p">,</span><span class="n">bounds</span><span class="o">=</span><span class="n">bounds</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     con: array([ 1.23415534e-06,  1.05034484e-06,  2.62587889e-08, -7.61500058e-07,
       -1.54925893e-06])
     fun: 469.9999898969424
 message: &#39;Optimization terminated successfully.&#39;
     nit: 5
   slack: array([], dtype=float64)
  status: 0
 success: True
       x: array([3.62017054e-07, 4.99999977e+01, 7.19274437e-07, 3.99999993e+01,
       8.99999970e+01, 3.55827520e-09, 2.99999985e+01])
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/usr/local/lib/python3.7/dist-packages/ipykernel_launcher.py:1: OptimizeWarning: A_eq does not appear to be of full row rank. To improve performance, check the problem formulation for redundant equality constraints.
  &quot;&quot;&quot;Entry point for launching an IPython kernel.
</pre></div>
</div>
</div>
</div>
<p>También con <code class="docutils literal notranslate"><span class="pre">cvxpy</span></code> podemos resolver el PL anterior:</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Ver <a class="reference external" href="https://www.cvxpy.org/examples/basic/linear_program.html">cvxpy: linear_program</a></p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cvxpy</span> <span class="k">as</span> <span class="nn">cp</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">RuntimeError</span><span class="g g-Whitespace">                              </span>Traceback (most recent call last)
<span class="ne">RuntimeError</span>: module compiled against API version 0xe but this version of numpy is 0xd
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="mi">7</span> <span class="c1">#number of variables</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">fo_cvxpy</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">T</span><span class="nd">@x</span> <span class="c1">#objective function</span>

<span class="n">constraints</span> <span class="o">=</span> <span class="p">[</span><span class="n">A_eq</span><span class="nd">@x</span> <span class="o">==</span> <span class="n">b</span><span class="p">,</span>
               <span class="n">x</span> <span class="o">&gt;=</span><span class="mi">0</span>
               <span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">opt_objective</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Minimize</span><span class="p">(</span><span class="n">fo_cvxpy</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">prob</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Problem</span><span class="p">(</span><span class="n">opt_objective</span><span class="p">,</span> <span class="n">constraints</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">prob</span><span class="o">.</span><span class="n">solve</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>470.000000290646
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Print result.</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">The optimal value is&quot;</span><span class="p">,</span> <span class="n">prob</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;A solution x is&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The optimal value is 470.000000290646
A solution x is
[1.65932275e-07 4.99999998e+01 3.63353936e-09 4.00000002e+01
 9.00000000e+01 2.34894911e-08 3.00000000e+01]
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="modelo-de-pl">
<h2>Modelo de PL<a class="headerlink" href="#modelo-de-pl" title="Permalink to this headline">¶</a></h2>
<p>Algunas características generales de los problemas de PL se presentan a continuación</p>
<div class="section" id="terminologia-en-pl">
<h3>Terminología en PL<a class="headerlink" href="#terminologia-en-pl" title="Permalink to this headline">¶</a></h3>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-align:center head"><p>Ejemplo anterior</p></th>
<th class="text-align:center head"><p>Problema general</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:center"><p>Capacidad  producción de las plantas</p></td>
<td class="text-align:center"><p>Recursos</p></td>
</tr>
<tr class="row-odd"><td class="text-align:center"><p>3 plantas</p></td>
<td class="text-align:center"><p>m recursos</p></td>
</tr>
<tr class="row-even"><td class="text-align:center"><p>Fabricación de productos</p></td>
<td class="text-align:center"><p>Actividades</p></td>
</tr>
<tr class="row-odd"><td class="text-align:center"><p>2 productos</p></td>
<td class="text-align:center"><p>n actividades</p></td>
</tr>
<tr class="row-even"><td class="text-align:center"><p>Tasa de producción del producto</p></td>
<td class="text-align:center"><p>Nivel de la actividad</p></td>
</tr>
<tr class="row-odd"><td class="text-align:center"><p>Ganancia</p></td>
<td class="text-align:center"><p>Medida global de desempeño</p></td>
</tr>
</tbody>
</table>
<p>Y en la terminología del problema general se desea determinar la asignación de recursos a ciertas actividades. Lo anterior implica elegir los niveles de las actividades (puntos óptimos) que lograrán el mejor valor posible (valor óptimo) de la medida global de desempeño.</p>
<p>En el PL:</p>
<p><span class="math notranslate nohighlight">\(f_o\)</span>: valor de la medida global de desempeño (función objetivo).</p>
<p><span class="math notranslate nohighlight">\(x_j\)</span>: nivel de la actividad <span class="math notranslate nohighlight">\(j\)</span> con <span class="math notranslate nohighlight">\(j=1, 2, \dots, n\)</span>. También se les conoce con el nombre de variables de decisión (variables de optimización).</p>
<p><span class="math notranslate nohighlight">\(c_j\)</span>: incremento en <span class="math notranslate nohighlight">\(f_o\)</span> que se obtiene al aumentar una unidad en el nivel de la actividad j.</p>
<p><span class="math notranslate nohighlight">\(b_i\)</span>: cantidad de recurso <span class="math notranslate nohighlight">\(i\)</span> disponible para asignarse a las actividades con <span class="math notranslate nohighlight">\(i=1, 2, \dots, m\)</span>.</p>
<p><span class="math notranslate nohighlight">\(a_{ij}\)</span>: cantidad del recurso <span class="math notranslate nohighlight">\(i\)</span> consumido por cada unidad de la actividad <span class="math notranslate nohighlight">\(j\)</span>.</p>
<div class="tip admonition">
<p class="admonition-title">Observación</p>
<p>Los valores de <span class="math notranslate nohighlight">\(c_j, b_i, a_{ij}\)</span> son las constantes o parámetros del modelo.</p>
</div>
</div>
<div class="section" id="formas-de-un-pl">
<h3>Formas de un PL<a class="headerlink" href="#formas-de-un-pl" title="Permalink to this headline">¶</a></h3>
<p>Es posible que se encuentren con PL en diferentes formas por ejemplo:</p>
<p>1.Minimizar en lugar de maximizar la función objetivo.</p>
<p>2.Restricciones con desigualdad en sentido mayor, menor o igual que.</p>
<p>3.Restricciones en forma de igualdad.</p>
<p>4.Variables de decisión sin la restricción de no negatividad (variables libres).</p>
<p>Pero siempre que se cumpla con que la función objetivo y las restricciones son funciones lineales entonces tal problema se clasifica como un PL.</p>
</div>
</div>
<div class="section" id="ejemplo-metodo-grafico">
<h2>Ejemplo: método gráfico<a class="headerlink" href="#ejemplo-metodo-grafico" title="Permalink to this headline">¶</a></h2>
<p>Supóngase que una compañía tiene tres plantas en las que se producen dos productos. La compañía nos entrega los siguientes datos relacionados con:</p>
<ol class="simple">
<li><p>Número de horas de producción disponibles por semana en cada planta para fabricar estos productos.</p></li>
<li><p>Número de horas de fabricación para producir cada lote de los productos.</p></li>
<li><p>La ganancia por lote de cada producto.</p></li>
</ol>
<p>Lo anterior se resume en la siguiente tabla:</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-align:center head"><p></p></th>
<th class="text-align:center head"><p>Tiempo de producción por lote en horas</p></th>
<th class="text-align:center head"><p></p></th>
<th class="text-align:center head"><p></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:center"><p>Planta</p></td>
<td class="text-align:center"><p>Producto 1</p></td>
<td class="text-align:center"><p>Producto 2</p></td>
<td class="text-align:center"><p>Tiempo de producción disponible a la semana en horas</p></td>
</tr>
<tr class="row-odd"><td class="text-align:center"><p>1</p></td>
<td class="text-align:center"><p>1</p></td>
<td class="text-align:center"><p>0</p></td>
<td class="text-align:center"><p>4</p></td>
</tr>
<tr class="row-even"><td class="text-align:center"><p>2</p></td>
<td class="text-align:center"><p>0</p></td>
<td class="text-align:center"><p>2</p></td>
<td class="text-align:center"><p>12</p></td>
</tr>
<tr class="row-odd"><td class="text-align:center"><p>3</p></td>
<td class="text-align:center"><p>3</p></td>
<td class="text-align:center"><p>2</p></td>
<td class="text-align:center"><p>18</p></td>
</tr>
<tr class="row-even"><td class="text-align:center"><p>Ganancia por lote</p></td>
<td class="text-align:center"><p>3000</p></td>
<td class="text-align:center"><p>5000</p></td>
<td class="text-align:center"><p></p></td>
</tr>
</tbody>
</table>
<p>La tabla anterior indica por ejemplo en su primer renglón que cada lote del producto 1 que se produce por semana emplea una hora de producción en la planta 1 y sólo se dispone de 4 horas semanales. Como se lee en la tabla, cada producto se fabrica en lotes de modo que la tasa de producción está definida como el número de lotes que se producen a la semana.</p>
<p>Se permite cualquier combinación de tasas de producción que satisfaga estas restricciones, incluso no fabricar uno de los productos y elaborar todo lo que sea posible del otro.</p>
<p>Se desea determinar cuáles tasas de producción (no negativas) deben tener los dos productos con el fin de maximizar las utilidades totales sujetas a las restricciones impuestas por las capacidades de producción limitadas disponibles en las tres plantas.</p>
<p>Se modela el problema anterior como un PL con las siguientes variables:</p>
<p><span class="math notranslate nohighlight">\(x_1\)</span>: número de lotes del producto 1 que se fabrican por semana.</p>
<p><span class="math notranslate nohighlight">\(x_2\)</span>: número de lotes del producto 2 que se fabrican por semana.</p>
<p><span class="math notranslate nohighlight">\(f_o(x_1, x_2)\)</span>: ganancia semanal total (en miles de pesos) que generan estos dos productos.</p>
<p>El objetivo es elegir los valores de <span class="math notranslate nohighlight">\(x_1, x_2\)</span> que maximicen <span class="math notranslate nohighlight">\(f_o\)</span> sujeta a las restricciones impuestas sobre sus valores por las capacidades de producción limitadas de las cuales se disponen en las tres plantas. Esto es, resolver el PL siguiente:</p>
<div class="math notranslate nohighlight">
\[\displaystyle \max 3x_1 + 5x_2\]</div>
<div class="math notranslate nohighlight">
\[\text{sujeto a: }\]</div>
<div class="math notranslate nohighlight">
\[x_1 \leq 4\]</div>
<div class="math notranslate nohighlight">
\[2x_2 \leq 12\]</div>
<div class="math notranslate nohighlight">
\[3x_1 + 2x_2 \leq 18\]</div>
<div class="math notranslate nohighlight">
\[x_1 \geq 0, x_2 \geq 0\]</div>
<p>A continuación se muestra un procedimiento gráfico para resolver el PL anterior. Esto es posible realizar pues tenemos sólo dos variables. Se tomará <span class="math notranslate nohighlight">\(x_1\)</span> como el eje horizontal y <span class="math notranslate nohighlight">\(x_2\)</span> el eje vertical. Entonces se tiene la siguiente región definida por las desigualdades del PL:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#x_1 ≤ 4</span>

<span class="n">point1_x_1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>

<span class="n">point2_x_1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

<span class="n">point1_point2_x_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">row_stack</span><span class="p">((</span><span class="n">point1_x_1</span><span class="p">,</span> <span class="n">point2_x_1</span><span class="p">))</span>

<span class="c1">#x_1 ≥ 0</span>
<span class="n">point3_x_1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>

<span class="n">point4_x_1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

<span class="n">point3_point4_x_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">row_stack</span><span class="p">((</span><span class="n">point3_x_1</span><span class="p">,</span> <span class="n">point4_x_1</span><span class="p">))</span>

<span class="c1">#2x_2 ≤ 12 or x_2 ≤ 6</span>

<span class="n">point1_x_2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>

<span class="n">point2_x_2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>

<span class="n">point1_point2_x_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">row_stack</span><span class="p">((</span><span class="n">point1_x_2</span><span class="p">,</span> <span class="n">point2_x_2</span><span class="p">))</span>

<span class="c1">#x_2 ≥ 0</span>

<span class="n">point3_x_2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="n">point4_x_2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="n">point3_point4_x_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">row_stack</span><span class="p">((</span><span class="n">point3_x_2</span><span class="p">,</span> <span class="n">point4_x_2</span><span class="p">))</span>

<span class="c1">#3x_1 + 2x_2 ≤ 18</span>

<span class="n">x_1_region_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

<span class="n">x_2_region_1</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">18</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">x_1_region_1</span><span class="p">)</span>


<span class="n">x_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

<span class="n">x_2</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">18</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">x_1</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">point1_point2_x_1</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">point1_point2_x_1</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span>
         <span class="n">point3_point4_x_1</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">point3_point4_x_1</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span>
         <span class="n">point1_point2_x_2</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">point1_point2_x_2</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span>
         <span class="n">point3_point4_x_2</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">point3_point4_x_2</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span>
         <span class="n">x_1</span><span class="p">,</span> <span class="n">x_2</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s2">&quot;$x_1 = 4$&quot;</span><span class="p">,</span> <span class="s2">&quot;$x_1 = 0$&quot;</span><span class="p">,</span> 
            <span class="s2">&quot;$2x_2 = 12$&quot;</span><span class="p">,</span> <span class="s2">&quot;$x_2 = 0$&quot;</span><span class="p">,</span>
            <span class="s2">&quot;$3x_1+2x_2 = 18$&quot;</span><span class="p">],</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x_1_region_1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">x_2_region_1</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="n">x_2_region_1</span><span class="o">&lt;=</span><span class="mi">6</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;plum&quot;</span><span class="p">)</span>
<span class="n">x_1_region_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x_1_region_2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;plum&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Región factible del PL&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Programacion_lineal_y_metodo_simplex_65_0.png" src="../../_images/Programacion_lineal_y_metodo_simplex_65_0.png" />
</div>
</div>
<p>La región sombreada es la región factible. Cualquier punto que se elija en la región factible satisface las desigualdades definidas en el PL. Ahora tenemos que seleccionar dentro de la región factible el punto que maximiza el valor de la función objetivo <span class="math notranslate nohighlight">\(f_o\)</span>.</p>
<p>El procedimiento gráfico consiste en dar a <span class="math notranslate nohighlight">\(f_o\)</span> algún valor arbitrario, dibujar la recta definida por tal valor  y “mover tal recta de forma paralela” en la dirección que <span class="math notranslate nohighlight">\(f_o\)</span> crece (si se desea maximizar y en la dirección en la que <span class="math notranslate nohighlight">\(f_o\)</span> decrece si se desea minimizar) hasta que se mantenga en la región factible.</p>
<p>Para la función objetivo del PL anterior queda como sigue:</p>
<div class="math notranslate nohighlight">
\[y = f(x) = 3x_1 + 5x_2\]</div>
<p>y vamos dando valores arbitrarios a <span class="math notranslate nohighlight">\(y\)</span>:</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Todas las rectas tienen la misma pendiente por lo que son paralelas. Cada una de las rectas son las curvas de nivel de <span class="math notranslate nohighlight">\(f_o\)</span></p>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">point1_point2_x_1</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">point1_point2_x_1</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;_nolegend_&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">point3_point4_x_1</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">point3_point4_x_1</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;_nolegend_&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">point1_point2_x_2</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">point1_point2_x_2</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;_nolegend_&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">point3_point4_x_2</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">point3_point4_x_2</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;_nolegend_&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_1</span><span class="p">,</span> <span class="n">x_2</span><span class="p">,</span> <span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;_nolegend_&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x_1_region_1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">x_2_region_1</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="n">x_2_region_1</span><span class="o">&lt;=</span><span class="mi">6</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;plum&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x_1_region_2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;plum&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Región factible del PL&quot;</span><span class="p">)</span>

<span class="n">x_1_line_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

<span class="n">x_2_line_1</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">5</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">x_1_line_1</span> <span class="o">+</span> <span class="mi">10</span><span class="p">)</span>

<span class="n">x_1_line_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

<span class="n">x_2_line_2</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">5</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">x_1_line_2</span> <span class="o">+</span> <span class="mi">20</span><span class="p">)</span>

<span class="n">x_1_line_3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

<span class="n">x_2_line_3</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">5</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">x_1_line_3</span> <span class="o">+</span> <span class="mi">36</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_1_line_1</span><span class="p">,</span> <span class="n">x_2_line_1</span><span class="p">,</span> <span class="s2">&quot;green&quot;</span><span class="p">,</span>
         <span class="n">x_1_line_2</span><span class="p">,</span> <span class="n">x_2_line_2</span><span class="p">,</span> <span class="s2">&quot;indigo&quot;</span><span class="p">,</span>
         <span class="n">x_1_line_3</span><span class="p">,</span> <span class="n">x_2_line_3</span><span class="p">,</span> <span class="s2">&quot;darkturquoise&quot;</span>
         <span class="p">)</span>


<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s2">&quot;$10 = 3x_1 + 5x_2$&quot;</span><span class="p">,</span>
            <span class="s2">&quot;$20 = 3x_1 + 5x_2$&quot;</span><span class="p">,</span>
            <span class="s2">&quot;$36 = 3x_1 + 5x_2$&quot;</span><span class="p">],</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span>
            <span class="n">facecolors</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">edgecolors</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>


<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Programacion_lineal_y_metodo_simplex_69_0.png" src="../../_images/Programacion_lineal_y_metodo_simplex_69_0.png" />
</div>
</div>
<p>Si realizamos este proceso para valores de <span class="math notranslate nohighlight">\(y\)</span> iguales a <span class="math notranslate nohighlight">\(36, 20, 10\)</span> observamos que la recta que da el mayor valor de la <span class="math notranslate nohighlight">\(f_o\)</span> y que se mantiene en la región factible es aquella con valor <span class="math notranslate nohighlight">\(y_1= f(x) = 36\)</span>. Corresponde a la pareja <span class="math notranslate nohighlight">\((x_1, x_2) = (2, 6)\)</span> y es la <strong>solución óptima</strong>. Entonces produciendo los productos <span class="math notranslate nohighlight">\(1\)</span> y <span class="math notranslate nohighlight">\(2\)</span> a una tasa de <span class="math notranslate nohighlight">\(2\)</span> y <span class="math notranslate nohighlight">\(6\)</span> lotes por semana se maximiza la ganancia siendo de 36 mil pesos. No existen otras tasas de producción que sean tan redituables como la anterior de acuerdo con el modelo.</p>
<div class="admonition-comentarios admonition">
<p class="admonition-title">Comentarios</p>
<ul class="simple">
<li><p>El método gráfico anterior sólo funciona para dos o tres dimensiones.</p></li>
<li><p>El gradiente de la función objetivo nos indica la dirección de máximo crecimiento de <span class="math notranslate nohighlight">\(f_o\)</span>. En el ejemplo anterior <span class="math notranslate nohighlight">\(\nabla f_o(x) = \left [ \begin{array}{c} 3 \\ 5 \end{array} \right ]\)</span> y tal vector apunta hacia la derecha y hacia arriba. Entonces en esa dirección es hacia donde desplazamos las rectas paralelas.</p></li>
<li><p>La región factible que resultó en el ejemplo anterior se le conoce con el nombre de poliedro y es un conjunto convexo (en dos dimensiones se le nombra polígono). Es una intersección finita entre hiperplanos y semi espacios, también puede pensarse como el conjunto solución de un número finito de ecuaciones y desigualdades lineales.</p></li>
</ul>
</div>
<div class="tip admonition">
<p class="admonition-title">Observación</p>
<p>Si se utiliza un PL con otras formas diferentes a la del ejemplo (por ejemplo variables libres en lugar de no negativas) es posible que la interpretación de “asignación de recursos limitados entre actividades que compiten” puede ya no aplicarse muy bien; pero sin importar cuál sea la interpretación o el contexto, lo único necesario es que la formulación matemática del problema se ajuste a las formas permitidas.</p>
</div>
<div class="tip admonition">
<p class="admonition-title">Ejercicio</p>
<p>Resuelve con el método gráfico el siguiente PL:</p>
<div class="math notranslate nohighlight">
\[\displaystyle \max 2x_1 + x_2\]</div>
<div class="math notranslate nohighlight">
\[\text{sujeto a: }\]</div>
<div class="math notranslate nohighlight">
\[x_2 \leq 10\]</div>
<div class="math notranslate nohighlight">
\[2x_1 + 5x_2 \leq 60\]</div>
<div class="math notranslate nohighlight">
\[x_1 + x_2 \leq 18\]</div>
<div class="math notranslate nohighlight">
\[3x_1 + x_2 \leq 44\]</div>
<div class="math notranslate nohighlight">
\[x_1 \geq 0, x_2 \geq 0\]</div>
<p>Marca al gradiente de la función objetivo en la gráfica.</p>
</div>
</div>
<div class="section" id="tipo-de-soluciones-en-un-pl">
<h2>Tipo de soluciones en un PL<a class="headerlink" href="#tipo-de-soluciones-en-un-pl" title="Permalink to this headline">¶</a></h2>
<p>Los puntos factibles que resultan de la intersección entre las rectas del ejemplo anterior que corresponden a las desigualdades se les nombra <strong>soluciones factibles en un vértice (FEV)</strong> (se encuentran en una esquina). Las soluciones FEV <strong>no</strong> son una combinación convexa estricta entre puntos distintos del poliedro (no caen en algún segmento de línea formado por dos puntos distintos).</p>
<div class="tip admonition">
<p class="admonition-title">Observación</p>
<p>También a las soluciones FEV se les conoce como <strong>puntos extremos</strong> pero resulta más sencillo recordar FEV.</p>
</div>
<p>El método gráfico en la región anterior ilustra una <strong>propiedad importante</strong> de los PL con soluciones factibles y una región acotada: siempre tiene soluciones FEV y al menos una solución óptima, aún más, la mejor solución en un FEV debe ser una solución óptima.</p>
<div class="section" id="a-que-le-llamamos-solucion-en-un-pl">
<h3>¿A qué le llamamos solución en un PL?<a class="headerlink" href="#a-que-le-llamamos-solucion-en-un-pl" title="Permalink to this headline">¶</a></h3>
<p>Cualquier conjunto de valores de las variables de decisión (<span class="math notranslate nohighlight">\(x_1, x_2, \dots, x_n\)</span>) se le nombra una solución y se identifican dos tipos:</p>
<ul class="simple">
<li><p>Una solución factible es aquella para la cual todas las restricciones se satisfacen.</p></li>
<li><p>Una solución no factible es aquella para la cual al menos una restricción no se satisface.</p></li>
</ul>
<p>En el ejemplo los puntos <span class="math notranslate nohighlight">\((2,3)\)</span> y <span class="math notranslate nohighlight">\((4,1)\)</span> son soluciones factibles y <span class="math notranslate nohighlight">\((-1, 3), (4,4)\)</span> son soluciones no factibles.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">point1_point2_x_1</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">point1_point2_x_1</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;_nolegend_&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">point3_point4_x_1</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">point3_point4_x_1</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;_nolegend_&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">point1_point2_x_2</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">point1_point2_x_2</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;_nolegend_&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">point3_point4_x_2</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">point3_point4_x_2</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;_nolegend_&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_1</span><span class="p">,</span> <span class="n">x_2</span><span class="p">,</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;_nolegend_&quot;</span><span class="p">)</span>


<span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x_1_region_1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">x_2_region_1</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="n">x_2_region_1</span><span class="o">&lt;=</span><span class="mi">6</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;plum&quot;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;_nolegend_&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x_1_region_2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;plum&quot;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;_nolegend_&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;v&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;^&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s2">&quot;Solución factible&quot;</span><span class="p">,</span> <span class="s2">&quot;Solución factible&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Solución no factible&quot;</span><span class="p">,</span> <span class="s2">&quot;Solución no factible&quot;</span><span class="p">])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Tipos de soluciones en un PL&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Programacion_lineal_y_metodo_simplex_81_0.png" src="../../_images/Programacion_lineal_y_metodo_simplex_81_0.png" />
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>“Valor más favorable de la función objetivo” depende si se tiene un problema de maximización o minimización.</p>
</div>
<p>De las soluciones factibles se busca aquella solución óptima (puede haber más de una) que nos dé el valor “más favorable” (valor óptimo) de la función objetivo.</p>
</div>
<div class="section" id="ejemplo-mas-de-una-solucion-optima">
<h3>Ejemplo: más de una solución óptima<a class="headerlink" href="#ejemplo-mas-de-una-solucion-optima" title="Permalink to this headline">¶</a></h3>
<p>Es posible tener más de una solución óptima, por ejemplo si la función objetivo hubiera sido <span class="math notranslate nohighlight">\(f_o(x) = 3x_1 + 2x_2\)</span> entonces:</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">point4</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="n">point5</span> <span class="o">=</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

<span class="n">point4_point5</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">row_stack</span><span class="p">((</span><span class="n">point4</span><span class="p">,</span> <span class="n">point5</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">point1_point2_x_1</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">point1_point2_x_1</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span>
         <span class="n">point3_point4_x_1</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">point3_point4_x_1</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span>
         <span class="n">point1_point2_x_2</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">point1_point2_x_2</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span>
         <span class="n">point3_point4_x_2</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">point3_point4_x_2</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span>
         <span class="n">x_1</span><span class="p">,</span> <span class="n">x_2</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x_1_region_1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">x_2_region_1</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="n">x_2_region_1</span><span class="o">&lt;=</span><span class="mi">6</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;plum&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x_1_region_2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;plum&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">point4_point5</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">point4_point5</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> 
         <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;darkred&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s2">&quot;$x_1 = 4$&quot;</span><span class="p">,</span> <span class="s2">&quot;$x_1 = 0$&quot;</span><span class="p">,</span> 
            <span class="s2">&quot;$2x_2 = 12$&quot;</span><span class="p">,</span> <span class="s2">&quot;$x_2 = 0$&quot;</span><span class="p">,</span>
            <span class="s2">&quot;$3x_1+2x_2 = 18$&quot;</span><span class="p">,</span>
            <span class="s2">&quot;$18 = f_o(x) = 3x_1 + 2x_2$&quot;</span><span class="p">],</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Región factible del PL&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Programacion_lineal_y_metodo_simplex_86_0.png" src="../../_images/Programacion_lineal_y_metodo_simplex_86_0.png" />
</div>
</div>
<p>El segmento de recta que va de <span class="math notranslate nohighlight">\((2,6)\)</span> a <span class="math notranslate nohighlight">\((4,3)\)</span> (en línea punteada) son soluciones óptimas. Tal segmento es la curva de nivel de <span class="math notranslate nohighlight">\(f_o(x)\)</span> con el valor <span class="math notranslate nohighlight">\(18\)</span>. Cualquier PL que tenga soluciones óptimas múltiples tendrá un número infinito de ellas, todas con el mismo valor óptimo.</p>
<div class="admonition-comentario admonition">
<p class="admonition-title">Comentario</p>
<p>Si un PL tiene exactamente una solución óptima, ésta debe ser una solución FEV. Si tiene múltiples soluciones óptimas, al menos dos deben ser soluciones FEV. Por esto para resolver problemas de PL sólo tenemos que considerar un número finito de soluciones.</p>
</div>
</div>
<div class="section" id="ejemplo-pl-s-sin-solucion">
<h3>Ejemplo: PL’s sin solución<a class="headerlink" href="#ejemplo-pl-s-sin-solucion" title="Permalink to this headline">¶</a></h3>
<p>Es posible que el PL no tenga soluciones óptimas lo cual ocurre sólo si:</p>
<p>1.No tiene soluciones factibles y se le nombra PL <strong>no factible</strong>.</p>
<p>2.Las restricciones no impiden que el valor de la función objetivo mejore indefinidamente en la dirección favorable. En este caso se tiene un PL con función objetivo no acotada y se le nombra PL <strong>no acotado</strong>.</p>
<p>Un ejemplo de un PL no factible pues su región factible es vacía se obtiene al añadir la restricción <span class="math notranslate nohighlight">\(3x_1+ 5x_2 \geq 50\)</span> a las restricciones anteriores:</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#3x_1 + 5x_2 ≥ 50</span>

<span class="n">x_1_b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

<span class="n">x_2_b</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">5</span><span class="o">*</span><span class="p">(</span><span class="mi">50</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">x_1_b</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">point1_point2_x_1</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">point1_point2_x_1</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span>
         <span class="n">point3_point4_x_1</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">point3_point4_x_1</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span>
         <span class="n">point1_point2_x_2</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">point1_point2_x_2</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span>
         <span class="n">point3_point4_x_2</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">point3_point4_x_2</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span>
         <span class="n">x_1</span><span class="p">,</span> <span class="n">x_2</span><span class="p">,</span>
         <span class="n">x_1_b</span><span class="p">,</span> <span class="n">x_2_b</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s2">&quot;$x_1 = 4$&quot;</span><span class="p">,</span> <span class="s2">&quot;$x_1 = 0$&quot;</span><span class="p">,</span> 
            <span class="s2">&quot;$2x_2 = 12$&quot;</span><span class="p">,</span> <span class="s2">&quot;$x_2 = 0$&quot;</span><span class="p">,</span>
            <span class="s2">&quot;$3x_1+2x_2 = 18$&quot;</span><span class="p">,</span>
            <span class="s2">&quot;$3x_1 + 5x_2 = 50$&quot;</span><span class="p">],</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x_1_b</span><span class="p">,</span> <span class="n">x_2_b</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;plum&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x_1_region_1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">x_2_region_1</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="n">x_2_region_1</span><span class="o">&lt;=</span><span class="mi">6</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;plum&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x_1_region_2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;plum&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;No existe solución factible&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Programacion_lineal_y_metodo_simplex_92_0.png" src="../../_images/Programacion_lineal_y_metodo_simplex_92_0.png" />
</div>
</div>
<p>La intersección entre las dos regiones sombreadas es vacía.</p>
<p>Un ejemplo de un PL no acotado resulta de sólo considerar las restricciones <span class="math notranslate nohighlight">\(x_1 \leq 4, x_1 \geq 0, x_2 \geq 0\)</span>:</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">11</span><span class="p">)))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">point1_point2_x_1</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">point1_point2_x_1</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span>
         <span class="n">point3_point4_x_1</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">point3_point4_x_1</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span>
         <span class="n">point3_point4_x_2</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">point3_point4_x_2</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">points</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">points</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s2">&quot;$x_1 = 4$&quot;</span><span class="p">,</span> <span class="s2">&quot;$x_1 = 0$&quot;</span><span class="p">,</span> 
            <span class="s2">&quot;$x_2 = 0$&quot;</span><span class="p">],</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>


<span class="n">x_1_region</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x_1_region</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;plum&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Región factible no acotada&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Programacion_lineal_y_metodo_simplex_95_0.png" src="../../_images/Programacion_lineal_y_metodo_simplex_95_0.png" />
</div>
</div>
<p>Se observa en la gráfica anterior que se tiene una región factible no acotada y como el objetivo es maximizar podemos elegir el valor <span class="math notranslate nohighlight">\(x_1 = 4\)</span> y arbitrariamente un valor cada vez más grande de <span class="math notranslate nohighlight">\(x_2\)</span> y obtendremos una mejor solución dentro de la región factible.</p>
</div>
</div>
<div class="section" id="metodo-simplex">
<h2>Método símplex<a class="headerlink" href="#metodo-simplex" title="Permalink to this headline">¶</a></h2>
<p>Para comprender sus conceptos fundamentales se considera un PL en una forma <strong>no estándar</strong> y se utiliza el mismo PL del ejemplo anterior:</p>
<div class="math notranslate nohighlight">
\[\displaystyle \max 3x_1 + 5x_2\]</div>
<div class="math notranslate nohighlight">
\[\text{sujeto a: }\]</div>
<div class="math notranslate nohighlight">
\[x_1 \leq 4\]</div>
<div class="math notranslate nohighlight">
\[2x_2 \leq 12\]</div>
<div class="math notranslate nohighlight">
\[3x_1 + 2x_2 \leq 18\]</div>
<div class="math notranslate nohighlight">
\[x_1 \geq 0, x_2 \geq 0\]</div>
<div class="section" id="soluciones-fev-y-nfev">
<h3>Soluciones FEV y NFEV<a class="headerlink" href="#soluciones-fev-y-nfev" title="Permalink to this headline">¶</a></h3>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">point1_point2_x_1</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">point1_point2_x_1</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;_nolegend_&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">point3_point4_x_1</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">point3_point4_x_1</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;_nolegend_&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">point1_point2_x_2</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">point1_point2_x_2</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;_nolegend_&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">point3_point4_x_2</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">point3_point4_x_2</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;_nolegend_&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_1</span><span class="p">,</span> <span class="n">x_2</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;_nolegend_&quot;</span><span class="p">)</span>


<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x_1_region_1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">x_2_region_1</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="n">x_2_region_1</span><span class="o">&lt;=</span><span class="mi">6</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;plum&quot;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;_nolegend_&quot;</span><span class="p">)</span>
<span class="n">x_1_region_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x_1_region_2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;plum&quot;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;_nolegend_&quot;</span><span class="p">)</span>


<span class="n">point_FEV_1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="n">point_FEV_2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>  
<span class="n">point_FEV_3</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span> 
<span class="n">point_FEV_4</span> <span class="o">=</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> 
<span class="n">point_FEV_5</span> <span class="o">=</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>


<span class="n">array_FEV</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">row_stack</span><span class="p">((</span><span class="n">point_FEV_1</span><span class="p">,</span>
                          <span class="n">point_FEV_2</span><span class="p">,</span>
                          <span class="n">point_FEV_3</span><span class="p">,</span>
                          <span class="n">point_FEV_4</span><span class="p">,</span>
                          <span class="n">point_FEV_5</span><span class="p">))</span>

<span class="n">point_NFEV_1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
<span class="n">point_NFEV_2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="n">point_NFEV_3</span> <span class="o">=</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="n">array_NFEV</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">row_stack</span><span class="p">((</span><span class="n">point_NFEV_1</span><span class="p">,</span>
                           <span class="n">point_NFEV_2</span><span class="p">,</span>
                           <span class="n">point_NFEV_3</span><span class="p">))</span>


<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">array_FEV</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">array_FEV</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;orangered&quot;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;FEV&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">array_NFEV</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">array_NFEV</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;darkmagenta&quot;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;NFEV&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Programacion_lineal_y_metodo_simplex_106_0.png" src="../../_images/Programacion_lineal_y_metodo_simplex_106_0.png" />
</div>
</div>
<p>Los puntos en la gráfica con etiqueta “FEV” son soluciones factibles en un vértice:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\((0, 0), (0, 6), (2, 6), (4, 3), (4, 0)\)</span></p></li>
</ul>
<p>y están definidos por las restricciones de desigualdad tomando sólo la igualdad, esto es, por las rectas: <span class="math notranslate nohighlight">\(x_1 = 4, 2x_2 = 12, 3x_1 + 2 x_2 = 18, x_1 = 0, x_2 = 0\)</span>.</p>
<div class="admonition-definiciones admonition">
<p class="admonition-title">Definiciones</p>
<ul class="simple">
<li><p>A las rectas que se forman a partir de una desigualdad tomando únicamente la igualdad se les nombra <strong>ecuaciones de frontera de restricción</strong> o sólo ecuaciones de frontera.</p></li>
<li><p>Las ecuaciones de frontera que definen a las FEV se les nombra <strong>ecuaciones de definición</strong>.</p></li>
</ul>
</div>
<p>Análogamente los puntos con etiqueta “NFEV” son soluciones no factibles en un vértice:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\((0, 9), (4, 6), (6,0)\)</span></p></li>
</ul>
<p>y también están definidos por las ecuaciones de frontera.</p>
<div class="tip admonition">
<p class="admonition-title">Observación</p>
<p>Aunque las soluciones en un vértice también pueden ser no factibles (NFEV) no es de importancia su análisis pues el método símplex no las revisa.</p>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>En más de dos dimensiones cada ecuación de definición genera un hiperplano en un espacio <span class="math notranslate nohighlight">\(n\)</span> dimensional. Y la intersección de las <span class="math notranslate nohighlight">\(n\)</span> ecuaciones de frontera es una solución simultánea de un sistema de <span class="math notranslate nohighlight">\(n\)</span> ecuaciones lineales de definición.</p>
</div>
<div class="admonition-comentario admonition">
<p class="admonition-title">Comentario</p>
<p>En general para un PL con <span class="math notranslate nohighlight">\(n\)</span> variables de decisión se cumple que cada solución FEV se define por la intersección de <span class="math notranslate nohighlight">\(n\)</span> ecuaciones de frontera. Podría ser que se tengan más de <span class="math notranslate nohighlight">\(n\)</span> fronteras de restricción que pasen por el vértice pero <span class="math notranslate nohighlight">\(n\)</span> de ellas definen a la solución FEV y éstas son las ecuaciones de definición.</p>
</div>
<div class="cell tag_hide-input tag_margin docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">point1_point2_x_1</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">point1_point2_x_1</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;_nolegend_&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">point3_point4_x_1</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">point3_point4_x_1</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;_nolegend_&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">point1_point2_x_2</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">point1_point2_x_2</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;_nolegend_&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">point3_point4_x_2</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">point3_point4_x_2</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;_nolegend_&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_1</span><span class="p">,</span> <span class="n">x_2</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;_nolegend_&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x_1_region_1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">x_2_region_1</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="n">x_2_region_1</span><span class="o">&lt;=</span><span class="mi">6</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;plum&quot;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;_nolegend_&quot;</span><span class="p">)</span>
<span class="n">x_1_region_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x_1_region_2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;plum&quot;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;_nolegend_&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">array_FEV</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">array_FEV</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;orangered&quot;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;FEV&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">array_NFEV</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">array_NFEV</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;darkmagenta&quot;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;NFEV&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Programacion_lineal_y_metodo_simplex_113_0.png" src="../../_images/Programacion_lineal_y_metodo_simplex_113_0.png" />
</div>
</div>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-align:center head"><p>Solución FEV</p></th>
<th class="text-align:center head"><p>Ecuaciones de definición</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:center"><p>(0,0)</p></td>
<td class="text-align:center"><p><span class="math notranslate nohighlight">\(x_1 = 0, x_2 = 0\)</span></p></td>
</tr>
<tr class="row-odd"><td class="text-align:center"><p>(0,6)</p></td>
<td class="text-align:center"><p><span class="math notranslate nohighlight">\(x_1 = 0, 2x_2 = 12\)</span></p></td>
</tr>
<tr class="row-even"><td class="text-align:center"><p>(2,6)</p></td>
<td class="text-align:center"><p><span class="math notranslate nohighlight">\(2x_2 = 12, 3x_1 + 2x_2 = 18\)</span></p></td>
</tr>
<tr class="row-odd"><td class="text-align:center"><p>(4,3)</p></td>
<td class="text-align:center"><p><span class="math notranslate nohighlight">\(3x_1 + 2x_2 = 18, x_1 = 4\)</span></p></td>
</tr>
<tr class="row-even"><td class="text-align:center"><p>(4,0)</p></td>
<td class="text-align:center"><p><span class="math notranslate nohighlight">\(x_1 = 4, x_2 = 0\)</span></p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="fev-adyacentes">
<h3>FEV adyacentes<a class="headerlink" href="#fev-adyacentes" title="Permalink to this headline">¶</a></h3>
<div class="admonition-definicion admonition">
<p class="admonition-title">Definición</p>
<p>En un PL con <span class="math notranslate nohighlight">\(n\)</span> variables de decisión nombramos soluciones FEV adyacentes a dos soluciones FEV que comparten <span class="math notranslate nohighlight">\(n-1\)</span> fronteras de restricción. Las soluciones FEV adyacentes están conectadas por una arista (segmento de recta)</p>
</div>
<div class="cell tag_hide-input tag_margin docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">point1_point2_x_1</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">point1_point2_x_1</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;_nolegend_&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">point3_point4_x_1</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">point3_point4_x_1</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;_nolegend_&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">point1_point2_x_2</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">point1_point2_x_2</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;_nolegend_&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">point3_point4_x_2</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">point3_point4_x_2</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;_nolegend_&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_1</span><span class="p">,</span> <span class="n">x_2</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;_nolegend_&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x_1_region_1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">x_2_region_1</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="n">x_2_region_1</span><span class="o">&lt;=</span><span class="mi">6</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;plum&quot;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;_nolegend_&quot;</span><span class="p">)</span>
<span class="n">x_1_region_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x_1_region_2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;plum&quot;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;_nolegend_&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">array_FEV</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">array_FEV</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;orangered&quot;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;FEV&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">array_NFEV</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">array_NFEV</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;darkmagenta&quot;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;NFEV&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Programacion_lineal_y_metodo_simplex_117_0.png" src="../../_images/Programacion_lineal_y_metodo_simplex_117_0.png" />
</div>
</div>
<p>En el ejemplo <span class="math notranslate nohighlight">\((0,0)\)</span> y <span class="math notranslate nohighlight">\((0,6)\)</span> son adyacentes pues comparten una arista formada por la ecuación de frontera <span class="math notranslate nohighlight">\(x_1=0\)</span> y de cada solución FEV salen dos aristas, esto es tienen dos soluciones FEV adyacentes.</p>
<div class="admonition-comentario admonition">
<p class="admonition-title">Comentario</p>
<p>Una razón para analizar las soluciones FEV adyacentes es la siguiente <strong>propiedad</strong>:</p>
<p>si un PL tiene al menos una solución óptima y una solución FEV no tiene soluciones FEV adyacentes que sean mejores entonces ésa debe ser una solución óptima.</p>
</div>
<div class="tip admonition">
<p class="admonition-title">Observación</p>
<p>En el ejemplo <span class="math notranslate nohighlight">\((2, 6)\)</span> es un punto óptimo pues sus soluciones FEV adyacentes, <span class="math notranslate nohighlight">\((0, 6)\)</span>, <span class="math notranslate nohighlight">\((4,3)\)</span> tienen un valor de la función objetivo menor (recuérdese es un problema de maximización).</p>
</div>
</div>
<div class="section" id="pasos-que-sigue-el-metodo-simplex">
<h3>Pasos que sigue el método símplex<a class="headerlink" href="#pasos-que-sigue-el-metodo-simplex" title="Permalink to this headline">¶</a></h3>
<p>Para el ejemplo anterior el método símplex a grandes rasgos realiza lo siguiente:</p>
<p><strong>Paso inicial:</strong> se elige <span class="math notranslate nohighlight">\((0,0)\)</span> como la solución FEV inicial para examinarla (esto siempre se puede hacer para problemas con restricciones de no negatividad).</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>En el ejemplo numérico se entenderá la frase “solución FEV adyacente que es mejor”</p>
</div>
<p><strong>Prueba de optimalidad:</strong> revisar condición de optimalidad para <span class="math notranslate nohighlight">\((0,0)\)</span>. Concluir que <span class="math notranslate nohighlight">\((0,0)\)</span> no es una solución óptima (existe una solución FEV adyacente que es mejor).</p>
<p><strong>Iteración 1:</strong> moverse a una solución FEV adyacente mejor, para esto se realizan los pasos:</p>
<p>1.Entre las dos aristas de la región factible que salen de <span class="math notranslate nohighlight">\((0,0)\)</span> se elige desplazarse <strong>a lo largo</strong> de la arista que aumenta el valor de <span class="math notranslate nohighlight">\(x_2\)</span> (con una función objetivo <span class="math notranslate nohighlight">\(f_o(x) = 3x_1 + 5x_2\)</span> si <span class="math notranslate nohighlight">\(x_2\)</span> aumenta entonces el valor de <span class="math notranslate nohighlight">\(f_o\)</span> crece más que con <span class="math notranslate nohighlight">\(x_1\)</span>).</p>
<p>2.Detenerse al llegar a la primera ecuación de frontera en esa dirección: <span class="math notranslate nohighlight">\(2x_2 = 12\)</span> para <strong>mantener factibilidad</strong>.</p>
<p>3.Obtener la intersección del nuevo conjunto de ecuaciones de frontera: <span class="math notranslate nohighlight">\((0,6)\)</span>.</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>En el ejemplo numérico se entenderá la frase “solución FEV adyacente que es mejor”</p>
</div>
<p><strong>Prueba de optimalidad</strong>: revisar condición de optimalidad para <span class="math notranslate nohighlight">\((0,6)\)</span>. Concluir que <span class="math notranslate nohighlight">\((0,6)\)</span> no es una solución óptima (existe una solución FEV adyacente que es mejor).</p>
<p><strong>Iteración 2:</strong> moverse a una solución FEV adyacente mejor:</p>
<p>1.De las dos aristas que salen de <span class="math notranslate nohighlight">\((0,6)\)</span> moverse a lo largo de la arista que aumenta el valor de <span class="math notranslate nohighlight">\(x_1\)</span> (para que la <span class="math notranslate nohighlight">\(f_o\)</span> continue mejorando no podemos ir hacia abajo pues esto implicaría disminuir el valor de <span class="math notranslate nohighlight">\(x_2\)</span> y por tanto <span class="math notranslate nohighlight">\(f_o\)</span>).</p>
<p>2.Detenerse al llegar a la primera ecuación de frontera en esa dirección: <span class="math notranslate nohighlight">\(3x_1+2x_2 = 12\)</span> para manterner factibilidad.</p>
<p>3.Obtener la intersección del nuevo conjunto de ecuaciones de frontera: <span class="math notranslate nohighlight">\((2,6)\)</span>.</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>En el ejemplo numérico se entenderá la frase “ninguna solución FEV adyacente es mejor”</p>
</div>
<p><strong>Prueba de optimalidad:</strong> revisar condición de optimalidad para <span class="math notranslate nohighlight">\((2,6)\)</span>. Concluir que <span class="math notranslate nohighlight">\((2,6)\)</span> es una solución óptima (ninguna solución FEV adyacente es mejor).</p>
</div>
<div class="section" id="forma-aumentada-de-un-pl">
<h3>Forma aumentada de un PL<a class="headerlink" href="#forma-aumentada-de-un-pl" title="Permalink to this headline">¶</a></h3>
<p>El método símplex inicia con un <strong>sistema de ecuaciones lineales</strong> con lado derecho igual a <span class="math notranslate nohighlight">\(b\)</span> (que es el lado derecho de las restricciones funcionales) y una matriz del sistema con menos renglones que columnas (<span class="math notranslate nohighlight">\(m &lt; n\)</span>). <strong>Asume</strong> que las entradas de <span class="math notranslate nohighlight">\(b\)</span> son no negativas y que el <em>rank</em> de <span class="math notranslate nohighlight">\(A\)</span> es <span class="math notranslate nohighlight">\(m\)</span> (esto es, de <em>rank</em> completo).</p>
<p>Para revisar los pasos del método símplex descritos anteriormente en esta sección continuaremos con el ejemplo anterior de PL:</p>
<div class="math notranslate nohighlight">
\[\displaystyle \max 3x_1 + 5x_2\]</div>
<div class="math notranslate nohighlight">
\[\text{sujeto a: }\]</div>
<div class="math notranslate nohighlight">
\[x_1 \leq 4\]</div>
<div class="math notranslate nohighlight">
\[2x_2 \leq 12\]</div>
<div class="math notranslate nohighlight">
\[3x_1 + 2x_2 \leq 18\]</div>
<div class="math notranslate nohighlight">
\[x_1 \geq 0, x_2 \geq 0\]</div>
<p>Y vamos a nombrar a las desigualdades <span class="math notranslate nohighlight">\(x_1 \leq4, 2x_2 \leq 12, 3x_1 + 2x_12 \leq 18\)</span> <strong>restricciones funcionales</strong> y a las desigualdades <span class="math notranslate nohighlight">\(x_1 \geq 0, x_2 \geq 0\)</span> <strong>restricciones de no negatividad</strong>.</p>
<div class="tip admonition">
<p class="admonition-title">Observación</p>
<p>Aunque hay diversas formas de PL en las que podríamos tener lados derechos negativos o desigualdades del tipo <span class="math notranslate nohighlight">\(\geq\)</span>, es sencillo transformar de forma algebraica tales PL a una forma similar descrita en esta sección.</p>
</div>
<p>En el ejemplo tenemos desigualdades por lo que se introducen <strong>variables de holgura</strong> no negativas para obtener la forma aumentada:</p>
<div class="math notranslate nohighlight">
\[\displaystyle \max 3x_1 + 5x_2\]</div>
<div class="math notranslate nohighlight">
\[\text{sujeto a: }\]</div>
<div class="math notranslate nohighlight">
\[x_1 + x_3 = 4\]</div>
<div class="math notranslate nohighlight">
\[2x_2 + x_4 = 12\]</div>
<div class="math notranslate nohighlight">
\[3x_1 + 2x_2 + x_5 = 18\]</div>
<div class="math notranslate nohighlight">
\[x_1 \geq 0, x_2 \geq 0, x_3 \geq 0, x_4 \geq 0, x_5 \geq 0\]</div>
<p>A esta forma se le nombra <strong>forma aumentada</strong> del PL.</p>
<p>Y en notación matricial el sistema de ecuaciones lineales es:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
Ax = 
\left [
\begin{array}{ccccc}
1 &amp; 0 &amp; 1 &amp; 0 &amp; 0 \\
0 &amp; 2 &amp; 0 &amp; 1 &amp; 0 \\
3 &amp; 2 &amp; 0 &amp; 0 &amp; 1 \\
\end{array}
\right ]
\left [
\begin{array}{c}
x_1 \\
x_2 \\
x_3 \\
x_4 \\
x_5
\end{array}
\right ]
=
\left[
\begin{array}{c}
4 \\
12 \\
18
\end{array}
\right ]
=
b
\end{split}\]</div>
<div class="tip admonition">
<p class="admonition-title">Observación</p>
<p>Obsérvese que en la matriz de la forma aumentada se tiene una matriz identidad.</p>
</div>
<div class="admonition-comentario admonition">
<p class="admonition-title">Comentario</p>
<p>Interpretación de algunos valores de las variables en la forma aumentada:</p>
<p>Si una variable de holgura es igual a <span class="math notranslate nohighlight">\(0\)</span> en la solución actual, entonces esta solución se encuentra sobre la ecuación de frontera de la restricción funcional correspondiente. Un valor mayor que <span class="math notranslate nohighlight">\(0\)</span> significa que la solución está en el lado factible de la ecuación de frontera, mientras que un valor menor que <span class="math notranslate nohighlight">\(0\)</span> señala que está en el lado no factible de esta ecuación de frontera.</p>
</div>
<div class="tip admonition">
<p class="admonition-title">Observación</p>
<p>Obsérvese que las variables de holgura al iniciar el método tienen un coeficiente de <span class="math notranslate nohighlight">\(0\)</span> en la función objetivo <span class="math notranslate nohighlight">\(f_o(x) = 3x_1 + 5x_2 = 3x_1 + 5x_2  + 0x_3 + 0x_4 + 0x_5\)</span></p>
</div>
<div class="cell tag_hide-input tag_margin docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">point1_point2_x_1</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">point1_point2_x_1</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;_nolegend_&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">point3_point4_x_1</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">point3_point4_x_1</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;_nolegend_&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">point1_point2_x_2</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">point1_point2_x_2</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;_nolegend_&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">point3_point4_x_2</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">point3_point4_x_2</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;_nolegend_&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_1</span><span class="p">,</span> <span class="n">x_2</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;_nolegend_&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x_1_region_1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">x_2_region_1</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="n">x_2_region_1</span><span class="o">&lt;=</span><span class="mi">6</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;plum&quot;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;_nolegend_&quot;</span><span class="p">)</span>
<span class="n">x_1_region_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x_1_region_2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;plum&quot;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;_nolegend_&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">array_FEV</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">array_FEV</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;orangered&quot;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;FEV&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">array_NFEV</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">array_NFEV</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;darkmagenta&quot;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;NFEV&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Programacion_lineal_y_metodo_simplex_155_0.png" src="../../_images/Programacion_lineal_y_metodo_simplex_155_0.png" />
</div>
</div>
<div class="admonition-definiciones admonition">
<p class="admonition-title">Definiciones</p>
<p>Una <strong>solución aumentada</strong> es una solución de las variables originales que se aumentó con los valores correspondientes de las variables de holgura.</p>
<p>Una <strong>solución básica</strong> es una solución FEV o NFEV aumentada.</p>
<p>Una <strong>solución básica factible (BF)</strong> es una solución FEV aumentada.</p>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<div class="math notranslate nohighlight">
\[\begin{split}
\left [
\begin{array}{ccccc}
1 &amp; 0 &amp; 1 &amp; 0 &amp; 0 \\
0 &amp; 2 &amp; 0 &amp; 1 &amp; 0 \\
3 &amp; 2 &amp; 0 &amp; 0 &amp; 1 \\
\end{array}
\right ]
\left [
\begin{array}{c}
x_1 \\
x_2 \\
x_3 \\
x_4 \\
x_5
\end{array}
\right ]
=
\left[
\begin{array}{c}
4 \\
12 \\
18
\end{array}
\right ]
\end{split}\]</div>
</div>
<p>En el ejemplo:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\left [ \begin{array}{c} x_1 \\ x_2 \end{array} \right ] = \left [ \begin{array}{c} 3 \\ 2 \end{array} \right ]\)</span> es solución (de hecho factible) y <span class="math notranslate nohighlight">\(\left [ \begin{array}{c} x_1 \\ x_2 \\ x_3 \\ x_4 \\ x_5 \end{array} \right ] = \left [ \begin{array}{c} 3 \\ 2 \\ 1 \\ 8 \\ 5 \end{array} \right ]\)</span> es solución aumentada (factible).</p></li>
<li><p><span class="math notranslate nohighlight">\(\left [ \begin{array}{c} x_1 \\ x_2 \end{array} \right ] =  \left [ \begin{array}{c} 4 \\ 6 \end{array} \right ]\)</span> es solución NFEV y <span class="math notranslate nohighlight">\(\left [ \begin{array}{c} x_1 \\ x_2 \\ x_3 \\ x_4 \\ x_5 \end{array} \right ] = \left [ \begin{array}{c} 4 \\ 6 \\ 0 \\ 0 \\ -6 \end{array} \right ]\)</span> es solución básica.</p></li>
<li><p><span class="math notranslate nohighlight">\(\left [ \begin{array}{c} x_1 \\ x_2 \end{array} \right ] =  \left [ \begin{array}{c} 0 \\ 6 \end{array} \right ]\)</span> es solución FEV y <span class="math notranslate nohighlight">\(\left [ \begin{array}{c} x_1 \\ x_2 \\ x_3 \\ x_4 \\ x_5 \end{array} \right ] = \left [ \begin{array}{c} 0 \\ 6 \\ 4 \\ 0 \\ 6 \end{array} \right ]\)</span> es solución BF.</p></li>
</ul>
</div>
<div class="section" id="soluciones-bf-adyacentes">
<h3>Soluciones BF adyacentes<a class="headerlink" href="#soluciones-bf-adyacentes" title="Permalink to this headline">¶</a></h3>
<div class="admonition-definicion admonition">
<p class="admonition-title">Definición</p>
<p>Dos soluciones BF son adyacentes si sus correspondientes soluciones FEV lo son.</p>
</div>
<div class="cell tag_hide-input tag_margin docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">point1_point2_x_1</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">point1_point2_x_1</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;_nolegend_&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">point3_point4_x_1</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">point3_point4_x_1</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;_nolegend_&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">point1_point2_x_2</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">point1_point2_x_2</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;_nolegend_&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">point3_point4_x_2</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">point3_point4_x_2</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;_nolegend_&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_1</span><span class="p">,</span> <span class="n">x_2</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;_nolegend_&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x_1_region_1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">x_2_region_1</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="n">x_2_region_1</span><span class="o">&lt;=</span><span class="mi">6</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;plum&quot;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;_nolegend_&quot;</span><span class="p">)</span>
<span class="n">x_1_region_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x_1_region_2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;plum&quot;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;_nolegend_&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">array_FEV</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">array_FEV</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;orangered&quot;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;FEV&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">array_NFEV</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">array_NFEV</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;darkmagenta&quot;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;NFEV&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Programacion_lineal_y_metodo_simplex_161_0.png" src="../../_images/Programacion_lineal_y_metodo_simplex_161_0.png" />
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<div class="math notranslate nohighlight">
\[\begin{split}
\left [
\begin{array}{ccccc}
1 &amp; 0 &amp; 1 &amp; 0 &amp; 0 \\
0 &amp; 2 &amp; 0 &amp; 1 &amp; 0 \\
3 &amp; 2 &amp; 0 &amp; 0 &amp; 1 \\
\end{array}
\right ]
\left [
\begin{array}{c}
x_1 \\
x_2 \\
x_3 \\
x_4 \\
x_5
\end{array}
\right ]
=
\left[
\begin{array}{c}
4 \\
12 \\
18
\end{array}
\right ]
\end{split}\]</div>
</div>
<p>En el ejemplo <span class="math notranslate nohighlight">\(\left [ \begin{array}{c} 0 \\ 0 \\ 4 \\ 12 \\ 18 \end{array} \right ]\)</span> y <span class="math notranslate nohighlight">\(\left [ \begin{array}{c} 0 \\ 6 \\ 4 \\ 0 \\ 6 \end{array} \right ]\)</span> son soluciones BF adyacentes.</p>
</div>
<div class="section" id="variables-basicas-y-no-basicas">
<h3>Variables básicas y no básicas<a class="headerlink" href="#variables-basicas-y-no-basicas" title="Permalink to this headline">¶</a></h3>
<div class="admonition-definicion admonition">
<p class="admonition-title">Definición</p>
<p>Dada la matriz <span class="math notranslate nohighlight">\(A \in \mathbb{R}^{m \times n}\)</span> de la forma aumentada aquellas variables de decisión que corresponden a columnas linealmente independientes se les nombra <strong>variables básicas</strong>. Las restantes son <strong>variables no básicas</strong>.</p>
</div>
<p>Al inicio del método símplex la matriz de la forma aumentada es:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\left [
\begin{array}{ccccc}
1 &amp; 0 &amp; 1 &amp; 0 &amp; 0 \\
0 &amp; 2 &amp; 0 &amp; 1 &amp; 0 \\
3 &amp; 2 &amp; 0 &amp; 0 &amp; 1 \\
\end{array}
\right ]
\end{split}\]</div>
<p>Por lo que las variables básicas son <span class="math notranslate nohighlight">\(x_3, x_4, x_5\)</span> y las no básicas son <span class="math notranslate nohighlight">\(x_1, x_2\)</span>.</p>
<div class="admonition-definicion admonition">
<p class="admonition-title">Definición</p>
<p>La matriz que se forma a partir de las columnas de <span class="math notranslate nohighlight">\(A\)</span> que corresponden a las variables básicas se denota como <span class="math notranslate nohighlight">\(B \in \mathbb{R}^{m \times m}\)</span> es no singular y se nombra <em><strong>basis matrix</strong></em>. La matriz que se forma con las columnas de las variables no básicas se denota con <span class="math notranslate nohighlight">\(N\)</span> y su nombre es <strong>nonbasis matrix</strong>.</p>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<div class="math notranslate nohighlight">
\[\begin{split}
\left [
\begin{array}{ccccc}
1 &amp; 0 &amp; 1 &amp; 0 &amp; 0 \\
0 &amp; 2 &amp; 0 &amp; 1 &amp; 0 \\
3 &amp; 2 &amp; 0 &amp; 0 &amp; 1 \\
\end{array}
\right ]
\left [
\begin{array}{c}
x_1 \\
x_2 \\
x_3 \\
x_4 \\
x_5
\end{array}
\right ]
=
\left[
\begin{array}{c}
4 \\
12 \\
18
\end{array}
\right ]
\end{split}\]</div>
</div>
<p>En el ejemplo la <em>basis matrix</em> y la <em>nonbasis matrix</em> al inicio del método son:</p>
<div class="math notranslate nohighlight">
\[\begin{split}B
=\left [
\begin{array}{ccc}
1 &amp; 0 &amp; 0 \\
0 &amp; 1 &amp; 0 \\
0 &amp; 0 &amp; 1 \\
\end{array}
\right ]
\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}N
=
\left [
\begin{array}{ccccc}
1 &amp; 0 \\
0 &amp; 2 \\
3 &amp; 2 \\
\end{array}
\right ]
\end{split}\]</div>
<div class="admonition-comentarios admonition">
<p class="admonition-title">Comentarios</p>
<ul class="simple">
<li><p>Obsérvese en el ejemplo que al tener 5 variables y tres ecuaciones si se le asigna un valor arbitrario a <span class="math notranslate nohighlight">\(x_1, x_2\)</span> entonces quedan determinadas las variables <span class="math notranslate nohighlight">\(x_3, x_4, x_5\)</span>. En el método símplex las variables no básicas se igualan a <span class="math notranslate nohighlight">\(0\)</span> por lo que se tiene: <span class="math notranslate nohighlight">\(\left [ \begin{array}{c} x_1 \\ x_2 \\ x_3 \\ x_4 \end{array} \right ] = \left [ \begin{array}{c} 0 \\ 0 \\ 4 \\ 12 \\ 18 \end{array} \right ]\)</span></p></li>
<li><p>Una forma de distinguir si dos soluciones BF son adyacentes es comparar qué variables no básicas (análogamente sus básicas) tienen. Si difieren en sólo una entonces son soluciones BF adyacentes. Por ejemplo: <span class="math notranslate nohighlight">\(\left [ \begin{array}{c} 0 \\ 0 \\ 4 \\ 12 \\ 18 \end{array} \right]\)</span> y <span class="math notranslate nohighlight">\(\left [ \begin{array}{c} 0 \\ 6 \\ 4 \\ 0 \\ 6 \end{array} \right ]\)</span> son BF adyacentes pues tienen como variables no básicas <span class="math notranslate nohighlight">\(x_1, x_2\)</span> y <span class="math notranslate nohighlight">\(x_1, x_4\)</span> respectivamente. Esto también se puede describir como: <span class="math notranslate nohighlight">\(x_2\)</span> “pasa de ser no básica a básica” (análogamente <span class="math notranslate nohighlight">\(x_4\)</span> pasa de básica a no básica). Lo anterior ayuda a identificar soluciones BF adyacentes en PL’s con más de dos variables en los que resulta más complicado graficar.</p></li>
<li><p>El método símplex al considerar variables no básicas con valor de <span class="math notranslate nohighlight">\(0\)</span> indica que la restricción no negativa <span class="math notranslate nohighlight">\(x_j \leq 0\)</span> es <strong>activa</strong> para <span class="math notranslate nohighlight">\(j\)</span> en los índices de las variables no básicas.</p></li>
<li><p>En el método símplex se puede verificar que una solución es BF si las variables básicas son no negativas (recuérdese que las no básicas en el método son igualadas a cero).</p></li>
</ul>
</div>
</div>
<div class="section" id="variables-basicas-no-degeneradas-y-degeneradas">
<h3>Variables básicas no degeneradas y degeneradas<a class="headerlink" href="#variables-basicas-no-degeneradas-y-degeneradas" title="Permalink to this headline">¶</a></h3>
<p>Denotemos a <span class="math notranslate nohighlight">\(\mathcal{B}\)</span> como el conjunto de índices en el conjunto <span class="math notranslate nohighlight">\(\{1, 2, \dots, m+n\}\)</span> que representan a las variables básicas y <span class="math notranslate nohighlight">\(\mathcal{N}\)</span> al conjunto de índices de las no básicas. En el ejemplo <span class="math notranslate nohighlight">\(\mathcal{B} = \{3, 4, 5\}\)</span>, <span class="math notranslate nohighlight">\(\mathcal{N} = \{1, 2\}\)</span> con <span class="math notranslate nohighlight">\(m+n=5\)</span> al inicio del método símplex. El método en sus iteraciones elige algún índice de <span class="math notranslate nohighlight">\(\mathcal{N}\)</span> y lo sustituye por un índice del conjunto <span class="math notranslate nohighlight">\(\mathcal{B}\)</span>.</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>En el ejemplo se entenderá la frase “mejoren la función objetivo <span class="math notranslate nohighlight">\(f_o\)</span>”</p>
</div>
<div class="admonition-comentarios admonition">
<p class="admonition-title">Comentarios</p>
<ul class="simple">
<li><p>El quitar y añadir variables a los conjuntos de índices <span class="math notranslate nohighlight">\(\mathcal{N}, \mathcal{B}\)</span> y realizar los ajustes necesarios (recalcular valores de las variables básicas) en los valores de todas las variables básicas y no básicas se le conoce con el nombre de <strong>pivoteo</strong>.</p></li>
<li><p>La interpretación geométrica de quitar, añadir variables de las matrices <span class="math notranslate nohighlight">\(N, B\)</span> y realizar los ajustes necesarios (recalcular valores de las variables básicas) en una solución BF es equivalente en dos dimensiones a moverse por una arista y detenerse hasta encontrar una solución FEV.</p></li>
<li><p>La elección de cuál variable no básica sustituir por una variable básica depende de la existencia de soluciones BF que mejoren la función objetivo <span class="math notranslate nohighlight">\(f_o\)</span> y para ello se utiliza un criterio de optimalidad.</p></li>
</ul>
</div>
<div class="admonition-definicion admonition">
<p class="admonition-title">Definición</p>
<p>Una solución BF en la que todas sus variables básicas son no negativas se nombra no degenerada y degenerada si existe al menos una con valor igual a cero.</p>
</div>
</div>
</div>
<div class="section" id="ejemplo-del-metodo-simplex">
<h2>Ejemplo del método símplex<a class="headerlink" href="#ejemplo-del-metodo-simplex" title="Permalink to this headline">¶</a></h2>
<p>Continuemos con el ejemplo anterior en su forma aumentada:</p>
<div class="math notranslate nohighlight">
\[\displaystyle \max 3x_1 + 5x_2\]</div>
<div class="math notranslate nohighlight">
\[\text{sujeto a: }\]</div>
<div class="math notranslate nohighlight">
\[x_1 + x_3 = 4\]</div>
<div class="math notranslate nohighlight">
\[2x_2 + x_4 = 12\]</div>
<div class="math notranslate nohighlight">
\[3x_1 + 2x_2 + x_5 = 18\]</div>
<div class="math notranslate nohighlight">
\[x_1 \geq 0, x_2 \geq 0, x_3 \geq 0, x_4 \geq 0, x_5 \geq 0\]</div>
<p>Y en notación matricial el sistema de ecuaciones lineales es:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
Ax = 
\left [
\begin{array}{ccccc}
1 &amp; 0 &amp; 1 &amp; 0 &amp; 0 \\
0 &amp; 2 &amp; 0 &amp; 1 &amp; 0 \\
3 &amp; 2 &amp; 0 &amp; 0 &amp; 1 \\
\end{array}
\right ]
\left [
\begin{array}{c}
x_1 \\
x_2 \\
x_3 \\
x_4 \\
x_5
\end{array}
\right ]
=
\left[
\begin{array}{c}
4 \\
12 \\
18
\end{array}
\right ]
=
b
\end{split}\]</div>
<p>Defínanse al vector <span class="math notranslate nohighlight">\(x\)</span> que contiene las variables “originales” y a las de holgura: <span class="math notranslate nohighlight">\(x = \left [ \begin{array}{c} x_1 \\ x_2 \\ x_3 \\ x_4 \\ x_5 \end{array} \right ]\)</span> y <span class="math notranslate nohighlight">\(c = \left [ \begin{array}{c} 3 \\ 5 \\ 0 \\ 0 \\ 0 \end{array}\right]\)</span> al vector de costos por lo que la función objetivo es: <span class="math notranslate nohighlight">\(f_o(x) = c^Tx\)</span>. También defínanse a los vectores de variables básicas y no básicas como: <span class="math notranslate nohighlight">\(x_B = [x_j]_{j \in \mathcal{B}}\)</span>, <span class="math notranslate nohighlight">\(x_N = [x_j]_{j \in \mathcal{N}}\)</span>.</p>
<p>Entonces el PL con esta notación que se debe resolver está en la forma estándar:</p>
<div class="math notranslate nohighlight">
\[\displaystyle \max_{x \in \mathbb{R}^5} c^Tx\]</div>
<div class="math notranslate nohighlight">
\[\text{sujeto a: }\]</div>
<div class="math notranslate nohighlight">
\[Ax = b\]</div>
<div class="math notranslate nohighlight">
\[x \geq 0\]</div>
<p>con <span class="math notranslate nohighlight">\(x=\left [ \begin{array}{c} x_B \\ x_N\end{array} \right ]\)</span>, <span class="math notranslate nohighlight">\(x_B \in \mathbb{R}^{3}, x_N \in \mathbb{R}^2\)</span>, <span class="math notranslate nohighlight">\(A \in \mathbb{R}^{3 \times 5}\)</span>.</p>
<div class="section" id="paso-inicial">
<h3>Paso inicial<a class="headerlink" href="#paso-inicial" title="Permalink to this headline">¶</a></h3>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<div class="math notranslate nohighlight">
\[\displaystyle \max 3x_1 + 5x_2\]</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<div class="math notranslate nohighlight">
\[\text{sujeto a: }\]</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<div class="math notranslate nohighlight">
\[x_1 + x_3 = 4\]</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<div class="math notranslate nohighlight">
\[2x_2 + x_4 = 12\]</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<div class="math notranslate nohighlight">
\[3x_1 + 2x_2 + x_5 = 18\]</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<div class="math notranslate nohighlight">
\[x_1 \geq 0, x_2 \geq 0, x_3 \geq 0, x_4 \geq 0, x_5 \geq 0\]</div>
</div>
<p>Se tienen la siguiente situación:</p>
<div class="math notranslate nohighlight">
\[c^Tx= 3x_1 + 5x_2 + 0x_3 + 0x_4 + 0x_5\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}
A = 
\left [
\begin{array}{ccccc}
1 &amp; 0 &amp; 1 &amp; 0 &amp; 0 \\
0 &amp; 2 &amp; 0 &amp; 1 &amp; 0 \\
3 &amp; 2 &amp; 0 &amp; 0 &amp; 1 \\
\end{array}
\right ]
\end{split}\]</div>
<p>Como <span class="math notranslate nohighlight">\(A = [ B \quad N ]\)</span> y <span class="math notranslate nohighlight">\(Ax = b\)</span> entonces <span class="math notranslate nohighlight">\(Ax = B x_B + N x_N = b\)</span>.</p>
<p>Se designa <span class="math notranslate nohighlight">\(x_N\)</span> como un vector de ceros:</p>
<div class="math notranslate nohighlight">
\[\begin{split}x_N = \left [ \begin{array}{c} x_1 \\ x_2 \end{array} \right ] = \left [ \begin{array}{c} 0 \\ 0 \end{array} \right ]\end{split}\]</div>
<p>Por tanto:</p>
<div class="math notranslate nohighlight">
\[Ax = Bx_B + N x_N = B x_B = b\]</div>
<p>En este paso inicial <span class="math notranslate nohighlight">\(x_B = b\)</span> pues <span class="math notranslate nohighlight">\(B\)</span> es la identidad:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\therefore x_B = \left [ \begin{array}{c} x_3 \\ x_4 \\ x_5\end{array}\right ] = B^{-1}b = \left [ \begin{array}{ccc} 1 &amp; 0 &amp; 0 \\ 0 &amp; 1 &amp; 0 \\ 0 &amp; 0 &amp; 1 \end{array} \right ]^{-1} \left [ \begin{array}{c} 4 \\ 12 \\ 18 \end{array}\right ]=\left [ \begin{array}{c} 4 \\ 12 \\ 18 \end{array}\right ]\end{split}\]</div>
<p>El vector de costos <span class="math notranslate nohighlight">\(c_B = \left [ \begin{array}{c} c_{B_3} \\ c_{B_4} \\ c_{B_5} \end{array} \right ] = \left [ \begin{array}{c} 0 \\ 0 \\ 0 \end{array} \right ]\)</span> contiene los costos de las variables básicas. El vector <span class="math notranslate nohighlight">\(c_N=\left [ \begin{array}{c} c_{N_1} \\ c_{N_2} \end{array} \right ]=\left [ \begin{array}{c}3 \\ 5 \end{array} \right ]\)</span> contiene los costos de las variables no básicas.</p>
<p>Las variables básicas son <span class="math notranslate nohighlight">\(x_3, x_4, x_5\)</span> y las no básicas son <span class="math notranslate nohighlight">\(x_1, x_2\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">18</span><span class="p">])</span>
<span class="n">x_B</span> <span class="o">=</span> <span class="n">b</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="n">c_B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="n">c_N</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>

<span class="c1">#list of indexes of nonbasic variables correspond to x1, x2</span>
<span class="n">N_list_idx</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="c1">#list of indexes of basic variables correspond to x3, x4, x5</span>
<span class="n">B_list_idx</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span> 
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="prueba-de-optimalidad">
<h3>Prueba de optimalidad<a class="headerlink" href="#prueba-de-optimalidad" title="Permalink to this headline">¶</a></h3>
<p>Para revisar tanto en el paso inicial como en las iteraciones posteriores la condición de optimalidad para encontrar soluciones FEV adyacentes mejores, realicemos algunas reescrituras de la función objetivo.</p>
<p>1.Obsérvese que la función objetivo se puede escribir como:</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Recuérdese que la función objetivo es <span class="math notranslate nohighlight">\(c^Tx= 3x_1 + 5x_2 + 0x_3 + 0x_4 + 0x_5\)</span>.</p>
</div>
<div class="math notranslate nohighlight">
\[\begin{split}f_o(x) = c^Tx = [c_B \quad c_N] ^T \left [ \begin{array}{c} x_B \\ x_N\end{array} \right ] = c_B^Tx_B + c_N^T x_N = c_B^T B^{-1}b = [0 \quad 0 \quad 0]^T \left [ \begin{array}{c} 4 \\ 12 \\ 18 \end{array}\right ]=0\end{split}\]</div>
<p>2.Obsérvese que todas las ecuaciones de frontera en su forma igualadas a cero pueden ser restadas de la función objetivo sin modificar su valor. Por ejemplo si tomamos la primer ecuación de frontera <span class="math notranslate nohighlight">\(x_1 + x_3 - 4 = 0\)</span> entonces:</p>
<div class="math notranslate nohighlight">
\[f_o(x) = f_o(x) - 0 =  f_o(x) -  (x_1 + x_3 - 4) = f_o(x) -x_1 -x_3 + 4\]</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<div class="math notranslate nohighlight">
\[\displaystyle \max 3x_1 + 5x_2\]</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<div class="math notranslate nohighlight">
\[\text{sujeto a: }\]</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<div class="math notranslate nohighlight">
\[x_1 + x_3 = 4\]</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<div class="math notranslate nohighlight">
\[2x_2 + x_4 = 12\]</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<div class="math notranslate nohighlight">
\[3x_1 + 2x_2 + x_5 = 18\]</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<div class="math notranslate nohighlight">
\[x_1 \geq 0, x_2 \geq 0, x_3 \geq 0, x_4 \geq 0, x_5 \geq 0\]</div>
</div>
<p>Y esto podemos hacer para todas las ecuaciones de frontera:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
f_o(x) &amp;=&amp; f_o(x) -  (x_1 + x_3 - 4) - (2x_2 + x_4 - 12) - (3x_1 + 2x_2 + x_5 - 18) \nonumber \\
&amp;=&amp; f_o(x) + (-x_1 - 2x_2 -2x_2) + (-x_3 - x_4 - x_5) + (4 + 12 + 18) \nonumber \\
&amp;=&amp; f_o(x) - \displaystyle \sum_{j \in \mathcal{B}} x_{B_j} - \sum_{j \in \mathcal{N}}x_{N_j} + \sum_{i = 1}^3 b(i)
\end{eqnarray}
\end{split}\]</div>
<p>con <span class="math notranslate nohighlight">\(x_{B_j}\)</span> <span class="math notranslate nohighlight">\(j\)</span>-ésima componente del vector <span class="math notranslate nohighlight">\(x_B\)</span>, <span class="math notranslate nohighlight">\(x_{N_j}\)</span> <span class="math notranslate nohighlight">\(j\)</span>-ésima componente del vector <span class="math notranslate nohighlight">\(x_N\)</span> y <span class="math notranslate nohighlight">\(b(i)\)</span> <span class="math notranslate nohighlight">\(i\)</span>-ésima componente de <span class="math notranslate nohighlight">\(b\)</span>.</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>No es coincidencia que se elijan las cantidades <span class="math notranslate nohighlight">\(\lambda, \nu\)</span> para representar esta igualdad, ver <a class="reference internal" href="../../III.optimizacion_convexa/3.3/Ejemplos_problemas_UCO_e_intro_CIEO_y_PI.html#funlagrangiana"><span class="std std-ref">la función Lagrangiana</span></a>.</p>
</div>
<p>En el método símplex no solamente se restan de la <span class="math notranslate nohighlight">\(f_o\)</span> las ecuaciones de frontera sino se multiplican por una cantidad <span class="math notranslate nohighlight">\(\nu_i\)</span> y posteriormente se restan de <span class="math notranslate nohighlight">\(f_o\)</span>:</p>
<div class="math notranslate nohighlight">
\[f_o(x) = f_o(x) + \displaystyle \sum_{j \in \mathcal{B}} \lambda_{B_j} x_{B_j} + \sum_{j \in \mathcal{N}}\lambda_{N_j}x_{N_j} + \sum_{i = 1}^3 \nu_i b(i)\]</div>
<p>con <span class="math notranslate nohighlight">\(\lambda_{B_j}\)</span>, <span class="math notranslate nohighlight">\(\lambda_{N_j}\)</span> coeficientes asociados a <span class="math notranslate nohighlight">\(x_{B_j}\)</span> y <span class="math notranslate nohighlight">\(x_{N_j}\)</span> respectivamente. Los coeficientes de la expresión anterior en el método de símplex se escriben como:</p>
<div class="math notranslate nohighlight">
\[\lambda_{B_j} = c_{B_j} - \nu^Ta_j \quad j \in \mathcal{B}\]</div>
<div class="math notranslate nohighlight">
\[\lambda_{N_j} = c_{N_j} - \nu^Ta_j \quad j \in \mathcal{N}\]</div>
<p>con <span class="math notranslate nohighlight">\(a_j\)</span> <span class="math notranslate nohighlight">\(j\)</span>-ésima columna de <span class="math notranslate nohighlight">\(A \in \mathbb{R}^{3 \times 5}\)</span> y <span class="math notranslate nohighlight">\(\nu \in \mathbb{R}^{3}\)</span> vector con las <span class="math notranslate nohighlight">\(\nu_i\)</span>’s para <span class="math notranslate nohighlight">\(i = 1, 2, 3\)</span>.</p>
<p>El vector <span class="math notranslate nohighlight">\(\nu\)</span> se obtiene resolviendo la ecuación: <span class="math notranslate nohighlight">\(\nu ^T B = c_B^T\)</span> y por tanto <span class="math notranslate nohighlight">\(\nu = B^{-T} c_B \)</span>.</p>
<div class="admonition-comentarios admonition">
<p class="admonition-title">Comentarios</p>
<ul class="simple">
<li><p>La justificación del por qué:</p></li>
</ul>
<ol class="simple">
<li><p><span class="math notranslate nohighlight">\(\lambda = c - A^T \nu\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\nu = B^{-T} c_B\)</span></p></li>
</ol>
<p>se realizará más adelante, por lo pronto considérese que esto se obtiene de las <a class="reference internal" href="../../III.optimizacion_convexa/3.3/Ejemplos_problemas_UCO_e_intro_CIEO_y_PI.html#primeraformulacioncondkkt"><span class="std std-ref">condiciones KKT de optimalidad</span></a>.</p>
<ul class="simple">
<li><p>En el método símplex se mantiene en cada iteración <span class="math notranslate nohighlight">\(\lambda_{B_j} = 0 \forall j \in \mathcal{B}\)</span> y se <strong>busca</strong> que <span class="math notranslate nohighlight">\(\lambda_{N_j} \forall j \in \mathcal{N}\)</span> sea estrictamente positivo para problemas de minimización o estrictamente negativo para problemas de maximización.</p></li>
</ul>
</div>
<div class="tip admonition">
<p class="admonition-title">Observación</p>
<p>Obsérvese que <span class="math notranslate nohighlight">\(f_o(x) = c_B^Tx_B + c_N^T x_N = c_B^T B^{-1}b = \nu^Tb\)</span>.</p>
</div>
<p>La prueba de optimalidad consiste en revisar los <span class="math notranslate nohighlight">\(\lambda_{N_j}\)</span>, <span class="math notranslate nohighlight">\(j \in \mathcal{N}\)</span>. Se selecciona(n) aquella(s) variable(s) no básica(s) que tenga(n) la tasa más alta de mejoramiento (esto depende si es un problema de maximización o minimización) del valor en la función objetivo.</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p><span class="math notranslate nohighlight">\(c_B = \left [ \begin{array}{c} c_{B_3} \\ c_{B_4} \\ c_{B_5} \end{array} \right ] = \left [ \begin{array}{c} 0 \\ 0 \\ 0 \end{array} \right ]\)</span></p>
</div>
<p>El vector <span class="math notranslate nohighlight">\(\nu\)</span> es:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\nu = B^{-T}c_B = \left [ \begin{array}{ccc} 1 &amp; 0 &amp; 0 \\ 0 &amp; 1 &amp; 0 \\ 0 &amp; 0 &amp; 1 \end{array} \right ] ^{-T} \left [ \begin{array}{c} 0 \\ 0 \\ 0 \end{array}\right ] = \left [ \begin{array}{c} 0 \\ 0 \\ 0 \end{array}\right ]\end{split}\]</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Resolviendo un sólo sistema de ecuaciones lineales nos ayuda a evitar calcular la inversa de una matriz que implica resolver un sistema de ecuaciones lineales más grande.</p>
</div>
<p>Para el cálculo de <span class="math notranslate nohighlight">\(\nu\)</span> resolvemos el sistema de ecuaciones lineales para el vector de incógnitas <span class="math notranslate nohighlight">\(\nu\)</span>:</p>
<div class="math notranslate nohighlight">
\[B^T \nu = c_B\]</div>
<p>Como <span class="math notranslate nohighlight">\(B = \left [ \begin{array}{ccc} 1 &amp; 0 &amp; 0 \\ 0 &amp; 1 &amp; 0 \\ 0 &amp; 0 &amp; 1 \end{array} \right ]\)</span> entonces directamente <span class="math notranslate nohighlight">\(\nu = c_B\)</span>. Por tanto:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nu</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>En el ejemplo <span class="math notranslate nohighlight">\(f_o(x) = \nu^Tb = 0\)</span> en el paso inicial:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">nu</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0
</pre></div>
</div>
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p><span class="math notranslate nohighlight">\(c_N= \left [ \begin{array}{c}3 \\ 5 \end{array} \right ]\)</span></p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lambda_N_1</span> <span class="o">=</span> <span class="n">c_N</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">nu</span><span class="p">,</span> <span class="n">A</span><span class="p">[:,</span> <span class="n">N_list_idx</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lambda_N_2</span> <span class="o">=</span> <span class="n">c_N</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">nu</span><span class="p">,</span> <span class="n">A</span><span class="p">[:,</span> <span class="n">N_list_idx</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">lambda_N_1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">lambda_N_2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>5
</pre></div>
</div>
</div>
</div>
<p><span class="math notranslate nohighlight">\(\lambda_{N_1} = c_{N_1} - \nu^Ta_1 = 3 - [0 \quad 0 \quad 0]^T \left [ \begin{array}{c} 1 \\ 0 \\ 3 \end{array}\right ] = 3\)</span></p>
<p><span class="math notranslate nohighlight">\(\lambda_{N_2} = c_{N_2}- \nu^Ta_2 =  5 - [0 \quad 0 \quad 0]^T \left [ \begin{array}{c} 0 \\ 2 \\ 2 \end{array}\right ] = 5\)</span></p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>“tasa más alta de mejoramiento” se refiere a mejorar <span class="math notranslate nohighlight">\(f_o\)</span> por un incremento de una unidad en la variable <span class="math notranslate nohighlight">\(x_2\)</span>.</p>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Incrementar una variable no básica equivale geométricamente a moverse por una arista desde una solución FEV.</p>
</div>
<p>Como tenemos un problema de <strong>maximización</strong> la tasa más alta de mejoramiento de <span class="math notranslate nohighlight">\(f_o\)</span> la da la variable <span class="math notranslate nohighlight">\(x_2\)</span> por lo que es la variable no básica que sustituye a una variable básica. ¿Cuál variable básica se debe elegir?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#index for nonbasic variables, in this case value 1 correspond to x2</span>

<span class="n">idx_x_N</span> <span class="o">=</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="prueba-del-cociente-minimo">
<h3>Prueba del cociente mínimo<a class="headerlink" href="#prueba-del-cociente-minimo" title="Permalink to this headline">¶</a></h3>
<p>El objetivo de esta prueba es determinar qué variable(s) básica(s) llega(n) a cero cuando crece la variable entrante. Tal variable(s) básica(s) en la siguiente iteración será no básica y la que aumenta pasa de ser no básica a básica.</p>
<p>En el paso inicial las variables básicas son <span class="math notranslate nohighlight">\(x_3\)</span>, <span class="math notranslate nohighlight">\(x_4\)</span> y <span class="math notranslate nohighlight">\(x_5\)</span>, por lo que hay que determinar de éstas cuál(es) es(son) la(s) que sale(n) al incrementar la variable no básica <span class="math notranslate nohighlight">\(x_2\)</span>.</p>
<p>Esta prueba del cociente mínimo primero se explicará de forma detallada para posteriormente representarla de forma matricial.</p>
<p>Las ecuaciones de <span class="math notranslate nohighlight">\(Ax = b\)</span> son:</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<div class="math notranslate nohighlight">
\[\displaystyle \max 3x_1 + 5x_2\]</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<div class="math notranslate nohighlight">
\[\text{sujeto a: }\]</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<div class="math notranslate nohighlight">
\[x_1 + x_3 = 4\]</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<div class="math notranslate nohighlight">
\[2x_2 + x_4 = 12\]</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<div class="math notranslate nohighlight">
\[3x_1 + 2x_2 + x_5 = 18\]</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<div class="math notranslate nohighlight">
\[x_1 \geq 0, x_2 \geq 0, x_3 \geq 0, x_4 \geq 0, x_5 \geq 0\]</div>
</div>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{eqnarray}
x_1 + x_3 &amp;=&amp; 4 \nonumber \\
2x_2 + x_4 &amp;=&amp; 12 \nonumber \\
3x_1 + 2x_2 + x_5 &amp;=&amp; 18
\end{eqnarray}
\end{split}\]</div>
<p>Despejamos cada variable básica de las ecuaciones anteriores:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{eqnarray}
x_3 &amp;=&amp; 4 - x_1 \nonumber \\
x_4 &amp;=&amp; 12 - 2x_2 \nonumber \\
x_5 &amp;=&amp; 18 - 3x_1 - 2x_2
\end{eqnarray}
\end{split}\]</div>
<p>Y se debe cumplir por las restricciones de no negatividad que al aumentar <span class="math notranslate nohighlight">\(x_2\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{eqnarray}
x_3 &amp;=&amp; 4 - x_1 \geq 0 \nonumber \\
x_4 &amp;=&amp; 12 - 2x_2 \geq 0  \nonumber \\
x_5 &amp;=&amp; 18 - 3x_1 - 2x_2 \geq 0
\end{eqnarray}
\end{split}\]</div>
<p>En la primera ecuación <span class="math notranslate nohighlight">\(x_3 = 4 - x_1\)</span> no tenemos contribución alguna de <span class="math notranslate nohighlight">\(x_2\)</span> por lo que no la tomamos en cuenta. La segunda y tercer ecuación sí aparece <span class="math notranslate nohighlight">\(x_2\)</span> y como <span class="math notranslate nohighlight">\(x_1\)</span> es variable no básica con valor <span class="math notranslate nohighlight">\(0\)</span> se debe cumplir:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{eqnarray}
x_2 \leq \frac{12}{2} = 6  \nonumber \\
x_2 \leq \frac{18}{2} = 9
\end{eqnarray}
\end{split}\]</div>
<p>Entonces se toma el mínimo de las cantidades anteriores y como es igual a <span class="math notranslate nohighlight">\(6\)</span> y esa desigualdad la obtuvimos de despejar <span class="math notranslate nohighlight">\(x_4\)</span> entonces se elige <span class="math notranslate nohighlight">\(x_4\)</span> como variable básica que se vuelve no básica. Tomamos el mínimo pues el valor de <span class="math notranslate nohighlight">\(6\)</span> es lo máximo que podemos incrementar <span class="math notranslate nohighlight">\(x_2\)</span> sin que <span class="math notranslate nohighlight">\(x_4\)</span> se haga no negativa.</p>
</div>
<div class="section" id="prueba-del-cociente-minimo-forma-general-y-con-notacion-matricial-y-vectorial">
<h3>Prueba del cociente mínimo: forma general y con notación matricial y vectorial<a class="headerlink" href="#prueba-del-cociente-minimo-forma-general-y-con-notacion-matricial-y-vectorial" title="Permalink to this headline">¶</a></h3>
<p>El procedimiento de la prueba del cociente mínimo entonces consiste en:</p>
<p>1.Elegir la columna de <span class="math notranslate nohighlight">\(A\)</span> correspondiente a la variable no básica que sustituye a la variable básica, que por lo anterior es <span class="math notranslate nohighlight">\(x_2\)</span> y corresponde a la segunda columna, <span class="math notranslate nohighlight">\(a_2\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
A = 
\left [
\begin{array}{ccccc}
1 &amp; 0 &amp; 1 &amp; 0 &amp; 0 \\
0 &amp; 2 &amp; 0 &amp; 1 &amp; 0 \\
3 &amp; 2 &amp; 0 &amp; 0 &amp; 1 \\
\end{array}
\right ]
\end{split}\]</div>
<p>2.Hacer la multiplicación <span class="math notranslate nohighlight">\(B^{-1}a_2\)</span>.</p>
<p>Esto en general se realiza, en el paso inicial <span class="math notranslate nohighlight">\(B^{-1}\)</span> es la identidad por lo que en este paso inicial no tuvo efecto hacer la multiplicación.</p>
<p>3.Para las entradas <strong>estrictamente positivas</strong> de tal multiplicación anterior se divide el lado derecho entre tales entradas y se toma el mínimo. Como el lado derecho en cada iteración es <span class="math notranslate nohighlight">\(x_B = B^{-1}b\)</span> entonces se dividen los valores de las variables básicas entre las entradas estrictamente positivas. Esto es, si se denota como <span class="math notranslate nohighlight">\(x_2^{+}\)</span> al mínimo:</p>
<div class="math notranslate nohighlight">
\[x_2^{+} = \min \{\frac{x_{B_i}}{d_i} : d_i &gt; 0, i = 1, 2, \dots, m \}\]</div>
<p>con <span class="math notranslate nohighlight">\(d_i\)</span> <span class="math notranslate nohighlight">\(i\)</span>-ésima componente del vector <span class="math notranslate nohighlight">\(d\)</span> que es solución del sistema de ecuaciones: <span class="math notranslate nohighlight">\(Bd = a_2\)</span> y <span class="math notranslate nohighlight">\(x_{B_i}\)</span> <span class="math notranslate nohighlight">\(i\)</span>-ésima entrada del vector <span class="math notranslate nohighlight">\(x_B\)</span> de la iteración actual.</p>
<p>4.El índice donde ocurre el mínimo es el de la variable básica que será sustituida.</p>
<p>En el ejemplo se tienen las siguientes asignaciones <strong>en el paso inicial</strong>:</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p><span class="math notranslate nohighlight">\(
B = 
\left [
\begin{array}{ccccc}
1 &amp; 0 &amp; 0 \\
0 &amp; 1 &amp; 0 \\
0 &amp; 0 &amp; 1 \\
\end{array}
\right ]
\)</span></p>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>La segunda columna de <span class="math notranslate nohighlight">\(A\)</span> se elige pues <span class="math notranslate nohighlight">\(x_2\)</span> es la variable no básica a la que se le aumentará su valor y sustituirá a una variable básica.</p>
</div>
<p>Se resuelve la ecuación: <span class="math notranslate nohighlight">\(Bd = a_2\)</span> para <span class="math notranslate nohighlight">\(d\)</span> vector de incógnitas.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">A</span><span class="p">[:,</span><span class="n">idx_x_N</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0. 2. 2.]
</pre></div>
</div>
</div>
</div>
<p>En esta iteración: <span class="math notranslate nohighlight">\(x_B = \left [ \begin{array}{c} x_3 \\ x_4 \\ x_5\end{array}\right ] = \left [ \begin{array}{c} 4 \\ 12 \\ 18 \end{array}\right ]\)</span> pues <span class="math notranslate nohighlight">\(B\)</span> es la matriz identidad por lo que <span class="math notranslate nohighlight">\(x_B = b\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">x_B</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[ 4 12 18]
</pre></div>
</div>
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Se hace la división únicamente entre las entradas estrictamente positivas</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">idx_positive</span> <span class="o">=</span> <span class="n">d</span> <span class="o">&gt;</span><span class="mi">0</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">x_B</span><span class="p">[</span><span class="n">idx_positive</span><span class="p">]</span><span class="o">/</span><span class="n">d</span><span class="p">[</span><span class="n">idx_positive</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[6. 9.]
</pre></div>
</div>
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Hacer cero una variable básica y convertirla en no básica equivale geométricamente a detener el movimiento por una arista hasta encontrar una solución FEV.</p>
</div>
<p>Entonces el mínimo ocurre en la segunda posición de <span class="math notranslate nohighlight">\(x_B\)</span> que corresponde a la variable básica <span class="math notranslate nohighlight">\(x_4\)</span>. Se elige <span class="math notranslate nohighlight">\(x_4\)</span> como variable básica que se vuelve no básica. <span class="math notranslate nohighlight">\(x_4\)</span> será sustituida por <span class="math notranslate nohighlight">\(x_2\)</span> en la próxima iteración.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#index for basic variables, in this case value 1 correspond to x4</span>

<span class="n">idx_x_B</span> <span class="o">=</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="actualizacion-del-vector-x-b">
<h3>Actualización del vector <span class="math notranslate nohighlight">\(x_B\)</span><a class="headerlink" href="#actualizacion-del-vector-x-b" title="Permalink to this headline">¶</a></h3>
<p>La actualización de las variables básicas después del paso inicial se realiza con la expresión computacional:</p>
<div class="math notranslate nohighlight">
\[x_B = x_B - dx_{nb}^{+}\]</div>
<p>donde: <span class="math notranslate nohighlight">\(x_{nb}\)</span> es la variable no básica que se volverá básica en la iteración actual. Después de actualizar <span class="math notranslate nohighlight">\(x_{nb}\)</span> la variable básica <span class="math notranslate nohighlight">\(x_{b}\)</span> pasa a estar en <span class="math notranslate nohighlight">\(x_N\)</span> con valor de <span class="math notranslate nohighlight">\(0\)</span>.</p>
<p>Posterior a la actualización de <span class="math notranslate nohighlight">\(x_B\)</span> se intercambian las columnas de <span class="math notranslate nohighlight">\(B\)</span> correspondientes a las variables <span class="math notranslate nohighlight">\(x_{nb}\)</span> y <span class="math notranslate nohighlight">\(x_b\)</span>.</p>
<p><strong>La justificación de la expresión anterior es la siguiente:</strong></p>
<p>Como <span class="math notranslate nohighlight">\(Ax = b\)</span> y <span class="math notranslate nohighlight">\(Bx_B + Nx_N = b\)</span> pero será incrementada la variable <span class="math notranslate nohighlight">\(x_{nb}\)</span> y disminuida <span class="math notranslate nohighlight">\(x_{b}\)</span> a cero entonces si <span class="math notranslate nohighlight">\(x^+\)</span> denota el nuevo valor de <span class="math notranslate nohighlight">\(x\)</span> se tiene:</p>
<div class="math notranslate nohighlight">
\[b = Ax ^+ = Bx_B^+ + a_{nb}x_{nb}^+ = B x_B = Ax = b\]</div>
<p>recordando que <span class="math notranslate nohighlight">\(Nx_N = 0\)</span> pues <span class="math notranslate nohighlight">\(x_N=0\)</span> donde: <span class="math notranslate nohighlight">\(a_{nb}\)</span> es la <span class="math notranslate nohighlight">\({nb}\)</span>-ésima columna de <span class="math notranslate nohighlight">\(A\)</span>.</p>
<p>Por tanto:</p>
<div class="math notranslate nohighlight">
\[Bx_B^+ = Bx_B - a_{nb}x_{nb}^+\]</div>
<p>Y premultiplicando por la inversa:</p>
<div class="math notranslate nohighlight">
\[x_B^+ = x_B - B^{-1}a_{nb}x_{nb}^+ = x_B - d x_{nb}^+.\]</div>
<p><strong>La interpretación geométrica de esta actualización es:</strong> un movimiento a lo largo de una arista del poliedro que mantiene factibilidad y mejora la función objetivo. Nos movemos a lo largo de esta arista hasta encontrar una solución FEV. En esta nueva solución FEV una nueva restricción no negativa se vuelve activa, la que corresponde a la variable <span class="math notranslate nohighlight">\(x_b\)</span>.</p>
<p>Después de la actualización se remueve el índice <span class="math notranslate nohighlight">\(b\)</span> del conjunto <span class="math notranslate nohighlight">\(\mathcal{B}\)</span> y se sustituye por <span class="math notranslate nohighlight">\(nb\)</span>.</p>
</div>
<div class="section" id="iteracion-1">
<h3>Iteración 1<a class="headerlink" href="#iteracion-1" title="Permalink to this headline">¶</a></h3>
<p>La matriz <span class="math notranslate nohighlight">\(B\)</span> del paso inicial era:</p>
<div class="math notranslate nohighlight">
\[\begin{split}B = \left [ \begin{array}{ccc} 1 &amp; 0 &amp; 0 \\ 0 &amp; 1 &amp; 0 \\ 0 &amp; 0 &amp; 1 \end{array} \right ]\end{split}\]</div>
<p>y correspondía cada columna a las variables <span class="math notranslate nohighlight">\(x_3, x_4, x_5\)</span> en ese orden.</p>
<p>Se realiza la actualización descrita para <span class="math notranslate nohighlight">\(x_B\)</span>:</p>
<div class="math notranslate nohighlight">
\[x_B = x_B - dx_2^{+}\]</div>
<p>con <span class="math notranslate nohighlight">\(x_2\)</span> es la variable no básica que se volverá básica en la iteración actual.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x_2_plus</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">x_B</span><span class="p">[</span><span class="n">idx_positive</span><span class="p">]</span><span class="o">/</span><span class="n">d</span><span class="p">[</span><span class="n">idx_positive</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">x_2_plus</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>6.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x_B</span> <span class="o">=</span> <span class="n">x_B</span> <span class="o">-</span> <span class="n">d</span><span class="o">*</span><span class="n">x_2_plus</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">x_B</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[4. 0. 6.]
</pre></div>
</div>
</div>
</div>
<p>Aquí el valor de la variable <span class="math notranslate nohighlight">\(x_4\)</span> se hace cero y tenemos que intercambiar tal entrada con la de <span class="math notranslate nohighlight">\(x_2^+\)</span> para el vector <span class="math notranslate nohighlight">\(x_B\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x_B</span><span class="p">[</span><span class="n">idx_x_B</span><span class="p">]</span> <span class="o">=</span> <span class="n">x_2_plus</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x_B</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[4. 6. 6.]
</pre></div>
</div>
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Antes de hacer el intercambio de columnas: <span class="math notranslate nohighlight">\(B = \left [ \begin{array}{ccc} 1 &amp; 0 &amp; 0 \\ 0 &amp; 1 &amp; 0 \\ 0 &amp; 0 &amp; 1 \end{array} \right ]\)</span> y la matriz original <span class="math notranslate nohighlight">\(A = 
\left [
\begin{array}{ccccc}
1 &amp; 0 &amp; 1 &amp; 0 &amp; 0 \\
0 &amp; 2 &amp; 0 &amp; 1 &amp; 0 \\
3 &amp; 2 &amp; 0 &amp; 0 &amp; 1 \\
\end{array}
\right ]
\)</span></p>
</div>
<p>Como <span class="math notranslate nohighlight">\(x_4\)</span> se intercambia por <span class="math notranslate nohighlight">\(x_2\)</span> entonces se intercambia la columna <span class="math notranslate nohighlight">\(2\)</span> de <span class="math notranslate nohighlight">\(A\)</span>, <span class="math notranslate nohighlight">\(a_2\)</span>, por la <span class="math notranslate nohighlight">\(2\)</span> de <span class="math notranslate nohighlight">\(B\)</span>, <span class="math notranslate nohighlight">\(b_2\)</span> por lo que al final de la iteración 1:</p>
<div class="math notranslate nohighlight">
\[\begin{split}B = \left [ \begin{array}{ccc} 1 &amp; 0 &amp; 0 \\ 0 &amp; 2 &amp; 0 \\ 0 &amp; 2 &amp; 1 \end{array} \right ]\end{split}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">aux</span> <span class="o">=</span> <span class="n">B</span><span class="p">[:,</span><span class="n">idx_x_B</span><span class="p">]</span>
<span class="n">B</span><span class="p">[:,</span><span class="n">idx_x_B</span><span class="p">]</span> <span class="o">=</span> <span class="n">A</span><span class="p">[:,</span><span class="n">idx_x_N</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p><span class="math notranslate nohighlight">\(x_B =  \left [ \begin{array}{c} x_3 \\ x_2 \\ x_5 \end{array}\right ] = \left [ \begin{array}{c} 4 \\ 6 \\ 6 \end{array}\right ]\)</span>,  <span class="math notranslate nohighlight">\(x_N = \left [ \begin{array}{c} x_1 \\ x_4\end{array}\right ] = \left [ \begin{array}{c} 0 \\ 0\end{array}\right ]\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">aux</span> <span class="o">=</span> <span class="n">B_list_idx</span><span class="p">[</span><span class="n">idx_x_B</span><span class="p">]</span>
<span class="n">B_list_idx</span><span class="p">[</span><span class="n">idx_x_B</span><span class="p">]</span> <span class="o">=</span> <span class="n">N_list_idx</span><span class="p">[</span><span class="n">idx_x_N</span><span class="p">]</span>
<span class="n">N_list_idx</span><span class="p">[</span><span class="n">idx_x_N</span><span class="p">]</span> <span class="o">=</span> <span class="n">aux</span>
</pre></div>
</div>
</div>
</div>
<div class="tip admonition">
<p class="admonition-title">Observación</p>
<p>La actualización de <span class="math notranslate nohighlight">\(x_B\)</span> anterior se puede verificar que es equivalente a:</p>
<div class="math notranslate nohighlight">
\[\begin{split}x_B = \left [ \begin{array}{c} x_3 \\ x_2 \\ x_5\end{array}\right ] = B^{-1}b = \left [ \begin{array}{ccc} 1 &amp; 0 &amp; 0 \\ 0 &amp; 2 &amp; 0 \\ 0 &amp; 2 &amp; 1 \end{array} \right ]^{-1} \left [ \begin{array}{c} 4 \\ 12 \\ 18 \end{array}\right ] =  \left [ \begin{array}{ccc} 1 &amp; 0 &amp; 0 \\ 0 &amp; \frac{1}{2} &amp; 0 \\ 0 &amp; -1 &amp; 1 \end{array} \right ]\left [ \begin{array}{c} 4 \\ 12 \\ 18 \end{array}\right ] = \left [ \begin{array}{c} 4 \\ 6 \\ 6 \end{array}\right ]  \end{split}\]</div>
</div>
</div>
<div class="section" id="id1">
<h3>Prueba de optimalidad<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>Se recalcula el vector <span class="math notranslate nohighlight">\(\nu\)</span> considerando que <span class="math notranslate nohighlight">\(c_B =  \left [ \begin{array}{c} c_{B_3} \\ c_{B_2} \\ c_{B_5} \end{array}\right ]\)</span> tomando ahora <span class="math notranslate nohighlight">\(x_2\)</span> como básica.</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p><span class="math notranslate nohighlight">\(B = \left [ \begin{array}{ccc} 1 &amp; 0 &amp; 0 \\ 0 &amp; 2 &amp; 0 \\ 0 &amp; 2 &amp; 1 \end{array} \right ]\)</span></p>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p><span class="math notranslate nohighlight">\(c_B = \left [ \begin{array}{c} c_{B_3} \\ c_{B_2} \\ c_{B_5} \end{array} \right ] = \left [ \begin{array}{c} 0 \\ 5 \\ 0 \end{array} \right ]\)</span></p>
</div>
<p>El vector <span class="math notranslate nohighlight">\(\nu\)</span> es:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\nu = B^{-T}c_B = \left [ \begin{array}{ccc} 1 &amp; 0 &amp; 0 \\ 0 &amp; \frac{1}{2} &amp; 0 \\ 0 &amp; -1 &amp; 1 \end{array} \right ] ^T \left [ \begin{array}{c} 0 \\ 5 \\ 0 \end{array}\right ] = \left [ \begin{array}{c} 0 \\ \frac{5}{2} \\ -5 \end{array}\right ]\end{split}\]</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Resolviendo un sólo sistema de ecuaciones lineales nos ayuda a evitar calcular la inversa de una matriz que implica resolver un sistema de ecuaciones lineales más grande.</p>
</div>
<p>Para el cálculo de <span class="math notranslate nohighlight">\(\nu\)</span> resolvemos el sistema de ecuaciones lineales para el vector de incógnitas <span class="math notranslate nohighlight">\(\nu\)</span>:</p>
<div class="math notranslate nohighlight">
\[B^T \nu = c_B\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">aux</span> <span class="o">=</span> <span class="n">c_B</span><span class="p">[</span><span class="n">idx_x_B</span><span class="p">]</span>
<span class="n">c_B</span><span class="p">[</span><span class="n">idx_x_B</span><span class="p">]</span> <span class="o">=</span> <span class="n">c_N</span><span class="p">[</span><span class="n">idx_x_N</span><span class="p">]</span>
<span class="n">c_N</span><span class="p">[</span><span class="n">idx_x_N</span><span class="p">]</span> <span class="o">=</span> <span class="n">aux</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nu</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">B</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">c_B</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">nu</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0.  2.5 0. ]
</pre></div>
</div>
</div>
</div>
<p>Por tanto:</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p><span class="math notranslate nohighlight">\(c_N= \left [ \begin{array}{c}3 \\ 0 \end{array} \right ]\)</span></p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lambda_N_1</span> <span class="o">=</span> <span class="n">c_N</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">nu</span><span class="p">,</span> <span class="n">A</span><span class="p">[:,</span><span class="n">N_list_idx</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lambda_N_4</span> <span class="o">=</span> <span class="n">c_N</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">nu</span><span class="p">,</span> <span class="n">A</span><span class="p">[:,</span><span class="n">N_list_idx</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">lambda_N_1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">lambda_N_4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-2.5
</pre></div>
</div>
</div>
</div>
<p><span class="math notranslate nohighlight">\(\lambda_{N_1} = c_{N_1} - \nu^Ta_1 = 3 - [0 \quad \frac{5}{2} \quad 0]^T \left [ \begin{array}{c} 1 \\ 0 \\ 3 \end{array}\right ] = 3\)</span></p>
<p><span class="math notranslate nohighlight">\(\lambda_{N_4} = c_{N_4} - \nu^Ta_4 = 0 - [0 \quad \frac{5}{2} \quad 0]^T\left [ \begin{array}{c} 0 \\ 1 \\ 0 \end{array}\right ] = -2.5\)</span></p>
<p>Como tenemos un problema de maximización la tasa más alta de mejoramiento de <span class="math notranslate nohighlight">\(f_o\)</span> la da la variable <span class="math notranslate nohighlight">\(x_1\)</span> por lo que es la variable no básica que sustituye a una variable básica.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#index for nonbasic variables, in this case value 0 correspond to x1</span>

<span class="n">idx_x_N</span> <span class="o">=</span> <span class="mi">0</span>
</pre></div>
</div>
</div>
</div>
<p>Valor de la función objetivo en la solución BF actual:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">nu</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>30.0
</pre></div>
</div>
</div>
</div>
<p><span class="math notranslate nohighlight">\(f_o(x) = \nu^Tb = 30\)</span></p>
</div>
<div class="section" id="id2">
<h3>Prueba del cociente mínimo<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p><span class="math notranslate nohighlight">\(B = \left [ \begin{array}{ccc} 1 &amp; 0 &amp; 0 \\ 0 &amp; 2 &amp; 0 \\ 0 &amp; 2 &amp; 1 \end{array} \right ]\)</span></p>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>La primer columna de <span class="math notranslate nohighlight">\(A\)</span> se elige pues <span class="math notranslate nohighlight">\(x_1\)</span> es la variable no básica a la que se le aumentará su valor y sustituirá a una variable básica.</p>
</div>
<p>Se resuelve la ecuación: <span class="math notranslate nohighlight">\(Bd = a_1\)</span> para <span class="math notranslate nohighlight">\(d\)</span> vector de incógnitas.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">A</span><span class="p">[:,</span> <span class="n">idx_x_N</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1. 0. 3.]
</pre></div>
</div>
</div>
</div>
<p>En esta iteración: <span class="math notranslate nohighlight">\(x_B = \left [ \begin{array}{c} x_3 \\ x_2 \\ x_5\end{array}\right ] = \left [ \begin{array}{c} 4 \\ 6 \\ 6 \end{array}\right ]\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">x_B</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[4. 6. 6.]
</pre></div>
</div>
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Se hace la división únicamente entre las entradas estrictamente positivas</p>
</div>
<div class="math notranslate nohighlight">
\[x_1^{+} = \min \{\frac{x_{B_i}}{d_i} : d_i &gt; 0, i = 1, 2, \dots, m \}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">idx_positive</span> <span class="o">=</span> <span class="n">d</span> <span class="o">&gt;</span><span class="mi">0</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">x_B</span><span class="p">[</span><span class="n">idx_positive</span><span class="p">]</span><span class="o">/</span><span class="n">d</span><span class="p">[</span><span class="n">idx_positive</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[4. 2.]
</pre></div>
</div>
</div>
</div>
<p>Entonces el mínimo ocurre en la tercera posición de <span class="math notranslate nohighlight">\(x_B\)</span> que corresponde a la variable básica <span class="math notranslate nohighlight">\(x_5\)</span>. Se elige <span class="math notranslate nohighlight">\(x_5\)</span> como variable básica que se vuelve no básica. <span class="math notranslate nohighlight">\(x_5\)</span> será sustituida por <span class="math notranslate nohighlight">\(x_1\)</span> en la próxima iteración.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#index for basic variables, in this case value 2 correspond to x5</span>

<span class="n">idx_x_B</span> <span class="o">=</span> <span class="mi">2</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="iteracion-2">
<h3>Iteración 2<a class="headerlink" href="#iteracion-2" title="Permalink to this headline">¶</a></h3>
<p>La matriz <span class="math notranslate nohighlight">\(B\)</span> de la iteración anterior era:</p>
<div class="math notranslate nohighlight">
\[\begin{split}B = \left [ \begin{array}{ccc} 1 &amp; 0 &amp; 0 \\ 0 &amp; 2 &amp; 0 \\ 0 &amp; 2 &amp; 1 \end{array} \right ]\end{split}\]</div>
<p>y correspondía cada columna a las variables <span class="math notranslate nohighlight">\(x_3, x_2, x_5\)</span> en ese orden.</p>
<p>Se realiza la actualización descrita para <span class="math notranslate nohighlight">\(x_B\)</span>:</p>
<div class="math notranslate nohighlight">
\[x_B = x_B - dx_1^{+}\]</div>
<p>con <span class="math notranslate nohighlight">\(x_1\)</span> es la variable no básica que se volverá básica en la iteración actual.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x_1_plus</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">x_B</span><span class="p">[</span><span class="n">idx_positive</span><span class="p">]</span><span class="o">/</span><span class="n">d</span><span class="p">[</span><span class="n">idx_positive</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">x_1_plus</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x_B</span> <span class="o">=</span> <span class="n">x_B</span> <span class="o">-</span> <span class="n">d</span><span class="o">*</span><span class="n">x_1_plus</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">x_B</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2. 6. 0.]
</pre></div>
</div>
</div>
</div>
<p>Aquí el valor de la variable <span class="math notranslate nohighlight">\(x_5\)</span> se hace cero y tenemos que intercambiar tal entrada con la de <span class="math notranslate nohighlight">\(x_1^+\)</span> para el vector <span class="math notranslate nohighlight">\(x_B\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x_B</span><span class="p">[</span><span class="n">idx_x_B</span><span class="p">]</span> <span class="o">=</span> <span class="n">x_1_plus</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x_B</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2. 6. 2.]
</pre></div>
</div>
</div>
</div>
<div class="tip admonition">
<p class="admonition-title">Observación</p>
<p>La actualización de <span class="math notranslate nohighlight">\(x_B\)</span> anterior se puede verificar que es equivalente a:</p>
<div class="math notranslate nohighlight">
\[\begin{split}x_B = \left [ \begin{array}{c} x_3 \\ x_2 \\ x_1\end{array}\right ] = B^{-1}b = \left [ \begin{array}{ccc} 1 &amp; 0 &amp; 1 \\ 0 &amp; 2 &amp; 0 \\ 0 &amp; 2 &amp; 3 \end{array} \right ]^{-1} \left [ \begin{array}{c} 4 \\ 12 \\ 18 \end{array}\right ] =  \left [ \begin{array}{ccc} 1 &amp; \frac{1}{3} &amp; -\frac{1}{3} \\ 0 &amp; \frac{1}{2} &amp; 0 \\ 0 &amp; -\frac{1}{3} &amp; \frac{1}{3} \end{array} \right ]\left [ \begin{array}{c} 4 \\ 12 \\ 18 \end{array}\right ] = \left [ \begin{array}{c} 2 \\ 6 \\ 2 \end{array}\right ]\end{split}\]</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Antes de hacer el intercambio de columnas: <span class="math notranslate nohighlight">\(B = \left [ \begin{array}{ccc} 1 &amp; 0 &amp; 0 \\ 0 &amp; 2 &amp; 0 \\ 0 &amp; 2 &amp; 1 \end{array} \right ]\)</span> y la matriz original <span class="math notranslate nohighlight">\( A = 
\left [
\begin{array}{ccccc}
1 &amp; 0 &amp; 1 &amp; 0 &amp; 0 \\
0 &amp; 1 &amp; 0 &amp; 1 &amp; 0 \\
3 &amp; 0 &amp; 0 &amp; 0 &amp; 1 \\
\end{array}
\right ]
\)</span></p>
</div>
<p>Como <span class="math notranslate nohighlight">\(x_5\)</span> se intercambia por <span class="math notranslate nohighlight">\(x_1\)</span> entonces se intercambia la columna <span class="math notranslate nohighlight">\(1\)</span> de <span class="math notranslate nohighlight">\(A\)</span>, <span class="math notranslate nohighlight">\(a_1\)</span>, por la <span class="math notranslate nohighlight">\(3\)</span> de <span class="math notranslate nohighlight">\(B\)</span>, <span class="math notranslate nohighlight">\(b_3\)</span> por lo que al final de la iteración <span class="math notranslate nohighlight">\(2\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}B = \left [ \begin{array}{ccc} 1 &amp; 0 &amp; 1 \\ 0 &amp; 2 &amp; 0 \\ 0 &amp; 2 &amp; 3 \end{array} \right ]\end{split}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">aux</span> <span class="o">=</span> <span class="n">B</span><span class="p">[:,</span><span class="n">idx_x_B</span><span class="p">]</span>
<span class="n">B</span><span class="p">[:,</span><span class="n">idx_x_B</span><span class="p">]</span> <span class="o">=</span> <span class="n">A</span><span class="p">[:,</span><span class="n">idx_x_N</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p><span class="math notranslate nohighlight">\(x_B =  \left [ \begin{array}{c} x_3 \\ x_2 \\ x_1 \end{array}\right ] = \left [ \begin{array}{c} 2 \\ 6 \\ 2 \end{array}\right ]\)</span>,  <span class="math notranslate nohighlight">\(x_N = \left [ \begin{array}{c} x_5 \\ x_4\end{array}\right ] = \left [ \begin{array}{c} 0 \\ 0\end{array}\right ]\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">aux</span> <span class="o">=</span> <span class="n">B_list_idx</span><span class="p">[</span><span class="n">idx_x_B</span><span class="p">]</span>
<span class="n">B_list_idx</span><span class="p">[</span><span class="n">idx_x_B</span><span class="p">]</span> <span class="o">=</span> <span class="n">N_list_idx</span><span class="p">[</span><span class="n">idx_x_N</span><span class="p">]</span>
<span class="n">N_list_idx</span><span class="p">[</span><span class="n">idx_x_N</span><span class="p">]</span> <span class="o">=</span> <span class="n">aux</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id3">
<h3>Prueba de optimalidad<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<p>Se recalcula el vector <span class="math notranslate nohighlight">\(\nu\)</span> considerando que <span class="math notranslate nohighlight">\(c_B =  \left [ \begin{array}{c} c_{B_3} \\ c_{B_2} \\ c_{B_1} \end{array}\right ]\)</span> tomando ahora <span class="math notranslate nohighlight">\(x_1\)</span> como básica.</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p><span class="math notranslate nohighlight">\(B = \left [ \begin{array}{ccc} 1 &amp; 0 &amp; 1 \\ 0 &amp; 2 &amp; 0 \\ 0 &amp; 2 &amp; 3 \end{array} \right ]\)</span></p>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p><span class="math notranslate nohighlight">\(c_B = \left [ \begin{array}{c} c_{B_3} \\ c_{B_2} \\ c_{B_1} \end{array} \right ] = \left [ \begin{array}{c} 0 \\ 5 \\ 3 \end{array} \right ]\)</span></p>
</div>
<p>El vector <span class="math notranslate nohighlight">\(\nu\)</span> es:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\nu = B^{-T}c_B = \left [ \begin{array}{ccc} 1 &amp; 0 &amp; 0 \\ 0 &amp; \frac{1}{2} &amp; 0 \\ 0 &amp; -1 &amp; 1 \end{array} \right ] ^T \left [ \begin{array}{c} 0 \\ 5 \\ 3 \end{array}\right ] = \left [ \begin{array}{c} 0 \\ \frac{3}{2} \\ 1 \end{array}\right ]\end{split}\]</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Resolviendo un sólo sistema de ecuaciones lineales nos ayuda a evitar calcular la inversa de una matriz que implica resolver un sistema de ecuaciones lineales más grande.</p>
</div>
<p>Para el cálculo de <span class="math notranslate nohighlight">\(\nu\)</span> resolvemos el sistema de ecuaciones lineales para el vector de incógnitas <span class="math notranslate nohighlight">\(\nu\)</span>:</p>
<div class="math notranslate nohighlight">
\[B^T \nu = c_B\]</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p><span class="math notranslate nohighlight">\(B = \left [ \begin{array}{ccc} 1 &amp; 0 &amp; 1 \\ 0 &amp; 2 &amp; 0 \\ 0 &amp; 2 &amp; 3 \end{array} \right ]\)</span></p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">aux</span> <span class="o">=</span> <span class="n">c_B</span><span class="p">[</span><span class="n">idx_x_B</span><span class="p">]</span>
<span class="n">c_B</span><span class="p">[</span><span class="n">idx_x_B</span><span class="p">]</span> <span class="o">=</span> <span class="n">c_N</span><span class="p">[</span><span class="n">idx_x_N</span><span class="p">]</span>
<span class="n">c_N</span><span class="p">[</span><span class="n">idx_x_N</span><span class="p">]</span> <span class="o">=</span> <span class="n">aux</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nu</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">B</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">c_B</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">nu</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0.  1.5 1. ]
</pre></div>
</div>
</div>
</div>
<p>Por tanto:</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p><span class="math notranslate nohighlight">\(c_N= \left [ \begin{array}{c}0 \\ 0 \end{array} \right ]\)</span></p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lambda_N_5</span> <span class="o">=</span> <span class="n">c_N</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">nu</span><span class="p">,</span> <span class="n">A</span><span class="p">[:,</span><span class="n">N_list_idx</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lambda_N_4</span> <span class="o">=</span> <span class="n">c_N</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">nu</span><span class="p">,</span> <span class="n">A</span><span class="p">[:,</span><span class="n">N_list_idx</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">lambda_N_5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-1.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">lambda_N_4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-1.5
</pre></div>
</div>
</div>
</div>
<p><span class="math notranslate nohighlight">\(\lambda_{N_5} = c_{N_5} - \nu^Ta_5 = 0 - [0 \quad \frac{3}{2} \quad 1]^T\left [ \begin{array}{c} 0 \\ 0 \\ 1 \end{array}\right ] = -1\)</span></p>
<p><span class="math notranslate nohighlight">\(\lambda_{N_4} = c_{N_4} - \nu^Ta_4 = 0 - [0 \quad \frac{3}{2} \quad 1]^T \left [ \begin{array}{c} 0 \\ 1 \\ 0 \end{array}\right ] = -1.5\)</span></p>
<p><strong>Índices de las variables básicas:</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">B_list_idx</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2, 1, 0]
</pre></div>
</div>
</div>
</div>
<p><strong>Índices de las variables no básicas:</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">N_list_idx</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[4, 3]
</pre></div>
</div>
</div>
</div>
<p><strong>Valores de <span class="math notranslate nohighlight">\(\nu\)</span>:</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">nu</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0.  1.5 1. ]
</pre></div>
</div>
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Recuérdese que en el método símplex se mantiene en cada iteración <span class="math notranslate nohighlight">\(\lambda_{B_j} = 0 \forall j \in \mathcal{B}\)</span> y se <strong>busca</strong> que <span class="math notranslate nohighlight">\(\lambda_{N_j} \forall j \in \mathcal{N}\)</span> sea estrictamente positivo para problemas de minimización o estrictamente negativo para problemas de maximización.</p>
</div>
<div class="admonition-comentario admonition">
<p class="admonition-title">Comentario</p>
<p>Entonces al finalizar el método símplex aplicado al ejemplo:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\lambda_{B_1} = \lambda_{B_2} = \lambda_{B_3} = 0\)</span> para los índices de las variables básicas <span class="math notranslate nohighlight">\(x_1, x_2, x_3\)</span>, <span class="math notranslate nohighlight">\(\mathcal{B} = \{1, 2, 3\}\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(\lambda_{N_4} = -1.5\)</span>, <span class="math notranslate nohighlight">\(\lambda_{N_5} = -1\)</span> para los índices de las variables no básicas <span class="math notranslate nohighlight">\(x_4, x_5\)</span>, <span class="math notranslate nohighlight">\(\mathcal{N} = \{4, 5\}\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(\nu_{1}  = 0, \nu_{2}  = 1.5, \nu_{3} = 1\)</span>.</p></li>
</ul>
</div>
<p>Como tenemos un problema de maximización la tasa más alta de mejoramiento de <span class="math notranslate nohighlight">\(f_o\)</span> no la da ninguna de las variables no básicas por lo que la solución BF actual <span class="math notranslate nohighlight">\(x = \left [ \begin{array}{c} x_1\\ x_2\\ x_3\\ x_4 \\ x_5 \end{array} \right ]= \left [ \begin{array}{c} 2\\ 6\\ 2\\ 0 \\ 0 \end{array}\right ]\)</span> es la solución óptima.</p>
<p>Valor de la función objetivo en la solución BF actual:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">nu</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>36.0
</pre></div>
</div>
</div>
</div>
<p><span class="math notranslate nohighlight">\(f_o(x) = \nu^Tb = 36\)</span></p>
<div class="tip admonition">
<p class="admonition-title">Ejercicio</p>
<p>Resuelve con el método de símplex y corrobora con algún software tu respuesta:</p>
<div class="math notranslate nohighlight">
\[\displaystyle \min_{x \in \mathbb{R}^3}x_1 + x_2 - 4x_3\]</div>
<div class="math notranslate nohighlight">
\[\text{sujeto a:}\]</div>
<div class="math notranslate nohighlight">
\[x_1 + x_2 + 2x_3 \leq 9\]</div>
<div class="math notranslate nohighlight">
\[x_1 + x_2 - x_3 \leq 2\]</div>
<div class="math notranslate nohighlight">
\[-x_1 + x_2 + x_3 \leq 4\]</div>
<div class="math notranslate nohighlight">
\[x_1 \geq 0, x_2 \geq 0 , x_3 \geq 0\]</div>
</div>
</div>
</div>
<div class="section" id="consideraciones-sobre-el-metodo-simplex">
<h2>Consideraciones sobre el método símplex<a class="headerlink" href="#consideraciones-sobre-el-metodo-simplex" title="Permalink to this headline">¶</a></h2>
<p>Al método símplex anteriormente descrito se le tienen que añadir funcionalidades para realizar una implementación que maneje los siguientes puntos:</p>
<ul class="simple">
<li><p>Sobre empates en la variable básica, no básica.</p></li>
<li><p>Sobre el álgebra matricial numérica.</p></li>
<li><p>Sobre variables básicas degeneradas.</p></li>
<li><p>Sobre variables de decisión con cotas inferiores distintas de cero, con cotas superiores.</p></li>
</ul>
<p>No se profundizará sobre los mismos y se sugiere ir a las referencias de esta nota para su consulta.</p>
</div>
<div class="section" id="metodo-simplex-en-redes">
<h2>Método símplex en redes<a class="headerlink" href="#metodo-simplex-en-redes" title="Permalink to this headline">¶</a></h2>
<p>Para ver un ejemplo del uso del método símplex aplicado a problemas de redes con capacidades (variables de decisión con cotas superiores) se utilizarán las <a class="reference internal" href="../4.1/Definiciones_generales_de_flujo_en_redes.html#dgflujoredes"><span class="std std-ref">Definiciones generales de flujo en redes</span></a> y  el ejemplo de <a class="reference internal" href="#ejflujoenredesypl"><span class="std std-ref">flujo en redes</span></a> añadiendo capacidad a los arcos <span class="math notranslate nohighlight">\((A, B)\)</span> y <span class="math notranslate nohighlight">\((C, E)\)</span> igual a <span class="math notranslate nohighlight">\(10\)</span> y <span class="math notranslate nohighlight">\(80\)</span> respectivamente:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">networkx</span> <span class="k">as</span> <span class="nn">nx</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nodes_pos</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.18181818181818182</span><span class="p">,</span> <span class="mf">0.7272727272727273</span><span class="p">],</span>
             <span class="p">[</span><span class="mf">0.18181818181818182</span><span class="p">,</span> <span class="mf">0.2727272727272727</span><span class="p">],</span>
             <span class="p">[</span><span class="mf">0.5454545454545454</span><span class="p">,</span> <span class="mf">0.2727272727272727</span><span class="p">],</span>
             <span class="p">[</span><span class="mf">0.5454545454545454</span><span class="p">,</span> <span class="mf">0.7272727272727273</span><span class="p">],</span>
             <span class="p">[</span><span class="mf">0.36363636363636365</span><span class="p">,</span> <span class="mf">0.5454545454545454</span><span class="p">]]</span>

<span class="n">nodes</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">]</span>

<span class="n">nodes_and_pos</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">nodes</span><span class="p">,</span> <span class="n">nodes_pos</span><span class="p">))</span>

<span class="n">G_min_cost_flow</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">()</span>

<span class="n">G_min_cost_flow</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="n">demand</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="n">node_and_demand</span><span class="o">=</span><span class="s2">&quot;A [50]&quot;</span><span class="p">)</span>
<span class="n">G_min_cost_flow</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="n">demand</span> <span class="o">=</span> <span class="mi">40</span><span class="p">,</span> <span class="n">node_and_demand</span><span class="o">=</span><span class="s2">&quot;B [40]&quot;</span><span class="p">)</span>
<span class="n">G_min_cost_flow</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="n">demand</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">node_and_demand</span><span class="o">=</span><span class="s2">&quot;C [0]&quot;</span><span class="p">)</span>
<span class="n">G_min_cost_flow</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="n">demand</span> <span class="o">=</span> <span class="o">-</span><span class="mi">30</span><span class="p">,</span> <span class="n">node_and_demand</span><span class="o">=</span><span class="s2">&quot;D [-30]&quot;</span><span class="p">)</span>
<span class="n">G_min_cost_flow</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="s1">&#39;E&#39;</span><span class="p">,</span> <span class="n">demand</span> <span class="o">=</span> <span class="o">-</span><span class="mi">60</span><span class="p">,</span> <span class="n">node_and_demand</span><span class="o">=</span><span class="s2">&quot;E [-60]&quot;</span><span class="p">)</span>

<span class="n">edge_labels_min_cost_flow</span> <span class="o">=</span> <span class="p">{(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">):</span> <span class="p">{</span><span class="s2">&quot;weight&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;capacity&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">},</span>
                             <span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">):</span> <span class="p">{</span><span class="s2">&quot;weight&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;capacity&quot;</span><span class="p">:</span> <span class="s2">&quot;inf&quot;</span><span class="p">},</span>
                             <span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">):</span> <span class="p">{</span><span class="s2">&quot;weight&quot;</span><span class="p">:</span> <span class="mi">9</span><span class="p">,</span> <span class="s2">&quot;capacity&quot;</span><span class="p">:</span> <span class="s2">&quot;inf&quot;</span><span class="p">},</span>
                             <span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">):</span> <span class="p">{</span><span class="s2">&quot;weight&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;capacity&quot;</span><span class="p">:</span> <span class="s2">&quot;inf&quot;</span><span class="p">},</span>
                             <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">):</span> <span class="p">{</span><span class="s2">&quot;weight&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;capacity&quot;</span><span class="p">:</span> <span class="mi">80</span><span class="p">}</span>
                            <span class="p">}</span>

<span class="n">G_min_cost_flow</span><span class="o">.</span><span class="n">add_edges_from</span><span class="p">(</span><span class="n">edge_labels_min_cost_flow</span><span class="p">)</span>
<span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">G_min_cost_flow</span><span class="o">.</span><span class="n">edges</span><span class="p">():</span>
    <span class="n">G_min_cost_flow</span><span class="p">[</span><span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s2">&quot;capacity&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">edge_labels_min_cost_flow</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s2">&quot;capacity&quot;</span><span class="p">]</span>
    <span class="n">G_min_cost_flow</span><span class="p">[</span><span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s2">&quot;weight&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">edge_labels_min_cost_flow</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s2">&quot;weight&quot;</span><span class="p">]</span>

        
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>

<span class="n">list_of_edges_not_trouble_to_visualize_min_cost_flow</span> <span class="o">=</span> <span class="n">edge_labels_min_cost_flow</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>

<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_edges</span><span class="p">(</span><span class="n">G_min_cost_flow</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nodes_and_pos</span><span class="p">,</span> 
                       <span class="n">min_target_margin</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">connectionstyle</span><span class="o">=</span><span class="s2">&quot;arc3, rad = 0.1&quot;</span><span class="p">,</span>
                       <span class="n">edgelist</span><span class="o">=</span><span class="n">list_of_edges_not_trouble_to_visualize_min_cost_flow</span><span class="p">)</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_edge_labels</span><span class="p">(</span><span class="n">G_min_cost_flow</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nodes_and_pos</span><span class="p">,</span> 
                             <span class="n">font_size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">edge_labels_min_cost_flow</span><span class="p">[(</span><span class="s1">&#39;E&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">)]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;weight&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;capacity&quot;</span><span class="p">:</span> <span class="s2">&quot;inf&quot;</span><span class="p">}</span>

<span class="n">edge_labels_min_cost_flow</span><span class="p">[(</span><span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">)]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;weight&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;capacity&quot;</span><span class="p">:</span> <span class="s2">&quot;inf&quot;</span><span class="p">}</span>


<span class="n">G_min_cost_flow</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="s1">&#39;E&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">)</span>
<span class="n">G_min_cost_flow</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">)</span>

<span class="n">n1</span> <span class="o">=</span> <span class="n">G_min_cost_flow</span><span class="p">[</span><span class="s1">&#39;E&#39;</span><span class="p">][</span><span class="s1">&#39;D&#39;</span><span class="p">]</span>
<span class="n">n2</span> <span class="o">=</span> <span class="n">G_min_cost_flow</span><span class="p">[</span><span class="s1">&#39;D&#39;</span><span class="p">][</span><span class="s1">&#39;E&#39;</span><span class="p">]</span>

<span class="n">n1</span><span class="p">[</span><span class="s2">&quot;weight&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">n1</span><span class="p">[</span><span class="s2">&quot;capacity&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;inf&quot;</span>

<span class="n">n2</span><span class="p">[</span><span class="s2">&quot;weight&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">n2</span><span class="p">[</span><span class="s2">&quot;capacity&quot;</span><span class="p">]</span><span class="o">=</span> <span class="s2">&quot;inf&quot;</span>


<span class="n">stri1</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="p">({</span><span class="s2">&quot;weight&quot;</span><span class="p">:</span> <span class="n">n1</span><span class="p">[</span><span class="s2">&quot;weight&quot;</span><span class="p">]},{</span><span class="s2">&quot;capacity&quot;</span><span class="p">:</span> <span class="n">n1</span><span class="p">[</span><span class="s2">&quot;capacity&quot;</span><span class="p">]},)</span><span class="si">}</span><span class="s1">&#39;</span>
<span class="n">stri2</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\n\n\n</span><span class="s1">&#39;</span>
<span class="n">stri3</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="p">({</span><span class="s2">&quot;weight&quot;</span><span class="p">:</span> <span class="n">n2</span><span class="p">[</span><span class="s2">&quot;weight&quot;</span><span class="p">]},</span> <span class="p">{</span><span class="s2">&quot;capacity&quot;</span><span class="p">:</span> <span class="n">n2</span><span class="p">[</span><span class="s2">&quot;capacity&quot;</span><span class="p">]},)</span><span class="si">}</span><span class="s1">&#39;</span>
<span class="n">string_for_edges_trouble_to_visualize_min_cost_flow</span> <span class="o">=</span> <span class="p">{(</span><span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">):</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">stri1</span><span class="p">,</span> <span class="n">stri2</span><span class="p">,</span> <span class="n">stri3</span><span class="p">])}</span>
<span class="n">list_of_edges_trouble_to_visualize_min_cost_flow</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;E&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">)]</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_edges</span><span class="p">(</span><span class="n">G_min_cost_flow</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nodes_and_pos</span><span class="p">,</span> 
                       <span class="n">min_target_margin</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">connectionstyle</span><span class="o">=</span><span class="s2">&quot;arc3, rad = 0.1&quot;</span><span class="p">,</span>
                       <span class="n">edgelist</span><span class="o">=</span><span class="n">list_of_edges_trouble_to_visualize_min_cost_flow</span><span class="p">)</span>

<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_edge_labels</span><span class="p">(</span><span class="n">G_min_cost_flow</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nodes_and_pos</span><span class="p">,</span> 
                             <span class="n">edge_labels</span><span class="o">=</span><span class="n">string_for_edges_trouble_to_visualize_min_cost_flow</span><span class="p">,</span>
                             <span class="n">font_size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">nodes_pos_modified</span> <span class="o">=</span> <span class="p">{}</span>

<span class="n">y_off</span> <span class="o">=</span> <span class="mf">0.03</span>

<span class="n">nodes_and_pos_modified</span> <span class="o">=</span> <span class="n">nodes_and_pos</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">G_min_cost_flow</span><span class="o">.</span><span class="n">nodes</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">node</span> <span class="o">==</span> <span class="s1">&#39;B&#39;</span> <span class="ow">or</span> <span class="n">node</span> <span class="o">==</span> <span class="s1">&#39;E&#39;</span><span class="p">:</span>
        <span class="n">nodes_and_pos_modified</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="o">=</span>  <span class="p">[</span><span class="n">nodes_and_pos_modified</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> 
                                         <span class="n">nodes_and_pos_modified</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">y_off</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">nodes_and_pos_modified</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="o">=</span>  <span class="p">[</span><span class="n">nodes_and_pos_modified</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> 
                                         <span class="n">nodes_and_pos_modified</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">y_off</span><span class="p">]</span>
        
    
<span class="n">node_labels_min_cost_flow</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">get_node_attributes</span><span class="p">(</span><span class="n">G_min_cost_flow</span><span class="p">,</span> <span class="s2">&quot;node_and_demand&quot;</span><span class="p">)</span>

<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_labels</span><span class="p">(</span><span class="n">G_min_cost_flow</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nodes_and_pos_modified</span><span class="p">,</span> 
                        <span class="n">labels</span><span class="o">=</span><span class="n">node_labels_min_cost_flow</span><span class="p">)</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_nodes</span><span class="p">(</span><span class="n">G_min_cost_flow</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nodes_and_pos</span><span class="p">,</span> 
                       <span class="n">node_size</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>        
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Programacion_lineal_y_metodo_simplex_434_0.png" src="../../_images/Programacion_lineal_y_metodo_simplex_434_0.png" />
</div>
</div>
<p>En la red anterior el arco <span class="math notranslate nohighlight">\((D, E)\)</span> tiene costo igual a <span class="math notranslate nohighlight">\(3\)</span> y el arco <span class="math notranslate nohighlight">\((E, D)\)</span> tiene costo igual a <span class="math notranslate nohighlight">\(2\)</span>.</p>
<p>El PL es:</p>
<div class="math notranslate nohighlight">
\[\displaystyle \min 2 x_{AB} + 4 x_{AC} + 9 x_{AD} + 3 x_{BC} + x_{CE} + 3 x_{DE} + 2x_{ED}\]</div>
<div class="math notranslate nohighlight">
\[\text{sujeto a: }\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
&amp;x_{AB}&amp;  + &amp;x_{AC}&amp; + &amp;x_{AD}&amp;   &amp;&amp;         &amp;&amp;         &amp;&amp;         &amp;&amp;       &amp;=&amp; 50 \nonumber \\
&amp;-x_{AB}&amp;   &amp;&amp;         &amp;&amp;       + &amp;x_{BC}&amp;   &amp;&amp;         &amp;&amp;         &amp;&amp;       &amp;=&amp; 40 \nonumber \\
&amp;&amp;        - &amp;x_{AC}&amp;   &amp;&amp;       - &amp;x_{BC}&amp; + &amp;x_{CE}&amp;   &amp;&amp;         &amp;&amp;       &amp;=&amp; 0 \nonumber \\
&amp;&amp;          &amp;&amp;       - &amp;x_{AD}&amp;   &amp;&amp;         &amp;&amp;       + &amp;x_{DE}&amp; - &amp;x_{ED}&amp; &amp;=&amp; -30 \nonumber \\
&amp;&amp;          &amp;&amp;         &amp;&amp;         &amp;&amp;       - &amp;x_{CE}&amp; - &amp;x_{DE}&amp; + &amp;x_{ED}&amp; &amp;=&amp; -60 \nonumber
\end{eqnarray}
\end{split}\]</div>
<div class="math notranslate nohighlight">
\[x_{AB} \leq 10, x_{CE} \leq 80\]</div>
<div class="math notranslate nohighlight">
\[x_{ij} \geq 0 \forall i,j\]</div>
<p>La primer restricción de igualdad representa el flujo neto para el nodo <span class="math notranslate nohighlight">\(A\)</span> y la última el flujo neto para el nodo <span class="math notranslate nohighlight">\(E\)</span>.</p>
<p>La red solución es:</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">G_min_cost_flow_solution</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">()</span>

<span class="n">G_min_cost_flow_solution</span><span class="o">.</span><span class="n">add_nodes_from</span><span class="p">(</span><span class="n">nodes</span><span class="p">)</span>


<span class="n">edge_flows</span> <span class="o">=</span> <span class="p">{(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
              <span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">):</span> <span class="mi">40</span><span class="p">,</span>
              <span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">):</span> <span class="mi">10</span><span class="p">,</span>
              <span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">):</span> <span class="mi">40</span><span class="p">,</span>
              <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">):</span> <span class="mi">80</span><span class="p">,</span>
              <span class="p">(</span><span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>            
              <span class="p">(</span><span class="s1">&#39;E&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">):</span> <span class="mi">20</span>
              <span class="p">}</span>

<span class="n">G_min_cost_flow_solution</span><span class="o">.</span><span class="n">add_edges_from</span><span class="p">(</span><span class="n">edge_flows</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_edges</span><span class="p">(</span><span class="n">G_min_cost_flow_solution</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nodes_and_pos</span><span class="p">,</span> 
                       <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
                       <span class="n">min_target_margin</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">connectionstyle</span><span class="o">=</span><span class="s2">&quot;arc3, rad = 0.1&quot;</span><span class="p">)</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_edge_labels</span><span class="p">(</span><span class="n">G_min_cost_flow_solution</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nodes_and_pos</span><span class="p">,</span> 
                             <span class="n">edge_labels</span><span class="o">=</span><span class="n">edge_flows</span><span class="p">,</span> <span class="n">label_pos</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span>
                             <span class="n">font_size</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_labels</span><span class="p">(</span><span class="n">G_min_cost_flow_solution</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nodes_and_pos</span><span class="p">)</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_nodes</span><span class="p">(</span><span class="n">G_min_cost_flow_solution</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nodes_and_pos</span><span class="p">,</span> 
                       <span class="n">node_size</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>        
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Programacion_lineal_y_metodo_simplex_444_0.png" src="../../_images/Programacion_lineal_y_metodo_simplex_444_0.png" />
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Tal solución se puede verificar utilizando el paquete <em>Networkx</em> y ejecutar las instrucciones en el ejemplo de <a class="reference internal" href="../4.1/Definiciones_generales_de_flujo_en_redes.html#ejredflujocostomin"><span class="std std-ref">flujo con costo mínimo</span></a>, en estas instrucciones se utiliza la función <a class="reference external" href="https://networkx.org/documentation/stable/reference/algorithms/flow.html#network-simplex">network_simplex</a>.</p>
</div>
<p>En la red anterior el arco <span class="math notranslate nohighlight">\((E, D)\)</span> es de <span class="math notranslate nohighlight">\(20\)</span> unidades. La designación del flujo anterior entre todos los nodos incurre en un costo de <span class="math notranslate nohighlight">\(490\)</span>.</p>
<p>(explicación de la técnica de la cota superior o partir de una solución BF, luego llegar a la siguiente red utilizando el método de símplex de redes)</p>
<p>Supóngase que en alguna iteración <span class="math notranslate nohighlight">\(x_{AB}\)</span> se convirtió en la variable básica que será sustituida pues alcanzó su cota superior de <span class="math notranslate nohighlight">\(10\)</span>. Por tanto el arco <span class="math notranslate nohighlight">\(x_{AB}\)</span> se sustituye por <span class="math notranslate nohighlight">\(x_{AB} = 10 - y_{BA}\)</span> con <span class="math notranslate nohighlight">\(y_{BA}=0\)</span> y por tanto es una variable no básica “nueva”. Entonces se sustituye el arco <span class="math notranslate nohighlight">\((A,B)\)</span> por el arco <span class="math notranslate nohighlight">\((B,A)\)</span> el cual tiene un flujo de <span class="math notranslate nohighlight">\(y_{BA}\)</span> con capacidad de <span class="math notranslate nohighlight">\(10\)</span> y un costo unitario de <span class="math notranslate nohighlight">\(-2\)</span>. También <span class="math notranslate nohighlight">\(b_A\)</span> disminuye de <span class="math notranslate nohighlight">\(50\)</span> a <span class="math notranslate nohighlight">\(40\)</span> y <span class="math notranslate nohighlight">\(b_B\)</span> aumenta de <span class="math notranslate nohighlight">\(40\)</span> a <span class="math notranslate nohighlight">\(50\)</span>:</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">G_simplex</span> <span class="o">=</span> <span class="n">G_min_cost_flow</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">G_simplex</span><span class="o">.</span><span class="n">remove_edge</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">)</span>
<span class="n">G_simplex</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="s1">&#39;A&#39;</span><span class="p">)</span>
<span class="n">G_simplex</span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">][</span><span class="s1">&#39;A&#39;</span><span class="p">][</span><span class="s2">&quot;weight&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span>
<span class="n">G_simplex</span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">][</span><span class="s1">&#39;A&#39;</span><span class="p">][</span><span class="s2">&quot;capacity&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">nx</span><span class="o">.</span><span class="n">set_node_attributes</span><span class="p">(</span><span class="n">G_simplex</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;demand&quot;</span><span class="p">:</span> <span class="mi">40</span><span class="p">,</span>
                                         <span class="s2">&quot;node_and_demand&quot;</span><span class="p">:</span> <span class="s2">&quot;A [40]&quot;</span><span class="p">},</span>
                                   <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;demand&quot;</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span>
                                         <span class="s2">&quot;node_and_demand&quot;</span><span class="p">:</span> <span class="s2">&quot;B [50]&quot;</span><span class="p">}</span>
                                   <span class="p">})</span>

<span class="n">list_of_edges_not_trouble_to_visualize_simplex</span> <span class="o">=</span> <span class="n">G_simplex</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_edges</span><span class="p">(</span><span class="n">G_simplex</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nodes_and_pos</span><span class="p">,</span> 
                       <span class="n">min_target_margin</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">connectionstyle</span><span class="o">=</span><span class="s2">&quot;arc3, rad = 0.1&quot;</span><span class="p">,</span>
                       <span class="n">edgelist</span><span class="o">=</span><span class="n">list_of_edges_not_trouble_to_visualize_simplex</span><span class="p">)</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_edge_labels</span><span class="p">(</span><span class="n">G_simplex</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nodes_and_pos</span><span class="p">,</span> 
                             <span class="n">font_size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">n1</span> <span class="o">=</span> <span class="n">G_simplex</span><span class="p">[</span><span class="s1">&#39;E&#39;</span><span class="p">][</span><span class="s1">&#39;D&#39;</span><span class="p">]</span>
<span class="n">n2</span> <span class="o">=</span> <span class="n">G_simplex</span><span class="p">[</span><span class="s1">&#39;D&#39;</span><span class="p">][</span><span class="s1">&#39;E&#39;</span><span class="p">]</span>

<span class="n">n1</span><span class="p">[</span><span class="s2">&quot;weight&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">n1</span><span class="p">[</span><span class="s2">&quot;capacity&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;inf&quot;</span>

<span class="n">n2</span><span class="p">[</span><span class="s2">&quot;weight&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">n2</span><span class="p">[</span><span class="s2">&quot;capacity&quot;</span><span class="p">]</span><span class="o">=</span> <span class="s2">&quot;inf&quot;</span>

<span class="n">stri1</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="p">({</span><span class="s2">&quot;weight&quot;</span><span class="p">:</span> <span class="n">n1</span><span class="p">[</span><span class="s2">&quot;weight&quot;</span><span class="p">]},{</span><span class="s2">&quot;capacity&quot;</span><span class="p">:</span> <span class="n">n1</span><span class="p">[</span><span class="s2">&quot;capacity&quot;</span><span class="p">]},)</span><span class="si">}</span><span class="s1">&#39;</span>
<span class="n">stri2</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\n\n\n</span><span class="s1">&#39;</span>
<span class="n">stri3</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="p">({</span><span class="s2">&quot;weight&quot;</span><span class="p">:</span> <span class="n">n2</span><span class="p">[</span><span class="s2">&quot;weight&quot;</span><span class="p">]},</span> <span class="p">{</span><span class="s2">&quot;capacity&quot;</span><span class="p">:</span> <span class="n">n2</span><span class="p">[</span><span class="s2">&quot;capacity&quot;</span><span class="p">]},)</span><span class="si">}</span><span class="s1">&#39;</span>
<span class="n">string_for_edges_trouble_to_visualize_simplex</span> <span class="o">=</span> <span class="p">{(</span><span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">):</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">stri1</span><span class="p">,</span> <span class="n">stri2</span><span class="p">,</span> <span class="n">stri3</span><span class="p">])}</span>

<span class="n">list_of_edges_trouble_to_visualize_simplex</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;E&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">)]</span>

<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_edges</span><span class="p">(</span><span class="n">G_simplex</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nodes_and_pos</span><span class="p">,</span> 
                       <span class="n">min_target_margin</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">connectionstyle</span><span class="o">=</span><span class="s2">&quot;arc3, rad = 0.1&quot;</span><span class="p">,</span>
                       <span class="n">edgelist</span><span class="o">=</span><span class="n">list_of_edges_trouble_to_visualize_simplex</span><span class="p">)</span>

<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_edge_labels</span><span class="p">(</span><span class="n">G_simplex</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nodes_and_pos</span><span class="p">,</span> 
                             <span class="n">edge_labels</span><span class="o">=</span><span class="n">string_for_edges_trouble_to_visualize_simplex</span><span class="p">,</span>
                             <span class="n">font_size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">node_labels_simplex</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">get_node_attributes</span><span class="p">(</span><span class="n">G_simplex</span><span class="p">,</span> <span class="s2">&quot;node_and_demand&quot;</span><span class="p">)</span>

<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_labels</span><span class="p">(</span><span class="n">G_simplex</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nodes_and_pos_modified</span><span class="p">,</span> 
                        <span class="n">labels</span><span class="o">=</span><span class="n">node_labels_simplex</span><span class="p">)</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_nodes</span><span class="p">(</span><span class="n">G_simplex</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nodes_and_pos</span><span class="p">,</span> 
                       <span class="n">node_size</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Programacion_lineal_y_metodo_simplex_449_0.png" src="../../_images/Programacion_lineal_y_metodo_simplex_449_0.png" />
</div>
</div>
<p>Considérese el siguiente <em>spanning tree</em> factible de ésta red:</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">G_simplex_spanning_tree_1</span> <span class="o">=</span> <span class="n">G_simplex</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">G_simplex_spanning_tree_1</span><span class="o">.</span><span class="n">remove_edge</span><span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="s1">&#39;A&#39;</span><span class="p">)</span>
<span class="n">G_simplex_spanning_tree_1</span><span class="o">.</span><span class="n">remove_edge</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">)</span>
<span class="n">G_simplex_spanning_tree_1</span><span class="o">.</span><span class="n">remove_edge</span><span class="p">(</span><span class="s1">&#39;E&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">)</span>

<span class="n">list_edges_spanning_tree_1</span> <span class="o">=</span> <span class="n">G_simplex_spanning_tree_1</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>

<span class="n">edge_labels_simplex_spanning_tree_1</span> <span class="o">=</span> <span class="p">{}</span>

<span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">list_edges_spanning_tree_1</span><span class="p">:</span>
    <span class="n">edge_labels_simplex_spanning_tree_1</span><span class="p">[</span><span class="n">e</span><span class="p">]</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">edge_labels_min_cost_flow</span><span class="p">[</span><span class="n">e</span><span class="p">])</span>
     
<span class="n">edge_labels_simplex_spanning_tree_1</span><span class="p">[(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">)][</span><span class="s2">&quot;flow&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">40</span>
<span class="n">edge_labels_simplex_spanning_tree_1</span><span class="p">[(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">)][</span><span class="s2">&quot;flow&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">edge_labels_simplex_spanning_tree_1</span><span class="p">[(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">)][</span><span class="s2">&quot;flow&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">edge_labels_simplex_spanning_tree_1</span><span class="p">[(</span><span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">)][</span><span class="s2">&quot;flow&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span>

<span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">G_simplex_spanning_tree_1</span><span class="o">.</span><span class="n">edges</span><span class="p">():</span>
    <span class="n">G_simplex_spanning_tree_1</span><span class="p">[</span><span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s2">&quot;flow&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">edge_labels_simplex_spanning_tree_1</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s2">&quot;flow&quot;</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">9</span><span class="p">))</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_edges</span><span class="p">(</span><span class="n">G_simplex_spanning_tree_1</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nodes_and_pos</span><span class="p">,</span> 
                       <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
                       <span class="n">min_target_margin</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">connectionstyle</span><span class="o">=</span><span class="s2">&quot;arc3, rad = 0.1&quot;</span><span class="p">)</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_edge_labels</span><span class="p">(</span><span class="n">G_simplex_spanning_tree_1</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nodes_and_pos</span><span class="p">,</span> 
                             <span class="n">edge_labels</span><span class="o">=</span><span class="n">edge_labels_simplex_spanning_tree_1</span><span class="p">,</span> <span class="n">label_pos</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
                             <span class="n">font_size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">node_labels_simplex_spanning_tree_1</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">get_node_attributes</span><span class="p">(</span><span class="n">G_simplex_spanning_tree_1</span><span class="p">,</span> 
                                                            <span class="s2">&quot;node_and_demand&quot;</span><span class="p">)</span>

<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_labels</span><span class="p">(</span><span class="n">G_simplex_spanning_tree_1</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nodes_and_pos_modified</span><span class="p">,</span> 
                        <span class="n">labels</span><span class="o">=</span><span class="n">node_labels_simplex_spanning_tree_1</span><span class="p">)</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_nodes</span><span class="p">(</span><span class="n">G_simplex_spanning_tree_1</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nodes_and_pos</span><span class="p">,</span> 
                       <span class="n">node_size</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>    
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Programacion_lineal_y_metodo_simplex_451_0.png" src="../../_images/Programacion_lineal_y_metodo_simplex_451_0.png" />
</div>
</div>
<p>Los valores anteriores de flujo se pueden obtener resolviendo las siguientes ecuaciones de igualdad que resultan con el cambio <span class="math notranslate nohighlight">\(x_{AB} = 10 - y_{BA}\)</span> y considerando arcos no básicos: <span class="math notranslate nohighlight">\(y_{AB}, x_{AC}, x_{ED}\)</span> que tienen valor igual a <span class="math notranslate nohighlight">\(0\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
&amp;-y_{AB}&amp;  + &amp;x_{AC}&amp; + &amp;x_{AD}&amp;   &amp;&amp;         &amp;&amp;         &amp;&amp;         &amp;&amp;       &amp;=&amp; 40 \nonumber \\
&amp;y_{AB}&amp;   &amp;&amp;         &amp;&amp;       + &amp;x_{BC}&amp;   &amp;&amp;         &amp;&amp;         &amp;&amp;       &amp;=&amp; 50 \nonumber \\
&amp;&amp;        - &amp;x_{AC}&amp;   &amp;&amp;       - &amp;x_{BC}&amp; + &amp;x_{CE}&amp;   &amp;&amp;         &amp;&amp;       &amp;=&amp; 0 \nonumber \\
&amp;&amp;          &amp;&amp;       - &amp;x_{AD}&amp;   &amp;&amp;         &amp;&amp;       + &amp;x_{DE}&amp; - &amp;x_{ED}&amp; &amp;=&amp; -30 \nonumber \\
&amp;&amp;          &amp;&amp;         &amp;&amp;         &amp;&amp;       - &amp;x_{CE}&amp; - &amp;x_{DE}&amp; + &amp;x_{ED}&amp; &amp;=&amp; -60 \nonumber
\end{eqnarray}
\end{split}\]</div>
<p>Variables no básicas: <span class="math notranslate nohighlight">\(y_{AB}, x_{AC}, x_{ED}\)</span> que corresponden a árcos no básicos.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">nx</span><span class="o">.</span><span class="n">get_edge_attributes</span><span class="p">(</span><span class="n">G_simplex_spanning_tree_1</span><span class="p">,</span> <span class="s2">&quot;flow&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{(&#39;A&#39;, &#39;D&#39;): 40, (&#39;B&#39;, &#39;C&#39;): 50, (&#39;C&#39;, &#39;E&#39;): 50, (&#39;D&#39;, &#39;E&#39;): 10}
</pre></div>
</div>
</div>
</div>
<div class="section" id="revision-de-cual-variable-no-basica-sustituye-a-una-variable-basica">
<h3>Revisión de cuál variable no básica sustituye a una variable básica<a class="headerlink" href="#revision-de-cual-variable-no-basica-sustituye-a-una-variable-basica" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">add_arc_from_spanning_tree</span><span class="p">(</span><span class="n">G_full</span><span class="p">,</span> <span class="n">G_spanning_tree</span><span class="p">,</span> <span class="n">arc</span><span class="p">,</span> <span class="n">edge_labels</span><span class="p">):</span>
    <span class="n">G_cycle</span> <span class="o">=</span> <span class="n">G_spanning_tree</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">G_cycle</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">arc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">arc</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">G_cycle</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">arc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">arc</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">G_cycle</span><span class="p">[</span><span class="n">arc</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">arc</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s2">&quot;weight&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">G_full</span><span class="p">[</span><span class="n">arc</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">arc</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s2">&quot;weight&quot;</span><span class="p">]</span>
    <span class="n">G_cycle</span><span class="p">[</span><span class="n">arc</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">arc</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s2">&quot;capacity&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">G_full</span><span class="p">[</span><span class="n">arc</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">arc</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s2">&quot;capacity&quot;</span><span class="p">]</span>
    <span class="n">G_cycle</span><span class="p">[</span><span class="n">arc</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">arc</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s2">&quot;flow&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="n">edge_labels_new</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">edge_labels</span><span class="p">)</span>
    <span class="n">edge_labels_new</span><span class="p">[</span><span class="n">arc</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">edge_labels_new</span><span class="p">[</span><span class="n">arc</span><span class="p">][</span><span class="s2">&quot;weight&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">G_cycle</span><span class="p">[</span><span class="n">arc</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">arc</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s2">&quot;weight&quot;</span><span class="p">]</span>
    <span class="n">edge_labels_new</span><span class="p">[</span><span class="n">arc</span><span class="p">][</span><span class="s2">&quot;capacity&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">G_cycle</span><span class="p">[</span><span class="n">arc</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">arc</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s2">&quot;capacity&quot;</span><span class="p">]</span>
    <span class="n">edge_labels_new</span><span class="p">[</span><span class="n">arc</span><span class="p">][</span><span class="s2">&quot;flow&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">G_cycle</span><span class="p">[</span><span class="n">arc</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">arc</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s2">&quot;flow&quot;</span><span class="p">]</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">G_cycle</span><span class="p">,</span> <span class="n">edge_labels_new</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Arco <span class="math notranslate nohighlight">\(y_{AB}\)</span>:</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arc_to_be_added_1</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">G_simplex_cycle_1</span><span class="p">,</span> <span class="n">edge_labels_simplex_cycle_1</span> <span class="o">=</span> <span class="n">add_arc_from_spanning_tree</span><span class="p">(</span><span class="n">G_simplex</span><span class="p">,</span> <span class="n">G_simplex_spanning_tree_1</span><span class="p">,</span> 
                                                                            <span class="n">arc_to_be_added_1</span><span class="p">,</span>
                                                                            <span class="n">edge_labels_simplex_spanning_tree_1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_edges</span><span class="p">(</span><span class="n">G_simplex_cycle_1</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nodes_and_pos</span><span class="p">,</span> 
                       <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
                       <span class="n">min_target_margin</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">connectionstyle</span><span class="o">=</span><span class="s2">&quot;arc3, rad = 0.1&quot;</span><span class="p">,</span>
                       <span class="n">edgelist</span><span class="o">=</span><span class="n">G_simplex_spanning_tree_1</span><span class="o">.</span><span class="n">edges</span><span class="p">())</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_edges</span><span class="p">(</span><span class="n">G_simplex_cycle_1</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nodes_and_pos</span><span class="p">,</span> 
                       <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
                       <span class="n">min_target_margin</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">connectionstyle</span><span class="o">=</span><span class="s2">&quot;arc3, rad = 0.1&quot;</span><span class="p">,</span>
                       <span class="n">edgelist</span><span class="o">=</span><span class="p">[</span><span class="n">arc_to_be_added_1</span><span class="p">],</span>
                       <span class="n">width</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
                       <span class="n">style</span><span class="o">=</span><span class="s2">&quot;dashed&quot;</span><span class="p">)</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_edge_labels</span><span class="p">(</span><span class="n">G_simplex_cycle_1</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nodes_and_pos</span><span class="p">,</span> 
                             <span class="n">edge_labels</span><span class="o">=</span><span class="n">edge_labels_simplex_cycle_1</span><span class="p">,</span> <span class="n">label_pos</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
                             <span class="n">font_size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_labels</span><span class="p">(</span><span class="n">G_simplex_cycle_1</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nodes_and_pos_modified</span><span class="p">,</span> 
                        <span class="n">labels</span><span class="o">=</span><span class="n">node_labels_simplex_spanning_tree_1</span><span class="p">)</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_nodes</span><span class="p">(</span><span class="n">G_simplex_cycle_1</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nodes_and_pos</span><span class="p">,</span> 
                       <span class="n">node_size</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Programacion_lineal_y_metodo_simplex_460_0.png" src="../../_images/Programacion_lineal_y_metodo_simplex_460_0.png" />
</div>
</div>
<p>Entonces se forma un ciclo no dirigido. La orientación del ciclo se hereda de la dirección del arco añadido, en este caso en sentido de las manecillas del reloj:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cycle_1</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">find_cycle</span><span class="p">(</span><span class="n">G_simplex_cycle_1</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">fix_orientation</span><span class="p">(</span><span class="n">c_d</span><span class="p">,</span> <span class="n">arc</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">c_d</span><span class="p">[</span><span class="n">arc</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;reverse&quot;</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">c_d</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">c_d</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;forward&quot;</span><span class="p">:</span>
                <span class="n">c_d</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;reverse&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">c_d</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;forward&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cycle_1_d</span> <span class="o">=</span> <span class="p">{(</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span> <span class="n">t</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">cycle_1</span><span class="p">}</span>
<span class="n">fix_orientation</span><span class="p">(</span><span class="n">cycle_1_d</span><span class="p">,</span> <span class="n">arc_to_be_added_1</span><span class="p">)</span>
<span class="n">pprint</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">cycle_1_d</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{(&#39;A&#39;, &#39;D&#39;): &#39;forward&#39;,
 (&#39;B&#39;, &#39;A&#39;): &#39;forward&#39;,
 (&#39;B&#39;, &#39;C&#39;): &#39;reverse&#39;,
 (&#39;C&#39;, &#39;E&#39;): &#39;reverse&#39;,
 (&#39;D&#39;, &#39;E&#39;): &#39;forward&#39;}
</pre></div>
</div>
</div>
</div>
<p>Se calcula el costo unitario de incrementar el flujo por una unidad. Para los “forward” se suma y para los “reverse” se restan los costos:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">edges_and_weights_simplex_cycle_1</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">get_edge_attributes</span><span class="p">(</span><span class="n">G_simplex_cycle_1</span><span class="p">,</span> <span class="s2">&quot;weight&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pprint</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">edges_and_weights_simplex_cycle_1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{(&#39;A&#39;, &#39;D&#39;): 9, (&#39;B&#39;, &#39;A&#39;): -2, (&#39;B&#39;, &#39;C&#39;): 3, (&#39;C&#39;, &#39;E&#39;): 1, (&#39;D&#39;, &#39;E&#39;): 3}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">compute_cost_for_unit_increment</span><span class="p">(</span><span class="n">c_d</span><span class="p">,</span> <span class="n">e_w_d</span><span class="p">):</span>
    <span class="n">m_number_of_edges_simplex_cycle</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">e_w_d</span><span class="p">)</span>
    <span class="n">weights_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">m_number_of_edges_simplex_cycle</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">j</span><span class="p">,</span><span class="n">k</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">c_d</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
        <span class="k">if</span> <span class="n">c_d</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;forward&quot;</span><span class="p">:</span>
            <span class="n">weights_array</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">e_w_d</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">weights_array</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="n">e_w_d</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">weights_array</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">compute_cost_for_unit_increment</span><span class="p">(</span><span class="n">cycle_1_d</span><span class="p">,</span> 
                                             <span class="n">edges_and_weights_simplex_cycle_1</span><span class="p">))</span>
     <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>6.0
</pre></div>
</div>
</div>
</div>
<p><strong>Arco <span class="math notranslate nohighlight">\(x_{AC}\)</span>:</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arc_to_be_added_2</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">G_simplex_cycle_2</span><span class="p">,</span> <span class="n">edge_labels_simplex_cycle_2</span> <span class="o">=</span> <span class="n">add_arc_from_spanning_tree</span><span class="p">(</span><span class="n">G_simplex</span><span class="p">,</span> <span class="n">G_simplex_spanning_tree_1</span><span class="p">,</span> 
                                                                            <span class="n">arc_to_be_added_2</span><span class="p">,</span>
                                                                            <span class="n">edge_labels_simplex_spanning_tree_1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_edges</span><span class="p">(</span><span class="n">G_simplex_cycle_2</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nodes_and_pos</span><span class="p">,</span> 
                       <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
                       <span class="n">min_target_margin</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">connectionstyle</span><span class="o">=</span><span class="s2">&quot;arc3, rad = 0.1&quot;</span><span class="p">,</span>
                       <span class="n">edgelist</span><span class="o">=</span><span class="n">G_simplex_spanning_tree_1</span><span class="o">.</span><span class="n">edges</span><span class="p">())</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_edges</span><span class="p">(</span><span class="n">G_simplex_cycle_2</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nodes_and_pos</span><span class="p">,</span> 
                       <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
                       <span class="n">min_target_margin</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">connectionstyle</span><span class="o">=</span><span class="s2">&quot;arc3, rad = 0.1&quot;</span><span class="p">,</span>
                       <span class="n">edgelist</span><span class="o">=</span><span class="p">[</span><span class="n">arc_to_be_added_2</span><span class="p">],</span>
                       <span class="n">width</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
                       <span class="n">style</span><span class="o">=</span><span class="s2">&quot;dashed&quot;</span><span class="p">)</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_edge_labels</span><span class="p">(</span><span class="n">G_simplex_cycle_2</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nodes_and_pos</span><span class="p">,</span> 
                             <span class="n">edge_labels</span><span class="o">=</span><span class="n">edge_labels_simplex_cycle_2</span><span class="p">,</span> <span class="n">label_pos</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
                             <span class="n">font_size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_labels</span><span class="p">(</span><span class="n">G_simplex_cycle_2</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nodes_and_pos_modified</span><span class="p">,</span> 
                        <span class="n">labels</span><span class="o">=</span><span class="n">node_labels_simplex_spanning_tree_1</span><span class="p">)</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_nodes</span><span class="p">(</span><span class="n">G_simplex_cycle_2</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nodes_and_pos</span><span class="p">,</span> 
                       <span class="n">node_size</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Programacion_lineal_y_metodo_simplex_472_0.png" src="../../_images/Programacion_lineal_y_metodo_simplex_472_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cycle_2</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">find_cycle</span><span class="p">(</span><span class="n">G_simplex_cycle_2</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cycle_2_d</span> <span class="o">=</span> <span class="p">{(</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span> <span class="n">t</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">cycle_2</span><span class="p">}</span>
<span class="n">fix_orientation</span><span class="p">(</span><span class="n">cycle_2_d</span><span class="p">,</span> <span class="n">arc_to_be_added_2</span><span class="p">)</span>
<span class="n">pprint</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">cycle_2_d</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{(&#39;A&#39;, &#39;C&#39;): &#39;forward&#39;,
 (&#39;A&#39;, &#39;D&#39;): &#39;reverse&#39;,
 (&#39;C&#39;, &#39;E&#39;): &#39;forward&#39;,
 (&#39;D&#39;, &#39;E&#39;): &#39;reverse&#39;}
</pre></div>
</div>
</div>
</div>
<p>Se calcula el costo unitario de incrementar el flujo por una unidad. Para los “forward” se suma y para los “reverse” se restan los costos:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">edges_and_weights_simplex_cycle_2</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">get_edge_attributes</span><span class="p">(</span><span class="n">G_simplex_cycle_2</span><span class="p">,</span> <span class="s2">&quot;weight&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pprint</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">edges_and_weights_simplex_cycle_2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{(&#39;A&#39;, &#39;C&#39;): 4, (&#39;A&#39;, &#39;D&#39;): 9, (&#39;B&#39;, &#39;C&#39;): 3, (&#39;C&#39;, &#39;E&#39;): 1, (&#39;D&#39;, &#39;E&#39;): 3}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">compute_cost_for_unit_increment</span><span class="p">(</span><span class="n">cycle_2_d</span><span class="p">,</span> 
                                             <span class="n">edges_and_weights_simplex_cycle_2</span><span class="p">))</span>
     <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-7.0
</pre></div>
</div>
</div>
</div>
<p><strong>Arco <span class="math notranslate nohighlight">\(x_{ED}\)</span>:</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arc_to_be_added_3</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;E&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">G_simplex_cycle_3</span><span class="p">,</span> <span class="n">edge_labels_simplex_cycle_3</span> <span class="o">=</span> <span class="n">add_arc_from_spanning_tree</span><span class="p">(</span><span class="n">G_simplex</span><span class="p">,</span> <span class="n">G_simplex_spanning_tree_1</span><span class="p">,</span> 
                                                                            <span class="n">arc_to_be_added_3</span><span class="p">,</span>
                                                                            <span class="n">edge_labels_simplex_spanning_tree_1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_edges</span><span class="p">(</span><span class="n">G_simplex_cycle_3</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nodes_and_pos</span><span class="p">,</span> 
                       <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
                       <span class="n">min_target_margin</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">connectionstyle</span><span class="o">=</span><span class="s2">&quot;arc3, rad = 0.1&quot;</span><span class="p">,</span>
                       <span class="n">edgelist</span><span class="o">=</span><span class="n">G_simplex_spanning_tree_1</span><span class="o">.</span><span class="n">edges</span><span class="p">())</span>

<span class="n">list_of_edges_not_trouble_to_visualize_cycle_3</span> <span class="o">=</span> <span class="n">edge_labels_simplex_spanning_tree_1</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>

<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_edges</span><span class="p">(</span><span class="n">G_simplex_cycle_3</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nodes_and_pos</span><span class="p">,</span> 
                       <span class="n">min_target_margin</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">connectionstyle</span><span class="o">=</span><span class="s2">&quot;arc3, rad = 0.1&quot;</span><span class="p">,</span>
                       <span class="n">edgelist</span><span class="o">=</span><span class="n">list_of_edges_not_trouble_to_visualize_cycle_3</span><span class="p">)</span>

<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_edge_labels</span><span class="p">(</span><span class="n">G_simplex_cycle_3</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nodes_and_pos</span><span class="p">,</span> 
                             <span class="n">edge_labels</span><span class="o">=</span><span class="n">edge_labels_simplex_cycle_3</span><span class="p">,</span> <span class="n">label_pos</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
                             <span class="n">font_size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">n1</span> <span class="o">=</span> <span class="n">G_simplex_cycle_3</span><span class="p">[</span><span class="s1">&#39;E&#39;</span><span class="p">][</span><span class="s1">&#39;D&#39;</span><span class="p">]</span>
<span class="n">n2</span> <span class="o">=</span> <span class="n">G_simplex_cycle_3</span><span class="p">[</span><span class="s1">&#39;D&#39;</span><span class="p">][</span><span class="s1">&#39;E&#39;</span><span class="p">]</span>

<span class="n">n1</span><span class="p">[</span><span class="s2">&quot;weight&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">n1</span><span class="p">[</span><span class="s2">&quot;capacity&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;inf&quot;</span>
<span class="n">n1</span><span class="p">[</span><span class="s2">&quot;flow&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;$flow^+$&quot;</span>
<span class="n">n2</span><span class="p">[</span><span class="s2">&quot;flow&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">3</span>

<span class="n">stri1</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="p">({</span><span class="s2">&quot;weight&quot;</span><span class="p">:</span> <span class="n">n1</span><span class="p">[</span><span class="s2">&quot;weight&quot;</span><span class="p">]},{</span><span class="s2">&quot;capacity&quot;</span><span class="p">:</span> <span class="n">n1</span><span class="p">[</span><span class="s2">&quot;capacity&quot;</span><span class="p">]},</span> <span class="p">{</span><span class="s2">&quot;flow&quot;</span><span class="p">:</span> <span class="n">n1</span><span class="p">[</span><span class="s2">&quot;flow&quot;</span><span class="p">]},)</span><span class="si">}</span><span class="s1">&#39;</span>
<span class="n">stri2</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\n\n\n</span><span class="s1">&#39;</span>
<span class="n">stri3</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="p">({</span><span class="s2">&quot;weight&quot;</span><span class="p">:</span> <span class="n">n2</span><span class="p">[</span><span class="s2">&quot;weight&quot;</span><span class="p">]},</span> <span class="p">{</span><span class="s2">&quot;capacity&quot;</span><span class="p">:</span> <span class="n">n2</span><span class="p">[</span><span class="s2">&quot;capacity&quot;</span><span class="p">]},{</span><span class="s2">&quot;flow&quot;</span><span class="p">:</span> <span class="n">n2</span><span class="p">[</span><span class="s2">&quot;flow&quot;</span><span class="p">]})</span><span class="si">}</span><span class="s1">&#39;</span>
<span class="n">string_for_edges_trouble_to_visualize</span> <span class="o">=</span> <span class="p">{(</span><span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">):</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">stri1</span><span class="p">,</span> <span class="n">stri2</span><span class="p">,</span> <span class="n">stri3</span><span class="p">])}</span>

<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_edges</span><span class="p">(</span><span class="n">G_simplex_cycle_3</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nodes_and_pos</span><span class="p">,</span> 
                       <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
                       <span class="n">min_target_margin</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">connectionstyle</span><span class="o">=</span><span class="s2">&quot;arc3, rad = 0.1&quot;</span><span class="p">,</span>
                       <span class="n">edgelist</span><span class="o">=</span><span class="p">[</span><span class="n">arc_to_be_added_3</span><span class="p">],</span>
                       <span class="n">width</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
                       <span class="n">style</span><span class="o">=</span><span class="s2">&quot;dashed&quot;</span><span class="p">)</span>

<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_edge_labels</span><span class="p">(</span><span class="n">G_simplex_cycle_3</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nodes_and_pos</span><span class="p">,</span> 
                             <span class="n">edge_labels</span><span class="o">=</span><span class="n">string_for_edges_trouble_to_visualize</span><span class="p">,</span>
                             <span class="n">font_size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_labels</span><span class="p">(</span><span class="n">G_simplex_cycle_3</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nodes_and_pos_modified</span><span class="p">,</span> 
                        <span class="n">labels</span><span class="o">=</span><span class="n">node_labels_simplex_spanning_tree_1</span><span class="p">)</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_nodes</span><span class="p">(</span><span class="n">G_simplex_cycle_3</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nodes_and_pos</span><span class="p">,</span> 
                       <span class="n">node_size</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Programacion_lineal_y_metodo_simplex_481_0.png" src="../../_images/Programacion_lineal_y_metodo_simplex_481_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cycle_3</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">find_cycle</span><span class="p">(</span><span class="n">G_simplex_cycle_3</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cycle_3_d</span> <span class="o">=</span> <span class="p">{(</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span> <span class="n">t</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">cycle_3</span><span class="p">}</span>
<span class="n">fix_orientation</span><span class="p">(</span><span class="n">cycle_3_d</span><span class="p">,</span> <span class="n">arc_to_be_added_3</span><span class="p">)</span>
<span class="n">pprint</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">cycle_3_d</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{(&#39;D&#39;, &#39;E&#39;): &#39;forward&#39;, (&#39;E&#39;, &#39;D&#39;): &#39;forward&#39;}
</pre></div>
</div>
</div>
</div>
<p>Se calcula el costo unitario de incrementar el flujo por una unidad. Para los “forward” se suma y para los “reverse” se restan los costos:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">edges_and_weights_simplex_cycle_3</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">get_edge_attributes</span><span class="p">(</span><span class="n">G_simplex_cycle_3</span><span class="p">,</span> <span class="s2">&quot;weight&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pprint</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">edges_and_weights_simplex_cycle_3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{(&#39;A&#39;, &#39;D&#39;): 9, (&#39;B&#39;, &#39;C&#39;): 3, (&#39;C&#39;, &#39;E&#39;): 1, (&#39;D&#39;, &#39;E&#39;): 3, (&#39;E&#39;, &#39;D&#39;): 2}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">compute_cost_for_unit_increment</span><span class="p">(</span><span class="n">cycle_3_d</span><span class="p">,</span> 
                                             <span class="n">edges_and_weights_simplex_cycle_3</span><span class="p">))</span>
     <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>5.0
</pre></div>
</div>
</div>
</div>
<p>En resúmen:</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-align:center head"><p>Arco</p></th>
<th class="text-align:center head"><p>Costo por incrementar una unidad del arco</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:center"><p>(B,A)</p></td>
<td class="text-align:center"><p>6</p></td>
</tr>
<tr class="row-odd"><td class="text-align:center"><p>(A,C)</p></td>
<td class="text-align:center"><p>-7</p></td>
</tr>
<tr class="row-even"><td class="text-align:center"><p>(E,D)</p></td>
<td class="text-align:center"><p>5</p></td>
</tr>
</tbody>
</table>
<p>Entonces el arco no básico que tiene la tasa más alta de mejoramiento de <span class="math notranslate nohighlight">\(f_o\)</span> es <span class="math notranslate nohighlight">\((A,C)\)</span>.</p>
<div class="admonition-comentario admonition">
<p class="admonition-title">Comentario</p>
<p>Si no hay arcos no básicos que mejoren <span class="math notranslate nohighlight">\(f_o\)</span> entonces la solución actual es óptima.</p>
</div>
</div>
<div class="section" id="revision-de-cual-arco-basico-es-sustituido">
<h3>Revisión de cuál arco básico es sustituido<a class="headerlink" href="#revision-de-cual-arco-basico-es-sustituido" title="Permalink to this headline">¶</a></h3>
<p>Se determina incrementando el flujo de la red lo más posible hasta que uno de los arcos básicos llege a su cota inferior o superior. Denotemos al incremento como la cantidad <span class="math notranslate nohighlight">\(\text{flow}^+\)</span> y para los arcos que son “forward” se suma tal cantidad al flujo actual y para los que son “reverse” se resta:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">edge_label_change_for_basic_arc_subs</span><span class="p">(</span><span class="n">c_d</span><span class="p">,</span> <span class="n">edge_labels_reference</span><span class="p">,</span> <span class="n">arc_to_be_added</span><span class="p">):</span>
    <span class="n">edge_labels_modified</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">edge_labels_modified</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">edge_labels_reference</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">edge_labels_modified</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">c_d</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">e</span> <span class="o">!=</span> <span class="n">arc_to_be_added</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">c_d</span><span class="p">[</span><span class="n">e</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;forward&quot;</span><span class="p">:</span>
                    <span class="n">edge_labels_modified</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s2">&quot;flow&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">edge_labels_modified</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s2">&quot;flow&quot;</span><span class="p">]),</span>
                                                               <span class="s2">&quot;+ $flow^+$&quot;</span><span class="p">])</span>
                    <span class="n">edge_labels_modified</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s2">&quot;bool&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;+&quot;</span> 
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">edge_labels_modified</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s2">&quot;flow&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">edge_labels_modified</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s2">&quot;flow&quot;</span><span class="p">]),</span>
                                                               <span class="s2">&quot;- $flow^+$&quot;</span><span class="p">])</span>
                    <span class="n">edge_labels_modified</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s2">&quot;bool&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;-&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">edge_labels_modified</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s2">&quot;flow&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">edge_labels_modified</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s2">&quot;flow&quot;</span><span class="p">]),</span>
                                                           <span class="s2">&quot;$flow^+$&quot;</span><span class="p">])</span> 
        <span class="k">else</span><span class="p">:</span>
            <span class="n">edge_labels_modified</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s2">&quot;bool&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> 
    <span class="k">return</span> <span class="n">edge_labels_modified</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">edge_labels_simplex_cycle_2_modified</span> <span class="o">=</span> <span class="n">edge_label_change_for_basic_arc_subs</span><span class="p">(</span><span class="n">cycle_2_d</span><span class="p">,</span> 
                                                                            <span class="n">edge_labels_simplex_cycle_2</span><span class="p">,</span> 
                                                                            <span class="n">arc_to_be_added_2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pprint</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">edge_labels_simplex_cycle_2_modified</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{(&#39;A&#39;, &#39;C&#39;): {&#39;capacity&#39;: &#39;inf&#39;, &#39;flow&#39;: &#39;$flow^+$&#39;, &#39;weight&#39;: 4},
 (&#39;A&#39;, &#39;D&#39;): {&#39;bool&#39;: &#39;-&#39;,
              &#39;capacity&#39;: &#39;inf&#39;,
              &#39;flow&#39;: &#39;40- $flow^+$&#39;,
              &#39;weight&#39;: 9},
 (&#39;B&#39;, &#39;C&#39;): {&#39;bool&#39;: 0, &#39;capacity&#39;: &#39;inf&#39;, &#39;flow&#39;: 50, &#39;weight&#39;: 3},
 (&#39;C&#39;, &#39;E&#39;): {&#39;bool&#39;: &#39;+&#39;, &#39;capacity&#39;: 80, &#39;flow&#39;: &#39;50+ $flow^+$&#39;, &#39;weight&#39;: 1},
 (&#39;D&#39;, &#39;E&#39;): {&#39;bool&#39;: &#39;-&#39;,
              &#39;capacity&#39;: &#39;inf&#39;,
              &#39;flow&#39;: &#39;10- $flow^+$&#39;,
              &#39;weight&#39;: 3}}
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">11</span><span class="p">))</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_edges</span><span class="p">(</span><span class="n">G_simplex_cycle_2</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nodes_and_pos</span><span class="p">,</span> 
                       <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
                       <span class="n">min_target_margin</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">connectionstyle</span><span class="o">=</span><span class="s2">&quot;arc3, rad = 0.1&quot;</span><span class="p">,</span>
                       <span class="n">edgelist</span><span class="o">=</span><span class="n">G_simplex_spanning_tree_1</span><span class="o">.</span><span class="n">edges</span><span class="p">())</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_edges</span><span class="p">(</span><span class="n">G_simplex_cycle_2</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nodes_and_pos</span><span class="p">,</span> 
                       <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
                       <span class="n">min_target_margin</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">connectionstyle</span><span class="o">=</span><span class="s2">&quot;arc3, rad = 0.1&quot;</span><span class="p">,</span>
                       <span class="n">edgelist</span><span class="o">=</span><span class="p">[</span><span class="n">arc_to_be_added_2</span><span class="p">],</span>
                       <span class="n">width</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
                       <span class="n">style</span><span class="o">=</span><span class="s2">&quot;dashed&quot;</span><span class="p">)</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_edge_labels</span><span class="p">(</span><span class="n">G_simplex_cycle_2</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nodes_and_pos</span><span class="p">,</span> 
                             <span class="n">edge_labels</span><span class="o">=</span><span class="n">edge_labels_simplex_cycle_2_modified</span><span class="p">,</span> <span class="n">label_pos</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
                             <span class="n">font_size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_labels</span><span class="p">(</span><span class="n">G_simplex_cycle_2</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nodes_and_pos_modified</span><span class="p">,</span> 
                        <span class="n">labels</span><span class="o">=</span><span class="n">node_labels_simplex_spanning_tree_1</span><span class="p">)</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_nodes</span><span class="p">(</span><span class="n">G_simplex_cycle_2</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nodes_and_pos</span><span class="p">,</span> 
                       <span class="n">node_size</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Programacion_lineal_y_metodo_simplex_496_0.png" src="../../_images/Programacion_lineal_y_metodo_simplex_496_0.png" />
</div>
</div>
<p>Como se debe cumplir la no negatividad y la cota superior, para los arcos en los que se aumenta y tienen cota superior se tiene</p>
<div class="math notranslate nohighlight">
\[x_{CE} = 50 + \text{flow}^+ \leq 80\]</div>
<p>y para los arcos en los que se disminuye:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{eqnarray}
x_{AD} = 40 - \text{flow}^+ &amp;\geq&amp; 0 \nonumber \\
x_{DE} = 10 - \text{flow}^+ &amp;\geq&amp; 0
\end{eqnarray}
\end{split}\]</div>
<p>Por lo que:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{eqnarray}
\text{flow}^+ &amp;\leq&amp; 30 \quad \text{que se obtuvo del arco } x_{CE} \nonumber \\
\text{flow}^+ &amp;\leq&amp; 40 \quad \text{que se obtuvo del arco } x_{AD} \nonumber \\
\text{flow}^+ &amp;\leq&amp; 10 \quad \text{que se obtuvo del arco } x_{DE} \nonumber
\end{eqnarray}
\end{split}\]</div>
<p>El mínimo es <span class="math notranslate nohighlight">\(10\)</span>, entonces <span class="math notranslate nohighlight">\(\text{flow}^+ = 10\)</span> y el arco básico que será sustituido es <span class="math notranslate nohighlight">\((D,E)\)</span>.</p>
<p>El nuevo <em>spanning tree</em> factible es:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">flow_plus</span> <span class="o">=</span> <span class="mi">10</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arc_to_remove</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">)</span>
<span class="n">arc_to_add</span> <span class="o">=</span> <span class="n">arc_to_be_added_2</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">arc_to_add</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(&#39;A&#39;, &#39;C&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">G_simplex_spanning_tree_2</span> <span class="o">=</span> <span class="n">G_simplex_spanning_tree_1</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">G_simplex_spanning_tree_2</span><span class="o">.</span><span class="n">remove_edge</span><span class="p">(</span><span class="n">arc_to_remove</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">arc_to_remove</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">G_simplex_spanning_tree_2</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">arc_to_add</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">arc_to_add</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="n">list_edges_spanning_tree_2</span> <span class="o">=</span> <span class="n">G_simplex_spanning_tree_2</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>

<span class="n">edge_labels_simplex_spanning_tree_2</span> <span class="o">=</span> <span class="p">{}</span>

<span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">list_edges_spanning_tree_2</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">e</span> <span class="o">!=</span> <span class="n">arc_to_add</span><span class="p">:</span>
        <span class="n">edge_labels_simplex_spanning_tree_2</span><span class="p">[</span><span class="n">e</span><span class="p">]</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">G_simplex_spanning_tree_1</span><span class="p">[</span><span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
        <span class="k">if</span> <span class="n">edge_labels_simplex_cycle_2_modified</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s2">&quot;bool&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;+&quot;</span><span class="p">:</span>
            <span class="n">edge_labels_simplex_spanning_tree_2</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s2">&quot;flow&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">edge_labels_simplex_spanning_tree_2</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s2">&quot;flow&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">flow_plus</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">edge_labels_simplex_cycle_2_modified</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s2">&quot;bool&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;-&quot;</span><span class="p">:</span>
                <span class="n">edge_labels_simplex_spanning_tree_2</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s2">&quot;flow&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">edge_labels_simplex_spanning_tree_2</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s2">&quot;flow&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">flow_plus</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">edge_labels_simplex_spanning_tree_2</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s2">&quot;flow&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">edge_labels_simplex_spanning_tree_2</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s2">&quot;flow&quot;</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">e</span> <span class="o">==</span> <span class="n">arc_to_add</span><span class="p">:</span>
        <span class="n">edge_labels_simplex_spanning_tree_2</span><span class="p">[</span><span class="n">e</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">edge_labels_simplex_spanning_tree_2</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s2">&quot;weight&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">G_simplex</span><span class="p">[</span><span class="n">arc_to_add</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">arc_to_add</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s2">&quot;weight&quot;</span><span class="p">]</span>
        <span class="n">edge_labels_simplex_spanning_tree_2</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s2">&quot;capacity&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">G_simplex</span><span class="p">[</span><span class="n">arc_to_add</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">arc_to_add</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s2">&quot;capacity&quot;</span><span class="p">]</span>
        <span class="n">edge_labels_simplex_spanning_tree_2</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s2">&quot;flow&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">flow_plus</span> 
        

<span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">G_simplex_spanning_tree_2</span><span class="o">.</span><span class="n">edges</span><span class="p">():</span>
    <span class="n">G_simplex_spanning_tree_2</span><span class="p">[</span><span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s2">&quot;flow&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">edge_labels_simplex_spanning_tree_2</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s2">&quot;flow&quot;</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">e</span><span class="o">==</span><span class="n">arc_to_add</span><span class="p">:</span>
        <span class="n">G_simplex_spanning_tree_2</span><span class="p">[</span><span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s2">&quot;weight&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">edge_labels_simplex_spanning_tree_2</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s2">&quot;weight&quot;</span><span class="p">]</span>
        <span class="n">G_simplex_spanning_tree_2</span><span class="p">[</span><span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s2">&quot;capacity&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">edge_labels_simplex_spanning_tree_2</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s2">&quot;capacity&quot;</span><span class="p">]</span>
        
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">9</span><span class="p">))</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_edges</span><span class="p">(</span><span class="n">G_simplex_spanning_tree_2</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nodes_and_pos</span><span class="p">,</span> 
                       <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
                       <span class="n">min_target_margin</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">connectionstyle</span><span class="o">=</span><span class="s2">&quot;arc3, rad = 0.1&quot;</span><span class="p">)</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_edge_labels</span><span class="p">(</span><span class="n">G_simplex_spanning_tree_2</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nodes_and_pos</span><span class="p">,</span> 
                             <span class="n">edge_labels</span><span class="o">=</span><span class="n">edge_labels_simplex_spanning_tree_2</span><span class="p">,</span> <span class="n">label_pos</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
                             <span class="n">font_size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">node_labels_simplex_spanning_tree_2</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">get_node_attributes</span><span class="p">(</span><span class="n">G_simplex_spanning_tree_2</span><span class="p">,</span> 
                                                            <span class="s2">&quot;node_and_demand&quot;</span><span class="p">)</span>

<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_labels</span><span class="p">(</span><span class="n">G_simplex_spanning_tree_2</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nodes_and_pos_modified</span><span class="p">,</span> 
                        <span class="n">labels</span><span class="o">=</span><span class="n">node_labels_simplex_spanning_tree_2</span><span class="p">)</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_nodes</span><span class="p">(</span><span class="n">G_simplex_spanning_tree_2</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nodes_and_pos</span><span class="p">,</span> 
                       <span class="n">node_size</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>    
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Programacion_lineal_y_metodo_simplex_508_0.png" src="../../_images/Programacion_lineal_y_metodo_simplex_508_0.png" />
</div>
</div>
</div>
<div class="section" id="iteracion-siguiente">
<h3>Iteración siguiente<a class="headerlink" href="#iteracion-siguiente" title="Permalink to this headline">¶</a></h3>
<div class="cell tag_hide-input tag_margin docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_edges</span><span class="p">(</span><span class="n">G_simplex</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nodes_and_pos</span><span class="p">,</span> 
                       <span class="n">min_target_margin</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">connectionstyle</span><span class="o">=</span><span class="s2">&quot;arc3, rad = 0.1&quot;</span><span class="p">,</span>
                       <span class="n">edgelist</span><span class="o">=</span><span class="n">list_of_edges_not_trouble_to_visualize_simplex</span><span class="p">)</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_edge_labels</span><span class="p">(</span><span class="n">G_simplex</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nodes_and_pos</span><span class="p">,</span> 
                             <span class="n">font_size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">list_of_edges_trouble_to_visualize_simplex</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;E&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">)]</span>

<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_edges</span><span class="p">(</span><span class="n">G_simplex</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nodes_and_pos</span><span class="p">,</span> 
                       <span class="n">min_target_margin</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">connectionstyle</span><span class="o">=</span><span class="s2">&quot;arc3, rad = 0.1&quot;</span><span class="p">,</span>
                       <span class="n">edgelist</span><span class="o">=</span><span class="n">list_of_edges_trouble_to_visualize_simplex</span><span class="p">)</span>

<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_edge_labels</span><span class="p">(</span><span class="n">G_simplex</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nodes_and_pos</span><span class="p">,</span> 
                             <span class="n">edge_labels</span><span class="o">=</span><span class="n">string_for_edges_trouble_to_visualize_simplex</span><span class="p">,</span>
                             <span class="n">font_size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">node_labels_simplex</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">get_node_attributes</span><span class="p">(</span><span class="n">G_simplex</span><span class="p">,</span> <span class="s2">&quot;node_and_demand&quot;</span><span class="p">)</span>

<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_labels</span><span class="p">(</span><span class="n">G_simplex</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nodes_and_pos_modified</span><span class="p">,</span> 
                        <span class="n">labels</span><span class="o">=</span><span class="n">node_labels_simplex</span><span class="p">)</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_nodes</span><span class="p">(</span><span class="n">G_simplex</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nodes_and_pos</span><span class="p">,</span> 
                       <span class="n">node_size</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Programacion_lineal_y_metodo_simplex_510_0.png" src="../../_images/Programacion_lineal_y_metodo_simplex_510_0.png" />
</div>
</div>
<p>Identificamos los arcos no básicos que son los que no están en el <em>spanning tree factible</em> que se obtuvo al final de la iteración anterior. En el margen se muestra la red, entonces los arcos no básicos son <span class="math notranslate nohighlight">\((B, A), (D, E), (E,D)\)</span>.</p>
</div>
<div class="section" id="id4">
<h3>Revisión de cuál variable no básica sustituye a una variable básica<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h3>
<p><strong>Arco <span class="math notranslate nohighlight">\((B, A)\)</span></strong>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arc_to_be_added_1</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">G_simplex_cycle_1</span><span class="p">,</span> <span class="n">edge_labels_simplex_cycle_1</span> <span class="o">=</span> <span class="n">add_arc_from_spanning_tree</span><span class="p">(</span><span class="n">G_simplex</span><span class="p">,</span> <span class="n">G_simplex_spanning_tree_2</span><span class="p">,</span> 
                                                                            <span class="n">arc_to_be_added_1</span><span class="p">,</span>
                                                                            <span class="n">edge_labels_simplex_spanning_tree_2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_edges</span><span class="p">(</span><span class="n">G_simplex_cycle_1</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nodes_and_pos</span><span class="p">,</span> 
                       <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
                       <span class="n">min_target_margin</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">connectionstyle</span><span class="o">=</span><span class="s2">&quot;arc3, rad = 0.1&quot;</span><span class="p">,</span>
                       <span class="n">edgelist</span><span class="o">=</span><span class="n">G_simplex_spanning_tree_2</span><span class="o">.</span><span class="n">edges</span><span class="p">())</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_edges</span><span class="p">(</span><span class="n">G_simplex_cycle_1</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nodes_and_pos</span><span class="p">,</span> 
                       <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
                       <span class="n">min_target_margin</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">connectionstyle</span><span class="o">=</span><span class="s2">&quot;arc3, rad = 0.1&quot;</span><span class="p">,</span>
                       <span class="n">edgelist</span><span class="o">=</span><span class="p">[</span><span class="n">arc_to_be_added_1</span><span class="p">],</span>
                       <span class="n">width</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
                       <span class="n">style</span><span class="o">=</span><span class="s2">&quot;dashed&quot;</span><span class="p">)</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_edge_labels</span><span class="p">(</span><span class="n">G_simplex_cycle_1</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nodes_and_pos</span><span class="p">,</span> 
                             <span class="n">edge_labels</span><span class="o">=</span><span class="n">edge_labels_simplex_cycle_1</span><span class="p">,</span> <span class="n">label_pos</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
                             <span class="n">font_size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_labels</span><span class="p">(</span><span class="n">G_simplex_cycle_1</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nodes_and_pos_modified</span><span class="p">,</span> 
                        <span class="n">labels</span><span class="o">=</span><span class="n">node_labels_simplex_spanning_tree_2</span><span class="p">)</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_nodes</span><span class="p">(</span><span class="n">G_simplex_cycle_1</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nodes_and_pos</span><span class="p">,</span> 
                       <span class="n">node_size</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Programacion_lineal_y_metodo_simplex_515_0.png" src="../../_images/Programacion_lineal_y_metodo_simplex_515_0.png" />
</div>
</div>
<p>Entonces se forma un ciclo no dirigido. Se calcula el costo unitario de incrementar el flujo por una unidad. Para los arcos “forward” se suma y para los “reverse” se restan los costos:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cycle_1</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">find_cycle</span><span class="p">(</span><span class="n">G_simplex_cycle_1</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
<span class="n">cycle_1_d</span> <span class="o">=</span> <span class="p">{(</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span> <span class="n">t</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">cycle_1</span><span class="p">}</span>
<span class="n">fix_orientation</span><span class="p">(</span><span class="n">cycle_1_d</span><span class="p">,</span> <span class="n">arc_to_be_added_1</span><span class="p">)</span>

<span class="n">edges_and_weights_simplex_cycle_1</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">get_edge_attributes</span><span class="p">(</span><span class="n">G_simplex_cycle_1</span><span class="p">,</span> <span class="s2">&quot;weight&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">compute_cost_for_unit_increment</span><span class="p">(</span><span class="n">cycle_1_d</span><span class="p">,</span> 
                                             <span class="n">edges_and_weights_simplex_cycle_1</span><span class="p">))</span>
     <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-1.0
</pre></div>
</div>
</div>
</div>
<p><strong>Arco <span class="math notranslate nohighlight">\((D, E)\)</span></strong>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arc_to_be_added_2</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">G_simplex_cycle_2</span><span class="p">,</span> <span class="n">edge_labels_simplex_cycle_2</span> <span class="o">=</span> <span class="n">add_arc_from_spanning_tree</span><span class="p">(</span><span class="n">G_simplex</span><span class="p">,</span> <span class="n">G_simplex_spanning_tree_2</span><span class="p">,</span> 
                                                                            <span class="n">arc_to_be_added_2</span><span class="p">,</span>
                                                                            <span class="n">edge_labels_simplex_spanning_tree_2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_edges</span><span class="p">(</span><span class="n">G_simplex_cycle_2</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nodes_and_pos</span><span class="p">,</span> 
                       <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
                       <span class="n">min_target_margin</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">connectionstyle</span><span class="o">=</span><span class="s2">&quot;arc3, rad = 0.1&quot;</span><span class="p">,</span>
                       <span class="n">edgelist</span><span class="o">=</span><span class="n">G_simplex_spanning_tree_2</span><span class="o">.</span><span class="n">edges</span><span class="p">())</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_edges</span><span class="p">(</span><span class="n">G_simplex_cycle_2</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nodes_and_pos</span><span class="p">,</span> 
                       <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
                       <span class="n">min_target_margin</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">connectionstyle</span><span class="o">=</span><span class="s2">&quot;arc3, rad = 0.1&quot;</span><span class="p">,</span>
                       <span class="n">edgelist</span><span class="o">=</span><span class="p">[</span><span class="n">arc_to_be_added_2</span><span class="p">],</span>
                       <span class="n">width</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
                       <span class="n">style</span><span class="o">=</span><span class="s2">&quot;dashed&quot;</span><span class="p">)</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_edge_labels</span><span class="p">(</span><span class="n">G_simplex_cycle_2</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nodes_and_pos</span><span class="p">,</span> 
                             <span class="n">edge_labels</span><span class="o">=</span><span class="n">edge_labels_simplex_cycle_2</span><span class="p">,</span> <span class="n">label_pos</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
                             <span class="n">font_size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_labels</span><span class="p">(</span><span class="n">G_simplex_cycle_2</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nodes_and_pos_modified</span><span class="p">,</span> 
                        <span class="n">labels</span><span class="o">=</span><span class="n">node_labels_simplex_spanning_tree_2</span><span class="p">)</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_nodes</span><span class="p">(</span><span class="n">G_simplex_cycle_2</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nodes_and_pos</span><span class="p">,</span> 
                       <span class="n">node_size</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Programacion_lineal_y_metodo_simplex_520_0.png" src="../../_images/Programacion_lineal_y_metodo_simplex_520_0.png" />
</div>
</div>
<p>Entonces se forma un ciclo no dirigido. Se calcula el costo unitario de incrementar el flujo por una unidad. Para los arcos “forward” se suma y para los “reverse” se restan los costos:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cycle_2</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">find_cycle</span><span class="p">(</span><span class="n">G_simplex_cycle_2</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
<span class="n">cycle_2_d</span> <span class="o">=</span> <span class="p">{(</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span> <span class="n">t</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">cycle_2</span><span class="p">}</span>
<span class="n">fix_orientation</span><span class="p">(</span><span class="n">cycle_2_d</span><span class="p">,</span> <span class="n">arc_to_be_added_2</span><span class="p">)</span>

<span class="n">edges_and_weights_simplex_cycle_2</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">get_edge_attributes</span><span class="p">(</span><span class="n">G_simplex_cycle_2</span><span class="p">,</span> <span class="s2">&quot;weight&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">compute_cost_for_unit_increment</span><span class="p">(</span><span class="n">cycle_2_d</span><span class="p">,</span> 
                                             <span class="n">edges_and_weights_simplex_cycle_2</span><span class="p">))</span>
     <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>7.0
</pre></div>
</div>
</div>
</div>
<p><strong>Arco <span class="math notranslate nohighlight">\((E, D)\)</span></strong>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arc_to_be_added_3</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;E&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">G_simplex_cycle_3</span><span class="p">,</span> <span class="n">edge_labels_simplex_cycle_3</span> <span class="o">=</span> <span class="n">add_arc_from_spanning_tree</span><span class="p">(</span><span class="n">G_simplex</span><span class="p">,</span> <span class="n">G_simplex_spanning_tree_2</span><span class="p">,</span> 
                                                                            <span class="n">arc_to_be_added_3</span><span class="p">,</span>
                                                                            <span class="n">edge_labels_simplex_spanning_tree_2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_edges</span><span class="p">(</span><span class="n">G_simplex_cycle_3</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nodes_and_pos</span><span class="p">,</span> 
                       <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
                       <span class="n">min_target_margin</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">connectionstyle</span><span class="o">=</span><span class="s2">&quot;arc3, rad = 0.1&quot;</span><span class="p">,</span>
                       <span class="n">edgelist</span><span class="o">=</span><span class="n">G_simplex_spanning_tree_2</span><span class="o">.</span><span class="n">edges</span><span class="p">())</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_edges</span><span class="p">(</span><span class="n">G_simplex_cycle_3</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nodes_and_pos</span><span class="p">,</span> 
                       <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
                       <span class="n">min_target_margin</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">connectionstyle</span><span class="o">=</span><span class="s2">&quot;arc3, rad = 0.1&quot;</span><span class="p">,</span>
                       <span class="n">edgelist</span><span class="o">=</span><span class="p">[</span><span class="n">arc_to_be_added_3</span><span class="p">],</span>
                       <span class="n">width</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
                       <span class="n">style</span><span class="o">=</span><span class="s2">&quot;dashed&quot;</span><span class="p">)</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_edge_labels</span><span class="p">(</span><span class="n">G_simplex_cycle_3</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nodes_and_pos</span><span class="p">,</span> 
                             <span class="n">edge_labels</span><span class="o">=</span><span class="n">edge_labels_simplex_cycle_3</span><span class="p">,</span> <span class="n">label_pos</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
                             <span class="n">font_size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_labels</span><span class="p">(</span><span class="n">G_simplex_cycle_3</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nodes_and_pos_modified</span><span class="p">,</span> 
                        <span class="n">labels</span><span class="o">=</span><span class="n">node_labels_simplex_spanning_tree_2</span><span class="p">)</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_nodes</span><span class="p">(</span><span class="n">G_simplex_cycle_3</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nodes_and_pos</span><span class="p">,</span> 
                       <span class="n">node_size</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Programacion_lineal_y_metodo_simplex_525_0.png" src="../../_images/Programacion_lineal_y_metodo_simplex_525_0.png" />
</div>
</div>
<p>Entonces se forma un ciclo no dirigido. Se calcula el costo unitario de incrementar el flujo por una unidad. Para los arcos “forward” se suma y para los “reverse” se restan los costos:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cycle_3</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">find_cycle</span><span class="p">(</span><span class="n">G_simplex_cycle_3</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
<span class="n">cycle_3_d</span> <span class="o">=</span> <span class="p">{(</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span> <span class="n">t</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">cycle_3</span><span class="p">}</span>
<span class="n">fix_orientation</span><span class="p">(</span><span class="n">cycle_3_d</span><span class="p">,</span> <span class="n">arc_to_be_added_3</span><span class="p">)</span>

<span class="n">edges_and_weights_simplex_cycle_3</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">get_edge_attributes</span><span class="p">(</span><span class="n">G_simplex_cycle_3</span><span class="p">,</span> <span class="s2">&quot;weight&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">compute_cost_for_unit_increment</span><span class="p">(</span><span class="n">cycle_3_d</span><span class="p">,</span> 
                                             <span class="n">edges_and_weights_simplex_cycle_3</span><span class="p">))</span>
     <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-2.0
</pre></div>
</div>
</div>
</div>
<p>En resúmen:</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-align:center head"><p>Arco</p></th>
<th class="text-align:center head"><p>Costo por incrementar una unidad del arco</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:center"><p>(B,A)</p></td>
<td class="text-align:center"><p>-1</p></td>
</tr>
<tr class="row-odd"><td class="text-align:center"><p>(D,E)</p></td>
<td class="text-align:center"><p>7</p></td>
</tr>
<tr class="row-even"><td class="text-align:center"><p>(E,D)</p></td>
<td class="text-align:center"><p>-2</p></td>
</tr>
</tbody>
</table>
<p>Entonces el arco no básico que tiene la tasa más alta de mejoramiento de <span class="math notranslate nohighlight">\(f_o\)</span> es <span class="math notranslate nohighlight">\((E,D)\)</span>.</p>
</div>
<div class="section" id="id5">
<h3>Revisión de cuál arco básico es sustituido<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h3>
<p>Se denota como la cantidad <span class="math notranslate nohighlight">\(flow^+\)</span> y para los arcos que son “forward” se suma tal cantidad al flujo actual y para los que son “reverse” se resta:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">edge_labels_simplex_cycle_3_modified</span> <span class="o">=</span> <span class="n">edge_label_change_for_basic_arc_subs</span><span class="p">(</span><span class="n">cycle_3_d</span><span class="p">,</span> 
                                                                            <span class="n">edge_labels_simplex_cycle_3</span><span class="p">,</span> 
                                                                            <span class="n">arc_to_be_added_3</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pprint</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">edge_labels_simplex_cycle_3_modified</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{(&#39;A&#39;, &#39;C&#39;): {&#39;bool&#39;: &#39;+&#39;,
              &#39;capacity&#39;: &#39;inf&#39;,
              &#39;flow&#39;: &#39;10+ $flow^+$&#39;,
              &#39;weight&#39;: 4},
 (&#39;A&#39;, &#39;D&#39;): {&#39;bool&#39;: &#39;-&#39;,
              &#39;capacity&#39;: &#39;inf&#39;,
              &#39;flow&#39;: &#39;30- $flow^+$&#39;,
              &#39;weight&#39;: 9},
 (&#39;B&#39;, &#39;C&#39;): {&#39;bool&#39;: 0, &#39;capacity&#39;: &#39;inf&#39;, &#39;flow&#39;: 50, &#39;weight&#39;: 3},
 (&#39;C&#39;, &#39;E&#39;): {&#39;bool&#39;: &#39;+&#39;, &#39;capacity&#39;: 80, &#39;flow&#39;: &#39;60+ $flow^+$&#39;, &#39;weight&#39;: 1},
 (&#39;E&#39;, &#39;D&#39;): {&#39;capacity&#39;: &#39;inf&#39;, &#39;flow&#39;: &#39;$flow^+$&#39;, &#39;weight&#39;: 2}}
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">11</span><span class="p">))</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_edges</span><span class="p">(</span><span class="n">G_simplex_cycle_3</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nodes_and_pos</span><span class="p">,</span> 
                       <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
                       <span class="n">min_target_margin</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">connectionstyle</span><span class="o">=</span><span class="s2">&quot;arc3, rad = 0.1&quot;</span><span class="p">,</span>
                       <span class="n">edgelist</span><span class="o">=</span><span class="n">G_simplex_spanning_tree_2</span><span class="o">.</span><span class="n">edges</span><span class="p">())</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_edges</span><span class="p">(</span><span class="n">G_simplex_cycle_3</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nodes_and_pos</span><span class="p">,</span> 
                       <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
                       <span class="n">min_target_margin</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">connectionstyle</span><span class="o">=</span><span class="s2">&quot;arc3, rad = 0.1&quot;</span><span class="p">,</span>
                       <span class="n">edgelist</span><span class="o">=</span><span class="p">[</span><span class="n">arc_to_be_added_3</span><span class="p">],</span>
                       <span class="n">width</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
                       <span class="n">style</span><span class="o">=</span><span class="s2">&quot;dashed&quot;</span><span class="p">)</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_edge_labels</span><span class="p">(</span><span class="n">G_simplex_cycle_3</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nodes_and_pos</span><span class="p">,</span> 
                             <span class="n">edge_labels</span><span class="o">=</span><span class="n">edge_labels_simplex_cycle_3_modified</span><span class="p">,</span> <span class="n">label_pos</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
                             <span class="n">font_size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_labels</span><span class="p">(</span><span class="n">G_simplex_cycle_3</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nodes_and_pos_modified</span><span class="p">,</span> 
                        <span class="n">labels</span><span class="o">=</span><span class="n">node_labels_simplex_spanning_tree_2</span><span class="p">)</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_nodes</span><span class="p">(</span><span class="n">G_simplex_cycle_3</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nodes_and_pos</span><span class="p">,</span> 
                       <span class="n">node_size</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Programacion_lineal_y_metodo_simplex_534_0.png" src="../../_images/Programacion_lineal_y_metodo_simplex_534_0.png" />
</div>
</div>
<p>Como se debe cumplir la no negatividad y la cota superior, para los arcos en los que se aumenta y tienen cota superior se tiene:</p>
<div class="math notranslate nohighlight">
\[
x_{CE} = 60 + \text{flow}^+ \leq 80
\]</div>
<p>y para los arcos en los que se disminuye:</p>
<div class="math notranslate nohighlight">
\[
x_{AD} = 30 - \text{flow}^+ \geq 0
\]</div>
<p>Por lo que:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
\text{flow}^+ &amp;\leq&amp; 20 \quad \text{que se obtuvo del arco } x_{CE} \nonumber \\
\text{flow}^+ &amp;\leq&amp; 30 \quad \text{que se obtuvo del arco } x_{AD} \nonumber \\
\end{eqnarray}
\end{split}\]</div>
<p>El mínimo es 20, entonces <span class="math notranslate nohighlight">\(\text{flow}^+=20\)</span> y el arco básico que será sustituido es <span class="math notranslate nohighlight">\((C,E)\)</span>.</p>
</div>
<div class="section" id="tecnica-de-la-cota-superior">
<h3>Técnica de la cota superior<a class="headerlink" href="#tecnica-de-la-cota-superior" title="Permalink to this headline">¶</a></h3>
<p>Al modificar el flujo con <span class="math notranslate nohighlight">\(\text{flow}^+=20\)</span> se tiene que el arco <span class="math notranslate nohighlight">\((C,E)\)</span> tiene un flujo igual a <span class="math notranslate nohighlight">\(80\)</span> con lo que llegó a su capacidad máxima. Entonces se intercambia el arco <span class="math notranslate nohighlight">\((C, E)\)</span> por el arco <span class="math notranslate nohighlight">\((E, C)\)</span> con costo unitario igual al negativo de <span class="math notranslate nohighlight">\((C, E)\)</span>, misma capacidad y con flujo igual igual <span class="math notranslate nohighlight">\(0\)</span>. Surge una nueva variable no básica <span class="math notranslate nohighlight">\(y_{CE} = 0\)</span> y <span class="math notranslate nohighlight">\(x_{CE} = 80 - y_{CE}\)</span>. <span class="math notranslate nohighlight">\(b_E\)</span> se le aumenta <span class="math notranslate nohighlight">\(80\)</span> y <span class="math notranslate nohighlight">\(b_C\)</span> se le resta <span class="math notranslate nohighlight">\(80\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">new_demand_E</span> <span class="o">=</span> <span class="n">G_simplex</span><span class="p">[</span><span class="s1">&#39;C&#39;</span><span class="p">][</span><span class="s1">&#39;E&#39;</span><span class="p">][</span><span class="s2">&quot;capacity&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">nx</span><span class="o">.</span><span class="n">get_node_attributes</span><span class="p">(</span><span class="n">G_simplex</span><span class="p">,</span> <span class="s2">&quot;demand&quot;</span><span class="p">)[</span><span class="s1">&#39;E&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">new_demand_E</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>20
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">new_demand_C</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">get_node_attributes</span><span class="p">(</span><span class="n">G_simplex</span><span class="p">,</span> <span class="s2">&quot;demand&quot;</span><span class="p">)[</span><span class="s1">&#39;C&#39;</span><span class="p">]</span><span class="o">-</span> <span class="n">G_simplex</span><span class="p">[</span><span class="s1">&#39;C&#39;</span><span class="p">][</span><span class="s1">&#39;E&#39;</span><span class="p">][</span><span class="s2">&quot;capacity&quot;</span><span class="p">]</span> 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">new_demand_C</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-80
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">G_simplex2</span> <span class="o">=</span> <span class="n">G_simplex</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">G_simplex2</span><span class="o">.</span><span class="n">remove_edge</span><span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span><span class="s1">&#39;E&#39;</span><span class="p">)</span>
<span class="n">G_simplex2</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="s1">&#39;E&#39;</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">)</span>
<span class="n">G_simplex2</span><span class="p">[</span><span class="s1">&#39;E&#39;</span><span class="p">][</span><span class="s1">&#39;C&#39;</span><span class="p">][</span><span class="s2">&quot;weight&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">G_simplex</span><span class="p">[</span><span class="s1">&#39;C&#39;</span><span class="p">][</span><span class="s1">&#39;E&#39;</span><span class="p">][</span><span class="s2">&quot;weight&quot;</span><span class="p">]</span>
<span class="n">G_simplex2</span><span class="p">[</span><span class="s1">&#39;E&#39;</span><span class="p">][</span><span class="s1">&#39;C&#39;</span><span class="p">][</span><span class="s2">&quot;capacity&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">G_simplex</span><span class="p">[</span><span class="s1">&#39;C&#39;</span><span class="p">][</span><span class="s1">&#39;E&#39;</span><span class="p">][</span><span class="s2">&quot;capacity&quot;</span><span class="p">]</span>

<span class="n">node_and_demand_E</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39;E&#39;</span><span class="p">,</span> <span class="s1">&#39;[&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">new_demand_E</span><span class="p">),</span><span class="s1">&#39;]&#39;</span><span class="p">])</span>
<span class="n">node_and_demand_C</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;[&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">new_demand_C</span><span class="p">),</span><span class="s1">&#39;]&#39;</span><span class="p">])</span>

<span class="n">nx</span><span class="o">.</span><span class="n">set_node_attributes</span><span class="p">(</span><span class="n">G_simplex2</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;E&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;demand&quot;</span><span class="p">:</span> <span class="n">new_demand_E</span><span class="p">,</span>
                                         <span class="s2">&quot;node_and_demand&quot;</span><span class="p">:</span> <span class="n">node_and_demand_E</span><span class="p">},</span>
                                   <span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;demand&quot;</span><span class="p">:</span> <span class="n">new_demand_C</span><span class="p">,</span>
                                         <span class="s2">&quot;node_and_demand&quot;</span><span class="p">:</span> <span class="n">node_and_demand_C</span><span class="p">}</span>
                                   <span class="p">})</span>

<span class="n">list_of_edges_not_trouble_to_visualize_simplex2</span> <span class="o">=</span> <span class="n">G_simplex2</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_edges</span><span class="p">(</span><span class="n">G_simplex2</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nodes_and_pos</span><span class="p">,</span> 
                       <span class="n">min_target_margin</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">connectionstyle</span><span class="o">=</span><span class="s2">&quot;arc3, rad = 0.1&quot;</span><span class="p">,</span>
                       <span class="n">edgelist</span><span class="o">=</span><span class="n">list_of_edges_not_trouble_to_visualize_simplex2</span><span class="p">)</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_edge_labels</span><span class="p">(</span><span class="n">G_simplex2</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nodes_and_pos</span><span class="p">,</span> 
                             <span class="n">font_size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>


<span class="n">list_of_edges_trouble_to_visualize_simplex2</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;E&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">)]</span>

<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_edges</span><span class="p">(</span><span class="n">G_simplex2</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nodes_and_pos</span><span class="p">,</span> 
                       <span class="n">min_target_margin</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">connectionstyle</span><span class="o">=</span><span class="s2">&quot;arc3, rad = 0.1&quot;</span><span class="p">,</span>
                       <span class="n">edgelist</span><span class="o">=</span><span class="n">list_of_edges_trouble_to_visualize_simplex2</span><span class="p">)</span>

<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_edge_labels</span><span class="p">(</span><span class="n">G_simplex2</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nodes_and_pos</span><span class="p">,</span> 
                             <span class="n">edge_labels</span><span class="o">=</span><span class="n">string_for_edges_trouble_to_visualize_simplex</span><span class="p">,</span>
                             <span class="n">font_size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">node_labels_simplex2</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">get_node_attributes</span><span class="p">(</span><span class="n">G_simplex2</span><span class="p">,</span> <span class="s2">&quot;node_and_demand&quot;</span><span class="p">)</span>

<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_labels</span><span class="p">(</span><span class="n">G_simplex2</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nodes_and_pos_modified</span><span class="p">,</span> 
                        <span class="n">labels</span><span class="o">=</span><span class="n">node_labels_simplex2</span><span class="p">)</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_nodes</span><span class="p">(</span><span class="n">G_simplex2</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nodes_and_pos</span><span class="p">,</span> 
                       <span class="n">node_size</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Programacion_lineal_y_metodo_simplex_547_0.png" src="../../_images/Programacion_lineal_y_metodo_simplex_547_0.png" />
</div>
</div>
<p>El nuevo <em>spanning tree</em> factible es:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">flow_plus</span> <span class="o">=</span> <span class="mi">20</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arc_to_remove</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">)</span>
<span class="n">arc_to_add</span> <span class="o">=</span> <span class="n">arc_to_be_added_3</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">arc_to_add</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(&#39;E&#39;, &#39;D&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">G_simplex_spanning_tree_3</span> <span class="o">=</span> <span class="n">G_simplex_spanning_tree_2</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">G_simplex_spanning_tree_3</span><span class="o">.</span><span class="n">remove_edge</span><span class="p">(</span><span class="n">arc_to_remove</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">arc_to_remove</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">G_simplex_spanning_tree_3</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">arc_to_add</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">arc_to_add</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="c1">#update demands after upper bound technique</span>
<span class="n">nx</span><span class="o">.</span><span class="n">set_node_attributes</span><span class="p">(</span><span class="n">G_simplex_spanning_tree_3</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;demand&quot;</span><span class="p">:</span> <span class="n">new_demand_C</span><span class="p">,</span>
                                                         <span class="s2">&quot;node_and_demand&quot;</span><span class="p">:</span> <span class="n">node_and_demand_C</span><span class="p">}})</span>
<span class="n">nx</span><span class="o">.</span><span class="n">set_node_attributes</span><span class="p">(</span><span class="n">G_simplex_spanning_tree_3</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;E&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;demand&quot;</span><span class="p">:</span> <span class="n">new_demand_E</span><span class="p">,</span>
                                                         <span class="s2">&quot;node_and_demand&quot;</span><span class="p">:</span> <span class="n">node_and_demand_E</span><span class="p">}})</span>

<span class="n">list_edges_spanning_tree_3</span> <span class="o">=</span> <span class="n">G_simplex_spanning_tree_3</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>

<span class="n">edge_labels_simplex_spanning_tree_3</span> <span class="o">=</span> <span class="p">{}</span>

<span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">list_edges_spanning_tree_3</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">e</span> <span class="o">!=</span> <span class="n">arc_to_add</span><span class="p">:</span>
        <span class="n">edge_labels_simplex_spanning_tree_3</span><span class="p">[</span><span class="n">e</span><span class="p">]</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">G_simplex_spanning_tree_2</span><span class="p">[</span><span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
        <span class="k">if</span> <span class="n">edge_labels_simplex_cycle_3_modified</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s2">&quot;bool&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;+&quot;</span><span class="p">:</span>
            <span class="n">edge_labels_simplex_spanning_tree_3</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s2">&quot;flow&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">edge_labels_simplex_spanning_tree_3</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s2">&quot;flow&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">flow_plus</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">edge_labels_simplex_cycle_3_modified</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s2">&quot;bool&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;-&quot;</span><span class="p">:</span>
                <span class="n">edge_labels_simplex_spanning_tree_3</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s2">&quot;flow&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">edge_labels_simplex_spanning_tree_3</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s2">&quot;flow&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">flow_plus</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">edge_labels_simplex_spanning_tree_3</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s2">&quot;flow&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">edge_labels_simplex_spanning_tree_3</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s2">&quot;flow&quot;</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">e</span> <span class="o">==</span> <span class="n">arc_to_add</span><span class="p">:</span>
        <span class="n">edge_labels_simplex_spanning_tree_3</span><span class="p">[</span><span class="n">e</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">edge_labels_simplex_spanning_tree_3</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s2">&quot;weight&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">G_simplex</span><span class="p">[</span><span class="n">arc_to_add</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">arc_to_add</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s2">&quot;weight&quot;</span><span class="p">]</span>
        <span class="n">edge_labels_simplex_spanning_tree_3</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s2">&quot;capacity&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">G_simplex</span><span class="p">[</span><span class="n">arc_to_add</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">arc_to_add</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s2">&quot;capacity&quot;</span><span class="p">]</span>
        <span class="n">edge_labels_simplex_spanning_tree_3</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s2">&quot;flow&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">flow_plus</span> 
        

<span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">G_simplex_spanning_tree_3</span><span class="o">.</span><span class="n">edges</span><span class="p">():</span>
    <span class="n">G_simplex_spanning_tree_3</span><span class="p">[</span><span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s2">&quot;flow&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">edge_labels_simplex_spanning_tree_3</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s2">&quot;flow&quot;</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">e</span><span class="o">==</span><span class="n">arc_to_add</span><span class="p">:</span>
        <span class="n">G_simplex_spanning_tree_3</span><span class="p">[</span><span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s2">&quot;weight&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">edge_labels_simplex_spanning_tree_3</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s2">&quot;weight&quot;</span><span class="p">]</span>
        <span class="n">G_simplex_spanning_tree_3</span><span class="p">[</span><span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s2">&quot;capacity&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">edge_labels_simplex_spanning_tree_3</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s2">&quot;capacity&quot;</span><span class="p">]</span>
        
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">9</span><span class="p">))</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_edges</span><span class="p">(</span><span class="n">G_simplex_spanning_tree_3</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nodes_and_pos</span><span class="p">,</span> 
                       <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
                       <span class="n">min_target_margin</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">connectionstyle</span><span class="o">=</span><span class="s2">&quot;arc3, rad = 0.1&quot;</span><span class="p">)</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_edge_labels</span><span class="p">(</span><span class="n">G_simplex_spanning_tree_3</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nodes_and_pos</span><span class="p">,</span> 
                             <span class="n">edge_labels</span><span class="o">=</span><span class="n">edge_labels_simplex_spanning_tree_3</span><span class="p">,</span> <span class="n">label_pos</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
                             <span class="n">font_size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">node_labels_simplex_spanning_tree_3</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">get_node_attributes</span><span class="p">(</span><span class="n">G_simplex_spanning_tree_3</span><span class="p">,</span> 
                                                            <span class="s2">&quot;node_and_demand&quot;</span><span class="p">)</span>

<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_labels</span><span class="p">(</span><span class="n">G_simplex_spanning_tree_3</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nodes_and_pos_modified</span><span class="p">,</span> 
                        <span class="n">labels</span><span class="o">=</span><span class="n">node_labels_simplex_spanning_tree_3</span><span class="p">)</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_nodes</span><span class="p">(</span><span class="n">G_simplex_spanning_tree_3</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nodes_and_pos</span><span class="p">,</span> 
                       <span class="n">node_size</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>    
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Programacion_lineal_y_metodo_simplex_552_0.png" src="../../_images/Programacion_lineal_y_metodo_simplex_552_0.png" />
</div>
</div>
<div class="tip admonition">
<p class="admonition-title">Ejercicios</p>
<p>1.Resuelve los ejercicios y preguntas de la nota.</p>
</div>
<p><strong>Referencias:</strong></p>
<ol class="simple">
<li><p>F. Hillier, G. Lieberman, Introduction to Operations Research, Mc Graw Hill, 2014.</p></li>
<li><p>R. K. Ahuja, T. L. Magnanti, J. B. Orlin, Network Flows, Theory, Algorithms and Applications, Prentice Hall, 1993.</p></li>
<li><p>M. S. Bazaraa, J. J. Jarvis, H. D. Sherali, Linear Programming and Network Flows, Wiley, 2010.</p></li>
<li><p>J. Nocedal, S. J. Wright, Numerical Optimization, Springer, 2006.</p></li>
</ol>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "palmoreck/dockerfiles-for-binder",
            ref: "jupyterlab_optimizacion_2",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./IV.optimizacion_en_redes_y_prog_lineal/4.2"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="../4.1/Definiciones_generales_de_flujo_en_redes.html" title="previous page">4.1 Definiciones generales de flujo en redes</a>
    <a class='right-next' id="next-link" href="../4.3/Metodo_simplex.html" title="next page">4.3 Método símplex</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Erick Palacios Moreno<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../../_static/js/index.3da636dd464baa7582d2.js"></script>


    
  </body>
</html>