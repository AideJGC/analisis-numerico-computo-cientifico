
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>4.5 Método primal-dual de barrera logarítmica (BL)</title>
    
  <link rel="stylesheet" href="../../_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe,.cell"
        const thebe_selector_input = "pre,.cell_input div.highlight"
        const thebe_selector_output = ".output,.cell_output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="5.1 Introducción a optimización de código" href="../../V.optimizacion_de_codigo/5.1/introduccion_optimizacion_de_codigo.html" />
    <link rel="prev" title="4.4 Dualidad, lema de Farkas y condiciones de Karush-Kuhn-Tucker (KKT) de optimalidad" href="../4.4/Dualidad_lema_de_Farkas_condiciones_KKT_de_optimalidad.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../../index.html">
  
  <img src="../../_static/logo.png" class="logo" alt="logo">
  
  
</a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../README.html">
   Optimización
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  I. Cómputo científico
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../I.computo_cientifico/1.1/Analisis_numerico_y_computo_cientifico.html">
   1.1 Análisis numérico y cómputo científico
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../I.computo_cientifico/1.2/Sistema_de_punto_flotante.html">
   1.2 Sistema de punto flotante
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../I.computo_cientifico/1.3/Normas_vectoriales_y_matriciales.html">
   1.3 Normas vectoriales y matriciales
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../I.computo_cientifico/1.4/Condicion_de_un_problema_y_estabilidad_de_un_algoritmo.html">
   1.4 Condición de un problema y estabilidad de un algoritmo
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../I.computo_cientifico/1.5/Definicion_de_funcion_continuidad_derivada.html">
   1.5 Definición de función, continuidad y derivada
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../I.computo_cientifico/1.6/Polinomios_de_Taylor_y_diferenciacion_numerica.html">
   1.6 Polinomios de Taylor y diferenciación numérica
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../I.computo_cientifico/1.7/Integracion_numerica.html">
   1.7 Integración Numérica
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  II. Cómputo matricial
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../II.computo_matricial/2.1/Operaciones_y_transformaciones_basicas_del_Algebra_Lineal_Numerica.html">
   2.1 Operaciones y transformaciones básicas del Álgebra Lineal Numérica
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../II.computo_matricial/2.2/Eigenvalores_y_eigenvectores.html">
   2.2 Eigenvalores y eigenvectores
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../II.computo_matricial/2.3/Algoritmos_y_aplicaciones_de_eigenvalores_eigenvectores_de_una_matriz.html">
   2.3 Algoritmos y aplicaciones de eigenvalores y eigenvectores de una matriz
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../II.computo_matricial/2.4/Valores_vectores_singulares_y_algoritmos_para_calcular_la_SVD.html">
   2.4 Valores, vectores singulares y algoritmos para calcular la SVD
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  III. Optimización convexa y ecuaciones no lineales
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../III.optimizacion_convexa/3.1/Definicion_de_problema_optimizacion_conjuntos_y_funciones_convexas.html">
   3.1 Definición de problemas de optimización, conjuntos y funciones convexas
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../III.optimizacion_convexa/3.2/Algoritmos_de_descenso_y_busqueda_de_linea_en_uco.html">
   3.2 Algoritmos de descenso y búsqueda de línea en
   <em>
    Unconstrained Convex Optimization
   </em>
   (UCO)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../III.optimizacion_convexa/3.3/Ejemplos_problemas_UCO_e_intro_CIEO_y_PI.html">
   3.3 Ejemplos de problemas UCO, introducción a
   <em>
    Constrained Inequality and Equality Optimization
   </em>
   (CIEO) y puntos interiores
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../III.optimizacion_convexa/3.4/Ecuaciones_no_lineales.html">
   3.4 Ecuaciones no lineales
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  IV. Optimización en redes y programación lineal
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../4.1/Definiciones_generales_de_flujo_en_redes.html">
   4.1 Definiciones generales de flujo en redes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../4.2/Programacion_lineal_y_metodo_simplex.html">
   4.2 Programación lineal (PL) y método símplex
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../4.3/Ejemplo_metodo_simplex_de_redes.html">
   4.3 Ejemplo del método símplex de redes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../4.4/Dualidad_lema_de_Farkas_condiciones_KKT_de_optimalidad.html">
   4.4 Dualidad, lema de Farkas y condiciones de Karush-Kuhn-Tucker (KKT) de optimalidad
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   4.5 Método primal-dual de barrera logarítmica (BL)
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  V. Optimización de código
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../V.optimizacion_de_codigo/5.1/introduccion_optimizacion_de_codigo.html">
   5.1 Introducción a optimización de código
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../V.optimizacion_de_codigo/5.2/Herramientas_de_lenguajes_y_del_SO_para_perfilamiento_e_implementaciones_de_BLAS.html">
   5.2 Herramientas de lenguajes de programación y del sistema operativo para perfilamiento e implementaciones de BLAS
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  VI. Algoritmos de optimización convexa
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../VI.algoritmos_optimizacion_convexa/6.1/Problemas_UCO.html">
   6.1 Problemas tipo
   <em>
    Unconstrained Convex Optimization
   </em>
   (UCO)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../VI.algoritmos_optimizacion_convexa/6.2/Problemas_CECO.html">
   6.2 Problemas tipo
   <em>
    Constrained Equality Convex Optimization
   </em>
   (CECO)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../VI.algoritmos_optimizacion_convexa/6.3/Problemas_CIECO.html">
   6.3 Problemas tipo
   <em>
    Constrained Equality and Inequality Convex Optimization
   </em>
   (CIECO)
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/IV.optimizacion_en_redes_y_prog_lineal/4.5/Metodo_primal_dual_de_BL.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/palmoreck/dockerfiles-for-binder/jupyterlab_optimizacion_2?urlpath=lab/tree/analisis-numerico-computo-cientifico/libro_optimizacion/temas/IV.optimizacion_en_redes_y_prog_lineal/4.5/Metodo_primal_dual_de_BL.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <button type="button" class="btn btn-secondary topbarbtn"
            onclick="initThebeSBT()" title="Launch Thebe" data-toggle="tooltip" data-placement="left"><i
                class="fas fa-play"></i><span style="margin-left: .4em;">Live Code</span></button>
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#metodos-por-puntos-interiores-pi">
   Métodos por puntos interiores (PI)
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#metodo-primal-dual">
   Método primal-dual
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#primera-idea-determinar-la-direccion-de-busqueda">
     Primera idea: determinar la dirección de búsqueda
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#segunda-idea-cortar-el-paso">
     Segunda idea: cortar el paso
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id1">
   Método primal-dual de barrera logarítmica (BL)
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#tercera-idea-reducir-la-duality-gap-y-centrar-uso-de-la-funcion-de-barrera-logaritmica-fbl">
     Tercera idea: reducir la
     <em>
      duality gap
     </em>
     y centrar. Uso de la función de barrera logarítmica (FBL)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#trayectoria-central-determinada-por-los-puntos-centrales">
     Trayectoria central determinada por los puntos centrales
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#relacion-entre-las-condiciones-kkt-de-optimalidad-del-ple-y-las-del-pbl-ple">
     Relación entre las condiciones KKT de optimalidad del PLE y las del PBL-PLE
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#como-calcular-los-puntos-centrales">
     ¿Cómo calcular los puntos centrales?
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#metodo-primal-dual-de-bl-aplicado-al-ejemplo-prototipo">
   Método primal-dual de BL aplicado al ejemplo prototipo
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#primera-iteracion">
     Primera iteración
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#segunda-iteracion">
     Segunda iteración
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#tercera-iteracion">
     Tercera iteración
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#definicion-decremento-de-newton">
   Definición decremento de Newton
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#algoritmo-primal-dual-de-bl-para-un-pl-con-unicamente-desigualdades">
   Algoritmo primal-dual de BL para un PL con únicamente desigualdades
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#metodo-primal-dual-de-bl-aplicado-al-ejemplo-prototipo-completo">
   Método primal-dual de BL aplicado al ejemplo prototipo (completo)
  </a>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="metodo-primal-dual-de-barrera-logaritmica-bl">
<span id="mprimaldualbarreralog"></span><h1>4.5 Método primal-dual de barrera logarítmica (BL)<a class="headerlink" href="#metodo-primal-dual-de-barrera-logaritmica-bl" title="Permalink to this headline">¶</a></h1>
<div class="admonition-notas-para-contenedor-de-docker admonition">
<p class="admonition-title">Notas para contenedor de docker:</p>
<p>Comando de docker para ejecución de la nota de forma local:</p>
<p>nota: cambiar <code class="docutils literal notranslate"><span class="pre">&lt;ruta</span> <span class="pre">a</span> <span class="pre">mi</span> <span class="pre">directorio&gt;</span></code> por la ruta de directorio que se desea mapear a <code class="docutils literal notranslate"><span class="pre">/datos</span></code> dentro del contenedor de docker.</p>
<p><code class="docutils literal notranslate"><span class="pre">docker</span> <span class="pre">run</span> <span class="pre">--rm</span> <span class="pre">-v</span> <span class="pre">&lt;ruta</span> <span class="pre">a</span> <span class="pre">mi</span> <span class="pre">directorio&gt;:/datos</span> <span class="pre">--name</span> <span class="pre">jupyterlab_optimizacion_2</span> <span class="pre">-p</span> <span class="pre">8888:8888</span> <span class="pre">-p</span> <span class="pre">8787:8787</span> <span class="pre">-d</span> <span class="pre">palmoreck/jupyterlab_optimizacion_2:3.0.0</span></code></p>
<p>password para jupyterlab: <code class="docutils literal notranslate"><span class="pre">qwerty</span></code></p>
<p>Detener el contenedor de docker:</p>
<p><code class="docutils literal notranslate"><span class="pre">docker</span> <span class="pre">stop</span> <span class="pre">jupyterlab_optimizacion_2</span></code></p>
<p>Documentación de la imagen de docker <code class="docutils literal notranslate"><span class="pre">palmoreck/jupyterlab_optimizacion_2:3.0.0</span></code> en <a class="reference external" href="https://github.com/palmoreck/dockerfiles/tree/master/jupyterlab/optimizacion_2">liga</a>.</p>
</div>
<hr class="docutils" />
<p>Nota generada a partir de <a class="reference external" href="https://drive.google.com/file/d/16-_PvWNaO0Zc9x04-SRsxCRdn5fxebf2/view">liga1</a>, <a class="reference external" href="https://drive.google.com/file/d/1oulU1QAKyLyYrkpJBLSPlbWnKFCWpllX/view">liga2</a>, <a class="reference external" href="https://drive.google.com/file/d/1RMwUXEN_SOHKue-J9Cx3Ldvj9bejLjiM/view">liga3</a></p>
<div class="tip admonition">
<p class="admonition-title">Al final de esta nota el y la lectora:</p>
<ul class="simple">
<li><p>Conocerá el método primal dual de barrera logarítmica para resolver programas lineales.</p></li>
<li><p>Aprenderá que tal método:</p>
<ul>
<li><p>es un caso particular de métodos de penalización para resolver problemas de optimización con restricciones.</p></li>
<li><p>tiene la capacidad de resolver problemas convexos.</p></li>
<li><p>trabaja con bloques de matrices lo que ayuda a aprovechar operaciones vectoriales o matriciales.</p></li>
<li><p>puede implementarse con cómputo en paralelo.</p></li>
</ul>
</li>
</ul>
</div>
<p>El método primal-dual de barrera logarítmica (BL) es un método iterativo que realiza un manejo de las variables primales y duales del problema de optimización a resolver. Se le clasifica como un método por puntos interiores.</p>
<div class="sidebar">
<p class="sidebar-title">Un poco de historia …</p>
<p>El <a class="reference external" href="https://en.wikipedia.org/wiki/Simplex_algorithm">método símplex</a> desarrollado por Dantzig en los <span class="math notranslate nohighlight">\(40\)</span>’s hizo posible que se formularan y analizaran modelos grandes en una forma sistemática y eficiente. Hoy en día continúa siendo uno de los métodos más utilizados para resolver programas lineales. No obstante puede ser ineficiente en problemas lineales “patológicos” (ver <a class="reference external" href="https://en.wikipedia.org/wiki/Klee%E2%80%93Minty_cube">Klee-Minty cube</a>) pues el tiempo para resolver tales problemas es exponencial respecto al tamaño del problema (medido como el número de variables y la cantidad de almacenamiento para los datos del problema). Para la mayoría de problemas prácticos el método símplex es mucho más eficiente que estos casos “patológicos” pero esto motivó la investigación y desarrollo de nuevos algoritmos con mejor desempeño. En 1984 Karmarkar publicó el <a class="reference external" href="https://en.wikipedia.org/wiki/Karmarkar%27s_algorithm">algoritmo</a> que lleva su mismo nombre que tiene una complejidad polinomial y en la práctica resultó ser eficiente. Pertenece a la clase de métodos con el nombre de <a class="reference external" href="https://en.wikipedia.org/wiki/Interior-point_method">puntos interiores</a>. Hay diferentes tipos de métodos por puntos interiores siendo los de la clase primal-dual ampliamente usados en la práctica.</p>
</div>
<div class="section" id="metodos-por-puntos-interiores-pi">
<h2>Métodos por puntos interiores (PI)<a class="headerlink" href="#metodos-por-puntos-interiores-pi" title="Permalink to this headline">¶</a></h2>
<p>Los métodos por puntos interiores (PI) son esquemas iterativos que en un inicio se utilizaron para resolver PL’s, sin embargo, se ha extendido su uso al caso no lineal. Por ejemplo, distintos tipos de métodos por PI han sido usados para resolver problemas de optimización convexos, ver <a class="reference internal" href="../../III.optimizacion_convexa/3.1/Definicion_de_problema_optimizacion_conjuntos_y_funciones_convexas.html#proboptconvest"><span class="std std-ref">problemas de optimización convexa en su forma estándar o canónica</span></a>.</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Recuérdese que nombramos problemas de optimización con restricciones <em>large scale</em> a aquellos problemas de optimización que tienen un número de variables y restricciones mayor o igual a <span class="math notranslate nohighlight">\(10^5\)</span> (ambas).</p>
</div>
<p>En cada iteración de los métodos PI las restricciones de desigualdad del problema de optimización se satisfacen de forma estricta. Cada iteración es costosa de calcular y realiza avance significativo a la solución en contraste con el método símplex que requiere un gran número de iteraciones no costosas. Una característica que tienen los métodos PI es que los problemas <em>large scale</em> no requieren muchas más iteraciones que los problemas <em>small scale</em> a diferencia del método símplex. Sin embargo para problemas <em>small scale</em> en general realizan más iteraciones que el método símplex.</p>
<p>En cada iteración el método símplex se mueve de la solución FEV actual a una solución FEV adyacente por una arista de la frontera de la región factible, ver <a class="reference internal" href="../4.2/Programacion_lineal_y_metodo_simplex.html#metodosimplex"><span class="std std-ref">método símplex</span></a>. Los problemas del tipo <em>large scale</em> tienen una cantidad enorme de soluciones FEV. Para ver esto piénsese en un PL al que se le van añadiendo restricciones funcionales. Entonces se añadirán aristas y por tanto soluciones FEV.  Los métodos PI evitan tal comportamiento pues avanzan por el interior de la región factible hacia los puntos óptimos y tiene muy poco efecto el ir añadiedo restricciones funcionales al PL para el desempeño de los métodos PI.</p>
<div class="tip admonition">
<p class="admonition-title">Observación</p>
<p>Los métodos PI han mostrado “buena” eficiencia (en términos del número de iteraciones realizadas) en resolver problemas de optimización <em>large scale</em>. Además son métodos que pueden implementarse para procesamiento con cómputo en paralelo.</p>
</div>
<p>Los métodos PI conforme avanzan en las interaciones aproximan a los puntos óptimos en el límite. Por ejemplo, para el <a class="reference internal" href="../4.2/Programacion_lineal_y_metodo_simplex.html#ejprototipo"><span class="std std-ref">ejemplo prototipo</span></a> de un programa lineal (PL) a continuación se presenta una trayectoria obtenida por un método PI que se aproxima a la solución óptima <span class="math notranslate nohighlight">\((2, 6)\)</span>:</p>
<div class="math notranslate nohighlight">
\[\displaystyle \max_{x \in \mathbb{R}^2} 3x_1 + 5x_2\]</div>
<div class="math notranslate nohighlight">
\[\text{sujeto a: }\]</div>
<div class="math notranslate nohighlight">
\[x_1 \leq 4\]</div>
<div class="math notranslate nohighlight">
\[2x_2 \leq 12\]</div>
<div class="math notranslate nohighlight">
\[3x_1 + 2x_2 \leq 18\]</div>
<div class="math notranslate nohighlight">
\[x_1 \geq 0, x_2 \geq 0\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">suppress</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#x_1 ≤ 4</span>

<span class="n">point1_x_1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>

<span class="n">point2_x_1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

<span class="n">point1_point2_x_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">row_stack</span><span class="p">((</span><span class="n">point1_x_1</span><span class="p">,</span> <span class="n">point2_x_1</span><span class="p">))</span>

<span class="c1">#x_1 ≥ 0</span>
<span class="n">point3_x_1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>

<span class="n">point4_x_1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

<span class="n">point3_point4_x_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">row_stack</span><span class="p">((</span><span class="n">point3_x_1</span><span class="p">,</span> <span class="n">point4_x_1</span><span class="p">))</span>

<span class="c1">#2x_2 ≤ 12 or x_2 ≤ 6</span>

<span class="n">point1_x_2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>

<span class="n">point2_x_2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>

<span class="n">point1_point2_x_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">row_stack</span><span class="p">((</span><span class="n">point1_x_2</span><span class="p">,</span> <span class="n">point2_x_2</span><span class="p">))</span>

<span class="c1">#x_2 ≥ 0</span>

<span class="n">point3_x_2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="n">point4_x_2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="n">point3_point4_x_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">row_stack</span><span class="p">((</span><span class="n">point3_x_2</span><span class="p">,</span> <span class="n">point4_x_2</span><span class="p">))</span>

<span class="c1">#3x_1 + 2x_2 ≤ 18</span>

<span class="n">x_1_region_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

<span class="n">x_2_region_1</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">18</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">x_1_region_1</span><span class="p">)</span>


<span class="n">x_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

<span class="n">x_2</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">18</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">x_1</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">point1_point2_x_1</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">point1_point2_x_1</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span>
         <span class="n">point3_point4_x_1</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">point3_point4_x_1</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span>
         <span class="n">point1_point2_x_2</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">point1_point2_x_2</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span>
         <span class="n">point3_point4_x_2</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">point3_point4_x_2</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span>
         <span class="n">x_1</span><span class="p">,</span> <span class="n">x_2</span><span class="p">)</span>

<span class="n">optimal_point</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">optimal_point</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">optimal_point</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span>
            <span class="n">facecolors</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">,</span> <span class="n">edgecolors</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s2">&quot;$x_1 = 4$&quot;</span><span class="p">,</span> <span class="s2">&quot;$x_1 = 0$&quot;</span><span class="p">,</span> 
            <span class="s2">&quot;$2x_2 = 12$&quot;</span><span class="p">,</span> <span class="s2">&quot;$x_2 = 0$&quot;</span><span class="p">,</span>
            <span class="s2">&quot;$3x_1+2x_2 = 18$&quot;</span><span class="p">,</span> <span class="s2">&quot;(óptimo coordenada 1, óptimo coordenada 2)&quot;</span><span class="p">],</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

<span class="n">point_1_interior_points</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">point_2_interior_points</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.27</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">point_3_interior_points</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.38</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">point_4_interior_points</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.56</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">)</span>

<span class="n">points_interior_points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">row_stack</span><span class="p">((</span><span class="n">point_1_interior_points</span><span class="p">,</span>
                                       <span class="n">point_2_interior_points</span><span class="p">,</span>
                                       <span class="n">point_3_interior_points</span><span class="p">,</span>
                                       <span class="n">point_4_interior_points</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">points_interior_points</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">points_interior_points</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> 
         <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span>
         <span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x_1_region_1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">x_2_region_1</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="n">x_2_region_1</span><span class="o">&lt;=</span><span class="mi">6</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;plum&quot;</span><span class="p">)</span>
<span class="n">x_1_region_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x_1_region_2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;plum&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Región factible del PL&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Metodo_primal_dual_de_BL_22_0.png" src="../../_images/Metodo_primal_dual_de_BL_22_0.png" />
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Recuérdese que los parámetros de un PL son <span class="math notranslate nohighlight">\(b_i, c_i, a_{ij}\)</span>.</p>
</div>
<p>Aunque los métodos PI son una buena alternativa para resolver PL’s perdemos ventajas que tiene el método símplex como es el análisis de sensibilidad y el análisis posterior que puede realizarse al modificar los parámetros del PL. Ver las referencias al final de la nota para tales análisis.</p>
</div>
<div class="section" id="metodo-primal-dual">
<h2>Método primal-dual<a class="headerlink" href="#metodo-primal-dual" title="Permalink to this headline">¶</a></h2>
<p>Se describirán dos ideas que se utilizan en los métodos primal dual y posteriormente una tercera idea que utiliza la función de barrera logarítmica (FBL). Para esto, considérese la forma estándar de un PL (PLE):</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\displaystyle \min_{x \in \mathbb{R}^n} c^Tx\\
\text{sujeto a:} \\
Ax=b\\
x \geq 0
\end{split}\]</div>
<p>donde: <span class="math notranslate nohighlight">\(A \in \mathbb{R}^{m \times n}, b \in \mathbb{R}^m\)</span>, <span class="math notranslate nohighlight">\(m &lt; n\)</span> con <em>rank</em> completo por renglones y las restricciones se interpretan de una forma <em>pointwise</em>.</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Las restricciones <span class="math notranslate nohighlight">\(Ax = b\)</span> se pueden escribir con funciones <span class="math notranslate nohighlight">\(h: \mathbb{R}^n \rightarrow \mathbb{R}\)</span> , <span class="math notranslate nohighlight">\(h_i(x) = b_i-a_i ^Tx\)</span>, <span class="math notranslate nohighlight">\(a_i\)</span> <span class="math notranslate nohighlight">\(i\)</span>-ésimo renglón de <span class="math notranslate nohighlight">\(A \in \mathbb{R}^{m \times n}\)</span> y <span class="math notranslate nohighlight">\(b_i\)</span> <span class="math notranslate nohighlight">\(i\)</span>-ésima entrada de <span class="math notranslate nohighlight">\(b\)</span> para <span class="math notranslate nohighlight">\(i=1, \cdots, m\)</span></p>
</div>
<p>La función Lagrangiana del problema anterior es:</p>
<div class="math notranslate nohighlight">
\[\mathcal{L}(x, \lambda, \nu) = f_o(x) + \displaystyle \sum_{i=1}^n \lambda_i f_i(x) + \sum_{i=1}^m \nu_i h_i(x) = c^Tx + \lambda^T(-x)  + \nu^T(b-Ax)\]</div>
<p>donde: <span class="math notranslate nohighlight">\(\mathcal{L}: \mathbb{R}^n \times \mathbb{R}^n \times \mathbb{R}^m \rightarrow \mathbb{R}\)</span>.</p>
<p>El problema dual asociado es:</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>El problema primal es:</p>
<p><span class="math notranslate nohighlight">\(\displaystyle \min_{x \in \mathbb{R}^n} c^Tx \\
\text{sujeto a:}\\
Ax = b \\
x \geq 0
\)</span></p>
<p><span class="math notranslate nohighlight">\(A \in \mathbb{R}^{m \times n}\)</span> y <em>rank</em> de A igual a <span class="math notranslate nohighlight">\(m &lt; n\)</span>.</p>
</div>
<div class="math notranslate nohighlight">
\[\begin{split}\displaystyle \max_{\nu \in \mathbb{R}^m, \lambda \in \mathbb{R}^n} b^T \nu \\
\text{sujeto a :} \\
c - A^T \nu - \lambda = 0 \\
\lambda \geq 0
\end{split}\]</div>
<p>Las condiciones KKT son:</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Ver <a class="reference internal" href="../4.4/Dualidad_lema_de_Farkas_condiciones_KKT_de_optimalidad.html#condkktplestandar"><span class="std std-ref">las condiciones KKT para un PL en su forma estándar</span></a>.</p>
</div>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
\nabla_x \mathcal{L}(x, \lambda, \nu) &amp;=&amp; c - A^T\nu - \lambda = 0 \nonumber \\
\lambda^Tx &amp;=&amp; 0 \nonumber \\
Ax &amp;=&amp; b \nonumber \\
-x &amp;\leq&amp; 0 \nonumber \\
\lambda &amp;\geq&amp; 0
\end{eqnarray}
\end{split}\]</div>
<p>Los métodos de la clase primal-dual encuentran soluciones <span class="math notranslate nohighlight">\((x^*, \lambda^*, \nu^*)\)</span> para las igualdades anteriores y modifican las direcciones de búsqueda y tamaños de paso para que las desigualdades se satisfagan de forma <strong>estricta</strong> en cada iteración.</p>
<p>En los métodos de la clase primal-dual reescribimos las condiciones KKT de optimalidad anteriores mediante una función <span class="math notranslate nohighlight">\(F: \mathbb{R}^{2n + m} \rightarrow \mathbb{R}^{2n+m}\)</span> dada por:</p>
<div class="math notranslate nohighlight">
\[\begin{split}F(x, \lambda, \nu ) = \left [ \begin{array}{c} c - A^T \nu - \lambda \\ X \Lambda e \\  b - Ax \end{array} \right ]\end{split}\]</div>
<p>y resolvemos la ecuación <strong>no lineal</strong> <span class="math notranslate nohighlight">\(F(x, \lambda, \nu )=0\)</span> para <span class="math notranslate nohighlight">\((x, \lambda) \geq 0\)</span>, donde: <span class="math notranslate nohighlight">\(X = \text{diag}(x_1, \dots, x_n)\)</span>, <span class="math notranslate nohighlight">\(\Lambda = \text{diag}(\lambda_1, \dots, \lambda_n)\)</span> y <span class="math notranslate nohighlight">\(e\)</span> es un vector de <span class="math notranslate nohighlight">\(1\)</span>’s en <span class="math notranslate nohighlight">\(\mathbb{R}^n\)</span>. Además en cada iteración se cumple <span class="math notranslate nohighlight">\(x^{(k)} &gt; 0\)</span> y <span class="math notranslate nohighlight">\(\lambda^{(k)} &gt; 0\)</span> para <span class="math notranslate nohighlight">\((x^{(k)}, \lambda^{(k)}, \nu^{(k)})\)</span>, por esto tales métodos son considerados como puntos interiores.</p>
<p>Como la mayoría de los métodos iterativos en optimización, los métodos primal-dual tienen un procedimiento para determinar la dirección de búsqueda y una cantidad que debe ser monitoreada cuyo valor alcance un valor objetivo. En el caso de los PLE’s tal cantidad es la <em>duality gap</em> medida como: <span class="math notranslate nohighlight">\(\lambda^Tx\)</span>, ver <a class="reference internal" href="../4.4/Dualidad_lema_de_Farkas_condiciones_KKT_de_optimalidad.html#brechadual"><span class="std std-ref">brecha dual</span></a>.</p>
<div class="section" id="primera-idea-determinar-la-direccion-de-busqueda">
<span id="primideametprimdual"></span><h3>Primera idea: determinar la dirección de búsqueda<a class="headerlink" href="#primera-idea-determinar-la-direccion-de-busqueda" title="Permalink to this headline">¶</a></h3>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Sistema de ecuaciones no lineales a resolver:</p>
<p><span class="math notranslate nohighlight">\(F(x, \lambda, \nu ) = \left [ \begin{array}{c}  c - A^T \nu - \lambda \\ X \Lambda e \\ b - Ax \end{array} \right ] = 0\)</span></p>
</div>
<p>La dirección de búsqueda se determina aplicando el método de Newton al sistema de ecuaciones no lineales que se muestra en el margen del PLE. Por tanto, se resuelve el sistema de ecuaciones lineales:</p>
<div class="math notranslate nohighlight">
\[\begin{split}J_F(x, \lambda, \nu) \left [ \begin{array}{c} \Delta x \\ \Delta \lambda \\ \Delta \nu \end{array} \right ] = - F(x, \lambda, \nu)\end{split}\]</div>
<p>donde: <span class="math notranslate nohighlight">\(J_F\)</span> es la Jacobiana de <span class="math notranslate nohighlight">\(F\)</span> cuya expresión es:</p>
<div class="math notranslate nohighlight">
\[\begin{split}J_F(x, \lambda, \nu) = \left [ \begin{array}{ccc} 0 &amp; I &amp; -A^T \\ \Lambda &amp; X &amp; 0 \\ -A &amp; 0 &amp; 0 \end{array} \right ].\end{split}\]</div>
<p>para el vector de incógnitas <span class="math notranslate nohighlight">\(\left [ \begin{array}{c} \Delta x \\ \Delta \lambda \\ \Delta \nu \end{array} \right ]\)</span>.</p>
<p>Una vez calculado tal vector de incógnitas se realiza la actualización:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\left [ \begin{array}{c} x \\ \lambda \\ \nu \end{array} \right ]^{(k+1)} = \left [ \begin{array}{c} x \\ \lambda \\ \nu \end{array} \right ]^{(k)} + \left [ \begin{array}{c} \Delta x \\ \Delta \lambda \\ \Delta \nu \end{array} \right ]\end{split}\]</div>
<p>donde: <span class="math notranslate nohighlight">\(k\)</span> hace referencia a la <span class="math notranslate nohighlight">\(k\)</span>-ésima iteración.</p>
<p>Ver <a class="reference internal" href="../../III.optimizacion_convexa/3.4/Ecuaciones_no_lineales.html#sistecnolineales"><span class="std std-ref">Sistema de ecuaciones no lineales</span></a>.</p>
<div class="tip admonition">
<p class="admonition-title">Observación</p>
<p>Si bien podría elegirse otra dirección de búsqueda, la dirección de Newton (o variantes de ésta) se prefiere por sus propiedades de convergencia e invarianza ante transformaciones afín.</p>
</div>
<p>Si denotamos <span class="math notranslate nohighlight">\(r_d = c - A^T \nu - \lambda, r_p = b - Ax\)</span> como el residual para factibilidad dual y residual para factibilidad primal respectivamente entonces el sistema de ecuaciones lineales a resolver es:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\left [ \begin{array}{ccc} 0 &amp; I &amp; -A^T \\ \Lambda &amp; X &amp; 0 \\ -A &amp; 0 &amp; 0 \end{array} \right ]  \left [ \begin{array}{c} \Delta x \\ \Delta \lambda \\ \Delta \nu \end{array} \right ] =  - \left [ \begin{array}{c} r_d \\ X \Lambda e \\ r_p \end{array} \right ]\end{split}\]</div>
<div class="admonition-comentarios admonition">
<p class="admonition-title">Comentarios</p>
<ul class="simple">
<li><p>El sistema de ecuaciones lineales anterior para problemas <em>large scale</em> no se construye pues es un sistema cuadrado de tamaño <span class="math notranslate nohighlight">\(2n + m \times 2n + m\)</span> y se resuelve reduciéndolo a sistemas de ecuaciones equivalentes. Representa el paso más costoso del método primal-dual.</p></li>
<li><p>Se pueden eliminar los signos negativos que están en los bloques de la matriz del sistema de ecuaciones lineales anterior que contienen <span class="math notranslate nohighlight">\(A, A^T\)</span> pero por consistencia con lo desarrollado en la nota de dualidad para un PL se mantienen los signos negativos (si se eliminan también debe de ajustarse el lado derecho del sistema). Esta modificación se relaciona con la definición de la función Lagrangiana.</p></li>
</ul>
</div>
</div>
<div class="section" id="segunda-idea-cortar-el-paso">
<span id="segunideaprimdual"></span><h3>Segunda idea: cortar el paso<a class="headerlink" href="#segunda-idea-cortar-el-paso" title="Permalink to this headline">¶</a></h3>
<p>Si se toma un paso completo es muy posible que en la siguiente iteración se encuentre muy cerca de alguna de las fronteras de restricción o bien se salga de la región factible. Para esto se define un parámetro <span class="math notranslate nohighlight">\(t^{(k)} \in (0, 1]\)</span> y por tanto la actualización es:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\left [ \begin{array}{c} x \\ \lambda \\ \nu \end{array} \right ]^{(k+1)} = \left [ \begin{array}{c} x \\ \lambda \\ \nu \end{array} \right ]^{(k)} + t^{(k)}  \left [ \begin{array}{c} \Delta x \\ \Delta \lambda \\ \Delta \nu \end{array} \right ]\end{split}\]</div>
<p>donde: <span class="math notranslate nohighlight">\(k\)</span> hace referencia a la <span class="math notranslate nohighlight">\(k\)</span>-ésima iteración.</p>
<div class="admonition-comentario admonition">
<p class="admonition-title">Comentario</p>
<p>El parámetro <span class="math notranslate nohighlight">\(t^{(k)}\)</span> se calcula con metodologías como búsqueda de línea o regiones de confianza, ver <a class="reference external" href="https://en.wikipedia.org/wiki/Line_search">line search</a>, <a class="reference internal" href="../../III.optimizacion_convexa/3.2/Algoritmos_de_descenso_y_busqueda_de_linea_en_uco.html#mbuslinback"><span class="std std-ref">método de búsqueda de línea por backtracking</span></a>, <a class="reference external" href="https://en.wikipedia.org/wiki/Trust_region">trust region</a>.</p>
</div>
</div>
</div>
<div class="section" id="id1">
<h2>Método primal-dual de barrera logarítmica (BL)<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<div class="section" id="tercera-idea-reducir-la-duality-gap-y-centrar-uso-de-la-funcion-de-barrera-logaritmica-fbl">
<h3>Tercera idea: reducir la <em>duality gap</em> y centrar. Uso de la función de barrera logarítmica (FBL)<a class="headerlink" href="#tercera-idea-reducir-la-duality-gap-y-centrar-uso-de-la-funcion-de-barrera-logaritmica-fbl" title="Permalink to this headline">¶</a></h3>
<p>En cada iteración los métodos primal-dual buscan reducir la <em>duality gap</em> o bien mantenerse “cerca” de la trayectoria nombrada trayectoria central.</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Sistema de ecuaciones lineales <span class="math notranslate nohighlight">\(\left [ \begin{array}{ccc} 0 &amp; I &amp; -A^T \\ \Lambda &amp; X &amp; 0 \\ -A &amp; 0 &amp; 0 \end{array} \right ]  \left [ \begin{array}{c} \Delta x \\ \Delta \lambda \\ \Delta \nu \end{array} \right ] =  - \left [ \begin{array}{c} r_d \\ X \Lambda e \\ r_p \end{array} \right ]\)</span></p>
</div>
<div class="admonition-comentario admonition">
<p class="admonition-title">Comentario</p>
<p>Recuérdese que la <em>duality gap</em> en un PLE para el par <span class="math notranslate nohighlight">\((x, \nu)\)</span> primal-dual factible está dada por la diferencia: <span class="math notranslate nohighlight">\(c^Tx - b^T \nu\)</span>. La <em>duality gap</em> en un PLE es igual a <span class="math notranslate nohighlight">\(\lambda^Tx\)</span>. En el sistema de ecuaciones lineales que se muestra en el margen se representa cada sumando de <span class="math notranslate nohighlight">\(\lambda^Tx\)</span> con el producto <span class="math notranslate nohighlight">\(X \Lambda e\)</span> (recuérdese <span class="math notranslate nohighlight">\(X, \Lambda\)</span> son matrices diagonales).</p>
</div>
<p>La trayectoria central se define a partir de la FBL, ver <a class="reference external" href="https://en.wikipedia.org/wiki/Barrier_function">Barrier function</a>. La definición siguiente se da para un POCE de forma general.</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Las restricciones <span class="math notranslate nohighlight">\(Ax = b\)</span> se pueden escribir con funciones <span class="math notranslate nohighlight">\(h_i: \mathbb{R}^n \rightarrow \mathbb{R}\)</span> , <span class="math notranslate nohighlight">\(h_i(x) = b_i-a_i ^Tx\)</span>, <span class="math notranslate nohighlight">\(a_i\)</span> <span class="math notranslate nohighlight">\(i\)</span>-ésimo renglón de <span class="math notranslate nohighlight">\(A \in \mathbb{R}^{p \times n}\)</span> y <span class="math notranslate nohighlight">\(b_i\)</span> <span class="math notranslate nohighlight">\(i\)</span>-ésima entrada de <span class="math notranslate nohighlight">\(b\)</span> para <span class="math notranslate nohighlight">\(i=1, \cdots, p\)</span></p>
</div>
<div class="admonition-definicion admonition">
<p class="admonition-title">Definición</p>
<p>Considérese el problema de optimización convexa en la forma estándar (POCE):</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
\displaystyle \min_{x \in \mathbb{R}^n} &amp;f_o(x)&amp; \nonumber \\
&amp;\text{sujeto a:}&amp; \nonumber\\
f_i(x) &amp;\leq&amp; 0  \quad i=1,\dots,m \nonumber \\
Ax &amp;=&amp; b
\end{eqnarray}
\end{split}\]</div>
<p>con <span class="math notranslate nohighlight">\(A \in \mathbb{R}^{p \times n}\)</span> y <em>rank</em> de <span class="math notranslate nohighlight">\(A\)</span> igual a <span class="math notranslate nohighlight">\(p &lt; n\)</span>.</p>
<p>Se define la función de barrera logarítmica (FBL) como:</p>
<div class="math notranslate nohighlight">
\[\phi(x) =-\displaystyle \sum_{i=1}^m \log(-f_i(x))\]</div>
</div>
<div class="sidebar">
<p class="sidebar-title">Un poco de historia …</p>
<p>La metodología para resolver el problema de barrera logarítmica (PBL) está fundamentada en la <em>sequential unconstrained minimization technique (SUMT)</em>, <a class="reference external" href="https://www.jstor.org/stable/168637?seq=1">A. V. Fiacco, G. P. McCormick, 1965</a>. Es una técnica para resolver problemas no lineales sin restricciones que genera una secuencia de puntos interiores factibles que convergen a la solución del problema. Se eligen funciones de barrera con propiedades como la convexidad. Hay versiones de la SUMT para puntos exteriores que inician con puntos no factibles y vía la penalización se busca la convergencia hacia la región factible. En cada iteración de SUMT se define un valor del parámetro de barrera y se resuelve un problema de optimización más sencillo que el original con el método de Newton. La solución de tal problema se utiliza para definir puntos iniciales del siguiente problema a resolver con un valor del parámetro de barrera diferente. A medida que se avanza en las iteraciones la función objetivo del PBL se aproxima cada vez más a <span class="math notranslate nohighlight">\(f_o\)</span>, al valor óptimo y al conjunto óptimo.</p>
</div>
<p>El POCE se resuelve planteando el siguiente problema:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\displaystyle \min_{x \in \mathbb{R}^n} f_B(x|t_B) \\
\text{sujeto a:} \\
Ax = b
\end{split}\]</div>
<p>donde: <span class="math notranslate nohighlight">\(f_B(x|t_B) = f_o(x) + \frac{1}{t_B} \phi(x) = f_o(x) -  \frac{1}{t_B} \displaystyle \sum_{i=1}^m \log(-f_i(x))\)</span>, <span class="math notranslate nohighlight">\(\phi: \mathbb{R}^n \rightarrow \mathbb{R}\)</span> con <span class="math notranslate nohighlight">\(t_B\)</span> un parámetro positivo que nombramos <strong>parámetro de barrera</strong>. Denotamos a este problema como <strong>problema de barrera logarítmica (PBL)</strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-.</span><span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">log_barrier</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">)</span>
<span class="n">t_B1</span> <span class="o">=</span> <span class="mf">0.2</span>
<span class="n">t_B2</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">t_B3</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">t_B4</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">t_B5</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">t_B1</span><span class="o">*</span><span class="n">log_barrier</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span>
         <span class="n">x</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">t_B2</span><span class="o">*</span><span class="n">log_barrier</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span>
         <span class="n">x</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">t_B3</span><span class="o">*</span><span class="n">log_barrier</span><span class="p">,</span> <span class="s2">&quot;g&quot;</span><span class="p">,</span>
         <span class="n">x</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">t_B4</span><span class="o">*</span><span class="n">log_barrier</span><span class="p">,</span> <span class="s2">&quot;m&quot;</span><span class="p">,</span>
         <span class="n">x</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">t_B5</span><span class="o">*</span><span class="n">log_barrier</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s2">&quot;$t_</span><span class="si">{B1}</span><span class="s2">=0.2$&quot;</span><span class="p">,</span>
            <span class="s2">&quot;$t_</span><span class="si">{B2}</span><span class="s2">=0.5$&quot;</span><span class="p">,</span>
            <span class="s2">&quot;$t_</span><span class="si">{B3}</span><span class="s2">=1$&quot;</span><span class="p">,</span>
            <span class="s2">&quot;$t_</span><span class="si">{B4}</span><span class="s2">=2$&quot;</span><span class="p">,</span>
            <span class="s2">&quot;$t_</span><span class="si">{B5}</span><span class="s2">=10$&quot;</span><span class="p">],</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Gráfica de la FBL variando el parámetro $t_B$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Metodo_primal_dual_de_BL_69_0.png" src="../../_images/Metodo_primal_dual_de_BL_69_0.png" />
</div>
</div>
<p>Valores más grandes de <span class="math notranslate nohighlight">\(t_B\)</span> hacen que <span class="math notranslate nohighlight">\(f_B(x|t_B)\)</span> tienda a <span class="math notranslate nohighlight">\(f_o(x)\)</span>. Como se observa en la gráfica anterior al elegir un valor de <span class="math notranslate nohighlight">\(t_B\)</span> cada vez más grande se tiene: <span class="math notranslate nohighlight">\(f_B(x|t_B) = f_o(x) + \frac{1}{t_B} \phi(x) \approx f_o(x)\)</span>.</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>El POCE recuérdese es:</p>
<p><span class="math notranslate nohighlight">\(
\begin{eqnarray}
\displaystyle \min_{x \in \mathbb{R}^n} &amp;f_o(x)&amp; \nonumber \\
&amp;\text{sujeto a:}&amp; \nonumber\\
f_i(x) &amp;\leq&amp; 0  \quad i=1,\dots,m \nonumber \\
Ax &amp;=&amp; b
\end{eqnarray}
\)</span></p>
<p>y el PBL es:</p>
<p><span class="math notranslate nohighlight">\(
\displaystyle \min_{x \in \mathbb{R}^n} f_B(x|t_B) \\
\text{sujeto a:} \\
Ax = b
\)</span></p>
<p>con <span class="math notranslate nohighlight">\(A \in \mathbb{R}^{p \times n}\)</span> y <em>rank</em> de <span class="math notranslate nohighlight">\(A\)</span> igual a <span class="math notranslate nohighlight">\(p &lt; n\)</span>,</p>
<p><span class="math notranslate nohighlight">\(\begin{eqnarray}
f_B(x|t_B) &amp;=&amp; f_o(x) + \frac{1}{t_B} \phi(x) \nonumber \\
&amp;=&amp; f_o(x) -  \frac{1}{t_B} \displaystyle \sum_{i=1}^m \log(-f_i(x))
\end{eqnarray}
\)</span>.</p>
</div>
<div class="admonition-comentarios admonition">
<p class="admonition-title">Comentarios</p>
<ul class="simple">
<li><p>La función <span class="math notranslate nohighlight">\(\phi(x) = -\frac{1}{t_B} \log(-x)\)</span> para <span class="math notranslate nohighlight">\(x &lt; 0\)</span> es convexa, diferenciable y aproxima a la función indicadora:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}I(x) = \begin{cases} \infty \text{ si } x &gt; 0 \\ 0 \text{ si } x \leq 0 \end{cases}\end{split}\]</div>
<p>la cual es una función discontinua:</p>
<img src="https://dl.dropboxusercontent.com/s/i4t3j8c9amzue1n/indicator_func.png?dl=0" heigth="250" width="250">
<p>En el dibujo anterior sólo se visualiza para el eje horizontal el intervalo <span class="math notranslate nohighlight">\((-\infty, 0)\)</span>.</p>
<ul class="simple">
<li><p>La función indicadora del punto anterior ayuda a reescribir el POCE como:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\displaystyle \min_{x \in \mathbb{R}^n} f_o(x) + \displaystyle \sum_{i=1}^m I(f_i(x))\]</div>
<div class="math notranslate nohighlight">
\[\text{sujeto a:}\]</div>
<div class="math notranslate nohighlight">
\[Ax = b\]</div>
<p>por esto resolver el PBL es equivalente a resolver el POCE para valores más grandes de <span class="math notranslate nohighlight">\(t_B\)</span>.</p>
<ul class="simple">
<li><p>La FBL es un caso particular de funciones de barrera que penalizan al no satisfacer las restricciones de desigualdad, ver <a class="reference external" href="https://en.wikipedia.org/wiki/Penalty_method">Penalty method</a>.</p></li>
<li><p>En general las funciones de barrera deben tener las siguientes propiedades para <span class="math notranslate nohighlight">\(x\)</span> primal factibles:</p></li>
</ul>
<ol class="simple">
<li><p>Tener valores “pequeños” si <span class="math notranslate nohighlight">\(x\)</span> está “lejos” de la frontera de la región factible.</p></li>
<li><p>Tener valores “grandes” si <span class="math notranslate nohighlight">\(x\)</span> está “cerca” de la frontera de la región factible.</p></li>
<li><p>Tener propiedades como convexidad o diferenciabilidad (ventajas al tener tales propiedades).</p></li>
</ol>
<p>Por lo anterior las funciones de barrera evitan que se cruce o llegue a la frontera de la región factible del problema primal.</p>
<ul class="simple">
<li><p>Otra función de barrera para un PL es: <span class="math notranslate nohighlight">\(\phi(x) = -\displaystyle \sum_{i=1}^m \frac{1}{f_i(x)}\)</span> para <span class="math notranslate nohighlight">\(x\)</span> factibles.</p></li>
<li><p>Los problemas de optimización convexos con únicamente restricciones de igualdad pueden resolverse aplicando extensiones del método de Newton.</p></li>
</ul>
</div>
</div>
<div class="section" id="trayectoria-central-determinada-por-los-puntos-centrales">
<h3>Trayectoria central determinada por los puntos centrales<a class="headerlink" href="#trayectoria-central-determinada-por-los-puntos-centrales" title="Permalink to this headline">¶</a></h3>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>El PBL para un POCE recuérdese es:</p>
<p><span class="math notranslate nohighlight">\(
\displaystyle \min_{x \in \mathbb{R}^n} f_B(x|t_B) \\
\text{sujeto a:} \\
Ax = b
\)</span></p>
<p>con <span class="math notranslate nohighlight">\(A \in \mathbb{R}^{p \times n}\)</span> y <em>rank</em> de <span class="math notranslate nohighlight">\(A\)</span> igual a <span class="math notranslate nohighlight">\(p &lt; n\)</span>,</p>
<p><span class="math notranslate nohighlight">\(\begin{eqnarray}
f_B(x|t_B) &amp;=&amp; f_o(x) + \frac{1}{t_B} \phi(x) \nonumber \\
&amp;=&amp; f_o(x) -  \frac{1}{t_B} \displaystyle \sum_{i=1}^m \log(-f_i(x))
\end{eqnarray}
\)</span>.</p>
</div>
<div class="admonition-definicion admonition">
<p class="admonition-title">Definición</p>
<p>Para cada valor del parámetro de barrera <span class="math notranslate nohighlight">\(t_B\)</span>, se definen los <strong>puntos centrales</strong> <span class="math notranslate nohighlight">\(x^*(t_B)\)</span> como la solución del PBL y el conjunto de puntos centrales se le nombra trayectoria central, <em>central path</em>.</p>
</div>
<p>Revisemos las condiciones KKT de optimalidad que deben cumplir los puntos centrales para un PLE:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\displaystyle \min_{x \in \mathbb{R}^n} c^Tx\\
\text{sujeto a:} \\
Ax=b\\
x \geq 0
\end{split}\]</div>
<p>con <span class="math notranslate nohighlight">\(A \in \mathbb{R}^{m \times n}\)</span> y <em>rank</em> de <span class="math notranslate nohighlight">\(A\)</span> igual a <span class="math notranslate nohighlight">\(m &lt; n\)</span>.</p>
<p>Se tiene:</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Recuérdese que en un PLE <span class="math notranslate nohighlight">\(f_i(x) = - x_i \forall i=1, \cdots, n\)</span>.</p>
</div>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
\phi(x) &amp;=&amp; -\displaystyle \sum_{i=1}^n \log(-f_i(x)) \nonumber \\
&amp;=&amp; - \sum_{i=1}^n \log(x_i)
\end{eqnarray}
\end{split}\]</div>
<p>y por tanto el PBL para el PLE (PBL-PLE) es:</p>
<div class="math notranslate nohighlight">
\[\displaystyle \min_{x \in \mathbb{R}^n} c^Tx - \frac{1}{t_B} \displaystyle \sum_{i=1}^n \log(x_i)\]</div>
<div class="math notranslate nohighlight">
\[\text{sujeto a:}\]</div>
<div class="math notranslate nohighlight">
\[Ax=b\]</div>
<p>La función Lagrangiana del PBL-PLE es:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
\mathcal{L}_B(x, \nu) &amp;=&amp; f_B(x|t_B) + \sum_{i=1}^m \nu_i h_i(x) \nonumber \\
&amp;=&amp; c^Tx - \frac{1}{t_B} \displaystyle \sum_{i=1}^n \log(x_i)  + \sum_{i=1}^m \nu_i(b_i-a_i ^Tx) \nonumber \\
&amp;=&amp; c^Tx - \frac{1}{t_B} \displaystyle \sum_{i=1}^n \log(x_i)  + \nu^T(b-Ax) \nonumber
\end{eqnarray}
\end{split}\]</div>
<p>con <span class="math notranslate nohighlight">\(a_i\)</span> <span class="math notranslate nohighlight">\(i\)</span>-ésimo renglón de <span class="math notranslate nohighlight">\(A\)</span> y <span class="math notranslate nohighlight">\(b_i\)</span> <span class="math notranslate nohighlight">\(i\)</span>-ésima entrada de <span class="math notranslate nohighlight">\(b\)</span>. Las condiciones necesarias y suficientes KKT de optimalidad del PBL-PLE son:</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Recuérdese que las condiciones de KKT para un PLE son:</p>
<p><span class="math notranslate nohighlight">\(
\begin{eqnarray}
\nabla_x \mathcal{L}(x, \lambda, \nu) &amp;=&amp; c - A^T\nu - \lambda = 0 \nonumber \\
\lambda^Tx &amp;=&amp; 0 \nonumber \\
Ax &amp;=&amp; b \nonumber \\
-x &amp;\leq&amp; 0 \nonumber \\
\lambda &amp;\geq&amp; 0
\end{eqnarray}
\)</span></p>
</div>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
\nabla_x \mathcal{L}_B(x, \nu) &amp;=&amp; c - A^T\nu - \frac{1}{t_B}d = 0 \nonumber \\
Ax &amp;=&amp; b \nonumber \\
\end{eqnarray}
\end{split}\]</div>
<p>donde: <span class="math notranslate nohighlight">\(d = X^{-1}e = \left [ \begin{array}{c} \frac{1}{x_1} \\ \vdots \\ \frac{1}{x_n} \\ \end{array} \right ]\)</span>. Ver <a class="reference internal" href="../4.4/Dualidad_lema_de_Farkas_condiciones_KKT_de_optimalidad.html#condkktplestandar"><span class="std std-ref">condiciones KKT para un PL en su forma estándar</span></a> (se muestran en el margen).</p>
<p>Los puntos centrales <span class="math notranslate nohighlight">\(x^*(t_B)\)</span> resuelven el PBL-PLE y por tanto satisfacen:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
\nabla_x \mathcal{L}_B(x^*(t_B), \nu) &amp;=&amp; c - A^T\nu - \frac{1}{t_B} d(t_B) = 0 \nonumber \\
Ax^*(t_B) &amp;=&amp; b \nonumber \\
\end{eqnarray}
\end{split}\]</div>
<p>donde: <span class="math notranslate nohighlight">\(d(t_B) = X^{*-1}(t_B)e = \left [ \begin{array}{c} \frac{1}{x_1^*(t_B)} \\ \vdots \\ \frac{1}{x_n^*(t_B)} \\ \end{array} \right ]\)</span>.</p>
</div>
<div class="section" id="relacion-entre-las-condiciones-kkt-de-optimalidad-del-ple-y-las-del-pbl-ple">
<h3>Relación entre las condiciones KKT de optimalidad del PLE y las del PBL-PLE<a class="headerlink" href="#relacion-entre-las-condiciones-kkt-de-optimalidad-del-ple-y-las-del-pbl-ple" title="Permalink to this headline">¶</a></h3>
<p>Para establecer la relación entre las condiciones KKT de optimalidad del PLE y las del PBL-PLE considérese <strong>sólo</strong> en esta sección que el PBL-PLE es:</p>
<div class="math notranslate nohighlight">
\[\displaystyle \min_{x \in \mathbb{R}^n} t_B c^Tx - \displaystyle \sum_{i=1}^n \log(x_i)\]</div>
<div class="math notranslate nohighlight">
\[\text{sujeto a:}\]</div>
<div class="math notranslate nohighlight">
\[Ax=b\]</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>La FBL en el PBL-PLE recuérdese es:</p>
<p><span class="math notranslate nohighlight">\(
\begin{eqnarray}
\phi(x) &amp;=&amp; -\displaystyle \sum_{i=1}^n \log(-f_i(x)) \nonumber \\
&amp;=&amp; - \sum_{i=1}^n \log(x_i)
\end{eqnarray}
\)</span></p>
</div>
<div class="tip admonition">
<p class="admonition-title">Observación</p>
<p>Esta forma del PBL-PLE es equivalente a la revisada anteriormente en la que la FBL se divide por el parámetro <span class="math notranslate nohighlight">\(t_B\)</span>. Es una cuestión sólo de escritura matemática lo que se realiza a continuación.</p>
</div>
<p>Las condiciones KKT son iguales a las revisadas en la sección anterior salvo la posición en la que se tiene el parámetro <span class="math notranslate nohighlight">\(t_B\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
\nabla_x \mathcal{L}_B(x^*(t_B), \hat{\nu}) &amp;=&amp; t_Bc - A^T\hat{\nu} - d(t_B) = 0 \nonumber \\
Ax^*(t_B) &amp;=&amp; b \nonumber \\
\end{eqnarray}
\end{split}\]</div>
<p>donde: <span class="math notranslate nohighlight">\(\hat{\nu} = t_B \nu\)</span>.</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Recuérdese que las condiciones de KKT para un PLE son:</p>
<p><span class="math notranslate nohighlight">\(
\begin{eqnarray}
\nabla_x \mathcal{L}(x, \lambda, \nu) &amp;=&amp; c - A^T\nu - \lambda = 0 \nonumber \\
\lambda^Tx &amp;=&amp; 0 \nonumber \\
Ax &amp;=&amp; b \nonumber \\
-x &amp;\leq&amp; 0 \nonumber \\
\lambda &amp;\geq&amp; 0
\end{eqnarray}
\)</span></p>
</div>
<p>Las condiciones KKT para un PLE se muestran en el margen y obsérvese que si <span class="math notranslate nohighlight">\(\lambda_i^*(t_B) = - \frac{1}{t_B f_i(x^*(t_B))} = - \frac{1}{t_B (-x_i^*(t_B))}\)</span> con <span class="math notranslate nohighlight">\(x_i^*(t_B)\)</span> <span class="math notranslate nohighlight">\(i\)</span>-ésima componente de <span class="math notranslate nohighlight">\(x^*(t_B)\)</span> <span class="math notranslate nohighlight">\(\forall i = 1, \dots, n\)</span> entonces se cumple:</p>
<div class="math notranslate nohighlight">
\[\lambda_i^*(t_B) &gt; 0\]</div>
<p>pues por la definición de la FBL en el PBL-PLE debe cumplirse: <span class="math notranslate nohighlight">\(f_i(x)  = -x_i &lt; 0\)</span> o bien para los puntos centrales <span class="math notranslate nohighlight">\(-x_i^*(t_B) &lt; 0 \forall i=1, \dots, n\)</span>. Lo anterior resulta del dominio de la función <span class="math notranslate nohighlight">\(\log\)</span> la cual está definida únicamente en <span class="math notranslate nohighlight">\(\mathbb{R}_{++}\)</span> (reales positivos). Esto satisface las desigualdades de factibilidad primal y de factibilidad dual de las condiciones KKT de optimalidad.</p>
<p>La holgura complementaria de las condiciones KKT de optimalidad para un PBL-PLE son:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
\lambda^*(t_B)^Tx^*(t_B) &amp;=&amp; \displaystyle \sum_{i=1}^n \lambda_i^*(t_B) x_i^*(t_B) \nonumber \\
&amp;=&amp; \displaystyle \sum_{i=1}^n - \frac{x_i^*(t_B)}{t_B (-x_i^*(t_B))} \nonumber \\
&amp;=&amp; \displaystyle \sum_{i=1}^n \frac{1}{t_B} = \frac{n}{t_B}
\end{eqnarray}
\end{split}\]</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>El POCE recuérdese es:</p>
<p><span class="math notranslate nohighlight">\(
\begin{eqnarray}
\displaystyle \min_{x \in \mathbb{R}^n} &amp;f_o(x)&amp; \nonumber \\
&amp;\text{sujeto a:}&amp; \nonumber\\
f_i(x) &amp;\leq&amp; 0  \quad i=1,\dots,m \nonumber \\
Ax &amp;=&amp; b
\end{eqnarray}
\)</span></p>
<p>y el PBL es:</p>
<p><span class="math notranslate nohighlight">\(
\displaystyle \min_{x \in \mathbb{R}^n} f_B(x|t_B) \\
\text{sujeto a:} \\
Ax = b
\)</span></p>
<p>con <span class="math notranslate nohighlight">\(A \in \mathbb{R}^{p \times n}\)</span> y <em>rank</em> de <span class="math notranslate nohighlight">\(A\)</span> igual a <span class="math notranslate nohighlight">\(p &lt; n\)</span>,</p>
<p><span class="math notranslate nohighlight">\(\begin{eqnarray}
f_B(x|t_B) &amp;=&amp; f_o(x) + \frac{1}{t_B} \phi(x) \nonumber \\
&amp;=&amp; f_o(x) -  \frac{1}{t_B} \displaystyle \sum_{i=1}^m \log(-f_i(x))
\end{eqnarray}
\)</span>.</p>
</div>
<p>Por tanto la <em>duality gap</em> asociada con <span class="math notranslate nohighlight">\(x^*(t_B), \lambda^*(t_B), \nu^*(t_B)\)</span> es: <span class="math notranslate nohighlight">\(\frac{n}{t_B}\)</span> donde: <span class="math notranslate nohighlight">\(\nu^*(t_B) = \frac{\hat{\nu}}{t_B}\)</span>.</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Recuérdese que las condiciones de KKT para un PLE son:</p>
<p><span class="math notranslate nohighlight">\(
\begin{eqnarray}
\nabla_x \mathcal{L}(x, \lambda, \nu) &amp;=&amp; c - A^T\nu - \lambda = 0 \nonumber \\
\lambda^Tx &amp;=&amp; 0 \nonumber \\
Ax &amp;=&amp; b \nonumber \\
-x &amp;\leq&amp; 0 \nonumber \\
\lambda &amp;\geq&amp; 0
\end{eqnarray}
\)</span></p>
</div>
<div class="admonition-comentarios admonition">
<p class="admonition-title">Comentarios</p>
<ul class="simple">
<li><p>Por la forma de la <em>duality gap</em> anterior para los puntos centrales si <span class="math notranslate nohighlight">\(t_B\)</span> se incrementa entonces la <em>duality gap</em> tiende a cero en el método primal dual de BL.</p></li>
<li><p>Para un PBL que se obtiene de un POCE la <em>duality gap</em> anterior para los puntos centrales es <span class="math notranslate nohighlight">\(\frac{m}{t_B}\)</span> pues se tienen <span class="math notranslate nohighlight">\(m\)</span> funciones <span class="math notranslate nohighlight">\(f_i\)</span> de desigualdad.</p></li>
<li><p>Las condiciones KKT de optimalidad del PBL-PLE son las condiciones KKT de optimalidad del PLE (que se muestran en el margen) pero perturbadas por el parámetro <span class="math notranslate nohighlight">\(t_B\)</span>:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
\nabla_x \mathcal{L}_B(x(t_B), \hat{\nu}) &amp;=&amp; t_Bc - A^T\hat{\nu} - d(t_B) = 0 \nonumber \\
Ax(t_B) &amp;=&amp; b \nonumber \\
\lambda_i(t_B)x_i(t_B) &amp;=&amp; \frac{1}{t_B}
\end{eqnarray}
\end{split}\]</div>
<p>donde: <span class="math notranslate nohighlight">\(\hat{\nu} = t_B \nu\)</span>, <span class="math notranslate nohighlight">\(d(t_B) = X^{-1}(t)e = \left [ \begin{array}{c} \frac{1}{x_1(t_B)} \\ \vdots \\ \frac{1}{x_n(t_B)} \\ \end{array} \right ]\)</span> y la <em>duality gap</em> se estima como: <span class="math notranslate nohighlight">\(\lambda(t_B)^Tx(t_B) = \frac{n}{t_B}\)</span>.</p>
</div>
</div>
<div class="section" id="como-calcular-los-puntos-centrales">
<h3>¿Cómo calcular los puntos centrales?<a class="headerlink" href="#como-calcular-los-puntos-centrales" title="Permalink to this headline">¶</a></h3>
<p>Para calcular los puntos centrales del PBL-PLE se utiliza la <a class="reference internal" href="#primideametprimdual"><span class="std std-ref">primera idea: determinar la dirección de búsqueda</span></a> en la que se resuelve el siguiente sistema de ecuaciones no lineales con el método de Newton:</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>El PBL-PLE recuérdese es:</p>
<p><span class="math notranslate nohighlight">\(
\displaystyle \min_{x \in \mathbb{R}^n} c^Tx - \frac{1}{t_B} \displaystyle \sum_{i=1}^n \log(x_i) \nonumber \\
\text{sujeto a:} \nonumber \\
Ax=b
\)</span></p>
<p>con <span class="math notranslate nohighlight">\(A \in \mathbb{R}^{m \times n}\)</span> y <em>rank</em> de <span class="math notranslate nohighlight">\(A\)</span> igual a <span class="math notranslate nohighlight">\(m &lt; n\)</span>. Las condiciones KKT son:</p>
<p><span class="math notranslate nohighlight">\(
\begin{eqnarray}
\nabla_x \mathcal{L}_B(x, \nu) &amp;=&amp; c - A^T\nu - \frac{1}{t_B}d = 0 \nonumber \\
Ax &amp;=&amp; b \nonumber \\
\end{eqnarray}
\)</span></p>
<p>donde: <span class="math notranslate nohighlight">\(d = X^{-1}e = \left [ \begin{array}{c} \frac{1}{x_1} \\ \vdots \\ \frac{1}{x_n} \\ \end{array} \right ]\)</span>.</p>
</div>
<div class="math notranslate nohighlight">
\[\begin{split}F(x, \nu) = \left [ \begin{array}{c} c - A^T\nu - \frac{1}{t_B}d(t_B) \\ b- Ax(t_B) \end{array} \right ] = 0\end{split}\]</div>
<p>donde: <span class="math notranslate nohighlight">\(d(t_B) = X^{*-1}(t)e = \left [ \begin{array}{c} \frac{1}{x_1^*(t_B)} \\ \vdots \\ \frac{1}{x_n^*(t_B)} \\ \end{array} \right ]\)</span>.</p>
<p>Este sistema de ecuaciones no lineales conduce a resolver el sistema de ecuaciones lineales:</p>
<div class="math notranslate nohighlight">
\[\begin{split}J_F(x, \nu) \left [ \begin{array}{c} \Delta x \\ \Delta \nu \end{array} \right ] = - F(x, \nu)\end{split}\]</div>
<p>donde: <span class="math notranslate nohighlight">\(J_F(x, \nu) = \left [ \begin{array}{cc} \nabla_{xx} ^2 \mathcal{L}_B(x, \nu)  &amp;  \nabla_{\nu x} \mathcal{L}_B(x,\nu) \\ -A &amp; 0\end{array} \right ] = \left [ \begin{array}{cc} \frac{1}{t_B} D^2(t_B) &amp;  -A^T \\ -A &amp; 0\end{array} \right ]\)</span> y <span class="math notranslate nohighlight">\(D^2(t_B) = \text{diag}^2(d(t_B)) \in \mathbb{R}^{n \times n}\)</span>.</p>
<p>La actualización en el método de Newton es:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\left [ \begin{array}{c} x \\ \nu \end{array} \right ]^{(k+1)} = \left [ \begin{array}{c} x \\ \nu \end{array} \right ]^{(k)} + t^{(k)}  \left [ \begin{array}{c} \Delta x \\ \Delta \nu \end{array} \right ]\end{split}\]</div>
<p>donde se utilizó la <a class="reference internal" href="#segunideaprimdual"><span class="std std-ref">segunda idea: cortar el paso</span></a>.</p>
<div class="admonition-comentarios admonition">
<p class="admonition-title">Comentarios</p>
<ul class="simple">
<li><p>Se pueden eliminar los signos negativos que están en los bloques de la matriz del sistema de ecuaciones lineales anterior que contienen <span class="math notranslate nohighlight">\(A, A^T\)</span> pero por consistencia con lo desarrollado en la nota de dualidad para un PL se mantienen los signos negativos (si se eliminan también debe de ajustarse el lado derecho del sistema). Esta modificación se relaciona con la definición de la función Lagrangiana.</p></li>
<li><p>También una modificación que se realiza para que en el primer bloque del sistema de ecuaciones lineales anterior no tengamos del lado izquierdo y del lado derecho <span class="math notranslate nohighlight">\(\frac{1}{t_B}\)</span> se puede trabajar con el problema de optimización equivalente:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}
\displaystyle \min_{x \in \mathbb{R}^n} f_B(x|t_B) \\
\text{sujeto a:} \\
Ax = b
\end{split}\]</div>
<p>donde: <span class="math notranslate nohighlight">\(f_B(x|t_B) = t_Bf_o(x) + \phi(x) = t_Bf_o(x) - \displaystyle \sum_{i=1}^m \log(-f_i(x))\)</span>.</p>
<p><strong>Estas dos modificaciones se utilizan para implementar el método primal-dual de BL</strong>.</p>
</div>
</div>
</div>
<div class="section" id="metodo-primal-dual-de-bl-aplicado-al-ejemplo-prototipo">
<h2>Método primal-dual de BL aplicado al ejemplo prototipo<a class="headerlink" href="#metodo-primal-dual-de-bl-aplicado-al-ejemplo-prototipo" title="Permalink to this headline">¶</a></h2>
<div class="cell tag_margin docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>pip install --quiet <span class="s2">&quot;git+https://github.com/ITAM-DS/analisis-numerico-computo-cientifico.git#egg=opt&amp;subdirectory=src&quot;</span>
</pre></div>
</div>
</div>
</div>
<p>Se utiliza el paquete de <em>Python</em> <a class="reference external" href="https://analisis-numerico-computo-cientifico.readthedocs.io/">opt</a> en los siguientes <code class="docutils literal notranslate"><span class="pre">import</span></code>’s.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">opt.utils_logarithmic_barrier</span> <span class="kn">import</span> <span class="n">log_barrier_aux_eval_constraints</span><span class="p">,</span> \
<span class="n">constraint_inequalities_funcs_generator</span><span class="p">,</span> <span class="n">constraint_inequalities_funcs_eval</span><span class="p">,</span> \
<span class="n">phi</span><span class="p">,</span> <span class="n">logarithmic_barrier</span><span class="p">,</span> <span class="n">line_search_for_log_barrier_by_backtracking</span>
</pre></div>
</div>
</div>
</div>
<p>Problema de optimización:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\displaystyle \max_{x \in \mathbb{R}^2} 3x_1 + 5x_2\\
\text{sujeto a: } \\
x_1 \leq 4 \nonumber    \\
2x_2 \leq 12            \\
3x_1 + 2x_2 \leq 18     \\
x_1 \geq 0              \\
x_2 \geq 0              \\
\end{split}\]</div>
<p>Definimos la función <span class="math notranslate nohighlight">\(\phi: \mathbb{R}^n \rightarrow \mathbb{R}\)</span> como <span class="math notranslate nohighlight">\(\phi(x) = - \displaystyle \sum_{i=1}^m \log(-(a_i ^Tx-b_i)) - \sum_{i=1}^n \log(-{e}_i ^T(-x))\)</span> con <span class="math notranslate nohighlight">\(a_i\)</span> <span class="math notranslate nohighlight">\(i\)</span>-ésimo renglón de <span class="math notranslate nohighlight">\(A = \left [ \begin{array}{cc} 1 &amp; 0 \\0 &amp; 2 \\ 3 &amp; 2 \end{array} \right ]\)</span>, <span class="math notranslate nohighlight">\(b_i\)</span> <span class="math notranslate nohighlight">\(i\)</span>-ésima entrada del vector <span class="math notranslate nohighlight">\(b = \left [ \begin{array}{c} 4 \\ 12 \\ 18 \end{array} \right ]\)</span> y <span class="math notranslate nohighlight">\(e_i\)</span> <span class="math notranslate nohighlight">\(i\)</span>-ésimo vector canónico.</p>
<p>Para este problema las curvas de nivel de la función <span class="math notranslate nohighlight">\(\phi\)</span> se ven como sigue:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">const_ineq_two_pars</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">:</span> <span class="n">x1</span> <span class="o">-</span> <span class="mi">4</span><span class="p">,</span>
                       <span class="mi">1</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">:</span> <span class="mi">2</span><span class="o">*</span><span class="n">x2</span> <span class="o">-</span> <span class="mi">12</span><span class="p">,</span>
                       <span class="mi">2</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">:</span> <span class="mi">3</span><span class="o">*</span><span class="n">x1</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">x2</span> <span class="o">-</span> <span class="mi">18</span><span class="p">,</span>
                       <span class="mi">3</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">:</span> <span class="o">-</span><span class="n">x1</span><span class="p">,</span>
                       <span class="mi">4</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">:</span> <span class="o">-</span><span class="n">x2</span>
                       <span class="p">}</span>
<span class="k">def</span> <span class="nf">const_ineq_funcs_eval_two_pars</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span> 
                                   <span class="n">const_ineq</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Auxiliary function for the evaluation of constraint inequalities</span>
<span class="sd">    in logarithmic barrier function using two parameters as input.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">const_ineq_funcs_eval</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">const</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">)</span> <span class="k">for</span> <span class="n">const</span> <span class="ow">in</span> \
                                      <span class="n">constraint_inequalities_funcs_generator</span><span class="p">(</span><span class="n">const_ineq</span><span class="p">)])</span>
    <span class="k">return</span> <span class="n">const_ineq_funcs_eval</span>
<span class="k">def</span> <span class="nf">phi_two_pars</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span> <span class="n">const_ineq</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Implementation of phi function for logarithmic barrier using two </span>
<span class="sd">    parameters as input.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">const_ineq_funcs_eval</span> <span class="o">=</span> <span class="o">-</span><span class="n">const_ineq_funcs_eval_two_pars</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span>
                                                            <span class="n">x2</span><span class="p">,</span>
                                                            <span class="n">const_ineq</span><span class="p">)</span>
    <span class="n">log_barrier_const_eval</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">const_ineq_funcs_eval</span><span class="p">)</span>
    <span class="k">return</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">log_barrier_const_eval</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">density</span><span class="o">=</span><span class="mf">1e-1</span>
<span class="n">x1l</span><span class="o">=</span><span class="mf">0.1</span>
<span class="n">x2d</span><span class="o">=</span><span class="mf">0.1</span>
<span class="n">x1r</span><span class="o">=</span><span class="mi">4</span>
<span class="n">x2u</span><span class="o">=</span><span class="mi">8</span>
<span class="n">x1_p</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">x1l</span><span class="p">,</span><span class="n">x1r</span><span class="p">,</span><span class="n">density</span><span class="p">)</span>
<span class="n">x2_p</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">x2d</span><span class="p">,</span><span class="n">x2u</span><span class="p">,</span><span class="n">density</span><span class="p">)</span>
<span class="n">x1_mesh</span><span class="p">,</span><span class="n">x2_mesh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x1_p</span><span class="p">,</span><span class="n">x2_p</span><span class="p">)</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">phi_two_pars</span><span class="p">(</span><span class="n">x1_mesh</span><span class="p">,</span><span class="n">x2_mesh</span><span class="p">,</span><span class="n">const_ineq_two_pars</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">point1_point2_x_1</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">point1_point2_x_1</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;_nolegend_&quot;</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">point3_point4_x_1</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">point3_point4_x_1</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;_nolegend_&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">point1_point2_x_2</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">point1_point2_x_2</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;_nolegend_&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">point3_point4_x_2</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">point3_point4_x_2</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;_nolegend_&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_1</span><span class="p">,</span> <span class="n">x_2</span><span class="p">,</span> <span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;_nolegend_&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">x1_p</span><span class="p">,</span> <span class="n">x2_p</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Curvas de nivel de $\phi$&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/usr/local/lib/python3.7/dist-packages/ipykernel_launcher.py:24: RuntimeWarning: divide by zero encountered in log
/usr/local/lib/python3.7/dist-packages/ipykernel_launcher.py:24: RuntimeWarning: invalid value encountered in log
</pre></div>
</div>
<img alt="../../_images/Metodo_primal_dual_de_BL_126_1.png" src="../../_images/Metodo_primal_dual_de_BL_126_1.png" />
</div>
</div>
<p>Reescribimos el problema anterior sin las restricciones <span class="math notranslate nohighlight">\(A x \leq b\)</span> como:</p>
<p><span class="math notranslate nohighlight">\(
\displaystyle \min_{x \in \mathbb{R}^2} t_B(-3x_1 -5x_2) - [\log(4-x_1) + \log(12 - 2x_2) + \log(18 - (3 x_1 + 2 x_2)) + \log(x_1) + \log(x_2) ]\\
\)</span></p>
<p>Realizamos la actualización:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\left [ \begin{array}{c}x_1 \\ x_2 \end{array} \right ] = \left [ \begin{array}{c}x_1 \\ x_2 \end{array} \right ] + t \left [ \begin{array}{c}\Delta x_1 \\ \Delta x_2 \end{array} \right ]\end{split}\]</div>
<p>donde: <span class="math notranslate nohighlight">\(t\)</span> es parámetro de <em>backtracking</em> y <span class="math notranslate nohighlight">\(\left [ \begin{array}{c}\Delta x_1 \\ \Delta x_2 \end{array} \right ]\)</span> es solución del sistema de ecuaciones lineales:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\nabla^2f_{B}(x) \left [ \begin{array}{c}\Delta x_1 \\ \Delta x_2 \end{array} \right ] = - \nabla f_{B}(x) \nonumber \\
\end{split}\]</div>
<p>que para este problema es:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
\tilde{A}^T \text{diag}^2(d(t_B))\tilde{A} \left [ \begin{array}{c}\Delta x_1 \\ \Delta x_2 \end{array} \right ] &amp;=&amp; -(t_Bc + \tilde{A}^Td(t_B)) \nonumber 
\end{eqnarray}
\end{split}\]</div>
<p>donde:</p>
<p><span class="math notranslate nohighlight">\(c = \left [ \begin{array}{c}-3 \\ -5 \end{array} \right ], 
\tilde{A} = \left [ \begin{array}{c} A \\ I \end{array} \right ] = \left [ \begin{array}{cc} 1 &amp; 0 \\0 &amp; 2 \\ 3 &amp; 2 \\ 1 &amp; 0 \\ 0 &amp; 1 \end{array} \right ]\)</span>,
<span class="math notranslate nohighlight">\(b_i\)</span> <span class="math notranslate nohighlight">\(i\)</span>-ésima entrada del vector <span class="math notranslate nohighlight">\(b = \left [ \begin{array}{c} 4 \\ 12 \\ 18 \end{array} \right ]\)</span>.</p>
<p>Y el vector <span class="math notranslate nohighlight">\(d(t_B) = \left [ \begin{array}{c} \frac{1}{b_1 - a_1^Tx(t_B)} \\ \frac{1}{b_2 - a_2^Tx(t_B)} \\ \frac{1}{b_3 - a_3^Tx(t_B)} \\ \frac{1}{-x_1(t_B)} \\ \frac{1}{-x_2(t_B)} \end{array}\right ] = \left [ \begin{array}{c} \frac{1}{4-x_1(t_B)} \\ \frac{1}{12-2x_2(t_B)} \\ \frac{1}{18-3x_1(t_B)-2x_2(t_B)} \\ \frac{1}{-x_1(t_B)} \\ \frac{1}{-x_2(t_B)} \end{array}\right ]\)</span>.</p>
<div class="tip admonition">
<p class="admonition-title">Observación</p>
<p>Aunque podríamos definir las siguientes líneas de acuerdo al desarrollo matemático anterior:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>
<span class="n">m</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">18</span><span class="p">])</span>
<span class="n">A_tilde</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">row_stack</span><span class="p">((</span><span class="n">A</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">n</span><span class="p">)))</span>

<span class="n">d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">x</span><span class="p">)),</span>
              <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">,:]</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">x</span><span class="p">)),</span>
              <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="n">A</span><span class="p">[</span><span class="mi">2</span><span class="p">,:]</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">x</span><span class="p">)),</span>
              <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
              <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])])</span>
<span class="n">system_matrix</span> <span class="o">=</span> <span class="p">(</span><span class="n">A_tilde</span><span class="o">.</span><span class="n">T</span><span class="o">*</span><span class="p">(</span><span class="n">d</span><span class="o">*</span><span class="n">d</span><span class="p">))</span><span class="nd">@A_tilde</span>
<span class="n">rhs</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">t_B</span><span class="o">*</span><span class="n">c</span> <span class="o">+</span><span class="n">A_tilde</span><span class="o">.</span><span class="n">T</span><span class="nd">@d</span><span class="p">)</span>

</pre></div>
</div>
<p>usamos <em>SymPy</em> para uso de diferenciación simbólica (no se recomienda el uso de <em>SymPy</em> para problemas <em>medium</em> o <em>large scale</em>).</p>
</div>
<div class="admonition-comentario admonition">
<p class="admonition-title">Comentario</p>
<p>Valores más “grandes” de <span class="math notranslate nohighlight">\(t_B\)</span> hacen que la Hessiana de la función objetivo del PBL varíe rápidamente cerca de la frontera del conjunto factible. En este ejemplo prototipo algunas de las entradas de <span class="math notranslate nohighlight">\(\text{diag}^2(d(t_B))\)</span> serán muy grandes en tales valores de <span class="math notranslate nohighlight">\(t_B\)</span>.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sympy</span>
<span class="kn">from</span> <span class="nn">sympy.tensor.array</span> <span class="kn">import</span> <span class="n">derive_by_array</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s2">&quot;x1, x2&quot;</span><span class="p">)</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">])</span>
<span class="n">fo_sympy</span> <span class="o">=</span> <span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">x1</span> <span class="o">+</span> <span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">x2</span>
<span class="n">phi_sympy</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">sympy</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">4</span><span class="o">-</span><span class="n">x1</span><span class="p">)</span> <span class="o">+</span> <span class="n">sympy</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">12</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">x2</span><span class="p">)</span> <span class="o">+</span> <span class="n">sympy</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">18</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">x1</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">x2</span><span class="p">)</span> <span class="o">+</span> <span class="n">sympy</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span> <span class="o">+</span> <span class="n">sympy</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">x2</span><span class="p">))</span>

<span class="n">gf_sympy</span> <span class="o">=</span> <span class="n">derive_by_array</span><span class="p">(</span><span class="n">fo_sympy</span><span class="p">,</span> <span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">))</span>
<span class="n">Hf_sympy</span> <span class="o">=</span> <span class="n">derive_by_array</span><span class="p">(</span><span class="n">gf_sympy</span><span class="p">,</span> <span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">))</span>
<span class="n">gphi_sympy</span> <span class="o">=</span> <span class="n">derive_by_array</span><span class="p">(</span><span class="n">phi_sympy</span><span class="p">,</span> <span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">))</span>
<span class="n">Hphi_sympy</span> <span class="o">=</span> <span class="n">derive_by_array</span><span class="p">(</span><span class="n">gphi_sympy</span><span class="p">,</span> <span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">))</span>

<span class="n">constraints_ineq</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                    <span class="mi">1</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                    <span class="mi">2</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">b</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
                    <span class="mi">3</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                    <span class="mi">4</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                   <span class="p">}</span>
<span class="n">x_0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">x_0</span>
<span class="n">fo</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>

<span class="n">t_B_0</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">18</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">x_0</span><span class="o">.</span><span class="n">size</span>


<span class="n">gf_B</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">t_B</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">component</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="s2">&quot;x1&quot;</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                                <span class="s2">&quot;x2&quot;</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                                                <span class="s2">&quot;t_B&quot;</span><span class="p">:</span> <span class="n">t_B</span><span class="p">})</span> <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="n">t_B</span><span class="o">*</span><span class="n">gf_sympy</span> <span class="o">+</span> <span class="n">gphi_sympy</span><span class="p">],</span>
                                <span class="n">dtype</span> <span class="o">=</span> <span class="nb">float</span><span class="p">)</span>
<span class="n">Hf_B</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">t_B</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">second_partial_derivative</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="s2">&quot;x1&quot;</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> 
                                                                <span class="s2">&quot;x2&quot;</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                                                                <span class="s2">&quot;t_B&quot;</span><span class="p">:</span> <span class="n">t_B</span><span class="p">})</span> <span class="k">for</span> <span class="n">second_partial_derivative</span> <span class="ow">in</span> <span class="n">t_B</span><span class="o">*</span><span class="n">Hf_sympy</span> <span class="o">+</span> <span class="n">Hphi_sympy</span><span class="p">],</span>
                                <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="primera-iteracion">
<h3>Primera iteración<a class="headerlink" href="#primera-iteracion" title="Permalink to this headline">¶</a></h3>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Aquí evaluamos la FBL del ejemplo prototipo:</p>
<p><span class="math notranslate nohighlight">\(\begin{eqnarray}
f_B(x|t_B) &amp;=&amp; t_B(-3x_1 -5x_2) \nonumber \\
&amp;-&amp; \log(4-x_1) - \log(12 - 2x_2) \nonumber \\
&amp;-&amp; \log(18 - (3 x_1 + 2 x_2)) \nonumber \\
&amp;-&amp; \log(x_1) - \log(x_2) 
\end{eqnarray}
\)</span></p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">log_barrier_eval</span> <span class="o">=</span> <span class="n">logarithmic_barrier</span><span class="p">(</span><span class="n">fo</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">t_B_0</span><span class="p">,</span><span class="n">constraints_ineq</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">log_barrier_eval</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-136.26909628370626
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">const_ineq_funcs_eval</span> <span class="o">=</span> <span class="o">-</span><span class="n">constraint_inequalities_funcs_eval</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">constraints_ineq</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">const_ineq_funcs_eval</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[ 3.  8. 11.  1.  2.]
</pre></div>
</div>
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Aquí revisamos que al evaluar las restricciones esté dentro del dominio de la función <span class="math notranslate nohighlight">\(\log\)</span> (valores estrictamente positivos). Si no están los puntos en el dominio debemos devolver un mensaje y detener el método.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">const_ineq_funcs_eval</span> <span class="o">&lt;</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">nextafter</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span> <span class="o">&gt;=</span><span class="mi">1</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Some constraint inequalities evaluated in x were nonpositive, check approximations&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fo_eval</span> <span class="o">=</span> <span class="n">fo</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">fo_eval</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-13.0
</pre></div>
</div>
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Resolvemos el sistema de ecuaciones lineales para calcular la dirección de Newton.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">system_matrix</span> <span class="o">=</span> <span class="n">Hf_B</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">t_B_0</span><span class="p">)</span>
<span class="n">rhs</span> <span class="o">=</span> <span class="o">-</span><span class="n">gf_B</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">t_B_0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dir_Newton</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">system_matrix</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">dir_Newton</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[ 19.696 142.065]
</pre></div>
</div>
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Aquí calculamos el decremento de Newton cuya definición se da al finalizar las iteraciones.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dec_Newton_squared</span> <span class="o">=</span> <span class="n">rhs</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">dir_Newton</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">dec_Newton_squared</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>7711.552360817478
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stopping_criteria</span> <span class="o">=</span> <span class="n">dec_Newton_squared</span><span class="o">/</span><span class="mi">2</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">stopping_criteria</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3855.776180408739
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">der_direct</span> <span class="o">=</span> <span class="o">-</span><span class="n">dec_Newton_squared</span>
</pre></div>
</div>
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Aquí cortamos el paso con la metodología de búsqueda de línea por <em>backtracking</em>.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="n">line_search_for_log_barrier_by_backtracking</span><span class="p">(</span><span class="n">fo</span><span class="p">,</span><span class="n">dir_Newton</span><span class="p">,</span><span class="n">x_0</span><span class="p">,</span><span class="n">t_B_0</span><span class="p">,</span>
                                                <span class="n">constraints_ineq</span><span class="p">,</span>
                                                <span class="n">der_direct</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/miuser/.local/lib/python3.7/site-packages/opt/utils_logarithmic_barrier.py:17: RuntimeWarning: invalid value encountered in log
  eval_f_const_inequality = np.log(eval_f_const_inequality)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.015625
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">t</span><span class="o">*</span><span class="n">dir_Newton</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1.308 4.22 ]
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="segunda-iteracion">
<h3>Segunda iteración<a class="headerlink" href="#segunda-iteracion" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">system_matrix</span> <span class="o">=</span> <span class="n">Hf_B</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">t_B_0</span><span class="p">)</span>
<span class="n">rhs</span> <span class="o">=</span> <span class="o">-</span><span class="n">gf_B</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">t_B_0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">log_barrier_eval</span> <span class="o">=</span> <span class="n">logarithmic_barrier</span><span class="p">(</span><span class="n">fo</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">t_B_0</span><span class="p">,</span><span class="n">constraints_ineq</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">log_barrier_eval</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-255.91817648985682
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">const_ineq_funcs_eval</span> <span class="o">=</span> <span class="o">-</span><span class="n">constraint_inequalities_funcs_eval</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">constraints_ineq</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">const_ineq_funcs_eval</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2.692 3.56  5.637 1.308 4.22 ]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">const_ineq_funcs_eval</span> <span class="o">&lt;</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">nextafter</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span> <span class="o">&gt;=</span><span class="mi">1</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Some constraint inequalities evaluated in x were nonpositive, check approximations&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fo_eval</span> <span class="o">=</span> <span class="n">fo</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">fo_eval</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-25.022042371388302
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dir_Newton</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">system_matrix</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">dir_Newton</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[11.93  94.597]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dec_Newton_squared</span> <span class="o">=</span> <span class="n">rhs</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">dir_Newton</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">dec_Newton_squared</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>5021.819828077723
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stopping_criteria</span> <span class="o">=</span> <span class="n">dec_Newton_squared</span><span class="o">/</span><span class="mi">2</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">stopping_criteria</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2510.9099140388616
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">der_direct</span> <span class="o">=</span> <span class="o">-</span><span class="n">dec_Newton_squared</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="n">line_search_for_log_barrier_by_backtracking</span><span class="p">(</span><span class="n">fo</span><span class="p">,</span><span class="n">dir_Newton</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">t_B_0</span><span class="p">,</span>
                                                <span class="n">constraints_ineq</span><span class="p">,</span>
                                                <span class="n">der_direct</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.015625
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">t</span><span class="o">*</span><span class="n">dir_Newton</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1.494 5.698]
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="tercera-iteracion">
<h3>Tercera iteración<a class="headerlink" href="#tercera-iteracion" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">system_matrix</span> <span class="o">=</span> <span class="n">Hf_B</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">t_B_0</span><span class="p">)</span>
<span class="n">rhs</span> <span class="o">=</span> <span class="o">-</span><span class="n">gf_B</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">t_B_0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">log_barrier_eval</span> <span class="o">=</span> <span class="n">logarithmic_barrier</span><span class="p">(</span><span class="n">fo</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">t_B_0</span><span class="p">,</span><span class="n">constraints_ineq</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">log_barrier_eval</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-333.0255657565843
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">const_ineq_funcs_eval</span> <span class="o">=</span> <span class="o">-</span><span class="n">constraint_inequalities_funcs_eval</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">constraints_ineq</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">const_ineq_funcs_eval</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2.506 0.604 2.122 1.494 5.698]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">const_ineq_funcs_eval</span> <span class="o">&lt;</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">nextafter</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span> <span class="o">&gt;=</span><span class="mi">1</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Some constraint inequalities evaluated in x were nonpositive, check approximations&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fo_eval</span> <span class="o">=</span> <span class="n">fo</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">fo_eval</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-32.97166508298113
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dir_Newton</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">system_matrix</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">dir_Newton</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[9.648 2.785]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dec_Newton_squared</span> <span class="o">=</span> <span class="n">rhs</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">dir_Newton</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">dec_Newton_squared</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>406.3137761754695
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stopping_criteria</span> <span class="o">=</span> <span class="n">dec_Newton_squared</span><span class="o">/</span><span class="mi">2</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">stopping_criteria</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>203.15688808773476
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">der_direct</span> <span class="o">=</span> <span class="o">-</span><span class="n">dec_Newton_squared</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="n">line_search_for_log_barrier_by_backtracking</span><span class="p">(</span><span class="n">fo</span><span class="p">,</span><span class="n">dir_Newton</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">t_B_0</span><span class="p">,</span>
                                                <span class="n">constraints_ineq</span><span class="p">,</span>
                                                <span class="n">der_direct</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.03125
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">t</span><span class="o">*</span><span class="n">dir_Newton</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1.796 5.785]
</pre></div>
</div>
</div>
</div>
<div class="tip admonition">
<p class="admonition-title">Ejercicio</p>
<p>Utiliza las definiciones:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>
<span class="n">m</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">18</span><span class="p">])</span>
<span class="n">A_tilde</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">row_stack</span><span class="p">((</span><span class="n">A</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">n</span><span class="p">)))</span>

<span class="n">d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">x</span><span class="p">)),</span>
              <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">,:]</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">x</span><span class="p">)),</span>
              <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="n">A</span><span class="p">[</span><span class="mi">2</span><span class="p">,:]</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">x</span><span class="p">)),</span>
              <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
              <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])])</span>
<span class="n">system_matrix</span> <span class="o">=</span> <span class="p">(</span><span class="n">A_tilde</span><span class="o">.</span><span class="n">T</span><span class="o">*</span><span class="p">(</span><span class="n">d</span><span class="o">*</span><span class="n">d</span><span class="p">))</span><span class="nd">@A_tilde</span>
<span class="n">rhs</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">t_B</span><span class="o">*</span><span class="n">c</span> <span class="o">+</span><span class="n">A_tilde</span><span class="o">.</span><span class="n">T</span><span class="nd">@d</span><span class="p">)</span>
</pre></div>
</div>
<p>y realiza cuatro iteraciones recalculando lo necesario para el sistema de ecuaciones lineales con <code class="docutils literal notranslate"><span class="pre">system_matrix</span></code> y <code class="docutils literal notranslate"><span class="pre">rhs</span></code> dadas por las últimas dos líneas del código que está en este ejercicio. Corrobora que obtienes los mismos resultados que con <em>SymPy</em>.</p>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>El POCE recuérdese es:</p>
<p><span class="math notranslate nohighlight">\(
\begin{eqnarray}
\displaystyle \min_{x \in \mathbb{R}^n} &amp;f_o(x)&amp; \nonumber \\
&amp;\text{sujeto a:}&amp; \nonumber\\
f_i(x) &amp;\leq&amp; 0  \quad i=1,\dots,m \nonumber \\
Ax &amp;=&amp; b
\end{eqnarray}
\)</span></p>
<p>y el PBL es:</p>
<p><span class="math notranslate nohighlight">\(
\displaystyle \min_{x \in \mathbb{R}^n} f_B(x|t_B) \\
\text{sujeto a:} \\
Ax = b
\)</span></p>
<p>con <span class="math notranslate nohighlight">\(A \in \mathbb{R}^{p \times n}\)</span> y <em>rank</em> de <span class="math notranslate nohighlight">\(A\)</span> igual a <span class="math notranslate nohighlight">\(p &lt; n\)</span>,</p>
<p><span class="math notranslate nohighlight">\(\begin{eqnarray}
f_B(x|t_B) &amp;=&amp; f_o(x) + \frac{1}{t_B} \phi(x) \nonumber \\
&amp;=&amp; f_o(x) -  \frac{1}{t_B} \displaystyle \sum_{i=1}^m \log(-f_i(x))
\end{eqnarray}
\)</span>.</p>
</div>
<div class="admonition-comentarios admonition">
<p class="admonition-title">Comentarios</p>
<ul class="simple">
<li><p>La forma general de la condición de KKT de optimalidad <span class="math notranslate nohighlight">\(\nabla_x \mathcal{L}_B(x^, \nu) = 0\)</span> para un PBL que se obtuvo de un POCE es:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
\nabla_x \mathcal{L}_B(x, \nu) &amp;=&amp; \nabla f_o(x) + \frac{1}{t_B}\nabla \phi(x) + A^T \nu = 0 \nonumber \\
&amp;=&amp; \nabla f_o(x) + \frac{1}{t_B} \displaystyle \sum_{i=1}^m \frac{\nabla f_i(x)}{-f_i(x)} + A^T \nu \nonumber \\
\end{eqnarray}
\end{split}\]</div>
<p>con: <span class="math notranslate nohighlight">\(\mathcal{L}: \mathbb{R}^n \times \mathbb{R}^p \rightarrow \mathbb{R}\)</span>,</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{eqnarray} \mathcal{L}_B(x, \nu) &amp;=&amp; f_{B}(x|t_B) + \sum_{i=1}^p \nu_i h_i(x) \nonumber \\
&amp;=&amp; f_o(x|t_B) + \frac{1}{t_B} \phi(x) + \nu^T(b-Ax)
\end{eqnarray}
\end{split}\]</div>
<p>y al aplicar el método de Newton al sistema de ecuaciones no lineales conduce a resolver el sistema de ecuaciones lineales siguiente:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\left [ \begin{array}{cc} \nabla^2f_o(x) + \frac{1}{t_B} \nabla^2 \phi(x)  &amp; -A^T \\ -A &amp; 0\end{array} \right ] \left [ \begin{array}{c} \Delta x \\ \Delta \nu \end{array} \right ] = -\left [ \begin{array}{c} \nabla f_o(x) + \frac{1}{t_B} \nabla \phi(x) \\ r_p \end{array} \right ]\end{split}\]</div>
<p>donde: <span class="math notranslate nohighlight">\(r_p = b - Ax\)</span> es el residual para factibilidad primal.</p>
<p>Ver <a class="reference internal" href="../../III.optimizacion_convexa/3.3/Ejemplos_problemas_UCO_e_intro_CIEO_y_PI.html#funlagrangiana"><span class="std std-ref">la función Lagrangiana</span></a>.</p>
</div>
</div>
</div>
<div class="section" id="definicion-decremento-de-newton">
<h2>Definición decremento de Newton<a class="headerlink" href="#definicion-decremento-de-newton" title="Permalink to this headline">¶</a></h2>
<p>Para problemas de optimización convexos sin restricciones:</p>
<div class="math notranslate nohighlight">
\[\min_{x \in \mathbb{R}^n} f_o(x)\]</div>
<p>en los que utilizamos el método de Newton para resolverlos, se utiliza una cantidad en criterios de paro y en resultados de convergencia nombrada el decremento de Newton.</p>
<div class="admonition-definicion admonition">
<p class="admonition-title">Definición</p>
<p>El decremento de Newton para <span class="math notranslate nohighlight">\(f_o: \mathbb{R}^n \rightarrow \mathbb{R}\)</span> en <span class="math notranslate nohighlight">\(x\)</span> es la cantidad:</p>
<div class="math notranslate nohighlight">
\[\lambda(x) = (\nabla f_o(x)^T \nabla^2f_o(x)^{-1} \nabla f_o(x))^{1/2}\]</div>
<p>en donde se asume que <span class="math notranslate nohighlight">\(f_o \in \mathcal{C}^2(\text{dom}f_o)\)</span> y su Hessiana es definida positiva.</p>
</div>
<div class="admonition-comentarios admonition">
<p class="admonition-title">Comentarios</p>
<ul class="simple">
<li><p>Asumiendo que existe un punto óptimo <span class="math notranslate nohighlight">\(x^*\)</span> y el valor óptimo se denota por <span class="math notranslate nohighlight">\(p^* = f_o(x^*)\)</span> el decremento de Newton tiene propiedades como son:</p>
<ul>
<li><p><span class="math notranslate nohighlight">\(\frac{1}{2} \lambda ^2 (x)\)</span> estima <span class="math notranslate nohighlight">\(f_o(x)-p^*\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(|| \nabla^2 f_o(x)^{-1} \nabla f_o(x)||_{\nabla ^2f_o(x)} = \left ( \nabla f_o(x)^T \nabla^2 f_o(x)^{-1} \nabla ^2 f(x) \nabla ^2 f_o(x)^{-1} \nabla f_o(x) \right )^{1/2} = \lambda(x) \)</span> que indica que <span class="math notranslate nohighlight">\(\lambda(x)\)</span> es la norma del paso de Newton en la norma cuadrática definida por la Hessiana.</p></li>
<li><p>En el método de búsqueda de línea por <em>backtracking</em> <span class="math notranslate nohighlight">\(-\lambda (x) ^2\)</span> es la derivada direccional de <span class="math notranslate nohighlight">\(f_o\)</span> en <span class="math notranslate nohighlight">\(x\)</span> en la dirección de <span class="math notranslate nohighlight">\(\Delta x_{\text{nt}}\)</span>:</p></li>
</ul>
</li>
</ul>
<div class="math notranslate nohighlight">
\[\frac{df(x+t \Delta x_{\text{nt}})}{dt} \Bigr|_{t=0} = \nabla f_o(x)^T \Delta x_{\text{nt}} = \nabla f_o(x)^T (-\nabla^2 f_o(x)^{-1} \nabla f_o(x)) = -\lambda(x)^2\]</div>
<p>donde: <span class="math notranslate nohighlight">\(t\)</span> es el parámetro de búsqueda de línea por <em>backtracking</em>, <span class="math notranslate nohighlight">\(\Delta x_{\text{nt}} = -\nabla ^2 f_o(x)^{-1} \nabla f_o(x)\)</span> para <span class="math notranslate nohighlight">\(x \in \text{dom}f_o\)</span> es la dirección de Newton para <span class="math notranslate nohighlight">\(f_o\)</span> en <span class="math notranslate nohighlight">\(x\)</span>.</p>
<ul class="simple">
<li><p>En el método primal-dual para resolver un PBL el decremento de Newton se utiliza en las <em>inner iterations</em>.</p></li>
</ul>
</div>
</div>
<div class="section" id="algoritmo-primal-dual-de-bl-para-un-pl-con-unicamente-desigualdades">
<h2>Algoritmo primal-dual de BL para un PL con únicamente desigualdades<a class="headerlink" href="#algoritmo-primal-dual-de-bl-para-un-pl-con-unicamente-desigualdades" title="Permalink to this headline">¶</a></h2>
<p>Para un problema de la forma:</p>
<div class="math notranslate nohighlight">
\[\displaystyle \min_{x \in \mathbb{R}^n} c^Tx\]</div>
<div class="math notranslate nohighlight">
\[\text{sujeto a:}\]</div>
<div class="math notranslate nohighlight">
\[Ax \leq b\]</div>
<div class="math notranslate nohighlight">
\[x \geq 0\]</div>
<blockquote>
<div><p><strong>Dados</strong> <span class="math notranslate nohighlight">\(x\)</span> un punto estrictamente factible, esto es: <span class="math notranslate nohighlight">\(x &gt; 0\)</span>, <span class="math notranslate nohighlight">\(Ax &lt; b\)</span> (todas las entradas de <span class="math notranslate nohighlight">\(x\)</span> son positivas y <span class="math notranslate nohighlight">\(a_i^Tx &lt; b_i\)</span>), <span class="math notranslate nohighlight">\(t_B^{(0)}\)</span> parámetro de barrera, <span class="math notranslate nohighlight">\(\mu &gt; 1\)</span>, <span class="math notranslate nohighlight">\(tol &gt; 0\)</span>.</p>
<p><span class="math notranslate nohighlight">\(t_B:= t_B^{(0)}\)</span>.</p>
<p><strong>Repetir</strong> el siguiente bloque para <span class="math notranslate nohighlight">\(k=1,2,\dots\)</span></p>
<p><em><strong>Outer iterations</strong></em>:</p>
<blockquote>
<div><p><strong>Paso de centrado o <em>inner iterations</em></strong>:</p>
<p>Calcular <span class="math notranslate nohighlight">\(x^*(t_B)\)</span> que resuelva: <span class="math notranslate nohighlight">\(\displaystyle \min_{x \in \mathbb{R}^n} t_Bf_o(x) + \phi(x)\)</span> iniciando con <span class="math notranslate nohighlight">\(x\)</span>.</p>
<p>Utilizar criterio de paro para <em>inner iterations</em>.</p>
</div></blockquote>
<p>Actualizar <span class="math notranslate nohighlight">\(x:=x^*(t_B)\)</span>.</p>
<p>Incrementar <span class="math notranslate nohighlight">\(t_B\)</span> por <span class="math notranslate nohighlight">\(t_B=\mu t_B\)</span>.</p>
<p><strong>hasta</strong> convergencia: satisfacer criterio de paro en el que se utiliza <span class="math notranslate nohighlight">\(tol\)</span> y <span class="math notranslate nohighlight">\(maxiter\)</span>.</p>
</div></blockquote>
<div class="tip admonition">
<p class="admonition-title">Observación</p>
<p>Para un PL únicamente con desigualdades recuérdese:</p>
<div class="math notranslate nohighlight">
\[t_Bf_o(x) + \phi(x) = t_B c^Tx - \displaystyle \sum_{i=1}^m \log(-(a_i ^Tx-b_i)) - \sum_{i=1}^n \log(-{e}_i ^T(-x))\]</div>
<p>con <span class="math notranslate nohighlight">\(a_i\)</span> <span class="math notranslate nohighlight">\(i\)</span>-ésimo renglón de <span class="math notranslate nohighlight">\(A\)</span>.</p>
</div>
<div class="admonition-comentarios admonition">
<p class="admonition-title">Comentarios</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\mu\)</span> es un parámetro que realiza un <em>trade-off</em> en el número de <em>inner</em> y <em>outer iterations</em>. Controla el seguimiento de la trayectoria central en las <em>inner iterations</em>. Valores grandes causan un mayor número de <em>inner iterations</em> y valores cercanos a <span class="math notranslate nohighlight">\(1\)</span> causan un mayor número de <em>outer iterations</em>.</p></li>
<li><p>La elección de <span class="math notranslate nohighlight">\(t_B^{(0)}\)</span> ayuda a dar una estimación del recíproco de la <em>duality gap</em> (recuérdese que la estimación en un PBL-PLE es <span class="math notranslate nohighlight">\(\frac{n}{t_B}\)</span>). Es similar el efecto que con el parámetro <span class="math notranslate nohighlight">\(\mu\)</span>. Valores grandes causan que se realicen mayor número de <em>inner iterations</em> y valores pequeños un mayor número de <em>outer iterations</em>.</p></li>
<li><p>El criterio de paro de las <em>outer iterations</em> en un PBL-PLE es de la forma:</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">while</span> <span class="n">n</span><span class="o">/</span><span class="n">t_B</span> <span class="o">&gt;</span> <span class="n">tol</span> <span class="o">&amp;&amp;</span> <span class="n">iterations</span> <span class="o">&lt;</span> <span class="n">max_iters</span>
</pre></div>
</div>
<p>y el de las <em>inner iterations</em> es de la forma:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">while</span> <span class="n">dec_Newton</span><span class="o">/</span><span class="mi">2</span> <span class="o">&gt;</span> <span class="n">tol</span> <span class="o">&amp;&amp;</span> <span class="n">iterations</span> <span class="o">&lt;</span> <span class="n">max_iters</span>
</pre></div>
</div>
<p>con <code class="docutils literal notranslate"><span class="pre">dec_Newton/2</span></code> el decremento de Newton, <code class="docutils literal notranslate"><span class="pre">tol</span></code> una cantidad pequeña y positiva (comúnmente menor o igual a 10−8), <code class="docutils literal notranslate"><span class="pre">iterations</span></code> un contador de iteraciones.</p>
<ul class="simple">
<li><p>El algoritmo también puede regresar estimaciones para <span class="math notranslate nohighlight">\(\lambda\)</span> con <span class="math notranslate nohighlight">\(\lambda^*(t_B)\)</span> y <span class="math notranslate nohighlight">\(\nu\)</span> dada por <span class="math notranslate nohighlight">\(\nu^*(t_B)\)</span>.</p></li>
</ul>
</div>
</div>
<div class="section" id="metodo-primal-dual-de-bl-aplicado-al-ejemplo-prototipo-completo">
<h2>Método primal-dual de BL aplicado al ejemplo prototipo (completo)<a class="headerlink" href="#metodo-primal-dual-de-bl-aplicado-al-ejemplo-prototipo-completo" title="Permalink to this headline">¶</a></h2>
<p>Problema de optimización:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\displaystyle \max_{x \in \mathbb{R}^2} 3x_1 + 5x_2\\
\text{sujeto a: } \\
x_1 \leq 4 \nonumber    \\
2x_2 \leq 12            \\
3x_1 + 2x_2 \leq 18     \\
x_1 \geq 0              \\
x_2 \geq 0              \\
\end{split}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tol_outer_iter</span> <span class="o">=</span> <span class="mf">1e-6</span>
<span class="n">tol</span><span class="o">=</span><span class="mf">1e-8</span>
<span class="n">tol_backtracking</span><span class="o">=</span><span class="mf">1e-12</span>
<span class="n">max_inner_iter</span><span class="o">=</span><span class="mi">30</span>
<span class="n">mu</span><span class="o">=</span><span class="mi">10</span>
<span class="n">x_ast</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<span class="n">p_ast</span> <span class="o">=</span> <span class="n">fo</span><span class="p">(</span><span class="n">x_ast</span><span class="p">)</span> 
</pre></div>
</div>
</div>
</div>
<p>Se utiliza la función <a class="reference external" href="https://analisis-numerico-computo-cientifico.readthedocs.io/en/latest/_autosummary/opt.logarithmic_barrier.linear_program_inequalities.primal_dual_method.html#opt.logarithmic_barrier.linear_program_inequalities.primal_dual_method">primal_dual_method</a> del paquete <a class="reference external" href="https://analisis-numerico-computo-cientifico.readthedocs.io/en/latest/">opt</a> en la siguiente celda:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">opt.logarithmic_barrier.linear_program_inequalities</span> <span class="kn">import</span> <span class="n">primal_dual_method</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="n">total_iter</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">x_plot</span><span class="p">]</span> <span class="o">=</span> <span class="n">primal_dual_method</span><span class="p">(</span><span class="n">fo</span><span class="p">,</span> <span class="n">constraints_ineq</span><span class="p">,</span>
                                             <span class="n">x_0</span><span class="p">,</span> <span class="n">tol</span><span class="p">,</span>
                                             <span class="n">tol_backtracking</span><span class="p">,</span>
                                             <span class="n">t_B_0</span><span class="p">,</span>
                                             <span class="n">x_ast</span><span class="o">=</span><span class="n">x_ast</span><span class="p">,</span> 
                                             <span class="n">p_ast</span><span class="o">=</span><span class="n">p_ast</span><span class="p">,</span> 
                                             <span class="n">max_inner_iter</span><span class="o">=</span><span class="n">max_inner_iter</span><span class="p">,</span>
                                             <span class="n">mu</span><span class="o">=</span><span class="n">mu</span><span class="p">,</span> 
                                             <span class="n">tol_outer_iter</span><span class="o">=</span><span class="n">tol_outer_iter</span><span class="p">,</span>
                                             <span class="n">gf_B</span><span class="o">=</span><span class="n">gf_B</span><span class="p">,</span>
                                             <span class="n">Hf_B</span><span class="o">=</span><span class="n">Hf_B</span><span class="p">,</span>
                                             <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Outer iterations of primal-dual LB method
Mu value: 1.00e+01
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Outer iter</th>
      <th>logbarrier</th>
      <th>t_log_barrier</th>
      <th>duality gap</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>row0</th>
      <td>0</td>
      <td>-1.36e+02</td>
      <td>10</td>
      <td>5.00e-01</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-----------------------------------------------------------------
-----------------------------------------------------------------
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Iter</th>
      <th>Normgf_B</th>
      <th>Newtons decrement</th>
      <th>Err x ast</th>
      <th>Err p ast</th>
      <th>line search</th>
      <th>CondHf_B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>row0</th>
      <td>0</td>
      <td>5.86e+01</td>
      <td>7.71e+03</td>
      <td>6.52e-01</td>
      <td>6.39e-01</td>
      <td>---</td>
      <td>3.47e+00</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/miuser/.local/lib/python3.7/site-packages/opt/utils_logarithmic_barrier.py:17: RuntimeWarning: invalid value encountered in log
  eval_f_const_inequality = np.log(eval_f_const_inequality)
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Iter</th>
      <th>Normgf_B</th>
      <th>Newtons decrement</th>
      <th>Err x ast</th>
      <th>Err p ast</th>
      <th>line search</th>
      <th>CondHf_B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>row1</th>
      <td>1</td>
      <td>5.77e+01</td>
      <td>5.02e+03</td>
      <td>3.02e-01</td>
      <td>3.05e-01</td>
      <td>1.56e-02</td>
      <td>2.46e+00</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/miuser/.local/lib/python3.7/site-packages/opt/utils_logarithmic_barrier.py:17: RuntimeWarning: invalid value encountered in log
  eval_f_const_inequality = np.log(eval_f_const_inequality)
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Iter</th>
      <th>Normgf_B</th>
      <th>Newtons decrement</th>
      <th>Err x ast</th>
      <th>Err p ast</th>
      <th>line search</th>
      <th>CondHf_B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>row2</th>
      <td>2</td>
      <td>5.42e+01</td>
      <td>4.06e+02</td>
      <td>9.32e-02</td>
      <td>8.41e-02</td>
      <td>1.56e-02</td>
      <td>4.99e+00</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/miuser/.local/lib/python3.7/site-packages/opt/utils_logarithmic_barrier.py:17: RuntimeWarning: invalid value encountered in log
  eval_f_const_inequality = np.log(eval_f_const_inequality)
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Iter</th>
      <th>Normgf_B</th>
      <th>Newtons decrement</th>
      <th>Err x ast</th>
      <th>Err p ast</th>
      <th>line search</th>
      <th>CondHf_B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>row3</th>
      <td>3</td>
      <td>5.14e+01</td>
      <td>1.17e+02</td>
      <td>4.69e-02</td>
      <td>4.69e-02</td>
      <td>3.12e-02</td>
      <td>3.79e+00</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/miuser/.local/lib/python3.7/site-packages/opt/utils_logarithmic_barrier.py:17: RuntimeWarning: invalid value encountered in log
  eval_f_const_inequality = np.log(eval_f_const_inequality)
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Iter</th>
      <th>Normgf_B</th>
      <th>Newtons decrement</th>
      <th>Err x ast</th>
      <th>Err p ast</th>
      <th>line search</th>
      <th>CondHf_B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>row4</th>
      <td>4</td>
      <td>4.51e+01</td>
      <td>2.27e+01</td>
      <td>2.39e-02</td>
      <td>2.42e-02</td>
      <td>6.25e-02</td>
      <td>3.51e+00</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/miuser/.local/lib/python3.7/site-packages/opt/utils_logarithmic_barrier.py:17: RuntimeWarning: invalid value encountered in log
  eval_f_const_inequality = np.log(eval_f_const_inequality)
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Iter</th>
      <th>Normgf_B</th>
      <th>Newtons decrement</th>
      <th>Err x ast</th>
      <th>Err p ast</th>
      <th>line search</th>
      <th>CondHf_B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>row5</th>
      <td>5</td>
      <td>3.39e+01</td>
      <td>2.35e-01</td>
      <td>4.36e-03</td>
      <td>3.81e-03</td>
      <td>2.50e-01</td>
      <td>5.96e+00</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Iter</th>
      <th>Normgf_B</th>
      <th>Newtons decrement</th>
      <th>Err x ast</th>
      <th>Err p ast</th>
      <th>line search</th>
      <th>CondHf_B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>row6</th>
      <td>6</td>
      <td>9.93e+00</td>
      <td>4.36e-02</td>
      <td>5.15e-03</td>
      <td>4.89e-03</td>
      <td>1</td>
      <td>4.43e+00</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Iter</th>
      <th>Normgf_B</th>
      <th>Newtons decrement</th>
      <th>Err x ast</th>
      <th>Err p ast</th>
      <th>line search</th>
      <th>CondHf_B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>row7</th>
      <td>7</td>
      <td>1.63e+00</td>
      <td>1.83e-03</td>
      <td>5.46e-03</td>
      <td>5.42e-03</td>
      <td>1</td>
      <td>3.80e+00</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Iter</th>
      <th>Normgf_B</th>
      <th>Newtons decrement</th>
      <th>Err x ast</th>
      <th>Err p ast</th>
      <th>line search</th>
      <th>CondHf_B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>row8</th>
      <td>8</td>
      <td>6.61e-02</td>
      <td>3.35e-06</td>
      <td>5.53e-03</td>
      <td>5.53e-03</td>
      <td>1</td>
      <td>3.70e+00</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Iter</th>
      <th>Normgf_B</th>
      <th>Newtons decrement</th>
      <th>Err x ast</th>
      <th>Err p ast</th>
      <th>line search</th>
      <th>CondHf_B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>row9</th>
      <td>9</td>
      <td>1.21e-04</td>
      <td>1.12e-11</td>
      <td>5.53e-03</td>
      <td>5.54e-03</td>
      <td>1</td>
      <td>3.69e+00</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Error of x with respect to x_ast: 5.53e-03
Approximate solution: [1.989 5.967]
</pre></div>
</div>
<img alt="../../_images/Metodo_primal_dual_de_BL_223_19.png" src="../../_images/Metodo_primal_dual_de_BL_223_19.png" />
<img alt="../../_images/Metodo_primal_dual_de_BL_223_20.png" src="../../_images/Metodo_primal_dual_de_BL_223_20.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Inner iterations
[1.989 5.967]
-----------------------------------------------------------------
-----------------------------------------------------------------
Outer iterations of primal-dual LB method
Mu value: 1.00e+01
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Outer iter</th>
      <th>logbarrier</th>
      <th>t_log_barrier</th>
      <th>duality gap</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>row1</th>
      <td>1</td>
      <td>-3.58e+03</td>
      <td>100</td>
      <td>5.00e-02</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-----------------------------------------------------------------
-----------------------------------------------------------------
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Iter</th>
      <th>Normgf_B</th>
      <th>Newtons decrement</th>
      <th>Err x ast</th>
      <th>Err p ast</th>
      <th>line search</th>
      <th>CondHf_B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>row0</th>
      <td>0</td>
      <td>5.25e+02</td>
      <td>1.61e+02</td>
      <td>5.53e-03</td>
      <td>5.54e-03</td>
      <td>---</td>
      <td>3.69e+00</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/miuser/.local/lib/python3.7/site-packages/opt/utils_logarithmic_barrier.py:17: RuntimeWarning: invalid value encountered in log
  eval_f_const_inequality = np.log(eval_f_const_inequality)
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Iter</th>
      <th>Normgf_B</th>
      <th>Newtons decrement</th>
      <th>Err x ast</th>
      <th>Err p ast</th>
      <th>line search</th>
      <th>CondHf_B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>row1</th>
      <td>1</td>
      <td>4.50e+02</td>
      <td>2.28e+01</td>
      <td>2.43e-03</td>
      <td>2.43e-03</td>
      <td>6.25e-02</td>
      <td>3.71e+00</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/miuser/.local/lib/python3.7/site-packages/opt/utils_logarithmic_barrier.py:17: RuntimeWarning: invalid value encountered in log
  eval_f_const_inequality = np.log(eval_f_const_inequality)
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Iter</th>
      <th>Normgf_B</th>
      <th>Newtons decrement</th>
      <th>Err x ast</th>
      <th>Err p ast</th>
      <th>line search</th>
      <th>CondHf_B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>row2</th>
      <td>2</td>
      <td>2.75e+02</td>
      <td>2.06e-01</td>
      <td>3.76e-04</td>
      <td>3.77e-04</td>
      <td>2.50e-01</td>
      <td>3.68e+00</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Iter</th>
      <th>Normgf_B</th>
      <th>Newtons decrement</th>
      <th>Err x ast</th>
      <th>Err p ast</th>
      <th>line search</th>
      <th>CondHf_B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>row3</th>
      <td>3</td>
      <td>6.68e+01</td>
      <td>2.12e-02</td>
      <td>4.98e-04</td>
      <td>4.98e-04</td>
      <td>1</td>
      <td>3.69e+00</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Iter</th>
      <th>Normgf_B</th>
      <th>Newtons decrement</th>
      <th>Err x ast</th>
      <th>Err p ast</th>
      <th>line search</th>
      <th>CondHf_B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>row4</th>
      <td>4</td>
      <td>6.23e+00</td>
      <td>2.26e-04</td>
      <td>5.49e-04</td>
      <td>5.50e-04</td>
      <td>1</td>
      <td>3.70e+00</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Iter</th>
      <th>Normgf_B</th>
      <th>Newtons decrement</th>
      <th>Err x ast</th>
      <th>Err p ast</th>
      <th>line search</th>
      <th>CondHf_B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>row5</th>
      <td>5</td>
      <td>6.54e-02</td>
      <td>2.58e-08</td>
      <td>5.55e-04</td>
      <td>5.55e-04</td>
      <td>1</td>
      <td>3.70e+00</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Iter</th>
      <th>Normgf_B</th>
      <th>Newtons decrement</th>
      <th>Err x ast</th>
      <th>Err p ast</th>
      <th>line search</th>
      <th>CondHf_B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>row6</th>
      <td>6</td>
      <td>7.40e-06</td>
      <td>3.42e-16</td>
      <td>5.55e-04</td>
      <td>5.55e-04</td>
      <td>1</td>
      <td>3.70e+00</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Error of x with respect to x_ast: 5.55e-04
Approximate solution: [1.999 5.997]
</pre></div>
</div>
<img alt="../../_images/Metodo_primal_dual_de_BL_223_34.png" src="../../_images/Metodo_primal_dual_de_BL_223_34.png" />
<img alt="../../_images/Metodo_primal_dual_de_BL_223_35.png" src="../../_images/Metodo_primal_dual_de_BL_223_35.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Inner iterations
[1.999 5.997]
-----------------------------------------------------------------
-----------------------------------------------------------------
Outer iterations of primal-dual LB method
Mu value: 1.00e+01
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Outer iter</th>
      <th>logbarrier</th>
      <th>t_log_barrier</th>
      <th>duality gap</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>row2</th>
      <td>2</td>
      <td>-3.60e+04</td>
      <td>1000</td>
      <td>5.00e-03</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-----------------------------------------------------------------
-----------------------------------------------------------------
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Iter</th>
      <th>Normgf_B</th>
      <th>Newtons decrement</th>
      <th>Err x ast</th>
      <th>Err p ast</th>
      <th>line search</th>
      <th>CondHf_B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>row0</th>
      <td>0</td>
      <td>5.25e+03</td>
      <td>1.62e+02</td>
      <td>5.55e-04</td>
      <td>5.55e-04</td>
      <td>---</td>
      <td>3.70e+00</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/miuser/.local/lib/python3.7/site-packages/opt/utils_logarithmic_barrier.py:17: RuntimeWarning: invalid value encountered in log
  eval_f_const_inequality = np.log(eval_f_const_inequality)
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Iter</th>
      <th>Normgf_B</th>
      <th>Newtons decrement</th>
      <th>Err x ast</th>
      <th>Err p ast</th>
      <th>line search</th>
      <th>CondHf_B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>row1</th>
      <td>1</td>
      <td>4.50e+03</td>
      <td>2.28e+01</td>
      <td>2.43e-04</td>
      <td>2.43e-04</td>
      <td>6.25e-02</td>
      <td>3.71e+00</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/miuser/.local/lib/python3.7/site-packages/opt/utils_logarithmic_barrier.py:17: RuntimeWarning: invalid value encountered in log
  eval_f_const_inequality = np.log(eval_f_const_inequality)
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Iter</th>
      <th>Normgf_B</th>
      <th>Newtons decrement</th>
      <th>Err x ast</th>
      <th>Err p ast</th>
      <th>line search</th>
      <th>CondHf_B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>row2</th>
      <td>2</td>
      <td>2.70e+03</td>
      <td>2.01e-01</td>
      <td>3.79e-05</td>
      <td>3.80e-05</td>
      <td>2.50e-01</td>
      <td>3.70e+00</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Iter</th>
      <th>Normgf_B</th>
      <th>Newtons decrement</th>
      <th>Err x ast</th>
      <th>Err p ast</th>
      <th>line search</th>
      <th>CondHf_B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>row3</th>
      <td>3</td>
      <td>6.50e+02</td>
      <td>2.02e-02</td>
      <td>5.00e-05</td>
      <td>5.00e-05</td>
      <td>1</td>
      <td>3.70e+00</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Iter</th>
      <th>Normgf_B</th>
      <th>Newtons decrement</th>
      <th>Err x ast</th>
      <th>Err p ast</th>
      <th>line search</th>
      <th>CondHf_B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>row4</th>
      <td>4</td>
      <td>5.93e+01</td>
      <td>2.03e-04</td>
      <td>5.50e-05</td>
      <td>5.50e-05</td>
      <td>1</td>
      <td>3.71e+00</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Iter</th>
      <th>Normgf_B</th>
      <th>Newtons decrement</th>
      <th>Err x ast</th>
      <th>Err p ast</th>
      <th>line search</th>
      <th>CondHf_B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>row5</th>
      <td>5</td>
      <td>5.92e-01</td>
      <td>2.06e-08</td>
      <td>5.55e-05</td>
      <td>5.55e-05</td>
      <td>1</td>
      <td>3.71e+00</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Iter</th>
      <th>Normgf_B</th>
      <th>Newtons decrement</th>
      <th>Err x ast</th>
      <th>Err p ast</th>
      <th>line search</th>
      <th>CondHf_B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>row6</th>
      <td>6</td>
      <td>6.00e-05</td>
      <td>2.13e-16</td>
      <td>5.56e-05</td>
      <td>5.56e-05</td>
      <td>1</td>
      <td>3.71e+00</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Error of x with respect to x_ast: 5.56e-05
Approximate solution: [2. 6.]
</pre></div>
</div>
<img alt="../../_images/Metodo_primal_dual_de_BL_223_49.png" src="../../_images/Metodo_primal_dual_de_BL_223_49.png" />
<img alt="../../_images/Metodo_primal_dual_de_BL_223_50.png" src="../../_images/Metodo_primal_dual_de_BL_223_50.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Inner iterations
[2. 6.]
-----------------------------------------------------------------
-----------------------------------------------------------------
Outer iterations of primal-dual LB method
Mu value: 1.00e+01
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Outer iter</th>
      <th>logbarrier</th>
      <th>t_log_barrier</th>
      <th>duality gap</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>row3</th>
      <td>3</td>
      <td>-3.60e+05</td>
      <td>10000</td>
      <td>5.00e-04</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-----------------------------------------------------------------
-----------------------------------------------------------------
</pre></div>
</div>
</div>
</div>
<div class="tip admonition">
<p class="admonition-title">Observación</p>
<p>Obsérvese que se realizan más iteraciones con el método primal-dual para este ejemplo prototipo que con el método símplex.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">opt.utils_logarithmic_barrier</span> <span class="kn">import</span> <span class="n">plot_central_path</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">x1_p</span><span class="p">,</span> <span class="n">x2_p</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">6.5</span><span class="p">)</span>

<span class="c1">#level curves for fo</span>
<span class="n">x_1_line_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">x_2_line_1</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">5</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">x_1_line_1</span> <span class="o">+</span> <span class="mi">23</span><span class="p">)</span>
<span class="n">x_1_line_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">x_2_line_2</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">5</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">x_1_line_2</span> <span class="o">+</span> <span class="mi">29</span><span class="p">)</span>
<span class="n">x_1_line_3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">x_2_line_3</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">5</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">x_1_line_3</span> <span class="o">+</span> <span class="mi">36</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_1_line_1</span><span class="p">,</span> <span class="n">x_2_line_1</span><span class="p">,</span> <span class="s2">&quot;green&quot;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;_nolegend_&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_1_line_2</span><span class="p">,</span> <span class="n">x_2_line_2</span><span class="p">,</span> <span class="s2">&quot;indigo&quot;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;_nolegend_&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_1_line_3</span><span class="p">,</span> <span class="n">x_2_line_3</span><span class="p">,</span> <span class="s2">&quot;darkturquoise&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;_nolegend_&quot;</span><span class="p">)</span>


<span class="c1">#central path</span>
<span class="n">plot_central_path</span><span class="p">(</span><span class="n">x_plot</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Metodo_primal_dual_de_BL_226_0.png" src="../../_images/Metodo_primal_dual_de_BL_226_0.png" />
</div>
</div>
<div class="admonition-comentario admonition">
<p class="admonition-title">Comentario</p>
<p>En <strong>este ejemplo</strong> las curvas de nivel de la función objetivo <span class="math notranslate nohighlight">\(f_o\)</span> representadas con rectas en la gráfica anterior son tangentes a las curvas de nivel de <span class="math notranslate nohighlight">\(\phi\)</span> en <span class="math notranslate nohighlight">\(x^*(t_B)\)</span> pues: <span class="math notranslate nohighlight">\(t_B \nabla f_o(x^*(t_B)) + \nabla \phi(x^*(t_B)) = 0\)</span> por lo que:</p>
<div class="math notranslate nohighlight">
\[\nabla \phi(x^*(t_B)) = -t_B \nabla f_o(x^*(t_B)) = -t_Bc\]</div>
</div>
<div class="tip admonition">
<p class="admonition-title">Ejercicio</p>
<p>Resolver el siguiente problema con el método primal-dual de BL y corrobora con algún software tu respuesta:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\displaystyle \min_{x \in \mathbb{R}^2} x_1 + x_2 - 4x_3\\
\text{sujeto a:} \\
x_1 + x_2 + 2x_3 \leq 9 \nonumber    \\
x_1 + x_2 - x_3 \leq 2 \nonumber \\
-x_1 + x_2 + x_3 \leq 4 \nonumber \\
x_1 \geq 0, x_2 \geq 0, x_3 \geq 0
\end{split}\]</div>
</div>
<div class="admonition-comentario admonition">
<p class="admonition-title">Comentario</p>
<p>El método primal-dual puede modificarse para el caso en el que se tengan puntos no primal-dual factibles. En este caso se le nombra <em>path following method</em>.</p>
</div>
<div class="tip admonition">
<p class="admonition-title">Ejercicios</p>
<p>1.Resuelve los ejercicios y preguntas de la nota.</p>
</div>
<p><strong>Preguntas de comprehensión</strong></p>
<p>1)¿Qué es un método por puntos interiores?</p>
<p>2)¿Qué se busca con el método primal-dual y cuáles son las ideas que se utilizan para su desarrollo?</p>
<p>3)¿Por qué al método primal-dual se le nombra así?</p>
<p>4)¿Qué efecto y ventajas tienen añadir funciones de barrera que penalizan al no satisfacer las restricciones de desigualdad de un problema de optimización?</p>
<p>5)¿Qué propiedades se buscan que satisfagan las funciones de barrera?</p>
<p>6)¿Por qué se elige el método de Newton para resolver el problema PBL?</p>
<p>7)¿Qué son los puntos centrales y la trayectoria central?</p>
<p>8)¿Qué relación existe entre las condiciones KKT de optimalidad del PLE y las del PBL-PLE?</p>
<p>9)¿Cómo se define y qué propiedades tiene el decremento de Newton?</p>
<p>10)Explica la tarea que tienen los parámetros <span class="math notranslate nohighlight">\(\mu\)</span> y <span class="math notranslate nohighlight">\(t_B\)</span> en el problema PBL. Puedes apoyar tu respuesta considerando el efecto que resulta de elegir valores grandes, pequeños de tales parámetros.</p>
<p><strong>Referencias:</strong></p>
<ol class="simple">
<li><p>S. P. Boyd, L. Vandenberghe, Convex Optimization, Cambridge University Press, 2009.</p></li>
<li><p>J. Nocedal, S. J. Wright, Numerical Optimization, Springer, 2006.</p></li>
<li><p>F. Hillier, G. Lieberman, Introduction to Operations Research, Mc Graw Hill, 2014.</p></li>
</ol>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "palmoreck/dockerfiles-for-binder",
            ref: "jupyterlab_optimizacion_2",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./IV.optimizacion_en_redes_y_prog_lineal/4.5"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="../4.4/Dualidad_lema_de_Farkas_condiciones_KKT_de_optimalidad.html" title="previous page">4.4 Dualidad, lema de Farkas y condiciones de Karush-Kuhn-Tucker (KKT) de optimalidad</a>
    <a class='right-next' id="next-link" href="../../V.optimizacion_de_codigo/5.1/introduccion_optimizacion_de_codigo.html" title="next page">5.1 Introducción a optimización de código</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Erick Palacios Moreno<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../../_static/js/index.3da636dd464baa7582d2.js"></script>


    
  </body>
</html>