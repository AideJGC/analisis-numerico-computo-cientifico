
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>4.5 Método primal-dual de barrera logarítmica (BL)</title>
    
  <link rel="stylesheet" href="../../_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe,.cell"
        const thebe_selector_input = "pre,.cell_input div.highlight"
        const thebe_selector_output = ".output,.cell_output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="5.1 Introducción optimización de código" href="../../V.optimizacion_de_codigo/5.1/introduccion_optimizacion_de_codigo.html" />
    <link rel="prev" title="4.4 Dualidad, lema de Farkas y condiciones de Karush-Kuhn-Tucker (KKT) de optimalidad" href="../4.4/Dualidad_lema_de_Farkas_condiciones_KKT_de_optimalidad.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../../index.html">
  
  <img src="../../_static/logo.png" class="logo" alt="logo">
  
  
</a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../README.html">
   Optimización
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  I. Cómputo científico
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../I.computo_cientifico/1.1/Analisis_numerico_y_computo_cientifico.html">
   1.1 Análisis numérico y cómputo científico
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../I.computo_cientifico/1.2/Sistema_de_punto_flotante.html">
   1.2 Sistema de punto flotante
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../I.computo_cientifico/1.3/Normas_vectoriales_y_matriciales.html">
   1.3 Normas vectoriales y matriciales
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../I.computo_cientifico/1.4/Condicion_de_un_problema_y_estabilidad_de_un_algoritmo.html">
   1.4 Condición de un problema y estabilidad de un algoritmo
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../I.computo_cientifico/1.5/Definicion_de_funcion_continuidad_derivada.html">
   1.5 Definición de función, continuidad y derivada
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../I.computo_cientifico/1.6/Polinomios_de_Taylor_y_diferenciacion_numerica.html">
   1.6 Polinomios de Taylor y diferenciación numérica
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../I.computo_cientifico/1.7/Integracion_numerica.html">
   1.7 Integración Numérica
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  II. Cómputo matricial
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../II.computo_matricial/2.1/Operaciones_y_transformaciones_basicas_del_Algebra_Lineal_Numerica.html">
   2.1 Operaciones y transformaciones básicas del Álgebra Lineal Numérica
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../II.computo_matricial/2.2/Eigenvalores_y_eigenvectores.html">
   2.2 Eigenvalores y eigenvectores
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../II.computo_matricial/2.3/Algoritmos_y_aplicaciones_de_eigenvalores_eigenvectores_de_una_matriz.html">
   2.3 Algoritmos y aplicaciones de eigenvalores y eigenvectores de una matriz
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../II.computo_matricial/2.4/Valores_vectores_singulares_y_algoritmos_para_calcular_la_SVD.html">
   2.4 Valores, vectores singulares y algoritmos para calcular la SVD
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  III. Optimización convexa y ecuaciones no lineales
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../III.optimizacion_convexa/3.1/Definicion_de_problema_optimizacion_conjuntos_y_funciones_convexas.html">
   3.1 Definición de problemas de optimización, conjuntos y funciones convexas
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../III.optimizacion_convexa/3.2/Algoritmos_de_descenso_y_busqueda_de_linea_en_uco.html">
   3.2 Algoritmos de descenso y búsqueda de línea en
   <em>
    Unconstrained Convex Optimization
   </em>
   (UCO)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../III.optimizacion_convexa/3.3/Ejemplos_problemas_UCO_e_intro_CIEO_y_PI.html">
   3.3 Ejemplos de problemas UCO, introducción a
   <em>
    Constrained Inequality and Equality Optimization
   </em>
   (CIEO) y puntos interiores
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../III.optimizacion_convexa/3.4/Ecuaciones_no_lineales.html">
   3.4 Ecuaciones no lineales
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  IV. Optimización en redes y programación lineal
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../4.1/Definiciones_generales_de_flujo_en_redes.html">
   4.1 Definiciones generales de flujo en redes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../4.2/Programacion_lineal_y_metodo_simplex.html">
   4.2 Programación lineal (PL) y método símplex
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../4.3/Ejemplo_metodo_simplex_de_redes.html">
   4.3 Ejemplo del método símplex de redes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../4.4/Dualidad_lema_de_Farkas_condiciones_KKT_de_optimalidad.html">
   4.4 Dualidad, lema de Farkas y condiciones de Karush-Kuhn-Tucker (KKT) de optimalidad
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   4.5 Método primal-dual de barrera logarítmica (BL)
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  V. Optimización de código
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../V.optimizacion_de_codigo/5.1/introduccion_optimizacion_de_codigo.html">
   5.1 Introducción optimización de código
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  VI. Algoritmos de optimización convexa
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../VI.algoritmos_optimizacion_convexa/6.1/Problemas_UCO.html">
   6.1 Problemas tipo
   <em>
    Unconstrained Convex Optimization
   </em>
   (UCO)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../VI.algoritmos_optimizacion_convexa/6.2/Problemas_CECO.html">
   6.2 Problemas tipo
   <em>
    Constrained Equality Convex Optimization
   </em>
   (CECO)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../VI.algoritmos_optimizacion_convexa/6.3/Problemas_CIECO.html">
   6.3 Problemas tipo
   <em>
    Constrained Equality and Inequality Convex Optimization
   </em>
   (CIECO)
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/IV.optimizacion_en_redes_y_prog_lineal/4.5/Metodo_primal_dual_de_BL.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/palmoreck/dockerfiles-for-binder/jupyterlab_optimizacion_2?urlpath=lab/tree/analisis-numerico-computo-cientifico/libro_optimizacion/temas/IV.optimizacion_en_redes_y_prog_lineal/4.5/Metodo_primal_dual_de_BL.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <button type="button" class="btn btn-secondary topbarbtn"
            onclick="initThebeSBT()" title="Launch Thebe" data-toggle="tooltip" data-placement="left"><i
                class="fas fa-play"></i><span style="margin-left: .4em;">Live Code</span></button>
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#metodos-por-puntos-interiores-pi">
   Métodos por puntos interiores (PI)
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#metodo-primal-dual">
   Método primal-dual
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#primera-idea-determinar-la-direccion-de-busqueda">
     Primera idea: determinar la dirección de búsqueda
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#segunda-idea-cortar-el-paso">
     Segunda idea: cortar el paso
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id1">
   Método primal-dual de barrera logarítmica (BL)
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#tercera-idea-reducir-la-duality-gap-y-centrar-uso-de-la-funcion-de-barrera-logaritmica-fbl">
     Tercera idea: reducir la
     <em>
      duality gap
     </em>
     y centrar. Uso de la función de barrera logarítmica (FBL)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#trayectoria-central-determinada-por-los-puntos-centrales">
     Trayectoria central determinada por los puntos centrales
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#relacion-entre-las-condiciones-kkt-de-optimalidad-del-ple-y-las-del-pbl-ple">
     Relación entre las condiciones KKT de optimalidad del PLE y las del PBL-PLE
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#como-calcular-los-puntos-centrales">
     ¿Cómo calcular los puntos centrales?
    </a>
   </li>
  </ul>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="metodo-primal-dual-de-barrera-logaritmica-bl">
<span id="mprimaldualbarreralog"></span><h1>4.5 Método primal-dual de barrera logarítmica (BL)<a class="headerlink" href="#metodo-primal-dual-de-barrera-logaritmica-bl" title="Permalink to this headline">¶</a></h1>
<div class="admonition-notas-para-contenedor-de-docker admonition">
<p class="admonition-title">Notas para contenedor de docker:</p>
<p>Comando de docker para ejecución de la nota de forma local:</p>
<p>nota: cambiar <code class="docutils literal notranslate"><span class="pre">&lt;ruta</span> <span class="pre">a</span> <span class="pre">mi</span> <span class="pre">directorio&gt;</span></code> por la ruta de directorio que se desea mapear a <code class="docutils literal notranslate"><span class="pre">/datos</span></code> dentro del contenedor de docker.</p>
<p><code class="docutils literal notranslate"><span class="pre">docker</span> <span class="pre">run</span> <span class="pre">--rm</span> <span class="pre">-v</span> <span class="pre">&lt;ruta</span> <span class="pre">a</span> <span class="pre">mi</span> <span class="pre">directorio&gt;:/datos</span> <span class="pre">--name</span> <span class="pre">jupyterlab_optimizacion_2</span> <span class="pre">-p</span> <span class="pre">8888:8888</span> <span class="pre">-p</span> <span class="pre">8787:8787</span> <span class="pre">-d</span> <span class="pre">palmoreck/jupyterlab_optimizacion_2:3.0.0</span></code></p>
<p>password para jupyterlab: <code class="docutils literal notranslate"><span class="pre">qwerty</span></code></p>
<p>Detener el contenedor de docker:</p>
<p><code class="docutils literal notranslate"><span class="pre">docker</span> <span class="pre">stop</span> <span class="pre">jupyterlab_optimizacion_2</span></code></p>
<p>Documentación de la imagen de docker <code class="docutils literal notranslate"><span class="pre">palmoreck/jupyterlab_optimizacion_2:3.0.0</span></code> en <a class="reference external" href="https://github.com/palmoreck/dockerfiles/tree/master/jupyterlab/optimizacion_2">liga</a>.</p>
</div>
<hr class="docutils" />
<p>Nota generada a partir de <a class="reference external" href="https://drive.google.com/file/d/16-_PvWNaO0Zc9x04-SRsxCRdn5fxebf2/view">liga1</a>, <a class="reference external" href="https://drive.google.com/file/d/1oulU1QAKyLyYrkpJBLSPlbWnKFCWpllX/view">liga2</a>, <a class="reference external" href="https://drive.google.com/file/d/1RMwUXEN_SOHKue-J9Cx3Ldvj9bejLjiM/view">liga3</a></p>
<div class="tip admonition">
<p class="admonition-title">Al final de esta nota el y la lectora:</p>
<ul class="simple">
<li></li>
</ul>
</div>
<p>El método primal-dual de barrera logarítmica (BL) es un método iterativo que realiza un manejo de las variables primales y duales del problema de optimización a resolver. Se le clasifica como un método por puntos interiores.</p>
<div class="section" id="metodos-por-puntos-interiores-pi">
<h2>Métodos por puntos interiores (PI)<a class="headerlink" href="#metodos-por-puntos-interiores-pi" title="Permalink to this headline">¶</a></h2>
<div class="sidebar">
<p class="sidebar-title">Un poco de historia …</p>
<p>El <a class="reference external" href="https://en.wikipedia.org/wiki/Simplex_algorithm">método símplex</a> desarrollado por Dantzig en los <span class="math notranslate nohighlight">\(40\)</span>’s hizo posible que se formularan y analizaran modelos grandes en una forma sistemática y eficiente. Hoy en día continúa siendo uno de los métodos más utilizados para resolver programas lineales. No obstante puede ser ineficiente en problemas lineales “patológicos” (ver <a class="reference external" href="https://en.wikipedia.org/wiki/Klee%E2%80%93Minty_cube">Klee-Minty cube</a>) pues el tiempo para resolver tales problemas es exponencial respecto al tamaño del problema (medido como el número de variables y la cantidad de almacenamiento para los datos del problema). Para la mayoría de problemas prácticos el método símplex es mucho más eficiente que estos casos “patológicos” pero esto motivó la investigación y desarrollo de nuevos algoritmos con mejor desempeño. En 1984 Karmarkar publicó el <a class="reference external" href="https://en.wikipedia.org/wiki/Karmarkar%27s_algorithm">algoritmo</a> que lleva su mismo nombre que tiene una complejidad polinomial y en la práctica resultó ser eficiente. Pertenece a la clase de métodos con el nombre de <a class="reference external" href="https://en.wikipedia.org/wiki/Interior-point_method">puntos interiores</a>. Hay diferentes tipos de métodos por puntos interiores siendo los de la clase primal-dual ampliamente usados en la práctica.</p>
</div>
<p>Los métodos por puntos interiores (PI) son esquemas iterativos que en un inicio se utilizaron para resolver PL’s, sin embargo, se ha extendido su uso al caso no lineal. Por ejemplo, distintos tipos de métodos por PI han sido usados para resolver problemas de optimización convexos, ver <a class="reference internal" href="../../III.optimizacion_convexa/3.1/Definicion_de_problema_optimizacion_conjuntos_y_funciones_convexas.html#proboptconvest"><span class="std std-ref">problemas de optimización convexa en su forma estándar o canónica</span></a>.</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Recuérdese que nombramos problemas de optimización <em>large scale</em> a aquellos problemas de optimización <strong>con restricciones</strong> que tienen un número de variables y restricciones mayor o igual a <span class="math notranslate nohighlight">\(10^5\)</span> (ambas).</p>
</div>
<p>En cada iteración de los métodos PI las restricciones de desigualdad del problema de optimización se satisfacen de forma estricta. Cada iteración es costosa de calcular y realiza avance significativo a la solución en contraste con el método símplex que requiere un gran número de iteraciones no costosas. Una característica que tienen los métodos PI es que los problemas <em>large scale</em> no requieren muchas más iteraciones que los problemas <em>small scale</em> a diferencia del método símplex. Sin embargo para problemas <em>small scale</em> en general realizan más iteraciones que el método símplex.</p>
<p>En cada iteración el método símplex se mueve de la solución FEV actual a una solución FEV adyacente por una arista de la frontera de la región factible. Los problemas del tipo <em>large scale</em> tienen una cantidad enorme de soluciones FEV. Para ver esto piénsese en un PL al que se le van añadiendo restricciones funcionales. Entonces se añadirán aristas y por tanto soluciones FEV.  Los métodos PI evitan tal comportamiento pues avanzan por el interior de la región factible hacia los puntos óptimos y tiene muy poco efecto el ir añadiedo restricciones funcionales al PL para el desempeño de los métodos PI.</p>
<div class="tip admonition">
<p class="admonition-title">Observación</p>
<p>Los métodos PI pueden resolver problemas de optimización <em>large scale</em>. Además son métodos que pueden implementarse para procesamiento con cómputo en paralelo.</p>
</div>
<p>Conforme se avanza en las interaciones en los métodos PI se aproxima a los puntos óptimos en el límite. Por ejemplo, para el <a class="reference internal" href="../4.2/Programacion_lineal_y_metodo_simplex.html#ejprototipo"><span class="std std-ref">ejemplo prototipo</span></a> de un programa lineal (PL) a continuación se presenta una trayectoria obtenida por un método PI que se aproxima a la solución óptima <span class="math notranslate nohighlight">\((2, 6)\)</span>:</p>
<div class="math notranslate nohighlight">
\[\displaystyle \max_{x \in \mathbb{R}^2} 3x_1 + 5x_2\]</div>
<div class="math notranslate nohighlight">
\[\text{sujeto a: }\]</div>
<div class="math notranslate nohighlight">
\[x_1 \leq 4\]</div>
<div class="math notranslate nohighlight">
\[2x_2 \leq 12\]</div>
<div class="math notranslate nohighlight">
\[3x_1 + 2x_2 \leq 18\]</div>
<div class="math notranslate nohighlight">
\[x_1 \geq 0, x_2 \geq 0\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#x_1 ≤ 4</span>

<span class="n">point1_x_1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>

<span class="n">point2_x_1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

<span class="n">point1_point2_x_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">row_stack</span><span class="p">((</span><span class="n">point1_x_1</span><span class="p">,</span> <span class="n">point2_x_1</span><span class="p">))</span>

<span class="c1">#x_1 ≥ 0</span>
<span class="n">point3_x_1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>

<span class="n">point4_x_1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

<span class="n">point3_point4_x_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">row_stack</span><span class="p">((</span><span class="n">point3_x_1</span><span class="p">,</span> <span class="n">point4_x_1</span><span class="p">))</span>

<span class="c1">#2x_2 ≤ 12 or x_2 ≤ 6</span>

<span class="n">point1_x_2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>

<span class="n">point2_x_2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>

<span class="n">point1_point2_x_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">row_stack</span><span class="p">((</span><span class="n">point1_x_2</span><span class="p">,</span> <span class="n">point2_x_2</span><span class="p">))</span>

<span class="c1">#x_2 ≥ 0</span>

<span class="n">point3_x_2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="n">point4_x_2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="n">point3_point4_x_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">row_stack</span><span class="p">((</span><span class="n">point3_x_2</span><span class="p">,</span> <span class="n">point4_x_2</span><span class="p">))</span>

<span class="c1">#3x_1 + 2x_2 ≤ 18</span>

<span class="n">x_1_region_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

<span class="n">x_2_region_1</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">18</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">x_1_region_1</span><span class="p">)</span>


<span class="n">x_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

<span class="n">x_2</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">18</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">x_1</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">point1_point2_x_1</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">point1_point2_x_1</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span>
         <span class="n">point3_point4_x_1</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">point3_point4_x_1</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span>
         <span class="n">point1_point2_x_2</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">point1_point2_x_2</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span>
         <span class="n">point3_point4_x_2</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">point3_point4_x_2</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span>
         <span class="n">x_1</span><span class="p">,</span> <span class="n">x_2</span><span class="p">)</span>

<span class="n">optimal_point</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">optimal_point</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">optimal_point</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span>
            <span class="n">facecolors</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">,</span> <span class="n">edgecolors</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s2">&quot;$x_1 = 4$&quot;</span><span class="p">,</span> <span class="s2">&quot;$x_1 = 0$&quot;</span><span class="p">,</span> 
            <span class="s2">&quot;$2x_2 = 12$&quot;</span><span class="p">,</span> <span class="s2">&quot;$x_2 = 0$&quot;</span><span class="p">,</span>
            <span class="s2">&quot;$3x_1+2x_2 = 18$&quot;</span><span class="p">,</span> <span class="s2">&quot;(óptimo, valor óptimo)&quot;</span><span class="p">],</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

<span class="n">point_1_interior_points</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">point_2_interior_points</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.27</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">point_3_interior_points</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.38</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">point_4_interior_points</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.56</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">)</span>

<span class="n">points_interior_points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">row_stack</span><span class="p">((</span><span class="n">point_1_interior_points</span><span class="p">,</span>
                                       <span class="n">point_2_interior_points</span><span class="p">,</span>
                                       <span class="n">point_3_interior_points</span><span class="p">,</span>
                                       <span class="n">point_4_interior_points</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">points_interior_points</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">points_interior_points</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> 
         <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span>
         <span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x_1_region_1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">x_2_region_1</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="n">x_2_region_1</span><span class="o">&lt;=</span><span class="mi">6</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;plum&quot;</span><span class="p">)</span>
<span class="n">x_1_region_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x_1_region_2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;plum&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Región factible del PL&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Metodo_primal_dual_de_BL_21_0.png" src="../../_images/Metodo_primal_dual_de_BL_21_0.png" />
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Recuérdese que los parámetros de un PL son <span class="math notranslate nohighlight">\(b_i, c_i, a_{ij}\)</span>.</p>
</div>
<p>Aunque los métodos PI son una buena alternativa para resolver PL’s perdemos ventajas que tiene el método símplex como es el análisis de sensibilidad y el análisis posterior que puede realizarse al modificar los parámetros del PL. Ver las referencias al final de la nota para tales análisis.</p>
</div>
<div class="section" id="metodo-primal-dual">
<h2>Método primal-dual<a class="headerlink" href="#metodo-primal-dual" title="Permalink to this headline">¶</a></h2>
<p>Se describirán dos ideas que se utilizan en los métodos primal dual y posteriormente una tercera idea que utiliza la función de barrera logarítmica (FBL). Para esto, considérese la forma estándar de un PL (PLE):</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\displaystyle \min_{x \in \mathbb{R}^n} c^Tx\\
\text{sujeto a:} \\
Ax=b\\
x \geq 0
\end{split}\]</div>
<p>donde: <span class="math notranslate nohighlight">\(A \in \mathbb{R}^{m \times n}, b \in \mathbb{R}^m\)</span>, <span class="math notranslate nohighlight">\(m &lt; n\)</span> con <em>rank</em> completo por renglones y las restricciones se interpretan de una forma <em>pointwise</em>.</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Las restricciones <span class="math notranslate nohighlight">\(Ax = b\)</span> se pueden escribir con funciones <span class="math notranslate nohighlight">\(h: \mathbb{R}^n \rightarrow \mathbb{R}\)</span> , <span class="math notranslate nohighlight">\(h_i(x) = b_i-a_i ^Tx\)</span>, <span class="math notranslate nohighlight">\(a_i\)</span> <span class="math notranslate nohighlight">\(i\)</span>-ésimo renglón de <span class="math notranslate nohighlight">\(A \in \mathbb{R}^{m \times n}\)</span> y <span class="math notranslate nohighlight">\(b_i\)</span> <span class="math notranslate nohighlight">\(i\)</span>-ésima entrada de <span class="math notranslate nohighlight">\(b\)</span> para <span class="math notranslate nohighlight">\(i=1, \cdots, m\)</span></p>
</div>
<p>La función Lagrangiana del problema anterior es:</p>
<div class="math notranslate nohighlight">
\[\mathcal{L}(x, \lambda, \nu) = f_o(x) + \displaystyle \sum_{i=1}^n \lambda_i f_i(x) + \sum_{i=1}^m \nu_i h_i(x) = c^Tx + \lambda^T(-x)  + \nu^T(b-Ax)\]</div>
<p>donde: <span class="math notranslate nohighlight">\(\mathcal{L}: \mathbb{R}^n \times \mathbb{R}^n \times \mathbb{R}^m \rightarrow \mathbb{R}\)</span>.</p>
<p>El problema dual asociado es:</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>El problema primal es:</p>
<p><span class="math notranslate nohighlight">\(\displaystyle \min_{x \in \mathbb{R}^n} c^Tx \\
\text{sujeto a:}\\
Ax = b \\
x \geq 0
\)</span></p>
<p><span class="math notranslate nohighlight">\(A \in \mathbb{R}^{m \times n}\)</span> y <em>rank</em> de A igual a <span class="math notranslate nohighlight">\(m &lt; n\)</span>.</p>
</div>
<div class="math notranslate nohighlight">
\[\begin{split}\displaystyle \max_{\nu \in \mathbb{R}^m, \lambda \in \mathbb{R}^n} b^T \nu \\
\text{sujeto a :} \\
c - A^T \nu - \lambda = 0 \\
\lambda \geq 0
\end{split}\]</div>
<p>Las condiciones KKT son:</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Compárense estas condiciones con las señaladas en el <a class="reference internal" href="../../III.optimizacion_convexa/3.3/Ejemplos_problemas_UCO_e_intro_CIEO_y_PI.html#primeraformulacioncondkkt"><span class="std std-ref">comentario</span></a> sobre las condiciones KKT en el contexto de problemas de optimización convexa.</p>
</div>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
\nabla_x \mathcal{L}(x, \lambda, \nu) &amp;=&amp; c - A^T\nu - \lambda = 0 \nonumber \\
\lambda^Tx &amp;=&amp; 0 \nonumber \\
Ax &amp;=&amp; b \nonumber \\
-x &amp;\leq&amp; 0 \nonumber \\
\lambda &amp;\geq&amp; 0
\end{eqnarray}
\end{split}\]</div>
<p>Los métodos de la clase primal-dual encuentran soluciones <span class="math notranslate nohighlight">\((x^*, \lambda^*, \nu^*)\)</span> para las igualdades anteriores y modifican las direcciones de búsqueda y tamaños de paso para que las desigualdades se satisfagan de forma <strong>estricta</strong> en cada iteración.</p>
<p>En los métodos de la clase primal-dual reescribimos las condiciones KKT de optimalidad anteriores mediante una función <span class="math notranslate nohighlight">\(F: \mathbb{R}^{2n + m} \rightarrow \mathbb{R}^{2n+m}\)</span> dada por:</p>
<div class="math notranslate nohighlight">
\[\begin{split}F(x, \lambda, \nu ) = \left [ \begin{array}{c} A^T \nu + \lambda -c \\ X \Lambda e \\  b - Ax \end{array} \right ]\end{split}\]</div>
<p>y resolvemos la ecuación <strong>no lineal</strong> <span class="math notranslate nohighlight">\(F(x, \lambda, \nu )=0\)</span> para <span class="math notranslate nohighlight">\((x, \lambda) \geq 0\)</span>, donde: <span class="math notranslate nohighlight">\(X = \text{diag}(x_1, \dots, x_n)\)</span>, <span class="math notranslate nohighlight">\(\Lambda = \text{diag}(\lambda_1, \dots, \lambda_n)\)</span> y <span class="math notranslate nohighlight">\(e\)</span> es un vector de <span class="math notranslate nohighlight">\(1\)</span>’s en <span class="math notranslate nohighlight">\(\mathbb{R}^n\)</span>. Además en cada iteración se cumple <span class="math notranslate nohighlight">\(x^{(k)} &gt; 0\)</span> y <span class="math notranslate nohighlight">\(\lambda^{(k)} &gt; 0\)</span> para <span class="math notranslate nohighlight">\((x^{(k)}, \lambda^{(k)}, \nu^{(k)})\)</span>, por esto tales métodos son considerados como puntos interiores.</p>
<p>Como la mayoría de los métodos iterativos en optimización, los métodos primal-dual tienen un procedimiento para determinar la dirección de búsqueda y una cantidad que debe ser monitoreada cuyo valor alcance un valor objetivo. En el caso de los PLE’s tal cantidad es la <em>duality gap</em> medida como: <span class="math notranslate nohighlight">\(\lambda^Tx\)</span></p>
<div class="section" id="primera-idea-determinar-la-direccion-de-busqueda">
<span id="primideametprimdual"></span><h3>Primera idea: determinar la dirección de búsqueda<a class="headerlink" href="#primera-idea-determinar-la-direccion-de-busqueda" title="Permalink to this headline">¶</a></h3>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Sistema de ecuaciones no lineales a resolver:</p>
<p><span class="math notranslate nohighlight">\(F(x, \lambda, \nu ) = \left [ \begin{array}{c} A^T \nu + \lambda -c \\ X \Lambda e \\ b - Ax \end{array} \right ] = 0\)</span></p>
</div>
<p>La dirección de búsqueda se determina aplicando el método de Newton al sistema de ecuaciones no lineales que se muestra en el margen del PLE. Por tanto, se resuelve el sistema de ecuaciones lineales:</p>
<div class="math notranslate nohighlight">
\[\begin{split}J_F(x, \lambda, \nu) \left [ \begin{array}{c} \Delta x \\ \Delta \lambda \\ \Delta \nu \end{array} \right ] = - F(x, \lambda, \nu)\end{split}\]</div>
<p>donde: <span class="math notranslate nohighlight">\(J_F\)</span> es la Jacobiana de <span class="math notranslate nohighlight">\(F\)</span> cuya expresión es:</p>
<div class="math notranslate nohighlight">
\[\begin{split}J_F(x, \lambda, \nu) = \left [ \begin{array}{ccc} 0 &amp; I &amp; A^T \\ \Lambda &amp; X &amp; 0 \\ A &amp; 0 &amp; 0 \end{array} \right ].\end{split}\]</div>
<p>para el vector de incógnitas <span class="math notranslate nohighlight">\(\left [ \begin{array}{c} \Delta x \\ \Delta \lambda \\ \Delta \nu \end{array} \right ]\)</span>.</p>
<p>Una vez calculado tal vector de incógnitas se realiza la actualización:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\left [ \begin{array}{c} x \\ \lambda \\ \nu \end{array} \right ]^{(k+1)} = \left [ \begin{array}{c} x \\ \lambda \\ \nu \end{array} \right ]^{(k)} + \left [ \begin{array}{c} \Delta x \\ \Delta \lambda \\ \Delta \nu \end{array} \right ]\end{split}\]</div>
<p>donde: <span class="math notranslate nohighlight">\(k\)</span> hace referencia a la <span class="math notranslate nohighlight">\(k\)</span>-ésima iteración.</p>
<div class="tip admonition">
<p class="admonition-title">Observación</p>
<p>Si bien podría elegirse otra dirección de búsqueda, la dirección de Newton (o variantes de ésta) se prefiere por sus propiedades de convergencia e invarianza ante transformaciones afín.</p>
</div>
<p>Si denotamos <span class="math notranslate nohighlight">\(r_d = A^T \nu + \lambda -c, r_p = b - Ax\)</span> como el residual para factibilidad dual y residual para factibilidad primal respectivamente entonces el sistema de ecuaciones lineales a resolver es:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\left [ \begin{array}{ccc} 0 &amp; I &amp; A^T \\ \Lambda &amp; X &amp; 0 \\ A &amp; 0 &amp; 0 \end{array} \right ]  \left [ \begin{array}{c} \Delta x \\ \Delta \lambda \\ \Delta \nu \end{array} \right ] =  - \left [ \begin{array}{c} r_d \\ X \Lambda e \\ r_p \end{array} \right ]\end{split}\]</div>
<div class="admonition-comentario admonition">
<p class="admonition-title">Comentario</p>
<p>El sistema de ecuaciones lineales anterior para problemas <em>large scale</em> no se construye pues es un sistema cuadrado de tamaño <span class="math notranslate nohighlight">\(2n + m \times 2n + m\)</span> y se resuelve reduciéndolo a sistemas de ecuaciones equivalentes. Representa el paso más costoso del método primal-dual.</p>
</div>
</div>
<div class="section" id="segunda-idea-cortar-el-paso">
<span id="segunideaprimdual"></span><h3>Segunda idea: cortar el paso<a class="headerlink" href="#segunda-idea-cortar-el-paso" title="Permalink to this headline">¶</a></h3>
<p>Si se toma un paso completo es muy posible que en la siguiente iteración se encuentre muy cerca de alguna de las fronteras de restricción o bien se salga de la región factible. Para esto se define un parámetro <span class="math notranslate nohighlight">\(t^{(k)} \in (0, 1]\)</span> y por tanto la actualización es:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\left [ \begin{array}{c} x \\ \lambda \\ \nu \end{array} \right ]^{(k+1)} = \left [ \begin{array}{c} x \\ \lambda \\ \nu \end{array} \right ]^{(k)} + t^{(k)}  \left [ \begin{array}{c} \Delta x \\ \Delta \lambda \\ \Delta \nu \end{array} \right ]\end{split}\]</div>
<p>donde: <span class="math notranslate nohighlight">\(k\)</span> hace referencia a la <span class="math notranslate nohighlight">\(k\)</span>-ésima iteración.</p>
<div class="admonition-comentario admonition">
<p class="admonition-title">Comentario</p>
<p>El parámetro <span class="math notranslate nohighlight">\(t^{(k)}\)</span> se calcula con metodologías como búsqueda de línea o regiones de confianza, ver <a class="reference external" href="https://en.wikipedia.org/wiki/Line_search">line search</a>, <a class="reference internal" href="../../III.optimizacion_convexa/3.2/Algoritmos_de_descenso_y_busqueda_de_linea_en_uco.html#mbuslinback"><span class="std std-ref">método de búsqueda de línea por backtracking</span></a>, <a class="reference external" href="https://en.wikipedia.org/wiki/Trust_region">trust region</a>.</p>
</div>
</div>
</div>
<div class="section" id="id1">
<h2>Método primal-dual de barrera logarítmica (BL)<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<div class="section" id="tercera-idea-reducir-la-duality-gap-y-centrar-uso-de-la-funcion-de-barrera-logaritmica-fbl">
<h3>Tercera idea: reducir la <em>duality gap</em> y centrar. Uso de la función de barrera logarítmica (FBL)<a class="headerlink" href="#tercera-idea-reducir-la-duality-gap-y-centrar-uso-de-la-funcion-de-barrera-logaritmica-fbl" title="Permalink to this headline">¶</a></h3>
<p>En cada iteración los métodos primal-dual buscan reducir la <em>duality gap</em> o bien mantenerse “cerca” de la trayectoria nombrada trayectoria central.</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Sistema de ecuaciones lineales <span class="math notranslate nohighlight">\(\left [ \begin{array}{ccc} 0 &amp; I &amp; A^T \\ \Lambda &amp; X &amp; 0 \\ A &amp; 0 &amp; 0 \end{array} \right ]  \left [ \begin{array}{c} \Delta x \\ \Delta \lambda \\ \Delta \nu \end{array} \right ] =  - \left [ \begin{array}{c} r_d \\ X \Lambda e \\ r_p \end{array} \right ]\)</span></p>
</div>
<div class="admonition-comentario admonition">
<p class="admonition-title">Comentario</p>
<p>Recuérdese que la <em>duality gap</em> en un PLE para el par <span class="math notranslate nohighlight">\((x, \nu)\)</span> primal-dual factible está dada por la diferencia: <span class="math notranslate nohighlight">\(c^Tx - b^T \nu\)</span>. La <em>duality gap</em> en un PLE es igual a <span class="math notranslate nohighlight">\(\lambda^Tx\)</span>. En el sistema de ecuaciones lineales que se muestra en el margen se representa cada sumando de <span class="math notranslate nohighlight">\(\lambda^Tx\)</span> con el producto <span class="math notranslate nohighlight">\(X \Lambda e\)</span> (recuérdese <span class="math notranslate nohighlight">\(X, \Lambda\)</span> son matrices diagonales).</p>
</div>
<p>La trayectoria central se define a partir de la FBL, ver <a class="reference external" href="https://en.wikipedia.org/wiki/Barrier_function">Barrier function</a>. La definición siguiente se da para un POCE de forma general.</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Las restricciones <span class="math notranslate nohighlight">\(Ax = b\)</span> se pueden escribir con funciones <span class="math notranslate nohighlight">\(h: \mathbb{R}^n \rightarrow \mathbb{R}\)</span> , <span class="math notranslate nohighlight">\(h_i(x) = b_i-a_i ^Tx\)</span>, <span class="math notranslate nohighlight">\(a_i\)</span> <span class="math notranslate nohighlight">\(i\)</span>-ésimo renglón de <span class="math notranslate nohighlight">\(A \in \mathbb{R}^{p \times n}\)</span> y <span class="math notranslate nohighlight">\(b_i\)</span> <span class="math notranslate nohighlight">\(i\)</span>-ésima entrada de <span class="math notranslate nohighlight">\(b\)</span> para <span class="math notranslate nohighlight">\(i=1, \cdots, p\)</span></p>
</div>
<div class="admonition-definicion admonition">
<p class="admonition-title">Definición</p>
<p>Considérese el problema de optimización convexa en la forma estándar (POCE):</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
\displaystyle \min_{x \in \mathbb{R}^n} &amp;f_o(x)&amp; \nonumber \\
&amp;\text{sujeto a:}&amp; \nonumber\\
f_i(x) &amp;\leq&amp; 0  \quad i=1,\dots,m \nonumber \\
Ax &amp;=&amp; b
\end{eqnarray}
\end{split}\]</div>
<p>con <span class="math notranslate nohighlight">\(A \in \mathbb{R}^{p \times n}\)</span> y <em>rank</em> de <span class="math notranslate nohighlight">\(A\)</span> igual a <span class="math notranslate nohighlight">\(p &lt; n\)</span>.</p>
<p>Se define la función de barrera logarítmica (FBL) como:</p>
<div class="math notranslate nohighlight">
\[\phi(x) =-\displaystyle \sum_{i=1}^m \log(-f_i(x))\]</div>
</div>
<div class="sidebar">
<p class="sidebar-title">Un poco de historia …</p>
<p>La metodología para resolver el problema de barrera logarítmica (PBL) está fundamentada en la <em>sequential unconstrained minimization technique (SUMT)</em>, <a class="reference external" href="https://www.jstor.org/stable/168637?seq=1">A. V. Fiacco, G. P. McCormick, 1965</a>. Es una técnica para resolver problemas no lineales sin restricciones que genera una secuencia de puntos interiores factibles que convergen a la solución del problema. Se eligen funciones de barrera con propiedades como la convexidad. Hay versiones de la SUMT para puntos exteriores que inician con puntos no factibles y vía la penalización se busca la convergencia hacia la región factible. En cada iteración de SUMT se define un valor del parámetro de barrera y se resuelve un problema de optimización más sencillo que el original con el método de Newton. La solución de tal problema se utiliza para definir puntos iniciales del siguiente problema a resolver con un valor del parámetro de barrera diferente. A medida que se avanza en las iteraciones la función objetivo del PBL se aproxima cada vez más a <span class="math notranslate nohighlight">\(f_o\)</span>, al valor óptimo y al conjunto óptimo.</p>
</div>
<p>El POCE se resuelve planteando el siguiente problema:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\displaystyle \min_{x \in \mathbb{R}^n} f_B(x|t_B) \\
\text{sujeto a:} \\
Ax = b
\end{split}\]</div>
<p>donde: <span class="math notranslate nohighlight">\(f_B(x|t_B) = f_o(x) + \frac{1}{t_B} \phi(x) = f_o(x) -  \frac{1}{t_B} \displaystyle \sum_{i=1}^m \log(-f_i(x))\)</span> con <span class="math notranslate nohighlight">\(t_B\)</span> un parámetro positivo que nombramos <strong>parámetro de barrera</strong>. Denotamos a este problema como <strong>problema de barrera logarítmica (PBL)</strong>.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-.</span><span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">log_barrier</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">)</span>
<span class="n">t_B1</span> <span class="o">=</span> <span class="mf">0.2</span>
<span class="n">t_B2</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">t_B3</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">t_B4</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">t_B5</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">t_B1</span><span class="o">*</span><span class="n">log_barrier</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span>
         <span class="n">x</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">t_B2</span><span class="o">*</span><span class="n">log_barrier</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span>
         <span class="n">x</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">t_B3</span><span class="o">*</span><span class="n">log_barrier</span><span class="p">,</span> <span class="s2">&quot;g&quot;</span><span class="p">,</span>
         <span class="n">x</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">t_B4</span><span class="o">*</span><span class="n">log_barrier</span><span class="p">,</span> <span class="s2">&quot;m&quot;</span><span class="p">,</span>
         <span class="n">x</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">t_B5</span><span class="o">*</span><span class="n">log_barrier</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s2">&quot;$t_</span><span class="si">{B1}</span><span class="s2">=0.2$&quot;</span><span class="p">,</span>
            <span class="s2">&quot;$t_</span><span class="si">{B2}</span><span class="s2">=0.5$&quot;</span><span class="p">,</span>
            <span class="s2">&quot;$t_</span><span class="si">{B3}</span><span class="s2">=1$&quot;</span><span class="p">,</span>
            <span class="s2">&quot;$t_</span><span class="si">{B4}</span><span class="s2">=2$&quot;</span><span class="p">,</span>
            <span class="s2">&quot;$t_</span><span class="si">{B5}</span><span class="s2">=10$&quot;</span><span class="p">],</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Gráfica de la FBL variando el parámetro $t_B$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Metodo_primal_dual_de_BL_68_0.png" src="../../_images/Metodo_primal_dual_de_BL_68_0.png" />
</div>
</div>
<p>Valores más grandes de <span class="math notranslate nohighlight">\(t_B\)</span> hacen que <span class="math notranslate nohighlight">\(f_B(x|t_B)\)</span> tienda a <span class="math notranslate nohighlight">\(f_o(x)\)</span>. Como se observa en la gráfica anterior al elegir un valor de <span class="math notranslate nohighlight">\(t_B\)</span> cada vez más grande se tiene: <span class="math notranslate nohighlight">\(f_B(x|t_B) = f_o(x) + \frac{1}{t_B} \phi(x) \approx f_o(x)\)</span>.</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>El POCE recuérdese es:</p>
<p><span class="math notranslate nohighlight">\(
\begin{eqnarray}
\displaystyle \min_{x \in \mathbb{R}^n} &amp;f_o(x)&amp; \nonumber \\
&amp;\text{sujeto a:}&amp; \nonumber\\
f_i(x) &amp;\leq&amp; 0  \quad i=1,\dots,m \nonumber \\
Ax &amp;=&amp; b
\end{eqnarray}
\)</span></p>
<p>y el PBL es:</p>
<p><span class="math notranslate nohighlight">\(
\displaystyle \min_{x \in \mathbb{R}^n} f_B(x|t_B) \\
\text{sujeto a:} \\
Ax = b
\)</span></p>
<p>con <span class="math notranslate nohighlight">\(A \in \mathbb{R}^{p \times n}\)</span> y <em>rank</em> de <span class="math notranslate nohighlight">\(A\)</span> igual a <span class="math notranslate nohighlight">\(p &lt; n\)</span>.</p>
</div>
<div class="admonition-comentarios admonition">
<p class="admonition-title">Comentarios</p>
<ul class="simple">
<li><p>La función <span class="math notranslate nohighlight">\(f(x) = -\frac{1}{t_B} \log(-x)\)</span> para <span class="math notranslate nohighlight">\(x &lt; 0\)</span> es convexa, diferenciable y aproxima a la función indicadora:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}I(x) = \begin{cases} \infty \text{ si } x &gt; 0 \\ 0 \text{ si } x \leq 0 \end{cases}\end{split}\]</div>
<p>la cual es una función discontinua:</p>
<img src="https://dl.dropboxusercontent.com/s/i4t3j8c9amzue1n/indicator_func.png?dl=0" heigth="250" width="250">
<p>En el dibujo anterior sólo se visualiza para el eje horizontal el intervalo <span class="math notranslate nohighlight">\((-\infty, 0)\)</span>.</p>
<ul class="simple">
<li><p>La función indicadora del punto anterior ayuda a reescribir el POCE como:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\displaystyle \min_{x \in \mathbb{R}^n} f_o(x) + \displaystyle \sum_{i=1}^m I(f_i(x))\]</div>
<div class="math notranslate nohighlight">
\[\text{sujeto a:}\]</div>
<div class="math notranslate nohighlight">
\[Ax = b\]</div>
<p>por esto resolver el PBL es equivalente a resolver el POCE para valores más grandes de <span class="math notranslate nohighlight">\(t_B\)</span>.</p>
<ul class="simple">
<li><p>La FBL es un caso particular de funciones de barrera que penalizan al no satisfacer las restricciones de desigualdad, ver <a class="reference external" href="https://en.wikipedia.org/wiki/Penalty_method">Penalty method</a>.</p></li>
<li><p>En general las funciones de barrera deben tener las siguientes propiedades para <span class="math notranslate nohighlight">\(x\)</span> primal factibles:</p></li>
</ul>
<ol class="simple">
<li><p>Tener valores “pequeños” si <span class="math notranslate nohighlight">\(x\)</span> está “lejos” de la frontera de la región factible.</p></li>
<li><p>Tener valores “grandes” si <span class="math notranslate nohighlight">\(x\)</span> está “cerca” de la frontera de la región factible.</p></li>
<li><p>Tener propiedades como convexidad o diferenciabilidad (ventajas al tener tales propiedades).</p></li>
</ol>
<p>Por lo anterior las funciones de barrera evitan que se cruce o llegue a la frontera de la región factible del problema primal.</p>
<ul class="simple">
<li><p>Otra función de barrera para un PL es: <span class="math notranslate nohighlight">\(\phi(x) = -\displaystyle \sum_{i=1}^m \frac{1}{f_i(x)}\)</span> para <span class="math notranslate nohighlight">\(x\)</span> factibles.</p></li>
<li><p>Los problemas de optimización convexos con únicamente restricciones de igualdad pueden resolverse aplicando extensiones del método de Newton.</p></li>
</ul>
</div>
</div>
<div class="section" id="trayectoria-central-determinada-por-los-puntos-centrales">
<h3>Trayectoria central determinada por los puntos centrales<a class="headerlink" href="#trayectoria-central-determinada-por-los-puntos-centrales" title="Permalink to this headline">¶</a></h3>
<div class="admonition-definicion admonition">
<p class="admonition-title">Definición</p>
<p>Para cada valor del parámetro de barrera <span class="math notranslate nohighlight">\(t_B\)</span>, se definen los <strong>puntos centrales</strong> <span class="math notranslate nohighlight">\(x^*(t_B)\)</span> como la solución del PBL y el conjunto de puntos centrales se le nombra trayectoria central, <em>central path</em>.</p>
</div>
<p>Revisemos las condiciones KKT de optimalidad que deben cumplir los puntos centrales para un PLE:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\displaystyle \min_{x \in \mathbb{R}^n} c^Tx\\
\text{sujeto a:} \\
Ax=b\\
x \geq 0
\end{split}\]</div>
<p>con <span class="math notranslate nohighlight">\(A \in \mathbb{R}^{m \times n}\)</span> y <em>rank</em> de <span class="math notranslate nohighlight">\(A\)</span> igual a <span class="math notranslate nohighlight">\(m &lt; n\)</span>.</p>
<p>Se tiene:</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Recuérdese que en un PLE <span class="math notranslate nohighlight">\(f_i(x) = - x_i \forall i=1, \cdots, n\)</span>.</p>
</div>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
\phi(x) &amp;=&amp; -\displaystyle \sum_{i=1}^n \log(-f_i(x)) \nonumber \\
&amp;=&amp; - \sum_{i=1}^n \log(x_i)
\end{eqnarray}
\end{split}\]</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Recuérdese que el PBL para un POCE es:</p>
<p><span class="math notranslate nohighlight">\(
\displaystyle \min_{x \in \mathbb{R}^n} f_B(x|t_B) \\
\text{sujeto a:} \\
Ax = b
\)</span></p>
<p>con <span class="math notranslate nohighlight">\(A \in \mathbb{R}^{p \times n}\)</span> y <em>rank</em> de <span class="math notranslate nohighlight">\(A\)</span> igual a <span class="math notranslate nohighlight">\(p &lt; n\)</span>.</p>
</div>
<p>y por tanto el PBL para el PLE (PBL-PLE) es:</p>
<div class="math notranslate nohighlight">
\[\displaystyle \min_{x \in \mathbb{R}^n} c^Tx - \frac{1}{t_B} \displaystyle \sum_{i=1}^n \log(x_i)\]</div>
<div class="math notranslate nohighlight">
\[\text{sujeto a:}\]</div>
<div class="math notranslate nohighlight">
\[Ax=b\]</div>
<p>La función Lagrangiana del PBL-PLE es:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
\mathcal{L}^{BL}(x, \nu) &amp;=&amp; f_{BL}(x|t_B) + \sum_{i=1}^m \nu_i h_i(x) \nonumber \\
&amp;=&amp; c^Tx - \frac{1}{t_B} \displaystyle \sum_{i=1}^n \log(x_i)  + \sum_{i=1}^m \nu_i(b_i-a_i ^Tx) \nonumber \\
&amp;=&amp; c^Tx - \frac{1}{t_B} \displaystyle \sum_{i=1}^n \log(x_i)  + \nu^T(b-Ax) \nonumber
\end{eqnarray}
\end{split}\]</div>
<p>con <span class="math notranslate nohighlight">\(a_i\)</span> <span class="math notranslate nohighlight">\(i\)</span>-ésimo renglón de <span class="math notranslate nohighlight">\(A\)</span> y <span class="math notranslate nohighlight">\(b_i\)</span> <span class="math notranslate nohighlight">\(i\)</span>-ésima entrada de <span class="math notranslate nohighlight">\(b\)</span>. Las condiciones necesarias y suficientes KKT de optimalidad del PBL-PLE son:</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Recuérdese que las condiciones de KKT para un PLE son:</p>
<p><span class="math notranslate nohighlight">\(
\begin{eqnarray}
\nabla_x \mathcal{L}(x, \lambda, \nu) &amp;=&amp; c - A^T\nu - \lambda = 0 \nonumber \\
\lambda^Tx &amp;=&amp; 0 \nonumber \\
Ax &amp;=&amp; b \nonumber \\
-x &amp;\leq&amp; 0 \nonumber \\
\lambda &amp;\geq&amp; 0
\end{eqnarray}
\)</span></p>
</div>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
\nabla_x \mathcal{L}^{BL}(x, \nu) &amp;=&amp; c - A^T\nu - \frac{1}{t_B}d = 0 \nonumber \\
Ax &amp;=&amp; b \nonumber \\
\end{eqnarray}
\end{split}\]</div>
<p>donde: <span class="math notranslate nohighlight">\(d = X^{-1}e = \left [ \begin{array}{c} \frac{1}{x_1} \\ \vdots \\ \frac{1}{x_n} \\ \end{array} \right ]\)</span>. Ver <a class="reference internal" href="../4.4/Dualidad_lema_de_Farkas_condiciones_KKT_de_optimalidad.html#condkktplestandar"><span class="std std-ref">condiciones KKT para un PL en su forma estándar</span></a> (se muestran en el margen).</p>
<p>Los puntos centrales <span class="math notranslate nohighlight">\(x^*(t_B)\)</span> resuelven el PBL-PLE y por tanto satisfacen:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
\nabla_x \mathcal{L}^{BL}(x^*(t_B), \nu) &amp;=&amp; c - A^T\nu - \frac{1}{t_B} d(t_B) = 0 \nonumber \\
Ax^*(t) &amp;=&amp; b \nonumber \\
\end{eqnarray}
\end{split}\]</div>
<p>donde: <span class="math notranslate nohighlight">\(d(t_B) = X^{*-1}(t)e = \left [ \begin{array}{c} \frac{1}{x_1^*(t_B)} \\ \vdots \\ \frac{1}{x_n^*(t_B)} \\ \end{array} \right ]\)</span>.</p>
</div>
<div class="section" id="relacion-entre-las-condiciones-kkt-de-optimalidad-del-ple-y-las-del-pbl-ple">
<h3>Relación entre las condiciones KKT de optimalidad del PLE y las del PBL-PLE<a class="headerlink" href="#relacion-entre-las-condiciones-kkt-de-optimalidad-del-ple-y-las-del-pbl-ple" title="Permalink to this headline">¶</a></h3>
<p>Para establecer las relaciones entre las condiciones KKT de optimalidad del PLE y del PBL-PLE considérese sólo en esta sección que el PBL-PLE es:</p>
<div class="math notranslate nohighlight">
\[\displaystyle \min_{x \in \mathbb{R}^n} t_B c^Tx - \displaystyle \sum_{i=1}^n \log(x_i)\]</div>
<div class="math notranslate nohighlight">
\[\text{sujeto a:}\]</div>
<div class="math notranslate nohighlight">
\[Ax=b\]</div>
<p>Las condiciones KKT son iguales a las revisadas en la sección anterior salvo la posición en la que aparece el parámetro <span class="math notranslate nohighlight">\(t_B\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
\nabla_x \mathcal{L}^{BL}(x^*(t_B), \hat{\nu}) &amp;=&amp; t_Bc - A^T\hat{\nu} - d(t_B) = 0 \nonumber \\
Ax^*(t) &amp;=&amp; b \nonumber \\
\end{eqnarray}
\end{split}\]</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Recuérdese que las condiciones de KKT para un PLE son:</p>
<p><span class="math notranslate nohighlight">\(
\begin{eqnarray}
\nabla_x \mathcal{L}(x, \lambda, \nu) &amp;=&amp; c - A^T\nu - \lambda = 0 \nonumber \\
\lambda^Tx &amp;=&amp; 0 \nonumber \\
Ax &amp;=&amp; b \nonumber \\
-x &amp;\leq&amp; 0 \nonumber \\
\lambda &amp;\geq&amp; 0
\end{eqnarray}
\)</span></p>
</div>
<p>Las condiciones KKT para un PLE se muestran en el margen y obsérvese que si <span class="math notranslate nohighlight">\(\lambda^*(t) = - \frac{1}{t_B f_i(x^*(t))} = - \frac{1}{t_B (-x_i^*(t))}\)</span> con <span class="math notranslate nohighlight">\(x_i^*(t)\)</span> <span class="math notranslate nohighlight">\(i\)</span>-ésima componente de <span class="math notranslate nohighlight">\(x^*(t)\)</span> <span class="math notranslate nohighlight">\(\forall i = 1, \dots, n\)</span> y <span class="math notranslate nohighlight">\(\nu^*(t) = \frac{\hat{\nu}}{t_B}\)</span> entonces se cumple:</p>
<div class="math notranslate nohighlight">
\[\lambda^*(t) &gt; 0\]</div>
<p>pues por la definición de la FBL en el PBL-PLE debe cumplirse: <span class="math notranslate nohighlight">\(f_i(x)  = -x_i &lt; 0\)</span> o bien para los puntos centrales <span class="math notranslate nohighlight">\(x_i^*(t) &gt; 0 \forall i=1, \dots, n\)</span>. Lo anterior resulta del dominio de la función <span class="math notranslate nohighlight">\(\log\)</span> la cual está definida únicamente en <span class="math notranslate nohighlight">\(\mathbb{R}_{++}\)</span> (reales positivos). Esto satisface las desigualdades de factibilidad primal de las condiciones KKT de optimalidad.</p>
<p>La holgura complementaria de las condiciones KKT de optimalidad para un PLE en términos de los puntos centrales es:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
\lambda^*(t)x^*(t) &amp;=&amp; \displaystyle \sum_{i=1}^n \lambda_i^*(t) x_i^*(t) \nonumber \\
&amp;=&amp; \displaystyle \sum_{i=1}^n - \frac{x_i^*(t)}{t_B (-x_i^*(t))} \nonumber \\
&amp;=&amp; \displaystyle \sum_{i=1}^n \frac{1}{t_B} = \frac{n}{t_B}
\end{eqnarray}
\end{split}\]</div>
<p>Por tanto la <em>duality gap</em> asociada con <span class="math notranslate nohighlight">\(x^*(t), \lambda^*(t), \nu^*(t)\)</span> es: <span class="math notranslate nohighlight">\(\frac{n}{t_B}\)</span></p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>El POCE recuérdese es:</p>
<p><span class="math notranslate nohighlight">\(
\begin{eqnarray}
\displaystyle \min_{x \in \mathbb{R}^n} &amp;f_o(x)&amp; \nonumber \\
&amp;\text{sujeto a:}&amp; \nonumber\\
f_i(x) &amp;\leq&amp; 0  \quad i=1,\dots,m \nonumber \\
Ax &amp;=&amp; b
\end{eqnarray}
\)</span></p>
<p>y el PBL es:</p>
<p><span class="math notranslate nohighlight">\(
\displaystyle \min_{x \in \mathbb{R}^n} f_B(x|t_B) \\
\text{sujeto a:} \\
Ax = b
\)</span></p>
<p>con <span class="math notranslate nohighlight">\(A \in \mathbb{R}^{p \times n}\)</span> y <em>rank</em> de <span class="math notranslate nohighlight">\(A\)</span> igual a <span class="math notranslate nohighlight">\(p &lt; n\)</span>.</p>
</div>
<div class="admonition-comentarios admonition">
<p class="admonition-title">Comentarios</p>
<ul class="simple">
<li><p>Para un PBL que se obtiene de un POCE la <em>duality gap</em> es <span class="math notranslate nohighlight">\(\frac{m}{t_B}\)</span> pues se tienen <span class="math notranslate nohighlight">\(m\)</span> funciones <span class="math notranslate nohighlight">\(f_i\)</span> de desigualdad.</p></li>
<li><p>Por la forma de la <em>duality gap</em> si <span class="math notranslate nohighlight">\(t_B\)</span> se incrementa entonces la <em>duality gap</em> tiende a cero en el método primal dual de BL.</p></li>
</ul>
</div>
</div>
<div class="section" id="como-calcular-los-puntos-centrales">
<h3>¿Cómo calcular los puntos centrales?<a class="headerlink" href="#como-calcular-los-puntos-centrales" title="Permalink to this headline">¶</a></h3>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>El PBL-PLE recuérdese es:</p>
<p><span class="math notranslate nohighlight">\(
\displaystyle \min_{x \in \mathbb{R}^n} c^Tx - \frac{1}{t_B} \displaystyle \sum_{i=1}^n \log(x_i) \nonumber \\
\text{sujeto a:} \nonumber \\
Ax=b
\)</span></p>
<p>con <span class="math notranslate nohighlight">\(A \in \mathbb{R}^{m \times n}\)</span> y <em>rank</em> de <span class="math notranslate nohighlight">\(A\)</span> igual a <span class="math notranslate nohighlight">\(m &lt; n\)</span>.</p>
</div>
<p>Para calcular los puntos centrales del PBL-PLE se utiliza la <a class="reference internal" href="#primideametprimdual"><span class="std std-ref">primera idea: determinar la dirección de búsqueda</span></a> en la que se resuelve el siguiente sistema de ecuaciones no lineales con el método de Newton:</p>
<div class="math notranslate nohighlight">
\[\begin{split}F(x, \nu) = \left [ \begin{array}{c} c - A^T\nu - \frac{1}{t_B}d(t_B) \\ b- Ax(t) \end{array} \right ] = 0\end{split}\]</div>
<p>que requiere resolver el sistema de ecuaciones lineales:</p>
<div class="math notranslate nohighlight">
\[\begin{split}J_F(x, \nu) \left [ \begin{array}{c} \Delta x \\ \Delta \nu \end{array} \right ] = - F(x, \nu)\end{split}\]</div>
<p>donde: <span class="math notranslate nohighlight">\(J_F(x, \nu) = \left [ \begin{array}{cc} \nabla_{xx} ^2 \mathcal{L}^{BL}(x, \nu)  &amp;  \nabla_{\nu x} \mathcal{L}^{BL}(x,\nu) \\ -A &amp; 0\end{array} \right ] = \left [ \begin{array}{cc} \frac{1}{t_B} D^2(t_B) &amp;  -A^T \\ -A &amp; 0\end{array} \right ]\)</span> y <span class="math notranslate nohighlight">\(D^2(t_B) = \text{diag}^2(d(t_B)) \in \mathbb{R}^{n \times n}\)</span>.</p>
<p>La actualización en el método de Newton es:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\left [ \begin{array}{c} x \\ \nu \end{array} \right ]^{(k+1)} = \left [ \begin{array}{c} x \\ \nu \end{array} \right ]^{(k)} + t^{(k)}  \left [ \begin{array}{c} \Delta x \\ \Delta \nu \end{array} \right ]\end{split}\]</div>
<p>donde se utilizó la <a class="reference internal" href="#segunideaprimdual"><span class="std std-ref">segunda idea: cortar el paso</span></a>.</p>
<div class="tip admonition">
<p class="admonition-title">Observación</p>
<p>Se pueden eliminar los signos negativos que están en los bloques de la matriz del sistema de ecuaciones lineales anterior que contienen <span class="math notranslate nohighlight">\(A, A^T\)</span> pero por consistencia con lo desarrollado en la nota de dualidad se mantienen los signos negativos (si se eliminan también debe de ajustarse el lado derecho del sistema).</p>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>La FBL en el PBL-PLE recuérdese es:</p>
<p><span class="math notranslate nohighlight">\(
\begin{eqnarray}
\phi(x) &amp;=&amp; -\displaystyle \sum_{i=1}^n \log(-f_i(x)) \nonumber \\
&amp;=&amp; - \sum_{i=1}^n \log(x_i)
\end{eqnarray}
\)</span></p>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>El POCE recuérdese es:</p>
<p><span class="math notranslate nohighlight">\(
\begin{eqnarray}
\displaystyle \min_{x \in \mathbb{R}^n} &amp;f_o(x)&amp; \nonumber \\
&amp;\text{sujeto a:}&amp; \nonumber\\
f_i(x) &amp;\leq&amp; 0  \quad i=1,\dots,m \nonumber \\
Ax &amp;=&amp; b
\end{eqnarray}
\)</span></p>
<p>y el PBL es:</p>
<p><span class="math notranslate nohighlight">\(
\displaystyle \min_{x \in \mathbb{R}^n} f_B(x|t_B) \\
\text{sujeto a:} \\
Ax = b
\)</span></p>
<p>con <span class="math notranslate nohighlight">\(A \in \mathbb{R}^{p \times n}\)</span> y <em>rank</em> de <span class="math notranslate nohighlight">\(A\)</span> igual a <span class="math notranslate nohighlight">\(p &lt; n\)</span>.</p>
</div>
<div class="admonition-comentarios admonition">
<p class="admonition-title">Comentarios</p>
<ul class="simple">
<li><p>La forma general de la condición de KKT de optimalidad <span class="math notranslate nohighlight">\(\nabla_x \mathcal{L}^{BL}(x^, \nu) = 0\)</span> para un PBL que se obtuvo de un POCE es:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
\nabla_x \mathcal{L}^{BL}(x, \nu) &amp;=&amp; \nabla f_o(x) + \frac{1}{t_B}\nabla \phi(x) + A^T \nu = 0 \nonumber \\
&amp;=&amp; \nabla f_o(x) + \frac{1}{t_B} \displaystyle \sum_{i=1}^m \frac{\nabla f_i(x)}{-f_i(x)} + A^T \nu \nonumber \\
\end{eqnarray}
\end{split}\]</div>
<p>con: <span class="math notranslate nohighlight">\(\mathcal{L}: \mathbb{R}^n \times \mathbb{R}^p \rightarrow \mathbb{R}\)</span>,</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{eqnarray} \mathcal{L}^{BL}(x, \nu) &amp;=&amp; f_{BL}(x|t_B) + \sum_{i=1}^p \nu_i h_i(x) \nonumber \\
&amp;=&amp; f_o(x|t_B) + \frac{1}{t_B} \phi(x) + \nu^T(b-Ax)
\end{eqnarray}
\end{split}\]</div>
<p>y el sistema de ecuaciones lineales al aplicar el método de Newton al sistema de ecuaciones no lineales a resolver es:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\left [ \begin{array}{cc} \nabla^2f_o(x) + \frac{1}{t_B} \nabla^2 \phi(x)  &amp; -A^T \\ -A &amp; 0\end{array} \right ] \left [ \begin{array}{c} \Delta x \\ \Delta \nu \end{array} \right ] = -\left [ \begin{array}{c} \nabla f_o(x) + \frac{1}{t_B} \nabla \phi(x) \\ r_p \end{array} \right ]\end{split}\]</div>
<p>donde: <span class="math notranslate nohighlight">\(r_p = b - Ax\)</span> es el residual para factibilidad primal.</p>
<p>Ver <a class="reference internal" href="../../III.optimizacion_convexa/3.3/Ejemplos_problemas_UCO_e_intro_CIEO_y_PI.html#funlagrangiana"><span class="std std-ref">la función Lagrangiana</span></a>.</p>
</div>
<p><strong>Comentario para el que sería bueno mostrar un dibujo/gráfica:</strong></p>
<p>Valores más “grandes” de <span class="math notranslate nohighlight">\(t_B\)</span> hacen que la Hessiana de la función objetivo del PBL varíe rápidamente cerca de la frontera del conjunto factible.</p>
<div class="tip admonition">
<p class="admonition-title">Ejercicios</p>
<p>1.Resuelve los ejercicios y preguntas de la nota.</p>
</div>
<p><strong>Referencias:</strong></p>
<ol class="simple">
<li><p>S. P. Boyd, L. Vandenberghe, Convex Optimization, Cambridge University Press, 2009.</p></li>
<li><p>J. Nocedal, S. J. Wright, Numerical Optimization, Springer, 2006.</p></li>
<li><p>F. Hillier, G. Lieberman, Introduction to Operations Research, Mc Graw Hill, 2014.</p></li>
</ol>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "palmoreck/dockerfiles-for-binder",
            ref: "jupyterlab_optimizacion_2",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./IV.optimizacion_en_redes_y_prog_lineal/4.5"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="../4.4/Dualidad_lema_de_Farkas_condiciones_KKT_de_optimalidad.html" title="previous page">4.4 Dualidad, lema de Farkas y condiciones de Karush-Kuhn-Tucker (KKT) de optimalidad</a>
    <a class='right-next' id="next-link" href="../../V.optimizacion_de_codigo/5.1/introduccion_optimizacion_de_codigo.html" title="next page">5.1 Introducción optimización de código</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Erick Palacios Moreno<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../../_static/js/index.3da636dd464baa7582d2.js"></script>


    
  </body>
</html>