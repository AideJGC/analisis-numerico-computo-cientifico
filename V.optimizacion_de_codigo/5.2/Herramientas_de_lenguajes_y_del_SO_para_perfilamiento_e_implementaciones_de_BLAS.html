
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>5.2 Herramientas de lenguajes de programación y del sistema operativo para perfilamiento e implementaciones de BLAS</title>
    
  <link rel="stylesheet" href="../../_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe,.cell"
        const thebe_selector_input = "pre,.cell_input div.highlight"
        const thebe_selector_output = ".output,.cell_output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="6.1 Problemas tipo Unconstrained Convex Optimization (UCO)" href="../../VI.algoritmos_optimizacion_convexa/6.1/Problemas_UCO.html" />
    <link rel="prev" title="5.1 Introducción a optimización de código" href="../5.1/introduccion_optimizacion_de_codigo.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../../index.html">
  
  <img src="../../_static/logo.png" class="logo" alt="logo">
  
  
</a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../README.html">
   Optimización
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  I. Cómputo científico
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../I.computo_cientifico/1.1/Analisis_numerico_y_computo_cientifico.html">
   1.1 Análisis numérico y cómputo científico
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../I.computo_cientifico/1.2/Sistema_de_punto_flotante.html">
   1.2 Sistema de punto flotante
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../I.computo_cientifico/1.3/Normas_vectoriales_y_matriciales.html">
   1.3 Normas vectoriales y matriciales
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../I.computo_cientifico/1.4/Condicion_de_un_problema_y_estabilidad_de_un_algoritmo.html">
   1.4 Condición de un problema y estabilidad de un algoritmo
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../I.computo_cientifico/1.5/Definicion_de_funcion_continuidad_derivada.html">
   1.5 Definición de función, continuidad y derivada
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../I.computo_cientifico/1.6/Polinomios_de_Taylor_y_diferenciacion_numerica.html">
   1.6 Polinomios de Taylor y diferenciación numérica
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../I.computo_cientifico/1.7/Integracion_numerica.html">
   1.7 Integración Numérica
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  II. Cómputo matricial
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../II.computo_matricial/2.1/Operaciones_y_transformaciones_basicas_del_Algebra_Lineal_Numerica.html">
   2.1 Operaciones y transformaciones básicas del Álgebra Lineal Numérica
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../II.computo_matricial/2.2/Eigenvalores_y_eigenvectores.html">
   2.2 Eigenvalores y eigenvectores
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../II.computo_matricial/2.3/Algoritmos_y_aplicaciones_de_eigenvalores_eigenvectores_de_una_matriz.html">
   2.3 Algoritmos y aplicaciones de eigenvalores y eigenvectores de una matriz
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../II.computo_matricial/2.4/Valores_vectores_singulares_y_algoritmos_para_calcular_la_SVD.html">
   2.4 Valores, vectores singulares y algoritmos para calcular la SVD
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  III. Optimización convexa y ecuaciones no lineales
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../III.optimizacion_convexa/3.1/Definicion_de_problema_optimizacion_conjuntos_y_funciones_convexas.html">
   3.1 Definición de problemas de optimización, conjuntos y funciones convexas
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../III.optimizacion_convexa/3.2/Algoritmos_de_descenso_y_busqueda_de_linea_en_uco.html">
   3.2 Algoritmos de descenso y búsqueda de línea en
   <em>
    Unconstrained Convex Optimization
   </em>
   (UCO)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../III.optimizacion_convexa/3.3/Ejemplos_problemas_UCO_e_intro_CIEO_y_PI.html">
   3.3 Ejemplos de problemas UCO, introducción a
   <em>
    Constrained Inequality and Equality Optimization
   </em>
   (CIEO) y puntos interiores
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../III.optimizacion_convexa/3.4/Ecuaciones_no_lineales.html">
   3.4 Ecuaciones no lineales
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  IV. Optimización en redes y programación lineal
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../IV.optimizacion_en_redes_y_prog_lineal/4.1/Definiciones_generales_de_flujo_en_redes.html">
   4.1 Definiciones generales de flujo en redes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../IV.optimizacion_en_redes_y_prog_lineal/4.2/Programacion_lineal_y_metodo_simplex.html">
   4.2 Programación lineal (PL) y método símplex
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../IV.optimizacion_en_redes_y_prog_lineal/4.3/Ejemplo_metodo_simplex_de_redes.html">
   4.3 Ejemplo del método símplex de redes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../IV.optimizacion_en_redes_y_prog_lineal/4.4/Dualidad_lema_de_Farkas_condiciones_KKT_de_optimalidad.html">
   4.4 Dualidad, lema de Farkas y condiciones de Karush-Kuhn-Tucker (KKT) de optimalidad
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../IV.optimizacion_en_redes_y_prog_lineal/4.5/Metodo_primal_dual_de_BL.html">
   4.5 Método primal-dual de barrera logarítmica (BL)
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  V. Optimización de código
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../5.1/introduccion_optimizacion_de_codigo.html">
   5.1 Introducción a optimización de código
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   5.2 Herramientas de lenguajes de programación y del sistema operativo para perfilamiento e implementaciones de BLAS
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  VI. Algoritmos de optimización convexa
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../VI.algoritmos_optimizacion_convexa/6.1/Problemas_UCO.html">
   6.1 Problemas tipo
   <em>
    Unconstrained Convex Optimization
   </em>
   (UCO)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../VI.algoritmos_optimizacion_convexa/6.2/Problemas_CECO.html">
   6.2 Problemas tipo
   <em>
    Constrained Equality Convex Optimization
   </em>
   (CECO)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../VI.algoritmos_optimizacion_convexa/6.3/Problemas_CIECO.html">
   6.3 Problemas tipo
   <em>
    Constrained Equality and Inequality Convex Optimization
   </em>
   (CIECO)
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/V.optimizacion_de_codigo/5.2/Herramientas_de_lenguajes_y_del_SO_para_perfilamiento_e_implementaciones_de_BLAS.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/palmoreck/dockerfiles-for-binder/jupyterlab_optimizacion_2?urlpath=lab/tree/analisis-numerico-computo-cientifico/libro_optimizacion/temas/V.optimizacion_de_codigo/5.2/Herramientas_de_lenguajes_y_del_SO_para_perfilamiento_e_implementaciones_de_BLAS.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <button type="button" class="btn btn-secondary topbarbtn"
            onclick="initThebeSBT()" title="Launch Thebe" data-toggle="tooltip" data-placement="left"><i
                class="fas fa-play"></i><span style="margin-left: .4em;">Live Code</span></button>
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#perfilamiento-medicion-de-tiempo-en-python-y-ipython">
   Perfilamiento: medición de tiempo en
   <em>
    Python
   </em>
   y
   <em>
    IPython
   </em>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#modulo-time">
     Módulo: time
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#comando-de-magic-time">
     Comando de
     <em>
      magic
     </em>
     : %time
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#comando-de-magic-timeit">
     Comando de
     <em>
      magic
     </em>
     : %timeit
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#perfilamiento-medicion-de-uso-de-cpu-en-python">
   Perfilamiento: medición de uso de CPU en
   <em>
    Python
   </em>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cprofile">
     CProfile
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#line-profiler">
     line_profiler
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#perfilamiento-medicion-de-uso-de-memoria-en-python">
   Perfilamiento: medición de uso de memoria en
   <em>
    Python
   </em>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#memory-profiler">
     memory_profiler
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#heapy">
     heapy
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#basic-linear-algebra-subprograms-blas">
   <em>
    Basic Linear Algebra Subprograms
   </em>
   (BLAS)
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#operacion-del-producto-interno-estandar-o-producto-punto-nivel-1-de-blas">
     Operación del producto interno estándar o producto punto (nivel 1 de BLAS)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#ejemplo-y-algoritmo">
     Ejemplo y algoritmo
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#operacion-saxpy-nivel-1-de-blas">
     Operación
     <strong>
      saxpy
     </strong>
     (nivel 1 de BLAS)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Ejemplo y algoritmo
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#operacion-de-multiplicacion-matriz-vector-nivel-2-de-blas">
     Operación de multiplicación matriz-vector (nivel 2 de BLAS)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#ejemplo-y-algoritmo-gaxpy-row-oriented">
     Ejemplo y algoritmo gaxpy
     <em>
      row oriented
     </em>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#ejemplo-y-algoritmo-gaxpy-column-oriented">
     Ejemplo y algoritmo gaxpy
     <em>
      column oriented
     </em>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#operacion-de-multiplicacion-matriz-matriz-nivel-3-de-blas">
     Operación de multiplicación matriz-matriz (nivel 3 de BLAS)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#otras-versiones-de-la-multiplicacion-de-matrices-apoyandose-de-las-formas-i-j-k-j-k-i">
     Otras versiones de la multiplicación de matrices apoyándose de las formas (i,j,k), (j,k,i),…
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#operaciones-tipicas-del-algebra-lineal-y-los-flops-que-realizan">
     Operaciones típicas del álgebra lineal y los
     <em>
      flops
     </em>
     que realizan
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#blocking-algorithms-para-multiplicacion-de-matrices">
   Blocking algorithms para multiplicación de matrices
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#algunas-operaciones-en-matrices-por-bloques">
     Algunas operaciones en matrices por bloques
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#multiplicacion-por-escalares">
     Multiplicación por escalares
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#transposicion">
     Transposición
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#suma">
     Suma
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#multiplicacion">
     Multiplicación
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#openblas-y-numpy">
     OpenBLAS y
     <em>
      NumPy
     </em>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#resultados-utilizando-opt2-aws-educate-openblas-04-04-2021">
     Resultados utilizando
     <code class="docutils literal notranslate">
      <span class="pre">
       opt2-aws-educate-openblas-04-04-2021
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#multiplicacion-de-matrices">
     Multiplicación de matrices
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#factorizacion-lu">
     Factorización LU
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#resultados-utilizando-opt2-aws-educate-no-openblas-04-04-2021">
     Resultados utilizando
     <code class="docutils literal notranslate">
      <span class="pre">
       opt2-aws-educate-no-openblas-04-04-2021
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id2">
     Multiplicación de matrices
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#openblas-y-librerias-de-computo-matricial-de-r">
     OpenBLAS y librerías de cómputo matricial de
     <em>
      R
     </em>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id3">
     Resultados utilizando
     <code class="docutils literal notranslate">
      <span class="pre">
       opt2-aws-educate-openblas-04-04-2021
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id4">
     Resultados utilizando
     <code class="docutils literal notranslate">
      <span class="pre">
       opt2-aws-educate-no-openblas-04-04-2021
      </span>
     </code>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#perfilamiento-medicion-de-tiempo-en-el-sistema-operativo-ubuntu-20-04">
   Perfilamiento: medición de tiempo en el sistema operativo Ubuntu 20.04
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#usr-bin-time">
     /usr/bin/time
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#perfilamiento-medicion-de-uso-de-cpu-en-el-sistema-operativo-gnu-linux">
   Perfilamiento: medición de uso de CPU en el sistema operativo GNU/Linux
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#perf">
     perf
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#ejemplo-de-calculo-de-la-norma-2-al-cuadrado-de-un-vector">
     Ejemplo de cálculo de la norma
     <span class="math notranslate nohighlight">
      \(2\)
     </span>
     al cuadrado de un vector
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#check-next-results">
   Check next results:
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#perf-openblas-gaxpy-row-column-oriented-nivel-2">
     perf OpenBLAS:
     <em>
      gaxpy row, column oriented
     </em>
     (nivel 2)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#gaxpy-column-oriented-caso-no-vectorizado">
     <em>
      gaxpy column oriented
     </em>
     caso no vectorizado
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#gaxpy-column-oriented-caso-vectorizando">
     <em>
      gaxpy column oriented
     </em>
     caso vectorizando
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#gaxpy-row-oriented-caso-vectorizando">
     <em>
      gaxpy row oriented
     </em>
     caso vectorizando
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#perf-openblas-nivel-3-multiplicacion-de-matrices">
     perf OpenBLAS: nivel 3 multiplicación de matrices
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#comparacion-de-versiones-de-multiplicacion-de-matrices-utilizando-nivel-1-vs-nivel-2-de-blas">
     Comparación de versiones de multiplicación de matrices utilizando nivel 1 vs nivel 2 de BLAS
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#otras-herramientas-para-medicion-de-uso-de-cpu-en-el-sistema-operativo-gnu-linux">
     Otras herramientas para medición de uso de CPU en el sistema operativo GNU/Linux
    </a>
   </li>
  </ul>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="herramientas-de-lenguajes-de-programacion-y-del-sistema-operativo-para-perfilamiento-e-implementaciones-de-blas">
<span id="perfblas"></span><h1>5.2 Herramientas de lenguajes de programación y del sistema operativo para perfilamiento e implementaciones de BLAS<a class="headerlink" href="#herramientas-de-lenguajes-de-programacion-y-del-sistema-operativo-para-perfilamiento-e-implementaciones-de-blas" title="Permalink to this headline">¶</a></h1>
<div class="admonition-notas-para-contenedor-de-docker admonition">
<p class="admonition-title">Notas para contenedor de docker:</p>
<p>Comando de docker para ejecución de la nota de forma local:</p>
<p>nota: cambiar <code class="docutils literal notranslate"><span class="pre">&lt;ruta</span> <span class="pre">a</span> <span class="pre">mi</span> <span class="pre">directorio&gt;</span></code> por la ruta de directorio que se desea mapear a <code class="docutils literal notranslate"><span class="pre">/datos</span></code> dentro del contenedor de docker.</p>
<p><code class="docutils literal notranslate"><span class="pre">docker</span> <span class="pre">run</span> <span class="pre">--rm</span> <span class="pre">-v</span> <span class="pre">&lt;ruta</span> <span class="pre">a</span> <span class="pre">mi</span> <span class="pre">directorio&gt;:/datos</span> <span class="pre">--name</span> <span class="pre">jupyterlab_optimizacion_2</span> <span class="pre">-p</span> <span class="pre">8888:8888</span> <span class="pre">-p</span> <span class="pre">8787:8787</span> <span class="pre">-d</span> <span class="pre">palmoreck/jupyterlab_optimizacion_2:3.0.0</span></code></p>
<p>password para jupyterlab: <code class="docutils literal notranslate"><span class="pre">qwerty</span></code></p>
<p>Detener el contenedor de docker:</p>
<p><code class="docutils literal notranslate"><span class="pre">docker</span> <span class="pre">stop</span> <span class="pre">jupyterlab_optimizacion_2</span></code></p>
<p>Documentación de la imagen de docker <code class="docutils literal notranslate"><span class="pre">palmoreck/jupyterlab_optimizacion_2:3.0.0</span></code> en <a class="reference external" href="https://github.com/palmoreck/dockerfiles/tree/master/jupyterlab/optimizacion_2">liga</a>.</p>
</div>
<hr class="docutils" />
<div class="tip admonition">
<p class="admonition-title">Al final de esta nota el y la lectora:</p>
<ul class="simple">
<li></li>
</ul>
</div>
<p>En esta nota revisamos algunas herramientas de los lenguajes de programación y de los sistemas GNU/Linux para perfilamiento de código. También se revisan implementaciones de la especificación de <em>Basic Linear Algebra Subprograms</em> (BLAS) en sus diferentes niveles con ejemplos de paquetes en los lenguajes.</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Utilizamos la máquina <code class="docutils literal notranslate"><span class="pre">m4.16xlarge</span></code> pues en AWS no todas las instancias se pueden obtener algunas métricas con <code class="docutils literal notranslate"><span class="pre">perf</span></code>. Ver <a class="reference external" href="https://stackoverflow.com/questions/45683901/event-cache-misses-not-supported-by-perf-in-aws">stackoverflow1</a>, <a class="reference external" href="https://stackoverflow.com/questions/19763070/ubuntu-12-10-perf-stat-not-supported-cycles">stackoverflow2</a>, <a class="reference external" href="http://www.brendangregg.com/blog/2017-05-04/the-pmcs-of-ec2.html">the-pmcs-of-ec2</a></p>
</div>
<p>Se presentan códigos y sus ejecuciones en una máquina <code class="docutils literal notranslate"><span class="pre">m4.16xlarge</span></code> de la nube de <a class="reference external" href="https://aws.amazon.com/">AWS</a>. Se utilizó la AMI <code class="docutils literal notranslate"><span class="pre">opt2-aws-educate-openblas-04-04-2021</span></code> de la región <code class="docutils literal notranslate"><span class="pre">us-east-1</span></code> (Virginia) para reproducibilidad de resultados. Tal AMI se construyó a partir de una AMI <code class="docutils literal notranslate"><span class="pre">ubuntu</span> <span class="pre">20.04</span> <span class="pre">-</span> <span class="pre">ami-042e8287309f5df03</span></code> con el <a class="reference external" href="https://github.com/palmoreck/scripts_for_useful_tools_installations/blob/main/AWS/ubuntu_20.04/optimizacion_2/script_profiling_and_BLAS.sh">script_profiling_and_BLAS.sh</a></p>
<div class="admonition-comentario admonition">
<p class="admonition-title">Comentario</p>
<p>Si se utiliza la <em>AMI</em> <code class="docutils literal notranslate"><span class="pre">opt2-aws-educate-openblas-04-04-2021</span></code> colocar en <code class="docutils literal notranslate"><span class="pre">User</span> <span class="pre">data</span></code> el siguiente <em>script</em>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/bin/bash</span>
<span class="c1">##variables:</span>
<span class="nv">region</span><span class="o">=</span>us-east-1 <span class="c1">#make sure instance is in Virginia</span>
<span class="nv">name_instance</span><span class="o">=</span>OpenBLAS
<span class="nv">USER</span><span class="o">=</span>ubuntu
<span class="c1">##System update</span>
apt-get update -yq
<span class="c1">##Tag instance</span>
<span class="nv">INSTANCE_ID</span><span class="o">=</span><span class="k">$(</span>curl -s http://instance-data/latest/meta-data/instance-id<span class="k">)</span>
<span class="nv">PUBLIC_IP</span><span class="o">=</span><span class="k">$(</span>curl -s http://instance-data/latest/meta-data/public-ipv4<span class="k">)</span>
sudo -H -u <span class="nv">$USER</span> bash -c <span class="s2">&quot;/home/</span><span class="nv">$USER</span><span class="s2">/.local/bin/aws ec2 create-tags --resources </span><span class="nv">$INSTANCE_ID</span><span class="s2"> --tag Key=Name,Value=</span><span class="nv">$name_instance</span><span class="s2">-</span><span class="nv">$PUBLIC_IP</span><span class="s2"> --region=</span><span class="nv">$region</span><span class="s2">&quot;</span>
sudo -H -u <span class="nv">$USER</span> bash -c <span class="s2">&quot;cd / &amp;&amp; /home/</span><span class="nv">$USER</span><span class="s2">/.local/bin/jupyter lab --ip=0.0.0.0 --no-browser --config=/home/</span><span class="nv">$USER</span><span class="s2">/.jupyter/jupyter_notebook_config.py &amp;&quot;</span>
</pre></div>
</div>
</div>
<p>La máquina <code class="docutils literal notranslate"><span class="pre">m4.16xlarge</span></code> tiene las siguientes características:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">bash</span>
lscpu
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Architecture:                    x86_64
CPU op-mode(s):                  32-bit, 64-bit
Byte Order:                      Little Endian
Address sizes:                   46 bits physical, 48 bits virtual
CPU(s):                          64
On-line CPU(s) list:             0-63
Thread(s) per core:              2
Core(s) per socket:              16
Socket(s):                       2
NUMA node(s):                    2
Vendor ID:                       GenuineIntel
CPU family:                      6
Model:                           79
Model name:                      Intel(R) Xeon(R) CPU E5-2686 v4 @ 2.30GHz
Stepping:                        1
CPU MHz:                         2709.718
CPU max MHz:                     3000.0000
CPU min MHz:                     1200.0000
BogoMIPS:                        4600.02
Hypervisor vendor:               Xen
Virtualization type:             full
L1d cache:                       1 MiB
L1i cache:                       1 MiB
L2 cache:                        8 MiB
L3 cache:                        90 MiB
NUMA node0 CPU(s):               0-15,32-47
NUMA node1 CPU(s):               16-31,48-63
Vulnerability Itlb multihit:     KVM: Vulnerable
Vulnerability L1tf:              Mitigation; PTE Inversion
Vulnerability Mds:               Vulnerable: Clear CPU buffers attempted, no microcode; SMT Host state unknown
Vulnerability Meltdown:          Mitigation; PTI
Vulnerability Spec store bypass: Vulnerable
Vulnerability Spectre v1:        Mitigation; usercopy/swapgs barriers and __user pointer sanitization
Vulnerability Spectre v2:        Mitigation; Full generic retpoline, STIBP disabled, RSB filling
Vulnerability Srbds:             Not affected
Vulnerability Tsx async abort:   Vulnerable: Clear CPU buffers attempted, no microcode; SMT Host state unknown
Flags:                           fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush mmx fxsr sse sse2 ht syscall nx pdpe1gb rdtscp lm constant_tsc arch_perfmon rep_good nopl xtopology nonstop_tsc cpuid aperfmperf pni pclmulqdq monitor est ssse3 fma cx16 pcid sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand hypervisor lahf_lm abm cpuid_fault invpcid_single pti fsgsbase bmi1 hle avx2 smep bmi2 erms invpcid rtm xsaveopt ida
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">bash</span>
sudo lshw -C memory
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  *-firmware
       description: BIOS
       vendor: Xen
       physical id: 0
       version: 4.11.amazon
       date: 08/24/2006
       size: 96KiB
       capabilities: pci edd
  *-memory
       description: System Memory
       physical id: 1000
       size: 256GiB
       capabilities: ecc
       configuration: errordetection=multi-bit-ecc
     *-bank:0
          description: DIMM RAM
          physical id: 0
          slot: DIMM 0
          size: 16GiB
          width: 64 bits
     *-bank:1
          description: DIMM RAM
          physical id: 1
          slot: DIMM 1
          size: 16GiB
          width: 64 bits
     *-bank:2
          description: DIMM RAM
          physical id: 2
          slot: DIMM 2
          size: 16GiB
          width: 64 bits
     *-bank:3
          description: DIMM RAM
          physical id: 3
          slot: DIMM 3
          size: 16GiB
          width: 64 bits
     *-bank:4
          description: DIMM RAM
          physical id: 4
          slot: DIMM 4
          size: 16GiB
          width: 64 bits
     *-bank:5
          description: DIMM RAM
          physical id: 5
          slot: DIMM 5
          size: 16GiB
          width: 64 bits
     *-bank:6
          description: DIMM RAM
          physical id: 6
          slot: DIMM 6
          size: 16GiB
          width: 64 bits
     *-bank:7
          description: DIMM RAM
          physical id: 7
          slot: DIMM 7
          size: 16GiB
          width: 64 bits
     *-bank:8
          description: DIMM RAM
          physical id: 8
          slot: DIMM 8
          size: 16GiB
          width: 64 bits
     *-bank:9
          description: DIMM RAM
          physical id: 9
          slot: DIMM 9
          size: 16GiB
          width: 64 bits
     *-bank:10
          description: DIMM RAM
          physical id: a
          slot: DIMM 10
          size: 16GiB
          width: 64 bits
     *-bank:11
          description: DIMM RAM
          physical id: b
          slot: DIMM 11
          size: 16GiB
          width: 64 bits
     *-bank:12
          description: DIMM RAM
          physical id: c
          slot: DIMM 12
          size: 16GiB
          width: 64 bits
     *-bank:13
          description: DIMM RAM
          physical id: d
          slot: DIMM 13
          size: 16GiB
          width: 64 bits
     *-bank:14
          description: DIMM RAM
          physical id: e
          slot: DIMM 14
          size: 16GiB
          width: 64 bits
     *-bank:15
          description: DIMM RAM
          physical id: f
          slot: DIMM 15
          size: 16GiB
          width: 64 bits
</pre></div>
</div>
</div>
</div>
<div class="tip admonition">
<p class="admonition-title">Observación</p>
<p>En la celda anterior se utilizó el comando de <em>magic</em> <code class="docutils literal notranslate"><span class="pre">%%bash</span></code>. Algunos comandos de <em>magic</em> los podemos utilizar también con <em>import</em>’s. Ver <a class="reference external" href="https://ipython.readthedocs.io/en/stable/interactive/magics.html">ipython-magics</a></p>
</div>
<div class="section" id="perfilamiento-medicion-de-tiempo-en-python-y-ipython">
<h2>Perfilamiento: medición de tiempo en <em>Python</em> y <em>IPython</em><a class="headerlink" href="#perfilamiento-medicion-de-tiempo-en-python-y-ipython" title="Permalink to this headline">¶</a></h2>
<p>Lo más natural que podemos pensar en medir es el tiempo de ejecución de nuestros códigos. <em>Python</em> y <em>IPython</em> tienen herramientas para este propósito.</p>
<div class="section" id="modulo-time">
<h3>Módulo: <a class="reference external" href="https://docs.python.org/3/library/time.html#time.time">time</a><a class="headerlink" href="#modulo-time" title="Permalink to this headline">¶</a></h3>
<p>Imports y funciones de apoyo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">pytest</span> <span class="kn">import</span> <span class="n">approx</span>
<span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">quad</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">Rcf</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">n</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute numerical approximation using rectangle or mid-point</span>
<span class="sd">    method in an interval.</span>
<span class="sd">    Nodes are generated via formula: x_i = a+(i+1/2)h_hat for</span>
<span class="sd">    i=0,1,...,n-1 and h_hat=(b-a)/n</span>
<span class="sd">    Args:</span>
<span class="sd">    </span>
<span class="sd">        f (function): function expression of integrand.</span>
<span class="sd">        </span>
<span class="sd">        a (float): left point of interval.</span>
<span class="sd">        </span>
<span class="sd">        b (float): right point of interval.</span>
<span class="sd">        </span>
<span class="sd">        n (float): number of subintervals.</span>
<span class="sd">        </span>
<span class="sd">    Returns:</span>
<span class="sd">    </span>
<span class="sd">        sum_res (float): numerical approximation to integral</span>
<span class="sd">            of f in the interval a,b</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">h_hat</span><span class="o">=</span><span class="p">(</span><span class="n">b</span><span class="o">-</span><span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="n">n</span>
    <span class="n">nodes</span><span class="o">=</span><span class="p">[</span><span class="n">a</span><span class="o">+</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">h_hat</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">n</span><span class="p">)]</span>
    <span class="n">sum_res</span><span class="o">=</span><span class="mi">0</span>
    <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">nodes</span><span class="p">:</span>
        <span class="n">sum_res</span><span class="o">=</span><span class="n">sum_res</span><span class="o">+</span><span class="n">f</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">h_hat</span><span class="o">*</span><span class="n">sum_res</span>
</pre></div>
</div>
</div>
</div>
<p>Objetivo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="c1">#using math library</span>
<span class="n">a</span><span class="o">=</span><span class="mi">0</span>
<span class="n">b</span><span class="o">=</span><span class="mi">1</span>
<span class="n">obj</span><span class="p">,</span> <span class="n">err</span> <span class="o">=</span> <span class="n">quad</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.7468241328124271
</pre></div>
</div>
</div>
</div>
<p>Medición de tiempo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="mi">6</span>
<span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">res</span><span class="o">=</span><span class="n">Rcf</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
<span class="n">end_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">secs</span> <span class="o">=</span> <span class="n">end_time</span><span class="o">-</span><span class="n">start_time</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Rcf tomó&quot;</span><span class="p">,</span><span class="n">secs</span><span class="p">,</span><span class="s2">&quot;segundos&quot;</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Rcf tomó 0.39971065521240234 segundos
</pre></div>
</div>
</div>
</div>
<p>Prueba que se resuelve correctamente el problema:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">res</span> <span class="o">==</span> <span class="n">approx</span><span class="p">(</span><span class="n">obj</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="comando-de-magic-time">
<h3>Comando de <em>magic</em>: <a class="reference external" href="https://ipython.readthedocs.io/en/stable/interactive/magics.html#magic-time">%time</a><a class="headerlink" href="#comando-de-magic-time" title="Permalink to this headline">¶</a></h3>
<p>Nos regresa las mediciones siguientes:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">CPU</span> <span class="pre">times</span></code> que contiene:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">user</span></code>: mide la cantidad de tiempo de los <em>statements</em> que la CPU gastó para funciones que no están relacionadas con el <em>kernel</em> del sistema.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sys</span></code>: mide la cantidad de tiempo de los <em>statements</em> que la CPU gastó en funciones a nivel de kernel del sistema.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">total</span></code>: suma entre el <code class="docutils literal notranslate"><span class="pre">user</span></code> y <code class="docutils literal notranslate"><span class="pre">sys</span></code> para todos <strong>todos los <em>cores</em></strong>.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">Wall</span> <span class="pre">time</span></code>: mide el <em>wall clock</em> o <em>elapsed time</em> que se refiere al tiempo desde que inicia la ejecución de los <em>statements</em> hasta su finalización.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Out</span></code>: resultado.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">time</span> Rcf(f,a, b,n)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 365 ms, sys: 22.9 ms, total: 388 ms
Wall time: 386 ms
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.7468241328124773
</pre></div>
</div>
</div>
</div>
<div class="admonition-comentarios admonition">
<p class="admonition-title">Comentarios</p>
<ul class="simple">
<li><p>Para mediciones de tiempos que involucran cómputo en paralelo es posible que <code class="docutils literal notranslate"><span class="pre">total</span></code> exceda a <code class="docutils literal notranslate"><span class="pre">Wall</span> <span class="pre">time</span></code> por una diferencia notable pues es la suma de tiempos para todos los <em>cores</em>.</p></li>
<li><p>Recuérdese que algunos ejemplos de funciones relacionadas con el <em>kernel</em> del sistema es el alojamiento, lectura y escritura de variables en memoria, las relacionadas con el I/O de disco o <em>network</em>.</p></li>
<li><p>La diferencia entre <code class="docutils literal notranslate"><span class="pre">total</span></code> y <code class="docutils literal notranslate"><span class="pre">Wall</span> <span class="pre">time</span></code> da una idea de la cantidad de tiempo que se ocupó el sistema en la ejecución de <em>statements</em> que no involucran <code class="docutils literal notranslate"><span class="pre">user</span></code> ni a <code class="docutils literal notranslate"><span class="pre">sys</span></code> (por ejemplo un <em>statement</em> del tipo <code class="docutils literal notranslate"><span class="pre">sleep</span></code>) o en tareas no relacionadas con los <em>statements</em> medidos (por ejemplo si en el momento de la medición se estaban corriendo otros procesos).</p></li>
</ul>
</div>
<p>Al medir tiempos de ejecución, <strong>siempre</strong> hay variación en la medición por lo que se recomienda realizar las mediciones un número repetido de veces. Para este caso el comando de <em>magic</em> <code class="docutils literal notranslate"><span class="pre">%timeit</span></code> nos ayuda.</p>
</div>
<div class="section" id="comando-de-magic-timeit">
<h3>Comando de <em>magic</em>: <a class="reference external" href="https://ipython.readthedocs.io/en/stable/interactive/magics.html#magic-timeit">%timeit</a><a class="headerlink" href="#comando-de-magic-timeit" title="Permalink to this headline">¶</a></h3>
<p>A continuación se mide el tiempo de ejecución para la función <code class="docutils literal notranslate"><span class="pre">Rcf</span></code>. Se promedian los tiempos de <span class="math notranslate nohighlight">\(n=5\)</span> ejecuciones y se calcula su desviación estándar. Se reptite lo anterior <span class="math notranslate nohighlight">\(r=10\)</span> veces y se reporta el mejor resultado.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">timeit</span> -n 5 -r 10 Rcf(f,a, b,n)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>369 ms ± 1.99 ms per loop (mean ± std. dev. of 10 runs, 5 loops each)
</pre></div>
</div>
</div>
</div>
<div class="tip admonition">
<p class="admonition-title">Observación</p>
<p><span class="math notranslate nohighlight">\(ms\)</span> es milisecond, <span class="math notranslate nohighlight">\(\mu s\)</span> es microsecond y <span class="math notranslate nohighlight">\(ns\)</span> es nanosecond.</p>
</div>
<div class="admonition-comentarios admonition">
<p class="admonition-title">Comentarios</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">%timeit</span></code> se recomienda usar para secciones de código pequeñas. Si se observa una variación en las mediciones de tiempo entre distintas repeticiones entonces hay que realizar más repeticiones hasta tener un resultado estable.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">%timeit</span></code> desabilita temporalmente el <em>garbage collector</em> de <em>Python</em> (esto es, no habrá desalojamiento en memoria de objetos de Python que no se utilicen). Si el <em>garbage collector</em> es invocado en tus <em>statements</em>, esto puede ser una razón de posibles diferencias que se obtengan en las mediciones de tiempo.</p></li>
</ul>
</div>
</div>
</div>
<div class="section" id="perfilamiento-medicion-de-uso-de-cpu-en-python">
<h2>Perfilamiento: medición de uso de CPU en <em>Python</em><a class="headerlink" href="#perfilamiento-medicion-de-uso-de-cpu-en-python" title="Permalink to this headline">¶</a></h2>
<div class="section" id="cprofile">
<h3><a class="reference external" href="https://docs.python.org/2/library/profile.html">CProfile</a><a class="headerlink" href="#cprofile" title="Permalink to this headline">¶</a></h3>
<p>See:</p>
<p>https://stackoverflow.com/questions/51536411/saving-cprofile-results-to-readable-external-file</p>
<p>https://stackoverflow.com/questions/21274898/python-getting-meaningful-results-from-cprofile</p>
<p>https://stackoverflow.com/questions/23805312/filter-profiler-files-with-maximum-cumulative-time-greater-then-x</p>
<p><em>CProfile</em> es <code class="docutils literal notranslate"><span class="pre">built-in</span></code> en la <em>standard-library</em> de Python. Se utiliza con la implementación <code class="docutils literal notranslate"><span class="pre">CPython</span></code> de <code class="docutils literal notranslate"><span class="pre">Python</span></code> para medir el tiempo de ejecución de cada función en el programa. Se ejecuta desde la línea de comandos con un comando de <em>magic</em> o realizando <code class="docutils literal notranslate"><span class="pre">import</span></code>. La flag <code class="docutils literal notranslate"><span class="pre">-s</span></code> por la ejecución vía línea de comando, indica que se ordene el resultado por el tiempo acumulado dentro de cada función.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cProfile</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="mi">6</span>
<span class="n">pr</span> <span class="o">=</span> <span class="n">cProfile</span><span class="o">.</span><span class="n">Profile</span><span class="p">()</span>
<span class="n">pr</span><span class="o">.</span><span class="n">enable</span><span class="p">()</span>
<span class="n">res</span><span class="o">=</span><span class="n">Rcf</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
<span class="n">pr</span><span class="o">.</span><span class="n">disable</span><span class="p">()</span>
<span class="n">pr</span><span class="o">.</span><span class="n">print_stats</span><span class="p">(</span><span class="n">sort</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>         2000047 function calls in 3.050 seconds

   Ordered by: internal time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
  1000000    1.468    0.000    2.139    0.000 &lt;ipython-input-3-e098c9ed7b86&gt;:1(&lt;lambda&gt;)
        1    0.759    0.759    3.040    3.040 &lt;ipython-input-2-303d3a3bb088&gt;:1(Rcf)
  1000000    0.671    0.000    0.671    0.000 {built-in method math.exp}
        1    0.142    0.142    0.142    0.142 &lt;ipython-input-2-303d3a3bb088&gt;:23(&lt;listcomp&gt;)
        1    0.010    0.010    3.050    3.050 &lt;ipython-input-6-ebe01b6d678c&gt;:4(&lt;module&gt;)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.compile}
        2    0.000    0.000    3.050    1.525 interactiveshell.py:3396(run_code)
        2    0.000    0.000    0.000    0.000 contextlib.py:117(__exit__)
        2    0.000    0.000    0.000    0.000 codeop.py:140(__call__)
        2    0.000    0.000    0.000    0.000 hooks.py:103(__call__)
        2    0.000    0.000    0.000    0.000 contextlib.py:82(__init__)
        4    0.000    0.000    0.000    0.000 compilerop.py:166(extra_flags)
        1    0.000    0.000    0.000    0.000 &lt;ipython-input-6-ebe01b6d678c&gt;:5(&lt;module&gt;)
        4    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        4    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        2    0.000    0.000    0.000    0.000 ipstruct.py:125(__getattr__)
        2    0.000    0.000    3.050    1.525 {built-in method builtins.exec}
        2    0.000    0.000    0.000    0.000 interactiveshell.py:3334(compare)
        2    0.000    0.000    0.000    0.000 contextlib.py:108(__enter__)
        2    0.000    0.000    0.000    0.000 traitlets.py:564(__get__)
        2    0.000    0.000    0.000    0.000 hooks.py:168(pre_run_code_hook)
        2    0.000    0.000    0.000    0.000 contextlib.py:238(helper)
        2    0.000    0.000    0.000    0.000 traitlets.py:533(get)
        1    0.000    0.000    0.000    0.000 {method &#39;disable&#39; of &#39;_lsprof.Profiler&#39; objects}
        2    0.000    0.000    0.000    0.000 interactiveshell.py:1278(user_global_ns)
</pre></div>
</div>
</div>
</div>
<p>El output siguiente de <code class="docutils literal notranslate"><span class="pre">cProfile</span></code> muestra:</p>
<ul class="simple">
<li><p>El tiempo total de ejecución, el cual incluye el tiempo del bloque de código que estamos midiendo y el overhead al usar <code class="docutils literal notranslate"><span class="pre">cProfile</span></code>. Por esta razón se tiene un mayor tiempo de ejecución que con las mediciones de tiempo anteriores.</p></li>
<li><p>La columna <code class="docutils literal notranslate"><span class="pre">ncalls</span></code> que como el nombre indica, muestra el número de veces que se llamó a cada función. En este caso las funciones <code class="docutils literal notranslate"><span class="pre">lambda</span></code> y <code class="docutils literal notranslate"><span class="pre">math.exp</span></code> son las que se llaman un mayor número de veces: <span class="math notranslate nohighlight">\(n=10^6\)</span> veces. La columna<code class="docutils literal notranslate"><span class="pre">tottime</span></code> muestra el tiempo que tardaron estas funciones en ejecutarse (sin llamar a otras funciones).</p></li>
<li><p>La columna <code class="docutils literal notranslate"><span class="pre">percall</span></code> es el cociente entre <code class="docutils literal notranslate"><span class="pre">tottime</span></code> y <code class="docutils literal notranslate"><span class="pre">ncalls</span></code>.</p></li>
<li><p>La columna <code class="docutils literal notranslate"><span class="pre">cumtime</span></code> contiene el tiempo gastado en la función y en las demás que llama. Por ejemplo la función <code class="docutils literal notranslate"><span class="pre">Rcf</span></code> llama a <code class="docutils literal notranslate"><span class="pre">listcomp</span></code> por lo que es natural que <code class="docutils literal notranslate"><span class="pre">Rcf</span></code> esté más arriba en el output ordenado de <code class="docutils literal notranslate"><span class="pre">cProfile</span></code>. Esto también ocurre con <code class="docutils literal notranslate"><span class="pre">lambda</span></code> y <code class="docutils literal notranslate"><span class="pre">math.exp</span></code> pues la primera llama a la segunda.</p></li>
<li><p>La columna de <code class="docutils literal notranslate"><span class="pre">percall</span></code> es un cociente entre la columna <code class="docutils literal notranslate"><span class="pre">cumtime</span></code> y el llamado a primitivas.</p></li>
<li><p>La última columna indica información de la función y la línea en la que se encuentra dentro del código. La forma como se está ejecutando vía un <em>jupyter notebook</em> no es muy ilustrativa. Compárese con lo siguiente en donde se obtendrá que la línea <span class="math notranslate nohighlight">\(1\)</span> del módulo es el llamado a la función <code class="docutils literal notranslate"><span class="pre">__main__</span></code>. La línea <span class="math notranslate nohighlight">\(2\)</span> es el llamado a la función <code class="docutils literal notranslate"><span class="pre">Rcf</span></code>.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%file</span> Rcf.py
<span class="kn">import</span> <span class="nn">math</span>

<span class="kn">from</span> <span class="nn">pytest</span> <span class="kn">import</span> <span class="n">approx</span>
<span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">quad</span>
<span class="k">def</span> <span class="nf">Rcf</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">n</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute numerical approximation using rectangle or mid-point</span>
<span class="sd">    method in an interval.</span>
<span class="sd">    Nodes are generated via formula: x_i = a+(i+1/2)h_hat for</span>
<span class="sd">    i=0,1,...,n-1 and h_hat=(b-a)/n</span>
<span class="sd">    Args:</span>
<span class="sd">    </span>
<span class="sd">        f (function): function expression of integrand.</span>
<span class="sd">        </span>
<span class="sd">        a (float): left point of interval.</span>
<span class="sd">        </span>
<span class="sd">        b (float): right point of interval.</span>
<span class="sd">        </span>
<span class="sd">        n (float): number of subintervals.</span>
<span class="sd">        </span>
<span class="sd">    Returns:</span>
<span class="sd">    </span>
<span class="sd">        sum_res (float): numerical approximation to integral</span>
<span class="sd">            of f in the interval a,b</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">h_hat</span><span class="o">=</span><span class="p">(</span><span class="n">b</span><span class="o">-</span><span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="n">n</span>
    <span class="n">nodes</span><span class="o">=</span><span class="p">[</span><span class="n">a</span><span class="o">+</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">h_hat</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">n</span><span class="p">)]</span>
    <span class="n">sum_res</span><span class="o">=</span><span class="mi">0</span>
    <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">nodes</span><span class="p">:</span>
        <span class="n">sum_res</span><span class="o">=</span><span class="n">sum_res</span><span class="o">+</span><span class="n">f</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">h_hat</span><span class="o">*</span><span class="n">sum_res</span>
<span class="k">if</span> <span class="vm">__name__</span><span class="o">==</span><span class="s2">&quot;__main__&quot;</span><span class="p">:</span> <span class="c1">#añadimos este bloque para ejecución de la función Rcf</span>
    <span class="n">a</span><span class="o">=</span><span class="mi">0</span>
    <span class="n">b</span><span class="o">=</span><span class="mi">1</span>
    <span class="n">f</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">obj</span><span class="p">,</span> <span class="n">err</span> <span class="o">=</span> <span class="n">quad</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;objetivo: </span><span class="si">{:0.6e}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">obj</span><span class="p">))</span>
    <span class="n">n</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="mi">6</span>
    <span class="n">res</span><span class="o">=</span><span class="n">Rcf</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;aproximación: </span><span class="si">{:0.6e}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">res</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">res</span> <span class="o">==</span> <span class="n">approx</span><span class="p">(</span><span class="n">obj</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Writing Rcf.py
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#%%bash</span>
<span class="c1">#python3 -m cProfile -s cumulative Rcf.py</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="line-profiler">
<h3><a class="reference external" href="https://pypi.org/project/line-profiler/">line_profiler</a><a class="headerlink" href="#line-profiler" title="Permalink to this headline">¶</a></h3>
</div>
</div>
<div class="section" id="perfilamiento-medicion-de-uso-de-memoria-en-python">
<h2>Perfilamiento: medición de uso de memoria en <em>Python</em><a class="headerlink" href="#perfilamiento-medicion-de-uso-de-memoria-en-python" title="Permalink to this headline">¶</a></h2>
<div class="section" id="memory-profiler">
<h3><a class="reference external" href="https://pypi.org/project/memory-profiler/">memory_profiler</a><a class="headerlink" href="#memory-profiler" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="heapy">
<h3><a class="reference external" href="https://pypi.org/project/guppy/">heapy</a><a class="headerlink" href="#heapy" title="Permalink to this headline">¶</a></h3>
</div>
</div>
<div class="section" id="basic-linear-algebra-subprograms-blas">
<h2><em>Basic Linear Algebra Subprograms</em> (BLAS)<a class="headerlink" href="#basic-linear-algebra-subprograms-blas" title="Permalink to this headline">¶</a></h2>
<p>De acuerdo a la especificación BLAS, hay diferentes niveles dependiendo del número de datos y cantidad de operaciones a realizar que involucran tales datos.</p>
<div class="section" id="operacion-del-producto-interno-estandar-o-producto-punto-nivel-1-de-blas">
<h3>Operación del producto interno estándar o producto punto (nivel 1 de BLAS)<a class="headerlink" href="#operacion-del-producto-interno-estandar-o-producto-punto-nivel-1-de-blas" title="Permalink to this headline">¶</a></h3>
<p>Consideramos <span class="math notranslate nohighlight">\(x,y \in \mathbb{R}^n\)</span>. El producto punto entre <span class="math notranslate nohighlight">\(x\)</span> y <span class="math notranslate nohighlight">\(y\)</span> es <span class="math notranslate nohighlight">\(c = x^Ty = \displaystyle \sum_{i=1}^n x_iy_i\)</span>.</p>
</div>
<div class="section" id="ejemplo-y-algoritmo">
<h3>Ejemplo y algoritmo<a class="headerlink" href="#ejemplo-y-algoritmo" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">c</span><span class="o">=</span><span class="mi">0</span>
<span class="n">n</span><span class="o">=</span><span class="mi">5</span>
<span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">n</span>
<span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="mf">1.5</span><span class="p">]</span><span class="o">*</span><span class="n">n</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">c</span> <span class="o">+=</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">c</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-7.5
</pre></div>
</div>
</div>
</div>
<div class="admonition-comentarios admonition">
<p class="admonition-title">Comentarios</p>
<ul class="simple">
<li><p>El producto punto de dos <span class="math notranslate nohighlight">\(n\)</span>-vectores involucran <span class="math notranslate nohighlight">\(n\)</span> multiplicaciones y <span class="math notranslate nohighlight">\(n\)</span> sumas para un total de <span class="math notranslate nohighlight">\(2n\)</span> operaciones o <a class="reference external" href="https://en.wikipedia.org/wiki/FLOPS">floating point operations per second</a> (flops). Usamos la notación <span class="math notranslate nohighlight">\(\mathcal{O}(\cdot)\)</span> para escribir que el producto punto es <span class="math notranslate nohighlight">\(\mathcal{O}(n)\)</span> y se lee “de orden <span class="math notranslate nohighlight">\(n\)</span> o proporcional a <span class="math notranslate nohighlight">\(n\)</span>” para indicar que la <strong>cantidad de trabajo</strong> tiene un comportamiento <strong>lineal</strong> con la dimensión <span class="math notranslate nohighlight">\(n\)</span>. También tal cantidad de trabajo opera sobre una <strong>cantidad lineal de datos</strong>.</p></li>
<li><p>Los <em>flops</em> que realiza un algoritmo es una forma de cuantificar el volumen de trabajo asociado con un cálculo. Un <em>flop</em> es una operación de punto flotante: suma, multiplicación o división. Por ejemplo, en la línea:</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">C</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">C</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="n">B</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>
</pre></div>
</div>
<p>se realizan <span class="math notranslate nohighlight">\(2\)</span> <em>flops</em>. Los flops sólo representan una componente para categorizar a los algoritmos de acuerdo al trabajo que realizan, otras componentes son la transferencia o movimientos de datos, <em>data movement/motion</em>, ejecución secuencial o en paralelo y el <em>data locality</em> y <em>data reuse</em> que realizan.</p>
<ul class="simple">
<li><p>En LAPACK encontramos <a class="reference external" href="http://www.netlib.org/lapack/explore-html/d0/d16/sdot_8f.html">sdot</a>, <a class="reference external" href="http://www.netlib.org/lapack/explore-html/d5/df6/ddot_8f.html">ddot</a>, <a class="reference external" href="http://www.netlib.org/lapack/explore-html/d7/d7b/cdotu_8f.html">cdotu</a> y <a class="reference external" href="http://www.netlib.org/lapack/explore-html/db/d2d/zdotu_8f.html">zdotu</a> para descripción de las funciones/subrutinas escritas en <a class="reference external" href="https://en.wikipedia.org/wiki/Fortran">Fortran</a> del producto punto en los casos de precisión simple, doble o números complejos respectivamente.</p></li>
</ul>
</div>
</div>
<div class="section" id="operacion-saxpy-nivel-1-de-blas">
<h3>Operación <strong>saxpy</strong> (nivel 1 de BLAS)<a class="headerlink" href="#operacion-saxpy-nivel-1-de-blas" title="Permalink to this headline">¶</a></h3>
<p>Consideramos <span class="math notranslate nohighlight">\(\alpha \in \mathbb{R}, x,y \in \mathbb{R}^n\)</span>. El nombre lo recibe por <em>scalar alpha x plus y</em>. En LAPACK <a class="reference external" href="http://www.netlib.org/lapack/explore-html/d8/daf/saxpy_8f.html">saxpy</a> se escribe en forma <em>update</em>:</p>
<div class="math notranslate nohighlight">
\[y=\alpha x + y \therefore y_i = \alpha x_i + y_i \forall i=1,...,n\]</div>
<div class="admonition-comentarios admonition">
<p class="admonition-title">Comentarios</p>
<ul class="simple">
<li><p>El símbolo “=” no se utiliza como igualdad de expresiones sino para denotar asignación (como en computación al escribir un algoritmo).</p></li>
<li><p>También encontramos en LAPACK <a class="reference external" href="http://www.netlib.org/lapack/explore-html/de/da2/caxpy_8f.html">caxpy</a> o <a class="reference external" href="http://www.netlib.org/lapack/explore-html/d9/dcd/daxpy_8f.html">daxpy</a> para el caso complejo y para números en doble precisión respectivamente.</p></li>
<li><p>Ésta operación realiza un trabajo de <span class="math notranslate nohighlight">\(\mathcal{O}(n)\)</span> sobre una cantidad de datos <span class="math notranslate nohighlight">\(\mathcal{O}(n)\)</span>.</p></li>
</ul>
</div>
</div>
<div class="section" id="id1">
<h3>Ejemplo y algoritmo<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span><span class="o">=</span><span class="mi">2</span>
<span class="n">n</span><span class="o">=</span><span class="mi">5</span>
<span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">n</span>
<span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">n</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="n">alpha</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[-4, -4, -4, -4, -4]
</pre></div>
</div>
</div>
</div>
<p>o en una forma <em>update</em>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span><span class="o">=</span><span class="mi">2</span>
<span class="n">n</span><span class="o">=</span><span class="mi">5</span>
<span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">n</span>
<span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="n">alpha</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[-1, 0, -5, -4, -3]
</pre></div>
</div>
</div>
</div>
<div class="admonition-comentario admonition">
<p class="admonition-title">Comentario</p>
<p>La operación de producto punto y <em>saxpy</em> son algoritmos catalogados como de <strong>nivel BLAS 1</strong>, ver <a class="reference external" href="https://en.wikipedia.org/wiki/Basic_Linear_Algebra_Subprograms">BLAS: Basic Linear Algebra Subprograms</a>. Éstos algoritmos se caracterizan por involucrar una cantidad de trabajo lineal sobre una cantidad lineal de datos. Ver <a class="reference external" href="http://www.netlib.org/blas/#_level_1">level 1</a> para más ejemplos de este tipo de algoritmos.</p>
</div>
</div>
<div class="section" id="operacion-de-multiplicacion-matriz-vector-nivel-2-de-blas">
<h3>Operación de multiplicación matriz-vector (nivel 2 de BLAS)<a class="headerlink" href="#operacion-de-multiplicacion-matriz-vector-nivel-2-de-blas" title="Permalink to this headline">¶</a></h3>
<p>Consideramos <span class="math notranslate nohighlight">\(A \in \mathbb{R}^{m \times n}, x \in \mathbb{R}^n, y \in \mathbb{R}^m\)</span>. La operación <span class="math notranslate nohighlight">\(y = y + Ax\)</span> es una operación <em>generalizada</em> saxpy, por ello se denomina <strong>gaxpy</strong> pero en LAPACK podemos encontrarla con nombres como <a class="reference external" href="http://www.netlib.org/lapack/explore-html/db/d58/sgemv_8f.html">sgemv</a>, <a class="reference external" href="http://www.netlib.org/lapack/explore-html/dc/da8/dgemv_8f.html">dgemv</a>, <a class="reference external" href="http://www.netlib.org/lapack/explore-html/d4/d8a/cgemv_8f.html">cgemv</a> o <a class="reference external" href="http://www.netlib.org/lapack/explore-html/db/d40/zgemv_8f.html">zgemv</a> para los casos de precisión simple, doble o números complejos respectivamente. Hay diferentes formas de visualizar y escribir el algoritmo de multiplicación matriz-vector. Por ejemplo para una matriz <span class="math notranslate nohighlight">\(A\)</span> con entradas:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span><span class="o">=</span><span class="mi">2</span>
<span class="n">n</span><span class="o">=</span><span class="mi">5</span>
<span class="n">A</span><span class="o">=</span><span class="p">[[</span><span class="mf">1.2</span><span class="p">]</span><span class="o">*</span><span class="n">n</span> <span class="k">if</span> <span class="n">i</span><span class="o">%</span><span class="k">2</span>==0 else [1]*n for i in range(m)]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[1.2, 1.2, 1.2, 1.2, 1.2], [1, 1, 1, 1, 1]]
</pre></div>
</div>
</div>
</div>
<p>se tiene:</p>
</div>
<div class="section" id="ejemplo-y-algoritmo-gaxpy-row-oriented">
<h3>Ejemplo y algoritmo gaxpy <em>row oriented</em><a class="headerlink" href="#ejemplo-y-algoritmo-gaxpy-row-oriented" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">n</span>
<span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">m</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+=</span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[12.0, 10]
</pre></div>
</div>
</div>
</div>
<p>Si <span class="math notranslate nohighlight">\(y\)</span> tiene valores distintos de <span class="math notranslate nohighlight">\(0\)</span>, se realiza un <em>update</em>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">n</span>
<span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">m</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+=</span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[11.0, 9]
</pre></div>
</div>
</div>
</div>
<div class="admonition-comentarios admonition">
<p class="admonition-title">Comentarios</p>
<ul class="simple">
<li><p>En la versión <em>row oriented</em> del algoritmo <em>gaxpy</em>, el <strong>inner loop</strong> realiza <strong>productos punto</strong> entre el <span class="math notranslate nohighlight">\(i\)</span>-ésimo renglón de <span class="math notranslate nohighlight">\(A\)</span> y el vector <span class="math notranslate nohighlight">\(x\)</span>. Se realizan <span class="math notranslate nohighlight">\(m\)</span> productos punto <span class="math notranslate nohighlight">\(A[i,:]^Tx\)</span></p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
    <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+=</span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span><span class="o">*</span><span class="n">x</span> <span class="c1">#producto punto</span>
    
</pre></div>
</div>
<p>donde: <span class="math notranslate nohighlight">\(A[i,:]\)</span> es el <span class="math notranslate nohighlight">\(i\)</span>-ésimo renglón de <span class="math notranslate nohighlight">\(A\)</span>. Así podemos reescribir de forma más compacta este algoritmo.</p>
<p>Sin embargo como hemos visto en Python con su implementación más común CPython, no es posible realizar tal indexado pues resulta en el error:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">---------------------------------------------------------------------------</span>
<span class="ne">TypeError</span>                                 <span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">)</span>
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">14</span><span class="o">-</span><span class="mi">8</span><span class="n">ae2a3e9d101</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
      <span class="mi">1</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
<span class="o">----&gt;</span> <span class="mi">2</span>     <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+=</span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span><span class="o">*</span><span class="n">x</span> <span class="c1">#producto punto</span>
      <span class="mi">3</span> 

<span class="ne">TypeError</span><span class="p">:</span> <span class="nb">list</span> <span class="n">indices</span> <span class="n">must</span> <span class="n">be</span> <span class="n">integers</span> <span class="ow">or</span> <span class="n">slices</span><span class="p">,</span> <span class="ow">not</span> <span class="nb">tuple</span>
</pre></div>
</div>
<p>a menos que incorporemos alguna paquetería que permita la <strong>vectorización</strong> y el uso de índices para extracción de columnas (o renglones) de <span class="math notranslate nohighlight">\(A\)</span> como <em>NumPy</em>.</p>
</div>
<div class="tip admonition">
<p class="admonition-title">Observación</p>
<p>Obsérvese que el acceso a la matriz <span class="math notranslate nohighlight">\(A\)</span> del algoritmo <em>gaxpy row oriented</em> es <strong>por renglón</strong>, de ahí el nombre.</p>
</div>
<p>También puede escribirse al algoritmo <em>gaxpy</em> en una forma orientada por columnas.</p>
</div>
<div class="section" id="ejemplo-y-algoritmo-gaxpy-column-oriented">
<h3>Ejemplo y algoritmo gaxpy <em>column oriented</em><a class="headerlink" href="#ejemplo-y-algoritmo-gaxpy-column-oriented" title="Permalink to this headline">¶</a></h3>
<p>Este algoritmo ayuda a visualizar al producto matriz-vector como una combinación lineal de las columnas de <span class="math notranslate nohighlight">\(A\)</span>:</p>
<div class="math notranslate nohighlight">
\[Ax = \displaystyle \sum_{j=1}^n A_jx_j\]</div>
<p>con <span class="math notranslate nohighlight">\(A_j\)</span> la <span class="math notranslate nohighlight">\(j\)</span>-ésima columna de <span class="math notranslate nohighlight">\(A\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">n</span>
<span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">m</span>
<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
        <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+=</span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[12.0, 10]
</pre></div>
</div>
</div>
</div>
<div class="admonition-comentarios admonition">
<p class="admonition-title">Comentarios</p>
<ul class="simple">
<li><p>El algoritmo de multiplicación matriz-vector (versión <em>row</em> o <em>column</em> oriented) involucra <span class="math notranslate nohighlight">\(\mathcal{O}(mn)\)</span> operaciones o una cantidad <strong>cuadrática</strong> de trabajo, que podemos entender como “si duplicamos cada dimensión de <span class="math notranslate nohighlight">\(A\)</span> entonces la cantidad de trabajo se incrementa por un factor de <span class="math notranslate nohighlight">\(4\)</span>”. Tal número de operaciones trabajan sobre una matriz o sobre una cantidad <strong>cuadrática</strong> de datos. A los algoritmos que realizan una cantidad cuadrática de trabajo sobre una cantidad cuadrática de datos se les cataloga de <strong>nivel BLAS 2</strong>. Ver <a class="reference external" href="http://www.netlib.org/blas/#_level_2">level 2</a> para más ejemplos de algoritmos en el álgebra lineal en esta categoría.</p></li>
<li><p>En el algoritmo <em>gaxpy column oriented</em> el acceso a la matriz <span class="math notranslate nohighlight">\(A\)</span> es por columna.</p></li>
<li><p>La versión <em>column oriented</em> se puede analizar desde el punto de vista puramente algorítmico como un intercambio entre las líneas con los índices <span class="math notranslate nohighlight">\(i\)</span> y <span class="math notranslate nohighlight">\(j\)</span> de cada <em>loop</em> y un acceso a los datos de la matriz por columna. O bien, se puede analizar desde el álgebra lineal indicando que el vector <span class="math notranslate nohighlight">\(y\)</span> está en el espacio generado por las columnas de <span class="math notranslate nohighlight">\(A\)</span> y cuyas coordenadas son dadas por las entradas del vector <span class="math notranslate nohighlight">\(x\)</span>:</p></li>
</ul>
<img src="https://dl.dropboxusercontent.com/s/6a2b7rjs4a71sni/combinacion_lineal_columnas_A.png?dl=0" heigth="700" width="700">
<ul class="simple">
<li><p>Obsérvese que el <strong>inner loop</strong> de la versión <em>column oriented</em> en <em>gaxpy</em> es un <strong>saxpy</strong> en la que el escalar está dado por una entrada de <span class="math notranslate nohighlight">\(x\)</span>. Esto lo podemos escribir de forma explícita definiendo <span class="math notranslate nohighlight">\(A[:,j]\)</span> a la <span class="math notranslate nohighlight">\(j\)</span>-ésima columna de <span class="math notranslate nohighlight">\(A\)</span> por lo que <span class="math notranslate nohighlight">\(A = [A[:,1] | A[:,2] | \dots | A[:,n]]\)</span>, entonces:</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">n</span>
<span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">m</span>
<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">y</span><span class="o">+=</span><span class="n">A</span><span class="p">[:,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
</pre></div>
</div>
<p>Sin embargo como hemos visto en Python con su implementación más común CPython, no es posible realizar tal indexado pues resulta en el error:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="ne">TypeError</span>                                 <span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">)</span>
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">17</span><span class="o">-</span><span class="mi">93</span><span class="n">f449af9194</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
      <span class="mi">2</span> <span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">m</span>
      <span class="mi">3</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
<span class="o">----&gt;</span> <span class="mi">4</span>     <span class="n">y</span><span class="o">+=</span><span class="n">A</span><span class="p">[:,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>

<span class="ne">TypeError</span><span class="p">:</span> <span class="nb">list</span> <span class="n">indices</span> <span class="n">must</span> <span class="n">be</span> <span class="n">integers</span> <span class="ow">or</span> <span class="n">slices</span><span class="p">,</span> <span class="ow">not</span> <span class="nb">tuple</span>

</pre></div>
</div>
<p>a menos que incorporemos alguna paquetería que permita la <strong>vectorización</strong> y el uso de índices para extracción de columnas (o renglones) de <span class="math notranslate nohighlight">\(A\)</span> como <em>NumPy</em>.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2. 2. 2. 2. 2.]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0. 0.]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.2</span><span class="p">,</span><span class="mf">1.2</span><span class="p">,</span><span class="mf">1.2</span><span class="p">,</span><span class="mf">1.2</span><span class="p">,</span><span class="mf">1.2</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[1.2 1.2 1.2 1.2 1.2]
 [1.  1.  1.  1.  1. ]]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">y</span><span class="o">+=</span><span class="n">A</span><span class="p">[:,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[12. 10.]
</pre></div>
</div>
</div>
</div>
<p>El algoritmo <em>gaxpy row oriented</em> puede escribirse de forma más compacta haciendo uso de la definición de producto punto estándar: <span class="math notranslate nohighlight">\(x^Ty\)</span> para dos vectores columna <span class="math notranslate nohighlight">\(x\)</span> y <span class="math notranslate nohighlight">\(y\)</span>. En el caso de una matriz <span class="math notranslate nohighlight">\(A\)</span> se tiene:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">:</span><span class="n">m</span>
    <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+=</span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span><span class="o">^</span><span class="n">T</span><span class="o">*</span><span class="n">x</span>
</pre></div>
</div>
<p>donde: <span class="math notranslate nohighlight">\(A[i,:]\)</span> es el <span class="math notranslate nohighlight">\(i\)</span>-ésimo renglón de <span class="math notranslate nohighlight">\(A\)</span>. En <em>Python</em>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="n">A</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.2</span><span class="p">,</span><span class="mf">1.2</span><span class="p">,</span><span class="mf">1.2</span><span class="p">,</span><span class="mf">1.2</span><span class="p">,</span><span class="mf">1.2</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
    <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+=</span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[12. 10.]
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="operacion-de-multiplicacion-matriz-matriz-nivel-3-de-blas">
<h3>Operación de multiplicación matriz-matriz (nivel 3 de BLAS)<a class="headerlink" href="#operacion-de-multiplicacion-matriz-matriz-nivel-3-de-blas" title="Permalink to this headline">¶</a></h3>
<p>El algoritmo de multiplicación de matrices <span class="math notranslate nohighlight">\(C = C + AB\)</span> con <span class="math notranslate nohighlight">\(A \in \mathbb{R}^{m \times r}, B \in \mathbb{R}^{r \times n}, C \in \mathbb{R}^{m \times n}\)</span> se cataloga como de nivel 3 de BLAS pues realiza una <strong>cantidad de trabajo cúbica</strong> sobre una <strong>cantidad cuadrática de datos</strong>. Ver <a class="reference external" href="http://www.netlib.org/blas/#_level_3">level 3</a> para más ejemplos de algoritmos en el álgebra lineal en esta categoría.</p>
<p>En LAPACK encontramos al algoritmo de multiplicación matricial con nombres como <a class="reference external" href="http://www.netlib.org/lapack/explore-html/d4/de2/sgemm_8f.html">sgemm</a>, <a class="reference external" href="http://www.netlib.org/lapack/explore-html/d7/d2b/dgemm_8f.html">dgemm</a>, <a class="reference external" href="http://www.netlib.org/lapack/explore-html/d6/d5b/cgemm_8f.html">cgemm</a> y <a class="reference external" href="http://www.netlib.org/lapack/explore-html/d7/d76/zgemm_8f.html">zgemm</a> para los casos de precisión simple, doble o números complejos respectivamente.</p>
<p>El algoritmo de multiplicación de matrices puede escribirse en diferentes versiones. Por ejemplo la versión  <strong>i,j,k</strong> es:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">r</span><span class="p">):</span>
            <span class="n">C</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">+=</span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="n">B</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>
    
</pre></div>
</div>
<p>y la versión <strong>j,k,i</strong> es:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">r</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
            <span class="n">C</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">+=</span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="n">B</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>
</pre></div>
</div>
<div class="admonition-comentarios admonition">
<p class="admonition-title">Comentarios</p>
<ul class="simple">
<li><p>Cualquiera de las versiones (hay <span class="math notranslate nohighlight">\(3!\)</span> de ellas) involucra una cantidad de trabajo del orden <span class="math notranslate nohighlight">\(\mathcal{O}(mnr)\)</span>, la cual es cúbica. Es posible interpretar ésta cantidad de trabajo con una frase del tipo “si duplicamos cada dimensión de <span class="math notranslate nohighlight">\(A\)</span> entonces la cantidad de trabajo se incrementa por un factor de <span class="math notranslate nohighlight">\(8\)</span>”.</p></li>
<li><p>Distintas versiones tienen distinto patrón de acceso a los datos de <span class="math notranslate nohighlight">\(A, B\)</span> y <span class="math notranslate nohighlight">\(C\)</span>. Por ejemplo, para la variante <strong>i,j,k</strong> el <strong>inner loop</strong> realiza un producto punto que requiere acceso a renglones de <span class="math notranslate nohighlight">\(A\)</span> y columnas de <span class="math notranslate nohighlight">\(B\)</span> en una forma izquierda-derecha y abajo-arriba respectivamente. La variante <strong>j,k,i</strong> involucra una operación <em>saxpy</em> en el <strong>inner loop</strong> y acceso por columnas a la matriz <span class="math notranslate nohighlight">\(C\)</span> y a <span class="math notranslate nohighlight">\(A\)</span>. Un resúmen de lo anterior se presenta en el siguiente cuadro:</p></li>
</ul>
<img src="https://dl.dropboxusercontent.com/s/rw81crmo1b7fjvb/tabla_con_versiones_mult_matrices.png?dl=0" heigth="450" width="450">
</div>
</div>
<div class="section" id="otras-versiones-de-la-multiplicacion-de-matrices-apoyandose-de-las-formas-i-j-k-j-k-i">
<h3>Otras versiones de la multiplicación de matrices apoyándose de las formas (i,j,k), (j,k,i),…<a class="headerlink" href="#otras-versiones-de-la-multiplicacion-de-matrices-apoyandose-de-las-formas-i-j-k-j-k-i" title="Permalink to this headline">¶</a></h3>
<p>Si utilizamos la versión <strong>i,j,k</strong> podemos reescribir la multiplicación de matrices en una forma:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
        <span class="n">C</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">+=</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">B</span><span class="p">[:,</span><span class="n">j</span><span class="p">])</span>
</pre></div>
</div>
<p>y hemos vectorizado el <em>inner loop</em> para usar productos punto que es una operación nivel 1 de BLAS.</p>
<p>Además <code class="docutils literal notranslate"><span class="pre">numpy</span></code> nos provee de funcionalidad para reescribir ésta forma de productos punto en una como sigue:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
    <span class="n">C</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span><span class="o">+=</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span><span class="nd">@B</span>
</pre></div>
</div>
<div class="admonition-comentario admonition">
<p class="admonition-title">Comentario</p>
<p>En esta reescritura se realizan <span class="math notranslate nohighlight">\(m\)</span> operaciones <em>gaxpy</em> de nivel 2 en el <em>loop</em>. Esta versión debe ser más rápida que la que utiliza operaciones de nivel 1 de BLAS.</p>
</div>
</div>
<div class="section" id="operaciones-tipicas-del-algebra-lineal-y-los-flops-que-realizan">
<h3>Operaciones típicas del álgebra lineal y los <em>flops</em> que realizan<a class="headerlink" href="#operaciones-tipicas-del-algebra-lineal-y-los-flops-que-realizan" title="Permalink to this headline">¶</a></h3>
<p>A continuación se muestra una tabla que presenta el número de <em>flops</em> realizados por distintas operaciones del álgebra lineal:</p>
<img src="https://dl.dropboxusercontent.com/s/rvqkokicaqkwrif/tabla_con_flops_para_operaciones_alg_lineal.png?dl=0" heigth="550" width="550">
<div class="admonition-comentario admonition">
<p class="admonition-title">Comentario</p>
<p>Por la tabla anterior, <em>gaxpy</em> (nivel 2 de BLAS) realiza más <em>flops</em> que un producto punto. Aún así, debe cumplirse que la versión de <em>gaxpy</em> sea más rápida que la versión con productos punto (nivel 1 de BLAS) para la multiplicación de matrices pues aprovecha mejor el <em>data reuse</em> y <em>data locality</em>. Esto se logra pues <em>gaxpy</em> disminuye el número de <em>cache misses</em> y por tanto el tráfico hacia y desde el caché, el llamado <em>data movement/motion</em>.</p>
</div>
</div>
</div>
<div class="section" id="blocking-algorithms-para-multiplicacion-de-matrices">
<h2>Blocking algorithms para multiplicación de matrices<a class="headerlink" href="#blocking-algorithms-para-multiplicacion-de-matrices" title="Permalink to this headline">¶</a></h2>
<p>El <em>data reuse</em> y el <em>data locality</em> se incrementa al utilizar operaciones de nivel BLAS mayores. También disminuye el <em>data motion</em> hacia y desde el caché lo que disminuye el tráfico de datos o <em>data movement/motion</em> pues se resuelve el <em>bottleneck</em> de Von Neumann.</p>
<p>Por lo anterior hay algoritmos que se diseñan con el objetivo de aprovechar lo más posible el <em>data reuse</em> y el <em>data locality</em> y se nombran <em>blocking algorithms</em>. Entre los <em>blocking algorithms</em> encontramos a los que trabajan con matrices por bloques pues son más eficientes al utilizar un nivel <span class="math notranslate nohighlight">\(3\)</span> de BLAS. Una matriz <span class="math notranslate nohighlight">\(A \in \mathbb{R}^{m \times n}\)</span> por bloques se puede escribir como:</p>
<img src="https://dl.dropboxusercontent.com/s/s77weq74yoi2rfc/matrix_A_by_blocks.png?dl=0" heigth="300" width="300">
<p>donde: <span class="math notranslate nohighlight">\(m_1 + \dots + m_q = m\)</span>, <span class="math notranslate nohighlight">\(n_1 + \dots + n_r = n\)</span>. Con esta definición se llama a la matriz <span class="math notranslate nohighlight">\(A\)</span>, una matriz por bloques de tamaño <span class="math notranslate nohighlight">\(q \times r\)</span>.</p>
<div class="admonition-comentarios admonition">
<p class="admonition-title">Comentarios</p>
<ul class="simple">
<li><p>Hay que tener en cuenta que trabajar con matrices por bloques utiliza mayor cantidad de memoria que un algoritmo que opera a un nivel escalar esto puede ser benéfico o no dependiendo del problema, máquina o arquitectura en la que se esté trabajando.</p></li>
<li><p>Trabajar con <em>blocking algorithms</em> permite simplificar notación matemática. Su escritura ayuda a pensar en una implementación con cómputo en paralelo.</p></li>
</ul>
</div>
<div class="section" id="algunas-operaciones-en-matrices-por-bloques">
<h3>Algunas operaciones en matrices por bloques<a class="headerlink" href="#algunas-operaciones-en-matrices-por-bloques" title="Permalink to this headline">¶</a></h3>
<p>Entre las operaciones que son posibles realizar a un nivel por bloques se encuentran:</p>
</div>
<div class="section" id="multiplicacion-por-escalares">
<h3>Multiplicación por escalares<a class="headerlink" href="#multiplicacion-por-escalares" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{l}
\mu \left[ \begin{array}{cc}
A_{11} &amp; A_{12}\\
A_{21} &amp; A_{22}\\
A_{31} &amp; A_{32}
\end{array}
\right] = 
\left[\begin{array}{cc}
\mu A_{11} &amp; \mu A_{12}\\
\mu A_{21} &amp; \mu A_{22}\\
\mu A_{31} &amp; \mu A_{32}
\end{array}
\right] 
\end{array}
\end{split}\]</div>
<p>con <span class="math notranslate nohighlight">\(\mu \in \mathbb{R}\)</span>.</p>
</div>
<div class="section" id="transposicion">
<h3>Transposición<a class="headerlink" href="#transposicion" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{l}
\left[ \begin{array}{cc}
A_{11} &amp; A_{12}\\
A_{21} &amp; A_{22}\\
A_{31} &amp; A_{32}
\end{array}
\right]^T = 
\left[\begin{array}{ccc}
A_{11}^T &amp; A_{21}^T &amp; A_{31}^T\\
A_{12}^T &amp; A_{22}^T &amp; A_{32}^T\\
\end{array}
\right] 
\end{array}
\end{split}\]</div>
</div>
<div class="section" id="suma">
<h3>Suma<a class="headerlink" href="#suma" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{l}
\left[ \begin{array}{cc}
A_{11} &amp; A_{12}\\
A_{21} &amp; A_{22}\\
A_{31} &amp; A_{32}
\end{array}
\right] + 
\left[\begin{array}{cc}
B_{11} &amp; B_{12}\\
B_{21} &amp; B_{22}\\
B_{31} &amp; B_{32}
\end{array}
\right] =
\left[\begin{array}{cc}
A_{11} + B_{11} &amp; A_{12} + B_{12}\\
A_{21} + B_{21} &amp; A_{22} + B_{22}\\
A_{31} + B_{31} &amp; A_{32} + B_{32}
\end{array}
\right]
\end{array}
\end{split}\]</div>
</div>
<div class="section" id="multiplicacion">
<h3>Multiplicación<a class="headerlink" href="#multiplicacion" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{l}
\left[ \begin{array}{cc}
A_{11} &amp; A_{12}\\
A_{21} &amp; A_{22}\\
A_{31} &amp; A_{32}
\end{array}
\right] \cdot
\left[\begin{array}{cc}
B_{11} &amp; B_{12}\\
B_{21} &amp; B_{22}\\
\end{array}
\right] =
\left[\begin{array}{cc}
A_{11}B_{11} + A_{12}B_{21} &amp; A_{11}B_{12} + A_{12}B_{22}\\
A_{21}B_{11} + A_{22}B_{21} &amp; A_{21}B_{12} + A_{22}B_{22}\\
A_{31}B_{11} + A_{32}B_{21} &amp; A_{31}B_{12} + A_{32}B_{22}
\end{array}
\right]
\end{array}
\end{split}\]</div>
<div class="admonition-comentario admonition">
<p class="admonition-title">Comentario</p>
<p>El número de columnas de los bloques <span class="math notranslate nohighlight">\(A_{11}, A_{21}, A_{31}\)</span> deben coincidir con el número de renglones de <span class="math notranslate nohighlight">\(B_{11}, B_{12}\)</span>. Así como con los bloques <span class="math notranslate nohighlight">\(A_{12}, A_{22}, A_{32}\)</span> y <span class="math notranslate nohighlight">\(B_{21}, B_{22}\)</span>.</p>
</div>
<p>Considérese que se particionan a las matrices <span class="math notranslate nohighlight">\(A, B, C\)</span> como sigue:</p>
<img src="https://dl.dropboxusercontent.com/s/j0p89i19vf5r88k/A_B_C_matrices_by_blocks.png?dl=0" heigth="400" width="400">
<p>Esto es, <span class="math notranslate nohighlight">\(A,B,C\)</span> son <span class="math notranslate nohighlight">\(N \times N\)</span> matrices por bloques con <span class="math notranslate nohighlight">\(\ell \times \ell\)</span> bloques. Entonces, para índices <span class="math notranslate nohighlight">\(\alpha = 1,2,\dots, N\)</span> y <span class="math notranslate nohighlight">\(\beta = 1,2,\dots,N\)</span> se tiene que el bloque <span class="math notranslate nohighlight">\(\alpha \beta\)</span> de <span class="math notranslate nohighlight">\(C\)</span> se obtiene: <span class="math notranslate nohighlight">\(C_{\alpha \beta} = \displaystyle \sum_{\gamma=1}^N A_{\alpha \gamma} B_{\gamma \beta}\)</span>.</p>
<p>El algoritmo una vez definido el bloque de tamaño <span class="math notranslate nohighlight">\(\ell\)</span> es:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">alpha</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
    <span class="n">i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">((</span><span class="n">alpha</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">l</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span><span class="n">alpha</span><span class="o">*</span><span class="n">l</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="c1">#TODO: check if index is well defined</span>
    <span class="k">for</span> <span class="n">beta</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="n">j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">((</span><span class="n">beta</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">l</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">beta</span><span class="o">*</span><span class="n">l</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="c1">#TODO: check if index is well defined</span>
        <span class="k">for</span> <span class="n">gamma</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
            <span class="n">k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">((</span><span class="n">gamma</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">l</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">gamma</span><span class="o">*</span><span class="n">l</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="c1">#TODO: check if index is well defined</span>
            <span class="n">C</span><span class="p">[</span><span class="n">i</span><span class="p">][:,</span><span class="n">j</span><span class="p">]</span><span class="o">+=</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">][:,</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="n">B</span><span class="p">[</span><span class="n">k</span><span class="p">][:,</span><span class="n">j</span><span class="p">]</span>

</pre></div>
</div>
<div class="tip admonition">
<p class="admonition-title">Ejercicio</p>
<p>Implementar la multiplicación por bloques en <em>Python</em> y <em>R</em>. Perfilar tal implementación con <code class="docutils literal notranslate"><span class="pre">perf</span></code>.</p>
</div>
</div>
<div class="section" id="openblas-y-numpy">
<h3>OpenBLAS y <em>NumPy</em><a class="headerlink" href="#openblas-y-numpy" title="Permalink to this headline">¶</a></h3>
<p>En esta sección se sugiere para reproducibilidad de resultados utilizar la <em>AMI</em> y la instancia de AWS ambas descritas al inicio y la <em>AMI</em> <code class="docutils literal notranslate"><span class="pre">opt2-aws-educate-no-openblas-04-04-2021</span></code> de la región <code class="docutils literal notranslate"><span class="pre">us-east-1</span></code> (Virginia) en el mismo tipo de instancia. Tal AMI se construyó a partir de una <em>AMI</em> <code class="docutils literal notranslate"><span class="pre">ubuntu</span> <span class="pre">20.04</span> <span class="pre">-</span> <span class="pre">ami-042e8287309f5df03</span></code> con el <a class="reference external" href="https://github.com/palmoreck/scripts_for_useful_tools_installations/blob/main/AWS/ubuntu_20.04/optimizacion_2/script_no_OpenBLAS.sh">script_no_OpenBLAS.sh</a></p>
<div class="admonition-comentario admonition">
<p class="admonition-title">Comentario</p>
<p>Si se utiliza la <em>AMI</em> <code class="docutils literal notranslate"><span class="pre">opt2-aws-educate-no-openblas-04-04-2021</span></code> colocar en <code class="docutils literal notranslate"><span class="pre">User</span> <span class="pre">data</span></code> el siguiente <em>script</em>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/bin/bash</span>
<span class="c1">##variables:</span>
<span class="nv">region</span><span class="o">=</span>us-east-1 <span class="c1">#make sure instance is in Virginia</span>
<span class="nv">name_instance</span><span class="o">=</span>no-OpenBLAS
<span class="nv">USER</span><span class="o">=</span>ubuntu
<span class="c1">##System update</span>
apt-get update -yq
<span class="c1">##Tag instance</span>
<span class="nv">INSTANCE_ID</span><span class="o">=</span><span class="k">$(</span>curl -s http://instance-data/latest/meta-data/instance-id<span class="k">)</span>
<span class="nv">PUBLIC_IP</span><span class="o">=</span><span class="k">$(</span>curl -s http://instance-data/latest/meta-data/public-ipv4<span class="k">)</span>
sudo -H -u <span class="nv">$USER</span> bash -c <span class="s2">&quot;/home/</span><span class="nv">$USER</span><span class="s2">/.local/bin/aws ec2 create-tags --resources </span><span class="nv">$INSTANCE_ID</span><span class="s2"> --tag Key=Name,Value=</span><span class="nv">$name_instance</span><span class="s2">-</span><span class="nv">$PUBLIC_IP</span><span class="s2"> --region=</span><span class="nv">$region</span><span class="s2">&quot;</span>
sudo -H -u <span class="nv">$USER</span> bash -c <span class="s2">&quot;cd / &amp;&amp; /home/</span><span class="nv">$USER</span><span class="s2">/.local/bin/jupyter lab --ip=0.0.0.0 --no-browser --config=/home/</span><span class="nv">$USER</span><span class="s2">/.jupyter/jupyter_notebook_config.py &amp;&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="resultados-utilizando-opt2-aws-educate-openblas-04-04-2021">
<h3>Resultados utilizando <code class="docutils literal notranslate"><span class="pre">opt2-aws-educate-openblas-04-04-2021</span></code><a class="headerlink" href="#resultados-utilizando-opt2-aws-educate-openblas-04-04-2021" title="Permalink to this headline">¶</a></h3>
<p>Verificamos que <em>NumPy</em> está usando la implementación de la API de BLAS con OpenBLAS que se obtiene con <code class="docutils literal notranslate"><span class="pre">sudo</span> <span class="pre">apt-get</span> <span class="pre">install</span> <span class="pre">-y</span> <span class="pre">libopenblas-dev</span></code>, ver <a class="reference external" href="https://github.com/palmoreck/scripts_for_useful_tools_installations/blob/main/AWS/ubuntu_20.04/optimizacion_2/script_profiling_and_BLAS.sh">script_profiling_and_BLAS.sh</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">show_config</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>blas_mkl_info:
  NOT AVAILABLE
blis_info:
  NOT AVAILABLE
openblas_info:
    libraries = [&#39;openblas&#39;, &#39;openblas&#39;]
    library_dirs = [&#39;/usr/lib/x86_64-linux-gnu&#39;]
    language = c
    define_macros = [(&#39;HAVE_CBLAS&#39;, None)]
blas_opt_info:
    libraries = [&#39;openblas&#39;, &#39;openblas&#39;]
    library_dirs = [&#39;/usr/lib/x86_64-linux-gnu&#39;]
    language = c
    define_macros = [(&#39;HAVE_CBLAS&#39;, None)]
lapack_mkl_info:
  NOT AVAILABLE
openblas_lapack_info:
    libraries = [&#39;openblas&#39;, &#39;openblas&#39;]
    library_dirs = [&#39;/usr/lib/x86_64-linux-gnu&#39;]
    language = c
    define_macros = [(&#39;HAVE_CBLAS&#39;, None)]
lapack_opt_info:
    libraries = [&#39;openblas&#39;, &#39;openblas&#39;]
    library_dirs = [&#39;/usr/lib/x86_64-linux-gnu&#39;]
    language = c
    define_macros = [(&#39;HAVE_CBLAS&#39;, None)]
None
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="multiplicacion-de-matrices">
<h3>Multiplicación de matrices<a class="headerlink" href="#multiplicacion-de-matrices" title="Permalink to this headline">¶</a></h3>
<p>Hacemos una prueba de medición de tiempos:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">2020</span><span class="p">)</span>
<span class="n">m</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="mi">4</span>
<span class="n">r</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="mi">4</span>

<span class="n">A</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">r</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">2021</span><span class="p">)</span>
<span class="n">r</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="mi">4</span>
<span class="n">n</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="mi">4</span>

<span class="n">B</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="tip admonition">
<p class="admonition-title">Observación</p>
<p>Mientras se ejecuta la siguiente celda se sugiere en la terminal ejecutar en la línea de comando <code class="docutils literal notranslate"><span class="pre">htop</span></code>.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">timeit</span> -n 1 -r 7 A@B
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3.02 s ± 67 ms per loop (mean ± std. dev. of 7 runs, 1 loop each)
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="factorizacion-lu">
<h3>Factorización LU<a class="headerlink" href="#factorizacion-lu" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="resultados-utilizando-opt2-aws-educate-no-openblas-04-04-2021">
<h3>Resultados utilizando <code class="docutils literal notranslate"><span class="pre">opt2-aws-educate-no-openblas-04-04-2021</span></code><a class="headerlink" href="#resultados-utilizando-opt2-aws-educate-no-openblas-04-04-2021" title="Permalink to this headline">¶</a></h3>
<p>Verificamos que <em>NumPy</em> <strong>no</strong> está usando la implementación de la API de BLAS con OpenBLAS que se obtiene con <code class="docutils literal notranslate"><span class="pre">sudo</span> <span class="pre">apt-get</span> <span class="pre">install</span> <span class="pre">-y</span> <span class="pre">libopenblas-dev</span></code>, ver <a class="reference external" href="https://github.com/palmoreck/scripts_for_useful_tools_installations/blob/main/AWS/ubuntu_20.04/optimizacion_2/script_no_OpenBLAS.sh">script_no_OpenBLAS.sh</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">show_config</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>blas_mkl_info:
  NOT AVAILABLE
blis_info:
  NOT AVAILABLE
openblas_info:
    libraries = [&#39;openblas&#39;, &#39;openblas&#39;]
    library_dirs = [&#39;/usr/local/lib&#39;]
    language = c
    define_macros = [(&#39;HAVE_CBLAS&#39;, None)]
blas_opt_info:
    libraries = [&#39;openblas&#39;, &#39;openblas&#39;]
    library_dirs = [&#39;/usr/local/lib&#39;]
    language = c
    define_macros = [(&#39;HAVE_CBLAS&#39;, None)]
lapack_mkl_info:
  NOT AVAILABLE
openblas_lapack_info:
    libraries = [&#39;openblas&#39;, &#39;openblas&#39;]
    library_dirs = [&#39;/usr/local/lib&#39;]
    language = c
    define_macros = [(&#39;HAVE_CBLAS&#39;, None)]
lapack_opt_info:
    libraries = [&#39;openblas&#39;, &#39;openblas&#39;]
    library_dirs = [&#39;/usr/local/lib&#39;]
    language = c
    define_macros = [(&#39;HAVE_CBLAS&#39;, None)]
None
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id2">
<h3>Multiplicación de matrices<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<p>Hacemos una prueba de medición de tiempos:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">2020</span><span class="p">)</span>
<span class="n">m</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="mi">4</span>
<span class="n">r</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="mi">4</span>

<span class="n">A</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">r</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">2021</span><span class="p">)</span>
<span class="n">r</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="mi">4</span>
<span class="n">n</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="mi">4</span>

<span class="n">B</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="tip admonition">
<p class="admonition-title">Observación</p>
<p>Mientras se ejecuta la siguiente celda se sugiere en la terminal ejecutar en la línea de comando <code class="docutils literal notranslate"><span class="pre">htop</span></code>.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">timeit</span> -n 1 -r 7 A@B
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3.22 s ± 167 ms per loop (mean ± std. dev. of 7 runs, 1 loop each)
</pre></div>
</div>
</div>
</div>
<div class="admonition-comentarios admonition">
<p class="admonition-title">Comentarios</p>
<ul class="simple">
<li><p>La implementación de la API de BLAS con OpenBLAS que se instala mediante <code class="docutils literal notranslate"><span class="pre">sudo</span> <span class="pre">apt-get</span> <span class="pre">install</span> <span class="pre">-y</span> <span class="pre">libopenblas-dev</span></code> y <em>NumPy</em> instalado vía <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">numpy</span> <span class="pre">--no-binary</span> <span class="pre">numpy</span></code> resulta para el algoritmo de multiplicación de matrices ser un <strong>poco más rápido</strong> que con la implementación de la API de BLAS integrada en la instalación de <em>NumPy</em> vía <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">numpy</span></code>.</p></li>
<li><p>Más <em>cores</em> reducen el tiempo de cómputo, para ver esto probar lo anterior con máquinas con menos <em>cores</em>.</p></li>
</ul>
</div>
</div>
<div class="section" id="openblas-y-librerias-de-computo-matricial-de-r">
<h3>OpenBLAS y librerías de cómputo matricial de <em>R</em><a class="headerlink" href="#openblas-y-librerias-de-computo-matricial-de-r" title="Permalink to this headline">¶</a></h3>
<p>En esta sección se sugiere para reproducibilidad de resultados utilizar la <em>AMI</em> y la instancia de AWS ambas descritas al inicio y la <em>AMI</em> <code class="docutils literal notranslate"><span class="pre">opt2-aws-educate-no-openblas-04-04-2021</span></code> de la región <code class="docutils literal notranslate"><span class="pre">us-east-1</span></code> (Virginia) en el mismo tipo de instancia. Tal AMI se construyó a partir de una <em>AMI</em> <code class="docutils literal notranslate"><span class="pre">ubuntu</span> <span class="pre">20.04</span> <span class="pre">-</span> <span class="pre">ami-042e8287309f5df03</span></code> con el <a class="reference external" href="https://github.com/palmoreck/scripts_for_useful_tools_installations/blob/main/AWS/ubuntu_20.04/optimizacion_2/script_no_OpenBLAS.sh">script_no_OpenBLAS.sh</a></p>
<div class="admonition-comentario admonition">
<p class="admonition-title">Comentario</p>
<p>Si se utiliza la <em>AMI</em> <code class="docutils literal notranslate"><span class="pre">opt2-aws-educate-no-openblas-04-04-2021</span></code> colocar en <code class="docutils literal notranslate"><span class="pre">User</span> <span class="pre">data</span></code> el siguiente <em>script</em>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/bin/bash</span>
<span class="c1">##variables:</span>
<span class="nv">region</span><span class="o">=</span>us-east-1 <span class="c1">#make sure instance is in Virginia</span>
<span class="nv">name_instance</span><span class="o">=</span>no-OpenBLAS
<span class="nv">USER</span><span class="o">=</span>ubuntu
<span class="c1">##System update</span>
apt-get update -yq
<span class="c1">##Tag instance</span>
<span class="nv">INSTANCE_ID</span><span class="o">=</span><span class="k">$(</span>curl -s http://instance-data/latest/meta-data/instance-id<span class="k">)</span>
<span class="nv">PUBLIC_IP</span><span class="o">=</span><span class="k">$(</span>curl -s http://instance-data/latest/meta-data/public-ipv4<span class="k">)</span>
sudo -H -u <span class="nv">$USER</span> bash -c <span class="s2">&quot;/home/</span><span class="nv">$USER</span><span class="s2">/.local/bin/aws ec2 create-tags --resources </span><span class="nv">$INSTANCE_ID</span><span class="s2"> --tag Key=Name,Value=</span><span class="nv">$name_instance</span><span class="s2">-</span><span class="nv">$PUBLIC_IP</span><span class="s2"> --region=</span><span class="nv">$region</span><span class="s2">&quot;</span>
sudo -H -u <span class="nv">$USER</span> bash -c <span class="s2">&quot;cd / &amp;&amp; /home/</span><span class="nv">$USER</span><span class="s2">/.local/bin/jupyter lab --ip=0.0.0.0 --no-browser --config=/home/</span><span class="nv">$USER</span><span class="s2">/.jupyter/jupyter_notebook_config.py &amp;&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="id3">
<h3>Resultados utilizando <code class="docutils literal notranslate"><span class="pre">opt2-aws-educate-openblas-04-04-2021</span></code><a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<p>Verificamos que las librerías de cómputo matricial de <em>R</em> están usando la implementación de la API de BLAS con OpenBLAS que se obtiene con <code class="docutils literal notranslate"><span class="pre">sudo</span> <span class="pre">apt-get</span> <span class="pre">install</span> <span class="pre">-y</span> <span class="pre">libopenblas-dev</span></code>, ver <a class="reference external" href="https://github.com/palmoreck/scripts_for_useful_tools_installations/blob/main/AWS/ubuntu_20.04/optimizacion_2/script_profiling_and_BLAS.sh">script_profiling_and_BLAS.sh</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sessionInfo</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>R version 4.0.5 (2021-03-31)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.2 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3
LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/liblapack.so.3

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

loaded via a namespace (and not attached):
 [1] fansi_0.4.2         digest_0.6.27       utf8_1.2.1         
 [4] crayon_1.4.1        IRdisplay_1.0       repr_1.1.3         
 [7] lifecycle_1.0.0     jsonlite_1.7.2      evaluate_0.14      
[10] pillar_1.5.1        rlang_0.4.10        uuid_0.1-4         
[13] ellipsis_0.3.1      IRkernel_1.1.1.9000 tools_4.0.5        
[16] compiler_4.0.5      base64enc_0.1-3     pbdZMQ_0.3-5       
[19] htmltools_0.5.1.1  
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">set</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">2020</span><span class="p">)</span>
<span class="n">m</span><span class="o">&lt;-</span><span class="mi">10</span><span class="o">**</span><span class="mi">4</span>
<span class="n">r</span><span class="o">&lt;-</span><span class="mi">10</span><span class="o">**</span><span class="mi">4</span>
<span class="n">A</span> <span class="o">&lt;-</span> <span class="n">matrix</span><span class="p">(</span><span class="n">runif</span><span class="p">(</span><span class="n">m</span><span class="o">*</span><span class="n">r</span><span class="p">),</span> <span class="n">m</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">set</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">2021</span><span class="p">)</span>
<span class="n">r</span><span class="o">&lt;-</span><span class="mi">10</span><span class="o">**</span><span class="mi">4</span>
<span class="n">n</span><span class="o">&lt;-</span><span class="mi">10</span><span class="o">**</span><span class="mi">4</span>
<span class="n">B</span> <span class="o">&lt;-</span> <span class="n">matrix</span><span class="p">(</span><span class="n">runif</span><span class="p">(</span><span class="n">r</span><span class="o">*</span><span class="n">n</span><span class="p">),</span> <span class="n">r</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">library</span><span class="p">(</span><span class="n">microbenchmark</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="admonition-comentario admonition">
<p class="admonition-title">Comentario</p>
<p>El paquete de <a class="reference external" href="https://www.rdocumentation.org/packages/microbenchmark/versions/1.4-7/topics/microbenchmark">microbenchmark</a> nos ayuda a la medición de estadísticas para pequeñas piezas de código.</p>
</div>
<div class="tip admonition">
<p class="admonition-title">Observación</p>
<p>Mientras se ejecuta la siguiente celda se sugiere en la terminal ejecutar en la línea de comando <code class="docutils literal notranslate"><span class="pre">htop</span></code>.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mbk</span><span class="o">&lt;-</span><span class="n">microbenchmark</span><span class="p">(</span>
    <span class="n">A</span><span class="o">%*%</span><span class="k">B</span>,
    <span class="n">times</span><span class="o">=</span><span class="mi">7</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">mbk</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Unit: seconds
    expr      min       lq     mean   median       uq      max neval
 A %*% B 2.600818 2.723897 2.952135 2.833146 3.038394 3.706399     7
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id4">
<h3>Resultados utilizando <code class="docutils literal notranslate"><span class="pre">opt2-aws-educate-no-openblas-04-04-2021</span></code><a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h3>
<p>Verificamos que las librerías de cómputo matricial de <em>R</em> <strong>no</strong> están usando la implementación de la API de BLAS con OpenBLAS que se obtiene con <code class="docutils literal notranslate"><span class="pre">sudo</span> <span class="pre">apt-get</span> <span class="pre">install</span> <span class="pre">-y</span> <span class="pre">libopenblas-dev</span></code>, ver <a class="reference external" href="https://github.com/palmoreck/scripts_for_useful_tools_installations/blob/main/AWS/ubuntu_20.04/optimizacion_2/script_no_OpenBLAS.sh">script_no_OpenBLAS.sh</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sessionInfo</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>R version 4.0.5 (2021-03-31)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.2 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

loaded via a namespace (and not attached):
 [1] fansi_0.4.2         digest_0.6.27       utf8_1.2.1         
 [4] crayon_1.4.1        IRdisplay_1.0       repr_1.1.3         
 [7] lifecycle_1.0.0     jsonlite_1.7.2      evaluate_0.14      
[10] pillar_1.5.1        rlang_0.4.10        uuid_0.1-4         
[13] ellipsis_0.3.1      IRkernel_1.1.1.9000 tools_4.0.5        
[16] compiler_4.0.5      base64enc_0.1-3     pbdZMQ_0.3-5       
[19] htmltools_0.5.1.1  
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">set</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">2020</span><span class="p">)</span>
<span class="n">m</span><span class="o">&lt;-</span><span class="mi">10</span><span class="o">**</span><span class="mi">4</span>
<span class="n">r</span><span class="o">&lt;-</span><span class="mi">10</span><span class="o">**</span><span class="mi">4</span>
<span class="n">A</span> <span class="o">&lt;-</span> <span class="n">matrix</span><span class="p">(</span><span class="n">runif</span><span class="p">(</span><span class="n">m</span><span class="o">*</span><span class="n">r</span><span class="p">),</span> <span class="n">m</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">set</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">2021</span><span class="p">)</span>
<span class="n">r</span><span class="o">&lt;-</span><span class="mi">10</span><span class="o">**</span><span class="mi">4</span>
<span class="n">n</span><span class="o">&lt;-</span><span class="mi">10</span><span class="o">**</span><span class="mi">4</span>
<span class="n">B</span> <span class="o">&lt;-</span> <span class="n">matrix</span><span class="p">(</span><span class="n">runif</span><span class="p">(</span><span class="n">r</span><span class="o">*</span><span class="n">n</span><span class="p">),</span> <span class="n">r</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">library</span><span class="p">(</span><span class="n">microbenchmark</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="tip admonition">
<p class="admonition-title">Observación</p>
<p>Mientras se ejecuta la siguiente celda se sugiere en la terminal ejecutar en la línea de comando <code class="docutils literal notranslate"><span class="pre">htop</span></code>.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mbk</span><span class="o">&lt;-</span><span class="n">microbenchmark</span><span class="p">(</span>
    <span class="n">A</span><span class="o">%*%</span><span class="k">B</span>,
    <span class="n">times</span><span class="o">=</span><span class="mi">1</span> <span class="c1">#just one time as it takes too much time</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">mbk</span><span class="p">)</span> <span class="c1">#after ten minutes didnt finish</span>
</pre></div>
</div>
</div>
</div>
<div class="admonition-comentarios admonition">
<p class="admonition-title">Comentarios</p>
<ul class="simple">
<li><p>La implementación de la API de BLAS con OpenBLAS que se instala mediante <code class="docutils literal notranslate"><span class="pre">sudo</span> <span class="pre">apt-get</span> <span class="pre">install</span> <span class="pre">-y</span> <span class="pre">libopenblas-dev</span></code> y las librerías de cómputo matricial de <em>R</em> que utilizan tal instalación resulta para el algoritmo de multiplicación de matrices ser mucho más rápido que con la implementación de la API de BLAS integrada en la instalación de <em>R</em>.</p></li>
<li><p>Más <em>cores</em> reducen el tiempo de cómputo, para ver esto probar lo anterior con máquinas con menos <em>cores</em>.</p></li>
</ul>
</div>
</div>
</div>
<div class="section" id="perfilamiento-medicion-de-tiempo-en-el-sistema-operativo-ubuntu-20-04">
<h2>Perfilamiento: medición de tiempo en el sistema operativo Ubuntu 20.04<a class="headerlink" href="#perfilamiento-medicion-de-tiempo-en-el-sistema-operativo-ubuntu-20-04" title="Permalink to this headline">¶</a></h2>
<div class="section" id="usr-bin-time">
<h3><a class="reference external" href="http://manpages.ubuntu.com/manpages/focal/man1/time.1.html">/usr/bin/time</a><a class="headerlink" href="#usr-bin-time" title="Permalink to this headline">¶</a></h3>
<p>Ver también: <a class="reference external" href="https://en.wikipedia.org/wiki/Time_(Unix)">Wikipedia: Time_Unix</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%file</span> Rcf.py
<span class="kn">import</span> <span class="nn">math</span>

<span class="kn">from</span> <span class="nn">pytest</span> <span class="kn">import</span> <span class="n">approx</span>
<span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">quad</span>
<span class="k">def</span> <span class="nf">Rcf</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">n</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute numerical approximation using rectangle or mid-point</span>
<span class="sd">    method in an interval.</span>
<span class="sd">    Nodes are generated via formula: x_i = a+(i+1/2)h_hat for</span>
<span class="sd">    i=0,1,...,n-1 and h_hat=(b-a)/n</span>
<span class="sd">    Args:</span>
<span class="sd">    </span>
<span class="sd">        f (function): function expression of integrand.</span>
<span class="sd">        </span>
<span class="sd">        a (float): left point of interval.</span>
<span class="sd">        </span>
<span class="sd">        b (float): right point of interval.</span>
<span class="sd">        </span>
<span class="sd">        n (float): number of subintervals.</span>
<span class="sd">        </span>
<span class="sd">    Returns:</span>
<span class="sd">    </span>
<span class="sd">        sum_res (float): numerical approximation to integral</span>
<span class="sd">            of f in the interval a,b</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">h_hat</span><span class="o">=</span><span class="p">(</span><span class="n">b</span><span class="o">-</span><span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="n">n</span>
    <span class="n">nodes</span><span class="o">=</span><span class="p">[</span><span class="n">a</span><span class="o">+</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">h_hat</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">n</span><span class="p">)]</span>
    <span class="n">sum_res</span><span class="o">=</span><span class="mi">0</span>
    <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">nodes</span><span class="p">:</span>
        <span class="n">sum_res</span><span class="o">=</span><span class="n">sum_res</span><span class="o">+</span><span class="n">f</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">h_hat</span><span class="o">*</span><span class="n">sum_res</span>
<span class="k">if</span> <span class="vm">__name__</span><span class="o">==</span><span class="s2">&quot;__main__&quot;</span><span class="p">:</span> <span class="c1">#añadimos este bloque para ejecución de la función Rcf</span>
    <span class="n">a</span><span class="o">=</span><span class="mi">0</span>
    <span class="n">b</span><span class="o">=</span><span class="mi">1</span>
    <span class="n">f</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">obj</span><span class="p">,</span> <span class="n">err</span> <span class="o">=</span> <span class="n">quad</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;objetivo: </span><span class="si">{:0.6e}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">obj</span><span class="p">))</span>
    <span class="n">n</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="mi">6</span>
    <span class="n">res</span><span class="o">=</span><span class="n">Rcf</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;aproximación: </span><span class="si">{:0.6e}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">res</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">res</span> <span class="o">==</span> <span class="n">approx</span><span class="p">(</span><span class="n">obj</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Writing Rcf.py
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">bash</span>
/usr/bin/time -p python3 Rcf.py
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>objetivo: 7.468241e-01
aproximación: 7.468241e-01
True
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>real 0.84
user 2.57
sys 2.20
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">bash</span>
/usr/bin/time -v python3 Rcf.py
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>objetivo: 7.468241e-01
aproximación: 7.468241e-01
True
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>	Command being timed: &quot;python3 Rcf.py&quot;
	User time (seconds): 2.55
	System time (seconds): 2.34
	Percent of CPU this job got: 612%
	Elapsed (wall clock) time (h:mm:ss or m:ss): 0:00.79
	Average shared text size (kbytes): 0
	Average unshared data size (kbytes): 0
	Average stack size (kbytes): 0
	Average total size (kbytes): 0
	Maximum resident set size (kbytes): 97688
	Average resident set size (kbytes): 0
	Major (requiring I/O) page faults: 0
	Minor (reclaiming a frame) page faults: 20846
	Voluntary context switches: 87
	Involuntary context switches: 877104
	Swaps: 0
	File system inputs: 0
	File system outputs: 0
	Socket messages sent: 0
	Socket messages received: 0
	Signals delivered: 0
	Page size (bytes): 4096
	Exit status: 0
</pre></div>
</div>
</div>
</div>
<div class="admonition-comentario admonition">
<p class="admonition-title">Comentario</p>
<p>Una breve explicación del <em>output</em> se puede encontrar <a class="reference external" href="http://manpages.ubuntu.com/manpages/focal/man1/time.1.html">/usr/bin/time</a>. Por ejemplo, para el caso de <code class="docutils literal notranslate"><span class="pre">Major</span> <span class="pre">(requiring</span> <span class="pre">I/O)</span></code> nos interesa que sea <span class="math notranslate nohighlight">\(0\)</span> pues indica que el sistema operativo tiene que cargar páginas de datos del disco pues tales datos ya no residen en RAM (por alguna razón).</p>
</div>
<div class="tip admonition">
<p class="admonition-title">Observación</p>
<p>La medición <code class="docutils literal notranslate"><span class="pre">real</span></code> que regresa <code class="docutils literal notranslate"><span class="pre">/usr/bin/time</span></code> es el equivalente al <code class="docutils literal notranslate"><span class="pre">Wall</span> <span class="pre">time</span></code> de <code class="docutils literal notranslate"><span class="pre">%time</span></code>.</p>
</div>
</div>
</div>
<div class="section" id="perfilamiento-medicion-de-uso-de-cpu-en-el-sistema-operativo-gnu-linux">
<h2>Perfilamiento: medición de uso de CPU en el sistema operativo GNU/Linux<a class="headerlink" href="#perfilamiento-medicion-de-uso-de-cpu-en-el-sistema-operativo-gnu-linux" title="Permalink to this headline">¶</a></h2>
<div class="section" id="perf">
<h3><a class="reference external" href="https://github.com/torvalds/linux/tree/master/tools/perf">perf</a><a class="headerlink" href="#perf" title="Permalink to this headline">¶</a></h3>
<p>En GNU/Linux existe la herramienta <code class="docutils literal notranslate"><span class="pre">perf</span></code> que nos ayuda a calcular métricas de desempeño de la CPU. Los siguientes ejemplos se ejecutaron con la AMI <code class="docutils literal notranslate"><span class="pre">opt2-aws-educate-openblas-04-04-2021</span></code> y la instancia de AWS, ambas descritas al inicio.</p>
</div>
<div class="section" id="ejemplo-de-calculo-de-la-norma-2-al-cuadrado-de-un-vector">
<h3>Ejemplo de cálculo de la norma <span class="math notranslate nohighlight">\(2\)</span> al cuadrado de un vector<a class="headerlink" href="#ejemplo-de-calculo-de-la-norma-2-al-cuadrado-de-un-vector" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%file</span> norm_square.py
<span class="n">n</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="mi">7</span>
<span class="n">vector</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
<span class="n">norm</span><span class="o">=</span><span class="mi">0</span>
<span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">vector</span><span class="p">:</span>
    <span class="n">norm</span><span class="o">+=</span><span class="n">v</span><span class="o">*</span><span class="n">v</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Writing norm_square.py
</pre></div>
</div>
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Esta línea de <code class="docutils literal notranslate"><span class="pre">echo</span></code> es importante para permitir que <em>user</em> <code class="docutils literal notranslate"><span class="pre">ubuntu</span></code> ejecute <code class="docutils literal notranslate"><span class="pre">perf</span></code> sin <code class="docutils literal notranslate"><span class="pre">sudo</span></code>.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">bash</span>
echo &quot;-1&quot; |sudo tee -a /proc/sys/kernel/perf_event_paranoid
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-1
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">bash</span>
perf stat -S -e cycles,instructions,cache-references,cache-misses -r 20 python3 norm_square.py
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> Performance counter stats for &#39;python3 norm_square.py&#39; (20 runs):

        5123821017      cycles                                                        ( +-  0.55% )  (74.95%)
       14073511390      instructions              #    2.75  insn per cycle           ( +-  0.69% )  (75.01%)
          42426825      cache-references                                              ( +-  0.20% )  (75.06%)
          19997224      cache-misses              #   47.133 % of all cache refs      ( +-  0.13% )  (74.98%)

            1.9227 +- 0.0113 seconds time elapsed  ( +-  0.59% )
</pre></div>
</div>
</div>
</div>
<div class="admonition-comentarios admonition">
<p class="admonition-title">Comentarios</p>
<ul class="simple">
<li><p>Con <code class="docutils literal notranslate"><span class="pre">perf</span></code> se repiten las mediciones utilizando la <em>flag</em> <code class="docutils literal notranslate"><span class="pre">-r</span></code>. Con la <em>flag</em> <code class="docutils literal notranslate"><span class="pre">-e</span></code> se enlistan las métricas a calcular. <code class="docutils literal notranslate"><span class="pre">-S</span></code> llama a <a class="reference external" href="http://man7.org/linux/man-pages/man2/sync.2.html">sync</a> antes de iniciar la ejecución del programa. <code class="docutils literal notranslate"><span class="pre">-A</span></code> no agregar los conteos a lo largo de los <em>cores</em> monitoreados. Ver <code class="docutils literal notranslate"><span class="pre">perf</span> <span class="pre">stat</span> <span class="pre">--help</span></code>.</p></li>
<li><p>En el ejemplo anterior además de los ciclos e instrucciones se calculan los <em>cache references</em> y los <em>cache misses</em>.  Esencialmente el sistema de memoria buscó el número que aparece en <em>cache-references</em> por datos o instrucciones en el caché y de éstas búsquedas, en <em>cache-misses</em>, se repora el número (y porcentaje) de búsquedas fallidas que no estuvieron en memoria.</p></li>
<li><p>Recuérdese que la fragmentación de datos incrementa el número de <em>cache misses</em>.</p></li>
<li><p>Se reporta el IPC al lado de <em>instructions</em> con nombre <em>insn per cycle</em>. Un alto IPC indica una alta transferencia de instrucciones de la unidad de memoria hacia la unidad de cómputo y un menor IPC indica más <strong>stall cycles</strong>, ver <a class="reference external" href="https://en.wikipedia.org/wiki/Pipeline_stall">pipeline stall</a>. Se debe evaluar si <em>a high rate of instructions</em> indica un <em>high rate of actual work completed</em> (p.ej. un <em>loop</em> tiene una alta tasa de IPC pero no siempre se realiza trabajo útil). Ver sección <em>CPU statistics</em> en la <a class="reference external" href="http://www.brendangregg.com/perf.html">liga</a>. <code class="docutils literal notranslate"><span class="pre">perf</span></code> también tiene una métrica para medir el número de ciclos que se utilizaron para esperar a ejecutar instrucciones (los cores están <em>stalled</em>). Las métricas son: <code class="docutils literal notranslate"><span class="pre">stalled-cycles-frontend</span></code> y <code class="docutils literal notranslate"><span class="pre">stalled-cycles-backend</span></code>.</p></li>
</ul>
</div>
<p>También podemos obtener las estadísticas por core. Obsérvese que la salida anterior de <code class="docutils literal notranslate"><span class="pre">perf</span></code> calculó el IPC a partir del número de instrucciones y ciclos ahí reportados. El mismo cálculo se realiza a continuación:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">bash</span>
perf stat -S --all-cpus -A -e cycles,instructions,cache-references,cache-misses -r 20 python3 norm_square.py
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> Performance counter stats for &#39;system wide&#39; (20 runs):

CPU0               298120352      cycles                                                        (75.11%)
CPU1               301648607      cycles                                                        (75.03%)
CPU2               310307744      cycles                                                        (75.03%)
CPU3               309422661      cycles                                                        (75.05%)
CPU4               290664122      cycles                                                        (75.11%)
CPU5               306978407      cycles                                                        (75.05%)
CPU6               300076931      cycles                                                        (75.07%)
CPU7               303777036      cycles                                                        (75.09%)
CPU8               314116473      cycles                                                        (75.11%)
CPU9               318017593      cycles                                                        (75.11%)
CPU10              308414427      cycles                                                        (75.02%)
CPU11              314493811      cycles                                                        (75.04%)
CPU12              298690796      cycles                                                        (74.98%)
CPU13              307120629      cycles                                                        (75.07%)
CPU14              309364869      cycles                                                        (75.05%)
CPU15              319200699      cycles                                                        (75.08%)
CPU16              290768996      cycles                                                        (75.03%)
CPU17             5164163011      cycles                                                        (75.07%)
CPU18              305342850      cycles                                                        (75.01%)
CPU19              314267480      cycles                                                        (75.06%)
CPU20              320487210      cycles                                                        (75.10%)
CPU21              350302270      cycles                                                        (74.93%)
CPU22              310945367      cycles                                                        (75.04%)
CPU23              329433064      cycles                                                        (75.15%)
CPU24              325057263      cycles                                                        (75.06%)
CPU25              341041212      cycles                                                        (75.06%)
CPU26              348922548      cycles                                                        (75.06%)
CPU27              345931275      cycles                                                        (74.99%)
CPU28              328556284      cycles                                                        (75.00%)
CPU29              338996933      cycles                                                        (75.01%)
CPU30              358581060      cycles                                                        (75.06%)
CPU31              341516199      cycles                                                        (75.05%)
CPU32              276246541      cycles                                                        (75.04%)
CPU33              283213802      cycles                                                        (75.06%)
CPU34              288221918      cycles                                                        (74.99%)
CPU35              288850195      cycles                                                        (75.06%)
CPU36              269978323      cycles                                                        (75.12%)
CPU37              287564347      cycles                                                        (75.07%)
CPU38              283162389      cycles                                                        (75.04%)
CPU39              283253695      cycles                                                        (75.08%)
CPU40              288642183      cycles                                                        (75.06%)
CPU41              295561770      cycles                                                        (75.11%)
CPU42              304328830      cycles                                                        (75.08%)
CPU43              289614123      cycles                                                        (75.04%)
CPU44              276708731      cycles                                                        (75.02%)
CPU45              282892522      cycles                                                        (75.05%)
CPU46              288303765      cycles                                                        (75.12%)
CPU47              295691376      cycles                                                        (75.09%)
CPU48              209454202      cycles                                                        (75.06%)
CPU49               61974344      cycles                                                        (75.07%)
CPU50              282139648      cycles                                                        (75.12%)
CPU51              286940180      cycles                                                        (75.07%)
CPU52              287551443      cycles                                                        (75.01%)
CPU53              275035569      cycles                                                        (75.09%)
CPU54              277181434      cycles                                                        (75.12%)
CPU55              305867831      cycles                                                        (75.03%)
CPU56              297383426      cycles                                                        (75.14%)
CPU57              307472731      cycles                                                        (75.05%)
CPU58              320139371      cycles                                                        (75.04%)
CPU59              311849592      cycles                                                        (75.05%)
CPU60              292984565      cycles                                                        (75.05%)
CPU61              299543418      cycles                                                        (75.05%)
CPU62              313170552      cycles                                                        (75.06%)
CPU63              344809528      cycles                                                        (75.00%)
CPU0                40368193      instructions              #    0.15  insn per cycle           (74.95%)
CPU1                18125002      instructions              #    0.07  insn per cycle           (75.13%)
CPU2                17283266      instructions              #    0.07  insn per cycle           (74.95%)
CPU3                17732079      instructions              #    0.07  insn per cycle           (74.94%)
CPU4                17586164      instructions              #    0.07  insn per cycle           (75.02%)
CPU5                17306944      instructions              #    0.07  insn per cycle           (75.01%)
CPU6                17542118      instructions              #    0.07  insn per cycle           (75.01%)
CPU7                17075436      instructions              #    0.07  insn per cycle           (74.94%)
CPU8                17519022      instructions              #    0.07  insn per cycle           (75.02%)
CPU9                17434964      instructions              #    0.07  insn per cycle           (75.03%)
CPU10               17336552      instructions              #    0.07  insn per cycle           (75.00%)
CPU11               17364462      instructions              #    0.07  insn per cycle           (75.06%)
CPU12               17209196      instructions              #    0.07  insn per cycle           (75.06%)
CPU13               16847500      instructions              #    0.07  insn per cycle           (74.94%)
CPU14               16833327      instructions              #    0.07  insn per cycle           (75.05%)
CPU15               17194043      instructions              #    0.07  insn per cycle           (75.09%)
CPU16               34505523      instructions              #    0.13  insn per cycle           (75.07%)
CPU17            14059953163      instructions              #    4.81  insn per cycle           (75.07%)
CPU18               17955971      instructions              #    0.07  insn per cycle           (75.15%)
CPU19               18175295      instructions              #    0.07  insn per cycle           (75.00%)
CPU20               18132915      instructions              #    0.07  insn per cycle           (75.04%)
CPU21               56189175      instructions              #    0.17  insn per cycle           (75.15%)
CPU22               18719460      instructions              #    0.07  insn per cycle           (75.11%)
CPU23               18521784      instructions              #    0.07  insn per cycle           (75.08%)
CPU24               18217933      instructions              #    0.07  insn per cycle           (75.17%)
CPU25               18371388      instructions              #    0.07  insn per cycle           (75.04%)
CPU26               18513863      instructions              #    0.07  insn per cycle           (74.99%)
CPU27               18323582      instructions              #    0.07  insn per cycle           (75.09%)
CPU28               18461772      instructions              #    0.07  insn per cycle           (75.07%)
CPU29               21342989      instructions              #    0.06  insn per cycle           (75.13%)
CPU30               21170902      instructions              #    0.07  insn per cycle           (75.05%)
CPU31               18054949      instructions              #    0.06  insn per cycle           (74.98%)
CPU32               15999497      instructions              #    0.07  insn per cycle           (75.01%)
CPU33               16013625      instructions              #    0.07  insn per cycle           (75.10%)
CPU34               16311885      instructions              #    0.07  insn per cycle           (74.95%)
CPU35               16290472      instructions              #    0.07  insn per cycle           (74.99%)
CPU36               15811425      instructions              #    0.07  insn per cycle           (75.02%)
CPU37               16315176      instructions              #    0.07  insn per cycle           (75.04%)
CPU38               15889952      instructions              #    0.07  insn per cycle           (74.99%)
CPU39               16174461      instructions              #    0.07  insn per cycle           (75.02%)
CPU40               16081053      instructions              #    0.07  insn per cycle           (75.02%)
CPU41               15868005      instructions              #    0.07  insn per cycle           (74.97%)
CPU42               19555415      instructions              #    0.08  insn per cycle           (75.02%)
CPU43               15848767      instructions              #    0.07  insn per cycle           (75.01%)
CPU44               15939029      instructions              #    0.07  insn per cycle           (75.06%)
CPU45               15726391      instructions              #    0.07  insn per cycle           (74.96%)
CPU46               15860999      instructions              #    0.07  insn per cycle           (74.98%)
CPU47               15925326      instructions              #    0.07  insn per cycle           (75.03%)
CPU48               15739670      instructions              #    0.09  insn per cycle           (75.00%)
CPU49               14466692      instructions              #    0.01  insn per cycle           (75.07%)
CPU50               16512476      instructions              #    0.07  insn per cycle           (75.02%)
CPU51               17161483      instructions              #    0.07  insn per cycle           (75.12%)
CPU52               16857091      instructions              #    0.07  insn per cycle           (75.05%)
CPU53               16502003      instructions              #    0.07  insn per cycle           (75.05%)
CPU54               16558746      instructions              #    0.07  insn per cycle           (75.09%)
CPU55               17318143      instructions              #    0.07  insn per cycle           (75.08%)
CPU56               17076535      instructions              #    0.07  insn per cycle           (75.06%)
CPU57               16912024      instructions              #    0.07  insn per cycle           (75.05%)
CPU58               17452915      instructions              #    0.07  insn per cycle           (75.09%)
CPU59               16858288      instructions              #    0.06  insn per cycle           (75.06%)
CPU60               16418534      instructions              #    0.06  insn per cycle           (75.07%)
CPU61               16888327      instructions              #    0.06  insn per cycle           (75.10%)
CPU62               16756278      instructions              #    0.06  insn per cycle           (75.01%)
CPU63               21647466      instructions              #    0.07  insn per cycle           (75.12%)
CPU0                 2503549      cache-references                                              (75.12%)
CPU1                 1775315      cache-references                                              (75.10%)
CPU2                 1716775      cache-references                                              (75.12%)
CPU3                 1770964      cache-references                                              (75.09%)
CPU4                 1763964      cache-references                                              (75.08%)
CPU5                 1721617      cache-references                                              (75.13%)
CPU6                 1737825      cache-references                                              (75.06%)
CPU7                 1707310      cache-references                                              (75.10%)
CPU8                 1683707      cache-references                                              (74.99%)
CPU9                 1701485      cache-references                                              (74.99%)
CPU10                1600594      cache-references                                              (75.09%)
CPU11                1689965      cache-references                                              (75.13%)
CPU12                1665246      cache-references                                              (75.09%)
CPU13                1752033      cache-references                                              (75.13%)
CPU14                1668758      cache-references                                              (75.09%)
CPU15                1668197      cache-references                                              (75.06%)
CPU16                2161781      cache-references                                              (75.05%)
CPU17               42321217      cache-references                                              (75.06%)
CPU18                1560420      cache-references                                              (75.07%)
CPU19                1589044      cache-references                                              (75.12%)
CPU20                1583354      cache-references                                              (75.02%)
CPU21                2185819      cache-references                                              (75.06%)
CPU22                1765071      cache-references                                              (75.10%)
CPU23                1601809      cache-references                                              (75.01%)
CPU24                1627779      cache-references                                              (75.02%)
CPU25                1586693      cache-references                                              (75.02%)
CPU26                1588481      cache-references                                              (75.14%)
CPU27                1603270      cache-references                                              (74.98%)
CPU28                1594750      cache-references                                              (75.08%)
CPU29                2025931      cache-references                                              (75.07%)
CPU30                2037144      cache-references                                              (75.05%)
CPU31                1475729      cache-references                                              (75.11%)
CPU32                1361789      cache-references                                              (75.10%)
CPU33                1410020      cache-references                                              (75.08%)
CPU34                1371810      cache-references                                              (75.00%)
CPU35                1386393      cache-references                                              (75.05%)
CPU36                1365894      cache-references                                              (75.00%)
CPU37                1368355      cache-references                                              (75.04%)
CPU38                1341571      cache-references                                              (75.08%)
CPU39                1422180      cache-references                                              (75.04%)
CPU40                1371732      cache-references                                              (75.00%)
CPU41                1353717      cache-references                                              (75.00%)
CPU42                1594118      cache-references                                              (75.02%)
CPU43                1332520      cache-references                                              (75.13%)
CPU44                1278542      cache-references                                              (75.07%)
CPU45                1470079      cache-references                                              (75.10%)
CPU46                1397865      cache-references                                              (75.09%)
CPU47                1348330      cache-references                                              (75.01%)
CPU48                1383563      cache-references                                              (75.05%)
CPU49                 557250      cache-references                                              (75.25%)
CPU50                1258019      cache-references                                              (75.26%)
CPU51                1261573      cache-references                                              (75.26%)
CPU52                1300074      cache-references                                              (75.30%)
CPU53                1389467      cache-references                                              (75.30%)
CPU54                1288061      cache-references                                              (75.18%)
CPU55                1292927      cache-references                                              (75.22%)
CPU56                1282837      cache-references                                              (75.24%)
CPU57                1239222      cache-references                                              (75.29%)
CPU58                1246002      cache-references                                              (75.23%)
CPU59                1286085      cache-references                                              (75.27%)
CPU60                1260232      cache-references                                              (75.34%)
CPU61                1232467      cache-references                                              (75.29%)
CPU62                1290272      cache-references                                              (75.25%)
CPU63                1906962      cache-references                                              (75.28%)
CPU0                  165828      cache-misses              #    7.331 % of all cache refs      (75.12%)
CPU1                   83336      cache-misses              #    5.509 % of all cache refs      (75.04%)
CPU2                   82322      cache-misses              #    6.062 % of all cache refs      (75.20%)
CPU3                   85990      cache-misses              #    6.200 % of all cache refs      (75.22%)
CPU4                   91696      cache-misses              #    6.622 % of all cache refs      (75.10%)
CPU5                   80185      cache-misses              #    5.941 % of all cache refs      (75.12%)
CPU6                   84454      cache-misses              #    6.185 % of all cache refs      (75.17%)
CPU7                   80144      cache-misses              #    5.999 % of all cache refs      (75.17%)
CPU8                   85712      cache-misses              #    6.427 % of all cache refs      (75.18%)
CPU9                   86654      cache-misses              #    6.466 % of all cache refs      (75.18%)
CPU10                  81009      cache-misses              #    6.132 % of all cache refs      (75.20%)
CPU11                  81752      cache-misses              #    6.068 % of all cache refs      (75.09%)
CPU12                  80888      cache-misses              #    6.259 % of all cache refs      (75.19%)
CPU13                  81278      cache-misses              #    5.554 % of all cache refs      (75.18%)
CPU14                  80732      cache-misses              #    5.373 % of all cache refs      (75.14%)
CPU15                  86379      cache-misses              #    6.578 % of all cache refs      (75.10%)
CPU16                 109825      cache-misses              #    4.546 % of all cache refs      (75.18%)
CPU17               19850269      cache-misses              #   84.407 % of all cache refs      (75.13%)
CPU18                 101397      cache-misses              #    7.875 % of all cache refs      (75.10%)
CPU19                 102745      cache-misses              #    8.697 % of all cache refs      (75.15%)
CPU20                  97849      cache-misses              #    7.929 % of all cache refs      (75.18%)
CPU21                 217497      cache-misses              #    9.355 % of all cache refs      (75.21%)
CPU22                 103168      cache-misses              #    5.295 % of all cache refs      (75.10%)
CPU23                 100536      cache-misses              #    8.063 % of all cache refs      (75.11%)
CPU24                  99073      cache-misses              #    8.026 % of all cache refs      (75.10%)
CPU25                 109215      cache-misses              #    8.921 % of all cache refs      (75.24%)
CPU26                 104524      cache-misses              #    8.614 % of all cache refs      (75.16%)
CPU27                 105811      cache-misses              #    8.536 % of all cache refs      (75.30%)
CPU28                 107150      cache-misses              #    8.108 % of all cache refs      (75.21%)
CPU29                 127265      cache-misses              #    5.137 % of all cache refs      (75.16%)
CPU30                 117168      cache-misses              #    5.874 % of all cache refs      (75.21%)
CPU31                  99421      cache-misses              #    6.114 % of all cache refs      (75.23%)
CPU32                  79688      cache-misses              #    6.863 % of all cache refs      (75.23%)
CPU33                  78295      cache-misses              #    6.756 % of all cache refs      (75.13%)
CPU34                  80239      cache-misses              #    7.335 % of all cache refs      (75.44%)
CPU35                  79581      cache-misses              #    6.605 % of all cache refs      (75.28%)
CPU36                  77917      cache-misses              #    6.931 % of all cache refs      (75.24%)
CPU37                  83802      cache-misses              #    7.498 % of all cache refs      (75.24%)
CPU38                  83491      cache-misses              #    7.344 % of all cache refs      (75.28%)
CPU39                  83078      cache-misses              #    7.102 % of all cache refs      (75.25%)
CPU40                  78941      cache-misses              #    7.286 % of all cache refs      (75.31%)
CPU41                  83568      cache-misses              #    7.437 % of all cache refs      (75.32%)
CPU42                  89272      cache-misses              #    5.406 % of all cache refs      (75.27%)
CPU43                  81801      cache-misses              #    7.583 % of all cache refs      (75.23%)
CPU44                  81241      cache-misses              #    7.397 % of all cache refs      (75.25%)
CPU45                  82061      cache-misses              #    6.973 % of all cache refs      (75.30%)
CPU46                  82787      cache-misses              #    7.139 % of all cache refs      (75.22%)
CPU47                  87322      cache-misses              #    7.774 % of all cache refs      (75.28%)
CPU48                  74403      cache-misses              #    6.715 % of all cache refs      (75.30%)
CPU49                  26605      cache-misses              #    0.138 % of all cache refs      (75.03%)
CPU50                  89294      cache-misses              #    8.723 % of all cache refs      (75.03%)
CPU51                  92917      cache-misses              #    6.009 % of all cache refs      (74.99%)
CPU52                  89760      cache-misses              #    8.316 % of all cache refs      (75.07%)
CPU53                  81720      cache-misses              #    6.731 % of all cache refs      (74.99%)
CPU54                  87437      cache-misses              #    8.198 % of all cache refs      (75.04%)
CPU55                  95568      cache-misses              #    8.962 % of all cache refs      (75.11%)
CPU56                  91340      cache-misses              #    8.455 % of all cache refs      (74.99%)
CPU57                  96371      cache-misses              #    9.540 % of all cache refs      (75.05%)
CPU58                  96238      cache-misses              #    9.470 % of all cache refs      (75.08%)
CPU59                  94424      cache-misses              #    8.847 % of all cache refs      (75.07%)
CPU60                  88914      cache-misses              #    8.616 % of all cache refs      (74.99%)
CPU61                  94723      cache-misses              #    9.080 % of all cache refs      (75.01%)
CPU62                  97320      cache-misses              #    8.469 % of all cache refs      (75.12%)
CPU63                 114673      cache-misses              #    6.822 % of all cache refs      (75.05%)

            2.0029 +- 0.0166 seconds time elapsed  ( +-  0.83% )
</pre></div>
</div>
</div>
</div>
<p>Otras métricas pueden ser obtenidas si ejecutamos <code class="docutils literal notranslate"><span class="pre">perf</span></code> sólo con la <em>flag</em> <code class="docutils literal notranslate"><span class="pre">-r</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">bash</span>
perf stat -S -r 20 python3 norm_square.py
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> Performance counter stats for &#39;python3 norm_square.py&#39; (20 runs):

           1927.51 msec task-clock                #    1.000 CPUs utilized            ( +-  0.62% )
                 1      context-switches          #    0.000 K/sec                    ( +- 20.20% )
                 0      cpu-migrations            #    0.000 K/sec                  
             99924      page-faults               #    0.052 M/sec                    ( +-  0.00% )
        5150266707      cycles                    #    2.672 GHz                      ( +-  0.58% )  (74.97%)
       14131213509      instructions              #    2.74  insn per cycle           ( +-  0.74% )  (75.01%)
        2929512564      branches                  # 1519.839 M/sec                    ( +-  0.85% )  (75.04%)
           1173976      branch-misses             #    0.04% of all branches          ( +-  0.68% )  (74.98%)

            1.9279 +- 0.0119 seconds time elapsed  ( +-  0.62% )
</pre></div>
</div>
</div>
</div>
<div class="admonition-comentarios admonition">
<p class="admonition-title">Comentarios</p>
<ul class="simple">
<li><p>La métrica de <em>task-clock</em> indica cuántos <em>clock cycles</em> tomó nuestra tarea y se reporta en milisegundos. Obsérvese que también se indica cuántos CPU’s fueron utilizados. En el <em>output</em> anterior puede obtenerse no exactamente igual a 1 para <code class="docutils literal notranslate"><span class="pre">CPUs</span> <span class="pre">utilized</span></code> pues el programa no sólo involucra trabajo de CPU sino también de alojamiento de memoria.</p></li>
<li><p><em>context-switches</em> y <em>cpu-migrations</em> indican cuánto se detuvo el programa para realizar:</p>
<ul>
<li><p>operaciones relacionadas con el kernel del sistema (por ejemplo I/O).</p></li>
<li><p>ejecución de otras aplicaciones.</p></li>
<li><p>alojamiento de la ejecución en un core distinto (lo que ocasiona que haya movimiento de datos o instrucciones hacia el caché de otro core).</p></li>
</ul>
</li>
</ul>
<p>la idea es que nuestro programa tenga un número pequeño de éstas métricas.</p>
<ul class="simple">
<li><p><em>page-faults</em> se relaciona con el alojamiento de memoria a partir del kernel del sistema operativo. Ocasiona que se detenga la ejecución del programa y por tanto deseamos que ésta métrica no sea muy grande. Ver <a class="reference external" href="https://en.wikipedia.org/wiki/Page_fault">Page fault</a>.</p></li>
<li><p>Para el <em>branching</em> interesa que el número de <em>branch misses</em> sea pequeño.</p></li>
</ul>
</div>
<p>Podemos generar la salida anterior por <em>core</em>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">bash</span>
perf stat -S --all-cpus -A -r 20 python3 norm_square.py
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> Performance counter stats for &#39;system wide&#39; (20 runs):

CPU0                 2004.52 msec cpu-clock                 #    1.001 CPUs utilized          
CPU1                 2004.52 msec cpu-clock                 #    1.001 CPUs utilized          
CPU2                 2004.96 msec cpu-clock                 #    1.001 CPUs utilized          
CPU3                 2004.99 msec cpu-clock                 #    1.001 CPUs utilized          
CPU4                 2004.97 msec cpu-clock                 #    1.001 CPUs utilized          
CPU5                 2004.94 msec cpu-clock                 #    1.001 CPUs utilized          
CPU6                 2004.91 msec cpu-clock                 #    1.001 CPUs utilized          
CPU7                 2004.88 msec cpu-clock                 #    1.001 CPUs utilized          
CPU8                 2004.85 msec cpu-clock                 #    1.001 CPUs utilized          
CPU9                 2004.81 msec cpu-clock                 #    1.001 CPUs utilized          
CPU10                2004.77 msec cpu-clock                 #    1.001 CPUs utilized          
CPU11                2004.74 msec cpu-clock                 #    1.001 CPUs utilized          
CPU12                2004.71 msec cpu-clock                 #    1.001 CPUs utilized          
CPU13                2004.68 msec cpu-clock                 #    1.001 CPUs utilized          
CPU14                2004.65 msec cpu-clock                 #    1.001 CPUs utilized          
CPU15                2004.62 msec cpu-clock                 #    1.001 CPUs utilized          
CPU16                2004.62 msec cpu-clock                 #    1.001 CPUs utilized          
CPU17                2004.66 msec cpu-clock                 #    1.001 CPUs utilized          
CPU18                2004.64 msec cpu-clock                 #    1.001 CPUs utilized          
CPU19                2004.65 msec cpu-clock                 #    1.001 CPUs utilized          
CPU20                2004.64 msec cpu-clock                 #    1.001 CPUs utilized          
CPU21                2004.64 msec cpu-clock                 #    1.001 CPUs utilized          
CPU22                2004.64 msec cpu-clock                 #    1.001 CPUs utilized          
CPU23                2004.63 msec cpu-clock                 #    1.001 CPUs utilized          
CPU24                2004.63 msec cpu-clock                 #    1.001 CPUs utilized          
CPU25                2004.64 msec cpu-clock                 #    1.001 CPUs utilized          
CPU26                2004.65 msec cpu-clock                 #    1.001 CPUs utilized          
CPU27                2004.64 msec cpu-clock                 #    1.001 CPUs utilized          
CPU28                2004.64 msec cpu-clock                 #    1.001 CPUs utilized          
CPU29                2004.64 msec cpu-clock                 #    1.001 CPUs utilized          
CPU30                2004.67 msec cpu-clock                 #    1.001 CPUs utilized          
CPU31                2004.64 msec cpu-clock                 #    1.001 CPUs utilized          
CPU32                2004.64 msec cpu-clock                 #    1.001 CPUs utilized          
CPU33                2004.64 msec cpu-clock                 #    1.001 CPUs utilized          
CPU34                2004.63 msec cpu-clock                 #    1.001 CPUs utilized          
CPU35                2004.63 msec cpu-clock                 #    1.001 CPUs utilized          
CPU36                2004.63 msec cpu-clock                 #    1.001 CPUs utilized          
CPU37                2004.62 msec cpu-clock                 #    1.001 CPUs utilized          
CPU38                2004.64 msec cpu-clock                 #    1.001 CPUs utilized          
CPU39                2004.63 msec cpu-clock                 #    1.001 CPUs utilized          
CPU40                2004.62 msec cpu-clock                 #    1.001 CPUs utilized          
CPU41                2004.62 msec cpu-clock                 #    1.001 CPUs utilized          
CPU42                2004.63 msec cpu-clock                 #    1.001 CPUs utilized          
CPU43                2004.63 msec cpu-clock                 #    1.001 CPUs utilized          
CPU44                2004.65 msec cpu-clock                 #    1.001 CPUs utilized          
CPU45                2004.65 msec cpu-clock                 #    1.001 CPUs utilized          
CPU46                2004.64 msec cpu-clock                 #    1.001 CPUs utilized          
CPU47                2004.68 msec cpu-clock                 #    1.001 CPUs utilized          
CPU48                2004.70 msec cpu-clock                 #    1.001 CPUs utilized          
CPU49                2004.74 msec cpu-clock                 #    1.001 CPUs utilized          
CPU50                2004.71 msec cpu-clock                 #    1.001 CPUs utilized          
CPU51                2004.68 msec cpu-clock                 #    1.001 CPUs utilized          
CPU52                2004.67 msec cpu-clock                 #    1.001 CPUs utilized          
CPU53                2004.64 msec cpu-clock                 #    1.001 CPUs utilized          
CPU54                2004.61 msec cpu-clock                 #    1.001 CPUs utilized          
CPU55                2004.58 msec cpu-clock                 #    1.001 CPUs utilized          
CPU56                2004.55 msec cpu-clock                 #    1.001 CPUs utilized          
CPU57                2004.52 msec cpu-clock                 #    1.001 CPUs utilized          
CPU58                2004.48 msec cpu-clock                 #    1.000 CPUs utilized          
CPU59                2004.45 msec cpu-clock                 #    1.000 CPUs utilized          
CPU60                2004.41 msec cpu-clock                 #    1.000 CPUs utilized          
CPU61                2004.37 msec cpu-clock                 #    1.000 CPUs utilized          
CPU62                2004.37 msec cpu-clock                 #    1.000 CPUs utilized          
CPU63                2004.34 msec cpu-clock                 #    1.000 CPUs utilized          
CPU0                       6      context-switches          #    0.003 K/sec                  
CPU1                       4      context-switches          #    0.002 K/sec                  
CPU2                       2      context-switches          #    0.001 K/sec                  
CPU3                       2      context-switches          #    0.001 K/sec                  
CPU4                       2      context-switches          #    0.001 K/sec                  
CPU5                       2      context-switches          #    0.001 K/sec                  
CPU6                       2      context-switches          #    0.001 K/sec                  
CPU7                       2      context-switches          #    0.001 K/sec                  
CPU8                       2      context-switches          #    0.001 K/sec                  
CPU9                       2      context-switches          #    0.001 K/sec                  
CPU10                      2      context-switches          #    0.001 K/sec                  
CPU11                      2      context-switches          #    0.001 K/sec                  
CPU12                      2      context-switches          #    0.001 K/sec                  
CPU13                      2      context-switches          #    0.001 K/sec                  
CPU14                      2      context-switches          #    0.001 K/sec                  
CPU15                      2      context-switches          #    0.001 K/sec                  
CPU16                     10      context-switches          #    0.005 K/sec                  
CPU17                     11      context-switches          #    0.006 K/sec                  
CPU18                      2      context-switches          #    0.001 K/sec                  
CPU19                      2      context-switches          #    0.001 K/sec                  
CPU20                      2      context-switches          #    0.001 K/sec                  
CPU21                     10      context-switches          #    0.005 K/sec                  
CPU22                     58      context-switches          #    0.029 K/sec                  
CPU23                      2      context-switches          #    0.001 K/sec                  
CPU24                      2      context-switches          #    0.001 K/sec                  
CPU25                      2      context-switches          #    0.001 K/sec                  
CPU26                      2      context-switches          #    0.001 K/sec                  
CPU27                      2      context-switches          #    0.001 K/sec                  
CPU28                      2      context-switches          #    0.001 K/sec                  
CPU29                      8      context-switches          #    0.004 K/sec                  
CPU30                      4      context-switches          #    0.002 K/sec                  
CPU31                      6      context-switches          #    0.003 K/sec                  
CPU32                      2      context-switches          #    0.001 K/sec                  
CPU33                      2      context-switches          #    0.001 K/sec                  
CPU34                      2      context-switches          #    0.001 K/sec                  
CPU35                      2      context-switches          #    0.001 K/sec                  
CPU36                      2      context-switches          #    0.001 K/sec                  
CPU37                      2      context-switches          #    0.001 K/sec                  
CPU38                      2      context-switches          #    0.001 K/sec                  
CPU39                      2      context-switches          #    0.001 K/sec                  
CPU40                      2      context-switches          #    0.001 K/sec                  
CPU41                      2      context-switches          #    0.001 K/sec                  
CPU42                      6      context-switches          #    0.003 K/sec                  
CPU43                      2      context-switches          #    0.001 K/sec                  
CPU44                      2      context-switches          #    0.001 K/sec                  
CPU45                      2      context-switches          #    0.001 K/sec                  
CPU46                      2      context-switches          #    0.001 K/sec                  
CPU47                      2      context-switches          #    0.001 K/sec                  
CPU48                      2      context-switches          #    0.001 K/sec                  
CPU49                      8      context-switches          #    0.004 K/sec                  
CPU50                      2      context-switches          #    0.001 K/sec                  
CPU51                      2      context-switches          #    0.001 K/sec                  
CPU52                      2      context-switches          #    0.001 K/sec                  
CPU53                      2      context-switches          #    0.001 K/sec                  
CPU54                     10      context-switches          #    0.005 K/sec                  
CPU55                      2      context-switches          #    0.001 K/sec                  
CPU56                      2      context-switches          #    0.001 K/sec                  
CPU57                      2      context-switches          #    0.001 K/sec                  
CPU58                      2      context-switches          #    0.001 K/sec                  
CPU59                      2      context-switches          #    0.001 K/sec                  
CPU60                      2      context-switches          #    0.001 K/sec                  
CPU61                      2      context-switches          #    0.001 K/sec                  
CPU62                      2      context-switches          #    0.001 K/sec                  
CPU63                     52      context-switches          #    0.026 K/sec                  
CPU0                       0      cpu-migrations            #    0.000 K/sec                  
CPU1                       0      cpu-migrations            #    0.000 K/sec                  
CPU2                       0      cpu-migrations            #    0.000 K/sec                  
CPU3                       0      cpu-migrations            #    0.000 K/sec                  
CPU4                       0      cpu-migrations            #    0.000 K/sec                  
CPU5                       0      cpu-migrations            #    0.000 K/sec                  
CPU6                       0      cpu-migrations            #    0.000 K/sec                  
CPU7                       0      cpu-migrations            #    0.000 K/sec                  
CPU8                       0      cpu-migrations            #    0.000 K/sec                  
CPU9                       0      cpu-migrations            #    0.000 K/sec                  
CPU10                      0      cpu-migrations            #    0.000 K/sec                  
CPU11                      0      cpu-migrations            #    0.000 K/sec                  
CPU12                      0      cpu-migrations            #    0.000 K/sec                  
CPU13                      0      cpu-migrations            #    0.000 K/sec                  
CPU14                      0      cpu-migrations            #    0.000 K/sec                  
CPU15                      0      cpu-migrations            #    0.000 K/sec                  
CPU16                      0      cpu-migrations            #    0.000 K/sec                  
CPU17                      0      cpu-migrations            #    0.000 K/sec                  
CPU18                      0      cpu-migrations            #    0.000 K/sec                  
CPU19                      0      cpu-migrations            #    0.000 K/sec                  
CPU20                      0      cpu-migrations            #    0.000 K/sec                  
CPU21                      0      cpu-migrations            #    0.000 K/sec                  
CPU22                      0      cpu-migrations            #    0.000 K/sec                  
CPU23                      0      cpu-migrations            #    0.000 K/sec                  
CPU24                      0      cpu-migrations            #    0.000 K/sec                  
CPU25                      0      cpu-migrations            #    0.000 K/sec                  
CPU26                      0      cpu-migrations            #    0.000 K/sec                  
CPU27                      0      cpu-migrations            #    0.000 K/sec                  
CPU28                      0      cpu-migrations            #    0.000 K/sec                  
CPU29                      0      cpu-migrations            #    0.000 K/sec                  
CPU30                      0      cpu-migrations            #    0.000 K/sec                  
CPU31                      0      cpu-migrations            #    0.000 K/sec                  
CPU32                      0      cpu-migrations            #    0.000 K/sec                  
CPU33                      0      cpu-migrations            #    0.000 K/sec                  
CPU34                      0      cpu-migrations            #    0.000 K/sec                  
CPU35                      0      cpu-migrations            #    0.000 K/sec                  
CPU36                      0      cpu-migrations            #    0.000 K/sec                  
CPU37                      0      cpu-migrations            #    0.000 K/sec                  
CPU38                      0      cpu-migrations            #    0.000 K/sec                  
CPU39                      0      cpu-migrations            #    0.000 K/sec                  
CPU40                      0      cpu-migrations            #    0.000 K/sec                  
CPU41                      0      cpu-migrations            #    0.000 K/sec                  
CPU42                      0      cpu-migrations            #    0.000 K/sec                  
CPU43                      0      cpu-migrations            #    0.000 K/sec                  
CPU44                      0      cpu-migrations            #    0.000 K/sec                  
CPU45                      0      cpu-migrations            #    0.000 K/sec                  
CPU46                      0      cpu-migrations            #    0.000 K/sec                  
CPU47                      0      cpu-migrations            #    0.000 K/sec                  
CPU48                      0      cpu-migrations            #    0.000 K/sec                  
CPU49                      0      cpu-migrations            #    0.000 K/sec                  
CPU50                      0      cpu-migrations            #    0.000 K/sec                  
CPU51                      0      cpu-migrations            #    0.000 K/sec                  
CPU52                      0      cpu-migrations            #    0.000 K/sec                  
CPU53                      0      cpu-migrations            #    0.000 K/sec                  
CPU54                      0      cpu-migrations            #    0.000 K/sec                  
CPU55                      0      cpu-migrations            #    0.000 K/sec                  
CPU56                      0      cpu-migrations            #    0.000 K/sec                  
CPU57                      0      cpu-migrations            #    0.000 K/sec                  
CPU58                      0      cpu-migrations            #    0.000 K/sec                  
CPU59                      0      cpu-migrations            #    0.000 K/sec                  
CPU60                      0      cpu-migrations            #    0.000 K/sec                  
CPU61                      0      cpu-migrations            #    0.000 K/sec                  
CPU62                      0      cpu-migrations            #    0.000 K/sec                  
CPU63                      0      cpu-migrations            #    0.000 K/sec                  
CPU0                       0      page-faults               #    0.000 K/sec                  
CPU1                       0      page-faults               #    0.000 K/sec                  
CPU2                       0      page-faults               #    0.000 K/sec                  
CPU3                       0      page-faults               #    0.000 K/sec                  
CPU4                       0      page-faults               #    0.000 K/sec                  
CPU5                       0      page-faults               #    0.000 K/sec                  
CPU6                       0      page-faults               #    0.000 K/sec                  
CPU7                       0      page-faults               #    0.000 K/sec                  
CPU8                       0      page-faults               #    0.000 K/sec                  
CPU9                       0      page-faults               #    0.000 K/sec                  
CPU10                      0      page-faults               #    0.000 K/sec                  
CPU11                      0      page-faults               #    0.000 K/sec                  
CPU12                      0      page-faults               #    0.000 K/sec                  
CPU13                      0      page-faults               #    0.000 K/sec                  
CPU14                      0      page-faults               #    0.000 K/sec                  
CPU15                      0      page-faults               #    0.000 K/sec                  
CPU16                      1      page-faults               #    0.001 K/sec                  
CPU17                  99281      page-faults               #    0.050 M/sec                  
CPU18                      0      page-faults               #    0.000 K/sec                  
CPU19                      0      page-faults               #    0.000 K/sec                  
CPU20                      0      page-faults               #    0.000 K/sec                  
CPU21                      0      page-faults               #    0.000 K/sec                  
CPU22                      0      page-faults               #    0.000 K/sec                  
CPU23                      0      page-faults               #    0.000 K/sec                  
CPU24                      0      page-faults               #    0.000 K/sec                  
CPU25                      0      page-faults               #    0.000 K/sec                  
CPU26                      0      page-faults               #    0.000 K/sec                  
CPU27                      0      page-faults               #    0.000 K/sec                  
CPU28                      0      page-faults               #    0.000 K/sec                  
CPU29                      0      page-faults               #    0.000 K/sec                  
CPU30                      0      page-faults               #    0.000 K/sec                  
CPU31                      0      page-faults               #    0.000 K/sec                  
CPU32                      0      page-faults               #    0.000 K/sec                  
CPU33                      0      page-faults               #    0.000 K/sec                  
CPU34                      0      page-faults               #    0.000 K/sec                  
CPU35                      0      page-faults               #    0.000 K/sec                  
CPU36                      0      page-faults               #    0.000 K/sec                  
CPU37                      0      page-faults               #    0.000 K/sec                  
CPU38                      0      page-faults               #    0.000 K/sec                  
CPU39                      0      page-faults               #    0.000 K/sec                  
CPU40                      0      page-faults               #    0.000 K/sec                  
CPU41                      0      page-faults               #    0.000 K/sec                  
CPU42                      0      page-faults               #    0.000 K/sec                  
CPU43                      0      page-faults               #    0.000 K/sec                  
CPU44                      0      page-faults               #    0.000 K/sec                  
CPU45                      0      page-faults               #    0.000 K/sec                  
CPU46                      0      page-faults               #    0.000 K/sec                  
CPU47                      0      page-faults               #    0.000 K/sec                  
CPU48                      0      page-faults               #    0.000 K/sec                  
CPU49                      0      page-faults               #    0.000 K/sec                  
CPU50                      0      page-faults               #    0.000 K/sec                  
CPU51                      0      page-faults               #    0.000 K/sec                  
CPU52                      0      page-faults               #    0.000 K/sec                  
CPU53                      0      page-faults               #    0.000 K/sec                  
CPU54                      0      page-faults               #    0.000 K/sec                  
CPU55                      0      page-faults               #    0.000 K/sec                  
CPU56                      0      page-faults               #    0.000 K/sec                  
CPU57                      0      page-faults               #    0.000 K/sec                  
CPU58                      0      page-faults               #    0.000 K/sec                  
CPU59                      0      page-faults               #    0.000 K/sec                  
CPU60                      0      page-faults               #    0.000 K/sec                  
CPU61                      0      page-faults               #    0.000 K/sec                  
CPU62                      0      page-faults               #    0.000 K/sec                  
CPU63                      0      page-faults               #    0.000 K/sec                  
CPU0               306106305      cycles                    #    0.154 GHz                      (75.01%)
CPU1               321662266      cycles                    #    0.162 GHz                      (74.94%)
CPU2               326295801      cycles                    #    0.164 GHz                      (74.97%)
CPU3               322994674      cycles                    #    0.163 GHz                      (75.00%)
CPU4               325863884      cycles                    #    0.164 GHz                      (74.99%)
CPU5               328710013      cycles                    #    0.166 GHz                      (75.02%)
CPU6               324331567      cycles                    #    0.163 GHz                      (74.97%)
CPU7               322865115      cycles                    #    0.163 GHz                      (75.07%)
CPU8               329757218      cycles                    #    0.166 GHz                      (75.06%)
CPU9               331599412      cycles                    #    0.167 GHz                      (74.98%)
CPU10              336330558      cycles                    #    0.170 GHz                      (75.03%)
CPU11              336453252      cycles                    #    0.170 GHz                      (75.00%)
CPU12              319616711      cycles                    #    0.161 GHz                      (74.97%)
CPU13              322078523      cycles                    #    0.162 GHz                      (75.05%)
CPU14              326329895      cycles                    #    0.164 GHz                      (75.01%)
CPU15              332097985      cycles                    #    0.167 GHz                      (75.05%)
CPU16              310311098      cycles                    #    0.156 GHz                      (75.01%)
CPU17             5269164431      cycles                    #    2.656 GHz                      (75.03%)
CPU18              291034611      cycles                    #    0.147 GHz                      (75.00%)
CPU19              311080893      cycles                    #    0.157 GHz                      (75.08%)
CPU20              308661056      cycles                    #    0.156 GHz                      (74.98%)
CPU21              407339837      cycles                    #    0.205 GHz                      (75.08%)
CPU22              324464191      cycles                    #    0.164 GHz                      (75.04%)
CPU23              330185382      cycles                    #    0.166 GHz                      (74.96%)
CPU24              314450999      cycles                    #    0.158 GHz                      (75.02%)
CPU25              326412889      cycles                    #    0.165 GHz                      (75.07%)
CPU26              336248899      cycles                    #    0.169 GHz                      (75.04%)
CPU27              332909536      cycles                    #    0.168 GHz                      (75.04%)
CPU28              322263037      cycles                    #    0.162 GHz                      (75.07%)
CPU29              353811585      cycles                    #    0.178 GHz                      (75.14%)
CPU30              337210591      cycles                    #    0.170 GHz                      (75.04%)
CPU31              350407462      cycles                    #    0.177 GHz                      (74.98%)
CPU32              269878561      cycles                    #    0.136 GHz                      (75.04%)
CPU33              305915895      cycles                    #    0.154 GHz                      (75.03%)
CPU34              305142711      cycles                    #    0.154 GHz                      (75.01%)
CPU35              307963614      cycles                    #    0.155 GHz                      (75.12%)
CPU36              302383441      cycles                    #    0.152 GHz                      (75.02%)
CPU37              303830415      cycles                    #    0.153 GHz                      (74.98%)
CPU38              304090923      cycles                    #    0.153 GHz                      (75.08%)
CPU39              301698284      cycles                    #    0.152 GHz                      (75.02%)
CPU40              303872185      cycles                    #    0.153 GHz                      (75.08%)
CPU41              309196758      cycles                    #    0.156 GHz                      (74.96%)
CPU42              329434964      cycles                    #    0.166 GHz                      (75.05%)
CPU43              313422464      cycles                    #    0.158 GHz                      (75.05%)
CPU44              296047671      cycles                    #    0.149 GHz                      (74.99%)
CPU45              297793381      cycles                    #    0.150 GHz                      (75.04%)
CPU46              303275584      cycles                    #    0.153 GHz                      (74.99%)
CPU47              303263083      cycles                    #    0.153 GHz                      (75.03%)
CPU48              201375641      cycles                    #    0.102 GHz                      (74.97%)
CPU49               74307647      cycles                    #    0.037 GHz                      (75.03%)
CPU50              264947052      cycles                    #    0.134 GHz                      (74.98%)
CPU51              284238722      cycles                    #    0.143 GHz                      (75.04%)
CPU52              284536323      cycles                    #    0.143 GHz                      (74.99%)
CPU53              271268890      cycles                    #    0.137 GHz                      (75.03%)
CPU54              316171524      cycles                    #    0.159 GHz                      (75.02%)
CPU55              302706282      cycles                    #    0.153 GHz                      (74.98%)
CPU56              288801773      cycles                    #    0.146 GHz                      (75.04%)
CPU57              295142915      cycles                    #    0.149 GHz                      (75.10%)
CPU58              302572153      cycles                    #    0.153 GHz                      (75.04%)
CPU59              300787519      cycles                    #    0.152 GHz                      (75.05%)
CPU60              287873147      cycles                    #    0.145 GHz                      (75.05%)
CPU61              295315847      cycles                    #    0.149 GHz                      (75.15%)
CPU62              293546148      cycles                    #    0.148 GHz                      (75.07%)
CPU63              338261165      cycles                    #    0.171 GHz                      (74.98%)
CPU0                38176424      instructions              #    0.15  insn per cycle           (75.02%)
CPU1                17519359      instructions              #    0.07  insn per cycle           (75.04%)
CPU2                16930198      instructions              #    0.07  insn per cycle           (75.08%)
CPU3                17394401      instructions              #    0.07  insn per cycle           (75.09%)
CPU4                17297746      instructions              #    0.07  insn per cycle           (75.01%)
CPU5                16858864      instructions              #    0.07  insn per cycle           (75.02%)
CPU6                17157306      instructions              #    0.07  insn per cycle           (75.05%)
CPU7                16826766      instructions              #    0.07  insn per cycle           (75.05%)
CPU8                17198765      instructions              #    0.07  insn per cycle           (75.13%)
CPU9                16962492      instructions              #    0.07  insn per cycle           (75.09%)
CPU10               17133309      instructions              #    0.07  insn per cycle           (75.01%)
CPU11               17107229      instructions              #    0.07  insn per cycle           (75.07%)
CPU12               16946398      instructions              #    0.07  insn per cycle           (75.10%)
CPU13               16450384      instructions              #    0.07  insn per cycle           (75.05%)
CPU14               16353738      instructions              #    0.06  insn per cycle           (74.99%)
CPU15               16830672      instructions              #    0.07  insn per cycle           (74.98%)
CPU16               38987809      instructions              #    0.14  insn per cycle           (75.11%)
CPU17            14217530430      instructions              #    5.36  insn per cycle           (75.07%)
CPU18               16873215      instructions              #    0.07  insn per cycle           (75.06%)
CPU19               17509615      instructions              #    0.07  insn per cycle           (75.09%)
CPU20               17131848      instructions              #    0.07  insn per cycle           (75.08%)
CPU21               88661371      instructions              #    0.28  insn per cycle           (75.00%)
CPU22               20454188      instructions              #    0.07  insn per cycle           (75.07%)
CPU23               17386019      instructions              #    0.07  insn per cycle           (75.00%)
CPU24               17084776      instructions              #    0.07  insn per cycle           (75.05%)
CPU25               17233960      instructions              #    0.07  insn per cycle           (74.99%)
CPU26               17177017      instructions              #    0.06  insn per cycle           (75.02%)
CPU27               17290764      instructions              #    0.07  insn per cycle           (75.04%)
CPU28               17423322      instructions              #    0.07  insn per cycle           (74.95%)
CPU29               21756181      instructions              #    0.07  insn per cycle           (74.98%)
CPU30               18848138      instructions              #    0.07  insn per cycle           (74.95%)
CPU31               20449143      instructions              #    0.07  insn per cycle           (75.07%)
CPU32               15483810      instructions              #    0.07  insn per cycle           (75.01%)
CPU33               15982401      instructions              #    0.07  insn per cycle           (75.00%)
CPU34               15942200      instructions              #    0.07  insn per cycle           (75.05%)
CPU35               15941977      instructions              #    0.07  insn per cycle           (74.91%)
CPU36               15479710      instructions              #    0.07  insn per cycle           (74.98%)
CPU37               15851930      instructions              #    0.07  insn per cycle           (75.01%)
CPU38               15571039      instructions              #    0.07  insn per cycle           (75.04%)
CPU39               15805391      instructions              #    0.07  insn per cycle           (74.99%)
CPU40               15754263      instructions              #    0.07  insn per cycle           (75.02%)
CPU41               15459431      instructions              #    0.07  insn per cycle           (75.00%)
CPU42               19202261      instructions              #    0.07  insn per cycle           (74.95%)
CPU43               15446564      instructions              #    0.07  insn per cycle           (75.00%)
CPU44               15622786      instructions              #    0.07  insn per cycle           (75.02%)
CPU45               15354230      instructions              #    0.07  insn per cycle           (75.09%)
CPU46               15498422      instructions              #    0.07  insn per cycle           (74.94%)
CPU47               15421485      instructions              #    0.06  insn per cycle           (75.01%)
CPU48               15174512      instructions              #    0.09  insn per cycle           (75.11%)
CPU49               19161294      instructions              #    0.01  insn per cycle           (75.03%)
CPU50               15442820      instructions              #    0.07  insn per cycle           (74.98%)
CPU51               16146394      instructions              #    0.07  insn per cycle           (75.09%)
CPU52               16217412      instructions              #    0.07  insn per cycle           (75.02%)
CPU53               15617012      instructions              #    0.07  insn per cycle           (75.05%)
CPU54               20309413      instructions              #    0.08  insn per cycle           (75.05%)
CPU55               16305695      instructions              #    0.07  insn per cycle           (74.97%)
CPU56               15951744      instructions              #    0.07  insn per cycle           (74.99%)
CPU57               15834802      instructions              #    0.06  insn per cycle           (74.99%)
CPU58               16129508      instructions              #    0.06  insn per cycle           (74.98%)
CPU59               15761884      instructions              #    0.06  insn per cycle           (74.97%)
CPU60               15447066      instructions              #    0.07  insn per cycle           (74.96%)
CPU61               15799433      instructions              #    0.06  insn per cycle           (74.95%)
CPU62               15450106      instructions              #    0.06  insn per cycle           (74.93%)
CPU63               21223142      instructions              #    0.07  insn per cycle           (75.02%)
CPU0                 7731794      branches                  #    3.897 M/sec                    (74.95%)
CPU1                 3830667      branches                  #    1.931 M/sec                    (75.02%)
CPU2                 3720136      branches                  #    1.875 M/sec                    (74.98%)
CPU3                 3830437      branches                  #    1.931 M/sec                    (74.90%)
CPU4                 3795905      branches                  #    1.913 M/sec                    (75.01%)
CPU5                 3710373      branches                  #    1.870 M/sec                    (75.00%)
CPU6                 3771725      branches                  #    1.901 M/sec                    (75.03%)
CPU7                 3682561      branches                  #    1.856 M/sec                    (74.98%)
CPU8                 3772339      branches                  #    1.901 M/sec                    (74.91%)
CPU9                 3726271      branches                  #    1.878 M/sec                    (75.19%)
CPU10                3764386      branches                  #    1.897 M/sec                    (75.23%)
CPU11                3762059      branches                  #    1.896 M/sec                    (75.21%)
CPU12                3723936      branches                  #    1.877 M/sec                    (75.24%)
CPU13                3610716      branches                  #    1.820 M/sec                    (75.14%)
CPU14                3604534      branches                  #    1.817 M/sec                    (75.26%)
CPU15                3705402      branches                  #    1.868 M/sec                    (75.28%)
CPU16                9431117      branches                  #    4.754 M/sec                    (75.18%)
CPU17             2941611174      branches                  # 1482.654 M/sec                    (75.21%)
CPU18                3755062      branches                  #    1.893 M/sec                    (75.34%)
CPU19                3873927      branches                  #    1.953 M/sec                    (75.16%)
CPU20                3787231      branches                  #    1.909 M/sec                    (75.21%)
CPU21               19467599      branches                  #    9.812 M/sec                    (75.19%)
CPU22                4524527      branches                  #    2.281 M/sec                    (75.17%)
CPU23                3846215      branches                  #    1.939 M/sec                    (75.20%)
CPU24                3780367      branches                  #    1.905 M/sec                    (75.15%)
CPU25                3800662      branches                  #    1.916 M/sec                    (75.18%)
CPU26                3819317      branches                  #    1.925 M/sec                    (75.16%)
CPU27                3840248      branches                  #    1.936 M/sec                    (75.22%)
CPU28                3841462      branches                  #    1.936 M/sec                    (75.20%)
CPU29                4856204      branches                  #    2.448 M/sec                    (75.19%)
CPU30                4136601      branches                  #    2.085 M/sec                    (75.26%)
CPU31                4451110      branches                  #    2.244 M/sec                    (75.19%)
CPU32                3408780      branches                  #    1.718 M/sec                    (75.27%)
CPU33                3527597      branches                  #    1.778 M/sec                    (75.25%)
CPU34                3521111      branches                  #    1.775 M/sec                    (75.28%)
CPU35                3527430      branches                  #    1.778 M/sec                    (75.32%)
CPU36                3425730      branches                  #    1.727 M/sec                    (75.29%)
CPU37                3499592      branches                  #    1.764 M/sec                    (75.23%)
CPU38                3444253      branches                  #    1.736 M/sec                    (75.23%)
CPU39                3487132      branches                  #    1.758 M/sec                    (75.23%)
CPU40                3483466      branches                  #    1.756 M/sec                    (75.21%)
CPU41                3397462      branches                  #    1.713 M/sec                    (75.23%)
CPU42                4238889      branches                  #    2.137 M/sec                    (75.26%)
CPU43                3406676      branches                  #    1.717 M/sec                    (75.19%)
CPU44                3440157      branches                  #    1.734 M/sec                    (75.22%)
CPU45                3389686      branches                  #    1.709 M/sec                    (75.09%)
CPU46                3418141      branches                  #    1.723 M/sec                    (75.30%)
CPU47                3415962      branches                  #    1.722 M/sec                    (75.25%)
CPU48                3343031      branches                  #    1.685 M/sec                    (75.18%)
CPU49                4077566      branches                  #    2.055 M/sec                    (75.20%)
CPU50                3457873      branches                  #    1.743 M/sec                    (75.35%)
CPU51                3583130      branches                  #    1.806 M/sec                    (75.11%)
CPU52                3596808      branches                  #    1.813 M/sec                    (75.19%)
CPU53                3447169      branches                  #    1.738 M/sec                    (75.12%)
CPU54                4427456      branches                  #    2.232 M/sec                    (75.16%)
CPU55                3634016      branches                  #    1.832 M/sec                    (75.24%)
CPU56                3543971      branches                  #    1.786 M/sec                    (75.15%)
CPU57                3525977      branches                  #    1.777 M/sec                    (75.13%)
CPU58                3622211      branches                  #    1.826 M/sec                    (75.25%)
CPU59                3533650      branches                  #    1.781 M/sec                    (75.23%)
CPU60                3458440      branches                  #    1.743 M/sec                    (75.19%)
CPU61                3539112      branches                  #    1.784 M/sec                    (75.21%)
CPU62                3459792      branches                  #    1.744 M/sec                    (75.25%)
CPU63                4607909      branches                  #    2.323 M/sec                    (75.23%)
CPU0                  374333      branch-misses             #    5.18% of all branches          (75.29%)
CPU1                  322992      branch-misses             #    7.14% of all branches          (75.26%)
CPU2                  315334      branch-misses             #   10.78% of all branches          (75.23%)
CPU3                  324823      branch-misses             #   10.80% of all branches          (75.28%)
CPU4                  314184      branch-misses             #   10.50% of all branches          (75.27%)
CPU5                  315790      branch-misses             #   10.84% of all branches          (75.23%)
CPU6                  316377      branch-misses             #   10.49% of all branches          (75.23%)
CPU7                  313674      branch-misses             #    9.03% of all branches          (75.17%)
CPU8                  314333      branch-misses             #   10.55% of all branches          (75.18%)
CPU9                  312829      branch-misses             #   10.57% of all branches          (75.07%)
CPU10                 307299      branch-misses             #   10.29% of all branches          (75.05%)
CPU11                 309721      branch-misses             #   10.36% of all branches          (75.05%)
CPU12                 313833      branch-misses             #   10.51% of all branches          (75.02%)
CPU13                 307589      branch-misses             #   10.40% of all branches          (75.09%)
CPU14                 304448      branch-misses             #    9.42% of all branches          (75.05%)
CPU15                 307320      branch-misses             #   10.07% of all branches          (75.02%)
CPU16                 426069      branch-misses             #    4.77% of all branches          (75.01%)
CPU17                 596553      branch-misses             #    0.04% of all branches          (75.02%)
CPU18                 308044      branch-misses             #    9.90% of all branches          (74.93%)
CPU19                 315425      branch-misses             #   10.14% of all branches          (75.00%)
CPU20                 305915      branch-misses             #   10.08% of all branches          (75.05%)
CPU21                 554075      branch-misses             #    4.09% of all branches          (75.06%)
CPU22                 388852      branch-misses             #    9.35% of all branches          (75.04%)
CPU23                 313289      branch-misses             #   10.03% of all branches          (75.16%)
CPU24                 307651      branch-misses             #   10.03% of all branches          (75.11%)
CPU25                 306846      branch-misses             #    9.95% of all branches          (75.07%)
CPU26                 308390      branch-misses             #    9.88% of all branches          (75.11%)
CPU27                 312922      branch-misses             #   10.11% of all branches          (75.01%)
CPU28                 309297      branch-misses             #    9.82% of all branches          (75.09%)
CPU29                 423266      branch-misses             #    8.43% of all branches          (75.01%)
CPU30                 354380      branch-misses             #    9.58% of all branches          (75.07%)
CPU31                 382947      branch-misses             #    9.40% of all branches          (75.08%)
CPU32                 255123      branch-misses             #    9.25% of all branches          (75.01%)
CPU33                 270003      branch-misses             #    9.62% of all branches          (75.05%)
CPU34                 261534      branch-misses             #    9.14% of all branches          (75.00%)
CPU35                 270503      branch-misses             #    9.28% of all branches          (74.97%)
CPU36                 269276      branch-misses             #    9.77% of all branches          (75.05%)
CPU37                 266281      branch-misses             #    9.11% of all branches          (75.12%)
CPU38                 263606      branch-misses             #    9.17% of all branches          (75.00%)
CPU39                 270561      branch-misses             #    9.50% of all branches          (75.10%)
CPU40                 268227      branch-misses             #    9.47% of all branches          (75.03%)
CPU41                 260930      branch-misses             #    9.43% of all branches          (75.15%)
CPU42                 309139      branch-misses             #    7.43% of all branches          (75.09%)
CPU43                 264566      branch-misses             #    9.56% of all branches          (75.12%)
CPU44                 266440      branch-misses             #    9.33% of all branches          (75.12%)
CPU45                 263872      branch-misses             #    9.49% of all branches          (75.13%)
CPU46                 261024      branch-misses             #    8.98% of all branches          (75.13%)
CPU47                 264583      branch-misses             #    9.07% of all branches          (75.07%)
CPU48                 266245      branch-misses             #    9.42% of all branches          (75.11%)
CPU49                 107102      branch-misses             #    0.01% of all branches          (75.11%)
CPU50                 268393      branch-misses             #    9.01% of all branches          (75.05%)
CPU51                 274368      branch-misses             #    8.90% of all branches          (75.13%)
CPU52                 269165      branch-misses             #    8.84% of all branches          (75.17%)
CPU53                 260373      branch-misses             #    8.54% of all branches          (75.18%)
CPU54                 373812      branch-misses             #    9.87% of all branches          (75.14%)
CPU55                 268686      branch-misses             #    8.66% of all branches          (75.18%)
CPU56                 262133      branch-misses             #    8.30% of all branches          (75.19%)
CPU57                 262102      branch-misses             #    8.66% of all branches          (75.16%)
CPU58                 261321      branch-misses             #    8.31% of all branches          (75.12%)
CPU59                 265672      branch-misses             #    8.76% of all branches          (75.13%)
CPU60                 258695      branch-misses             #    8.66% of all branches          (75.20%)
CPU61                 268173      branch-misses             #    8.79% of all branches          (75.08%)
CPU62                 260297      branch-misses             #    8.29% of all branches          (75.15%)
CPU63                 389139      branch-misses             #    9.34% of all branches          (75.17%)

            2.0035 +- 0.0125 seconds time elapsed  ( +-  0.62% )
</pre></div>
</div>
</div>
</div>
<p>Para contrastar las salidas anteriores con un mejor uso del caché y de los <em>cores</em> se utiliza a continuación el paquete de <code class="docutils literal notranslate"><span class="pre">numpy</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%file</span> norm_square_numpy.py
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">n</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="mi">7</span>
<span class="n">vector</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">vector</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">vector</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Writing norm_square_numpy.py
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">bash</span>
perf stat -S -e cycles,instructions,cache-references,cache-misses -r 20 python3 norm_square_numpy.py
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> Performance counter stats for &#39;python3 norm_square_numpy.py&#39; (20 runs):

       10883030366      cycles                                                        ( +-  1.92% )  (74.13%)
        3317792148      instructions              #    0.30  insn per cycle           ( +-  2.36% )  (75.34%)
          20753464      cache-references                                              ( +-  1.15% )  (75.80%)
           1743193      cache-misses              #    8.400 % of all cache refs      ( +-  7.94% )  (74.73%)

           0.23934 +- 0.00512 seconds time elapsed  ( +-  2.14% )
</pre></div>
</div>
</div>
</div>
<div class="admonition-comentarios admonition">
<p class="admonition-title">Comentarios</p>
<ul class="simple">
<li><p>Obsérvese que es <strong>más rápido</strong> este programa para el número <span class="math notranslate nohighlight">\(n\)</span> que se está utilizando en comparación con el programa anterior sin vectorizar.</p></li>
<li><p>El número de instrucciones y el número de <em>cache-misses</em> son <strong>menores</strong> al reportado con el programa anterior sin vectorizar.</p></li>
</ul>
</div>
<p>Métricas por core:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">bash</span>
perf stat -S --all-cpus -A -e cycles,instructions,cache-references,cache-misses -r 20 python3 norm_square_numpy.py
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> Performance counter stats for &#39;system wide&#39; (20 runs):

CPU0                62508379      cycles                                                        (76.32%)
CPU1                26857115      cycles                                                        (76.26%)
CPU2                27978652      cycles                                                        (76.29%)
CPU3                24328931      cycles                                                        (76.22%)
CPU4                25400584      cycles                                                        (76.22%)
CPU5                23141653      cycles                                                        (76.12%)
CPU6                24341914      cycles                                                        (76.16%)
CPU7                22866352      cycles                                                        (76.25%)
CPU8                26054803      cycles                                                        (76.35%)
CPU9                26583601      cycles                                                        (76.28%)
CPU10               26667093      cycles                                                        (76.34%)
CPU11               26720326      cycles                                                        (76.30%)
CPU12               25075967      cycles                                                        (76.19%)
CPU13               25542921      cycles                                                        (76.52%)
CPU14               24075860      cycles                                                        (76.13%)
CPU15               27598528      cycles                                                        (76.26%)
CPU16              360103054      cycles                                                        (76.30%)
CPU17              601848696      cycles                                                        (76.24%)
CPU18              310345654      cycles                                                        (76.03%)
CPU19              310113303      cycles                                                        (76.24%)
CPU20              307656533      cycles                                                        (76.35%)
CPU21              301712884      cycles                                                        (76.42%)
CPU22              305946437      cycles                                                        (76.08%)
CPU23              311187756      cycles                                                        (76.17%)
CPU24              309925895      cycles                                                        (76.29%)
CPU25              317048104      cycles                                                        (76.07%)
CPU26              336229695      cycles                                                        (76.36%)
CPU27              338737259      cycles                                                        (76.10%)
CPU28              337831620      cycles                                                        (76.33%)
CPU29              336902132      cycles                                                        (76.23%)
CPU30              337720291      cycles                                                        (76.03%)
CPU31              343568104      cycles                                                        (76.44%)
CPU32               22229876      cycles                                                        (76.33%)
CPU33               23412324      cycles                                                        (76.24%)
CPU34               27028252      cycles                                                        (76.14%)
CPU35               23674835      cycles                                                        (76.03%)
CPU36               23816150      cycles                                                        (76.23%)
CPU37               23224199      cycles                                                        (76.22%)
CPU38               24569380      cycles                                                        (76.04%)
CPU39               22971636      cycles                                                        (76.21%)
CPU40               24754101      cycles                                                        (76.16%)
CPU41               25444472      cycles                                                        (76.32%)
CPU42               25791810      cycles                                                        (76.14%)
CPU43               25811747      cycles                                                        (76.19%)
CPU44               25355364      cycles                                                        (76.06%)
CPU45               24851746      cycles                                                        (76.29%)
CPU46               23253569      cycles                                                        (75.93%)
CPU47               26541259      cycles                                                        (76.15%)
CPU48              261467966      cycles                                                        (75.85%)
CPU49              302371155      cycles                                                        (76.07%)
CPU50              310754357      cycles                                                        (76.07%)
CPU51              309411164      cycles                                                        (75.96%)
CPU52              307310046      cycles                                                        (75.97%)
CPU53              305984603      cycles                                                        (75.83%)
CPU54              311663966      cycles                                                        (75.77%)
CPU55              312964400      cycles                                                        (75.78%)
CPU56              310689681      cycles                                                        (76.01%)
CPU57              328349976      cycles                                                        (76.33%)
CPU58              309713560      cycles                                                        (76.28%)
CPU59              312002114      cycles                                                        (76.25%)
CPU60              314274252      cycles                                                        (76.36%)
CPU61              330503808      cycles                                                        (76.10%)
CPU62              326899096      cycles                                                        (76.01%)
CPU63              337997365      cycles                                                        (75.88%)
CPU0                19806394      instructions              #    0.13  insn per cycle           (76.07%)
CPU1                 2199225      instructions              #    0.04  insn per cycle           (76.44%)
CPU2                 1355889      instructions              #    0.02  insn per cycle           (76.20%)
CPU3                 1385418      instructions              #    0.03  insn per cycle           (76.36%)
CPU4                 1374337      instructions              #    0.02  insn per cycle           (76.06%)
CPU5                 1326495      instructions              #    0.02  insn per cycle           (76.23%)
CPU6                 1382961      instructions              #    0.02  insn per cycle           (76.17%)
CPU7                 1350684      instructions              #    0.02  insn per cycle           (76.46%)
CPU8                 1400033      instructions              #    0.02  insn per cycle           (76.04%)
CPU9                 1428450      instructions              #    0.03  insn per cycle           (76.24%)
CPU10                1421247      instructions              #    0.04  insn per cycle           (76.19%)
CPU11                1419444      instructions              #    0.02  insn per cycle           (76.33%)
CPU12                1403913      instructions              #    0.03  insn per cycle           (76.28%)
CPU13                1345440      instructions              #    0.02  insn per cycle           (76.20%)
CPU14                1422025      instructions              #    0.02  insn per cycle           (76.25%)
CPU15                1398662      instructions              #    0.03  insn per cycle           (76.19%)
CPU16               92458882      instructions              #    0.28  insn per cycle           (76.00%)
CPU17              509742694      instructions              #    1.11  insn per cycle           (76.32%)
CPU18               74064074      instructions              #    0.23  insn per cycle           (76.55%)
CPU19               75127920      instructions              #    0.23  insn per cycle           (76.34%)
CPU20               81604386      instructions              #    0.25  insn per cycle           (76.12%)
CPU21              100858840      instructions              #    0.29  insn per cycle           (76.09%)
CPU22               75208022      instructions              #    0.23  insn per cycle           (76.07%)
CPU23               72765165      instructions              #    0.22  insn per cycle           (76.06%)
CPU24               70654240      instructions              #    0.22  insn per cycle           (76.04%)
CPU25               79131300      instructions              #    0.24  insn per cycle           (76.14%)
CPU26              106118208      instructions              #    0.32  insn per cycle           (76.29%)
CPU27              106531259      instructions              #    0.33  insn per cycle           (76.30%)
CPU28              104627691      instructions              #    0.32  insn per cycle           (76.31%)
CPU29              104477005      instructions              #    0.32  insn per cycle           (76.05%)
CPU30              104196307      instructions              #    0.32  insn per cycle           (76.38%)
CPU31              107772026      instructions              #    0.32  insn per cycle           (75.97%)
CPU32                1320970      instructions              #    0.02  insn per cycle           (76.11%)
CPU33                1357510      instructions              #    0.03  insn per cycle           (76.21%)
CPU34                1417245      instructions              #    0.03  insn per cycle           (76.22%)
CPU35                1420863      instructions              #    0.03  insn per cycle           (76.36%)
CPU36                1351213      instructions              #    0.03  insn per cycle           (76.01%)
CPU37                1357100      instructions              #    0.03  insn per cycle           (76.15%)
CPU38                1370744      instructions              #    0.03  insn per cycle           (76.22%)
CPU39                1396996      instructions              #    0.03  insn per cycle           (76.32%)
CPU40                1405574      instructions              #    0.04  insn per cycle           (76.24%)
CPU41                1382831      instructions              #    0.04  insn per cycle           (76.26%)
CPU42                1403793      instructions              #    0.02  insn per cycle           (76.12%)
CPU43                1362252      instructions              #    0.03  insn per cycle           (76.18%)
CPU44                1400621      instructions              #    0.03  insn per cycle           (76.36%)
CPU45                1406160      instructions              #    0.05  insn per cycle           (76.22%)
CPU46                1435219      instructions              #    0.04  insn per cycle           (76.10%)
CPU47                1384820      instructions              #    0.04  insn per cycle           (76.21%)
CPU48               62548432      instructions              #    0.19  insn per cycle           (76.01%)
CPU49              109259064      instructions              #    0.25  insn per cycle           (76.18%)
CPU50               69540891      instructions              #    0.21  insn per cycle           (76.33%)
CPU51               68296329      instructions              #    0.21  insn per cycle           (76.52%)
CPU52               76626742      instructions              #    0.24  insn per cycle           (76.19%)
CPU53               75726710      instructions              #    0.24  insn per cycle           (76.10%)
CPU54               72355419      instructions              #    0.23  insn per cycle           (76.12%)
CPU55               71133509      instructions              #    0.22  insn per cycle           (76.24%)
CPU56               70442004      instructions              #    0.22  insn per cycle           (76.08%)
CPU57              101628239      instructions              #    0.31  insn per cycle           (76.24%)
CPU58               82274990      instructions              #    0.26  insn per cycle           (76.09%)
CPU59               83694351      instructions              #    0.26  insn per cycle           (76.39%)
CPU60               82661990      instructions              #    0.26  insn per cycle           (76.06%)
CPU61              106542585      instructions              #    0.33  insn per cycle           (76.16%)
CPU62              103224305      instructions              #    0.31  insn per cycle           (76.36%)
CPU63              105520921      instructions              #    0.32  insn per cycle           (76.28%)
CPU0                  307367      cache-references                                              (76.40%)
CPU1                  180732      cache-references                                              (75.96%)
CPU2                  127179      cache-references                                              (76.02%)
CPU3                  128330      cache-references                                              (76.07%)
CPU4                  135053      cache-references                                              (76.19%)
CPU5                  124078      cache-references                                              (76.06%)
CPU6                  127289      cache-references                                              (76.09%)
CPU7                  139641      cache-references                                              (76.12%)
CPU8                  122703      cache-references                                              (76.18%)
CPU9                  125369      cache-references                                              (76.09%)
CPU10                 128076      cache-references                                              (76.09%)
CPU11                 130193      cache-references                                              (76.11%)
CPU12                 114001      cache-references                                              (76.12%)
CPU13                 131552      cache-references                                              (76.08%)
CPU14                 121643      cache-references                                              (76.14%)
CPU15                 125526      cache-references                                              (76.08%)
CPU16                 331925      cache-references                                              (76.29%)
CPU17               13296371      cache-references                                              (76.15%)
CPU18                 333012      cache-references                                              (76.08%)
CPU19                 312632      cache-references                                              (76.06%)
CPU20                 270514      cache-references                                              (76.35%)
CPU21                 276148      cache-references                                              (76.29%)
CPU22                 308640      cache-references                                              (76.17%)
CPU23                 288960      cache-references                                              (76.39%)
CPU24                 289913      cache-references                                              (76.41%)
CPU25                 319846      cache-references                                              (76.20%)
CPU26                 270389      cache-references                                              (75.99%)
CPU27                 383773      cache-references                                              (76.27%)
CPU28                 312680      cache-references                                              (75.91%)
CPU29                 312482      cache-references                                              (76.07%)
CPU30                 316875      cache-references                                              (76.10%)
CPU31                 349847      cache-references                                              (76.26%)
CPU32                 113622      cache-references                                              (76.26%)
CPU33                 122367      cache-references                                              (76.03%)
CPU34                 113792      cache-references                                              (75.98%)
CPU35                 113162      cache-references                                              (76.00%)
CPU36                 132061      cache-references                                              (76.06%)
CPU37                 110269      cache-references                                              (75.86%)
CPU38                 109695      cache-references                                              (75.88%)
CPU39                 125671      cache-references                                              (76.07%)
CPU40                 117870      cache-references                                              (75.98%)
CPU41                 114779      cache-references                                              (75.96%)
CPU42                 125351      cache-references                                              (76.12%)
CPU43                 112871      cache-references                                              (76.05%)
CPU44                 111115      cache-references                                              (75.96%)
CPU45                 133393      cache-references                                              (76.01%)
CPU46                 125909      cache-references                                              (76.13%)
CPU47                 118829      cache-references                                              (75.91%)
CPU48                 264090      cache-references                                              (76.31%)
CPU49                 543397      cache-references                                              (75.98%)
CPU50                 317091      cache-references                                              (75.96%)
CPU51                 301698      cache-references                                              (75.80%)
CPU52                 272330      cache-references                                              (76.00%)
CPU53                 335636      cache-references                                              (76.17%)
CPU54                 307103      cache-references                                              (76.15%)
CPU55                 282245      cache-references                                              (76.42%)
CPU56                 264168      cache-references                                              (76.27%)
CPU57                 282715      cache-references                                              (76.11%)
CPU58                 308893      cache-references                                              (75.98%)
CPU59                 323068      cache-references                                              (75.96%)
CPU60                 321393      cache-references                                              (75.99%)
CPU61                 321802      cache-references                                              (76.09%)
CPU62                 334023      cache-references                                              (76.08%)
CPU63                 332661      cache-references                                              (76.10%)
CPU0                   43768      cache-misses              #   13.997 % of all cache refs      (74.32%)
CPU1                    8582      cache-misses              #    3.686 % of all cache refs      (74.45%)
CPU2                    6424      cache-misses              #    3.518 % of all cache refs      (74.65%)
CPU3                    5656      cache-misses              #    3.198 % of all cache refs      (74.51%)
CPU4                    7271      cache-misses              #    3.549 % of all cache refs      (74.72%)
CPU5                    5634      cache-misses              #    3.439 % of all cache refs      (74.81%)
CPU6                    6464      cache-misses              #    3.219 % of all cache refs      (74.83%)
CPU7                    5228      cache-misses              #    2.587 % of all cache refs      (74.42%)
CPU8                    6548      cache-misses              #    3.949 % of all cache refs      (74.72%)
CPU9                    6447      cache-misses              #    3.462 % of all cache refs      (74.71%)
CPU10                   6655      cache-misses              #    4.193 % of all cache refs      (74.71%)
CPU11                   6097      cache-misses              #    2.768 % of all cache refs      (74.60%)
CPU12                   6418      cache-misses              #    3.587 % of all cache refs      (74.79%)
CPU13                   5750      cache-misses              #    2.705 % of all cache refs      (74.60%)
CPU14                   5730      cache-misses              #    3.091 % of all cache refs      (74.91%)
CPU15                   7273      cache-misses              #    3.728 % of all cache refs      (74.91%)
CPU16                  17303      cache-misses              #    6.106 % of all cache refs      (74.89%)
CPU17                1460742      cache-misses              #   25.261 % of all cache refs      (74.73%)
CPU18                  11244      cache-misses              #    3.988 % of all cache refs      (74.78%)
CPU19                  11862      cache-misses              #    1.406 % of all cache refs      (74.82%)
CPU20                   9365      cache-misses              #    3.567 % of all cache refs      (74.68%)
CPU21                  11438      cache-misses              #    1.334 % of all cache refs      (74.70%)
CPU22                  11064      cache-misses              #    4.331 % of all cache refs      (75.20%)
CPU23                  10644      cache-misses              #    4.124 % of all cache refs      (74.94%)
CPU24                  10355      cache-misses              #    3.907 % of all cache refs      (74.84%)
CPU25                   9915      cache-misses              #    3.899 % of all cache refs      (75.19%)
CPU26                   9317      cache-misses              #    3.365 % of all cache refs      (74.95%)
CPU27                  11170      cache-misses              #    4.050 % of all cache refs      (74.95%)
CPU28                  10921      cache-misses              #    4.135 % of all cache refs      (75.08%)
CPU29                  10652      cache-misses              #    4.005 % of all cache refs      (75.32%)
CPU30                  10488      cache-misses              #    4.030 % of all cache refs      (75.17%)
CPU31                  12166      cache-misses              #    4.735 % of all cache refs      (75.00%)
CPU32                   6851      cache-misses              #    4.459 % of all cache refs      (75.01%)
CPU33                   7362      cache-misses              #    4.859 % of all cache refs      (75.26%)
CPU34                   6825      cache-misses              #    4.817 % of all cache refs      (75.41%)
CPU35                   6781      cache-misses              #    4.520 % of all cache refs      (75.37%)
CPU36                   6637      cache-misses              #    4.056 % of all cache refs      (75.51%)
CPU37                   6230      cache-misses              #    4.286 % of all cache refs      (75.61%)
CPU38                   7198      cache-misses              #    5.291 % of all cache refs      (75.72%)
CPU39                   6037      cache-misses              #    3.864 % of all cache refs      (75.28%)
CPU40                   6733      cache-misses              #    5.150 % of all cache refs      (75.53%)
CPU41                   6713      cache-misses              #    5.074 % of all cache refs      (75.40%)
CPU42                   7022      cache-misses              #    4.022 % of all cache refs      (75.47%)
CPU43                   6332      cache-misses              #    4.387 % of all cache refs      (75.39%)
CPU44                   7005      cache-misses              #    4.520 % of all cache refs      (75.44%)
CPU45                   6432      cache-misses              #    4.329 % of all cache refs      (75.30%)
CPU46                   7135      cache-misses              #    4.943 % of all cache refs      (75.68%)
CPU47                   7825      cache-misses              #    5.245 % of all cache refs      (75.58%)
CPU48                  10718      cache-misses              #    0.771 % of all cache refs      (75.69%)
CPU49                   6269      cache-misses              #    0.127 % of all cache refs      (75.65%)
CPU50                  12321      cache-misses              #    1.330 % of all cache refs      (75.54%)
CPU51                  10723      cache-misses              #    4.257 % of all cache refs      (75.63%)
CPU52                  11286      cache-misses              #    4.678 % of all cache refs      (75.76%)
CPU53                   8797      cache-misses              #    2.798 % of all cache refs      (75.84%)
CPU54                   9904      cache-misses              #    4.002 % of all cache refs      (75.91%)
CPU55                  10928      cache-misses              #    4.093 % of all cache refs      (75.52%)
CPU56                   9413      cache-misses              #    3.602 % of all cache refs      (75.59%)
CPU57                  10298      cache-misses              #    4.178 % of all cache refs      (73.81%)
CPU58                   9502      cache-misses              #    3.683 % of all cache refs      (74.23%)
CPU59                   9959      cache-misses              #    4.072 % of all cache refs      (74.04%)
CPU60                   9228      cache-misses              #    3.580 % of all cache refs      (74.23%)
CPU61                  10515      cache-misses              #    4.243 % of all cache refs      (74.34%)
CPU62                  10850      cache-misses              #    4.288 % of all cache refs      (74.26%)
CPU63                  13201      cache-misses              #    5.243 % of all cache refs      (74.46%)

           0.26133 +- 0.00349 seconds time elapsed  ( +-  1.34% )
</pre></div>
</div>
</div>
</div>
<div class="admonition-comentarios admonition">
<p class="admonition-title">Comentarios</p>
<ul class="simple">
<li><p>Se observa que la métrica IPC está más uniforme a través de los cores lo que indica un mejor <em>load balancing</em>.</p></li>
<li><p>Además, el <span class="math notranslate nohighlight">\(\%\)</span> de <em>cache-misses</em> es menor que en el caso no vectorizado.</p></li>
</ul>
</div>
<p>También podemos obtener las salidas anteriores de <code class="docutils literal notranslate"><span class="pre">perf</span></code> al usar <code class="docutils literal notranslate"><span class="pre">numpy</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">bash</span>
perf stat -S -r 20 python3 norm_square_numpy.py
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> Performance counter stats for &#39;python3 norm_square_numpy.py&#39; (20 runs):

           4009.45 msec task-clock                #   17.208 CPUs utilized            ( +-  1.33% )
            564444      context-switches          #    0.141 M/sec                    ( +-  5.07% )
                50      cpu-migrations            #    0.013 K/sec                    ( +-  6.76% )
              4686      page-faults               #    0.001 M/sec                    ( +-  0.75% )
       10567628399      cycles                    #    2.636 GHz                      ( +-  1.28% )  (73.97%)
        3602865118      instructions              #    0.34  insn per cycle           ( +-  1.75% )  (75.34%)
         763664359      branches                  #  190.466 M/sec                    ( +-  1.77% )  (75.77%)
          15063370      branch-misses             #    1.97% of all branches          ( +-  1.82% )  (74.93%)

           0.23300 +- 0.00349 seconds time elapsed  ( +-  1.50% )
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">bash</span>
perf stat -S --all-cpus -A -r 20 python3 norm_square_numpy.py
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> Performance counter stats for &#39;system wide&#39; (20 runs):

CPU0                  233.86 msec cpu-clock                 #    0.883 CPUs utilized          
CPU1                  233.84 msec cpu-clock                 #    0.883 CPUs utilized          
CPU2                  233.83 msec cpu-clock                 #    0.883 CPUs utilized          
CPU3                  233.85 msec cpu-clock                 #    0.883 CPUs utilized          
CPU4                  233.86 msec cpu-clock                 #    0.883 CPUs utilized          
CPU5                  233.87 msec cpu-clock                 #    0.883 CPUs utilized          
CPU6                  233.89 msec cpu-clock                 #    0.883 CPUs utilized          
CPU7                  233.87 msec cpu-clock                 #    0.883 CPUs utilized          
CPU8                  233.88 msec cpu-clock                 #    0.883 CPUs utilized          
CPU9                  233.89 msec cpu-clock                 #    0.883 CPUs utilized          
CPU10                 233.90 msec cpu-clock                 #    0.883 CPUs utilized          
CPU11                 233.88 msec cpu-clock                 #    0.883 CPUs utilized          
CPU12                 233.89 msec cpu-clock                 #    0.883 CPUs utilized          
CPU13                 233.92 msec cpu-clock                 #    0.884 CPUs utilized          
CPU14                 233.93 msec cpu-clock                 #    0.884 CPUs utilized          
CPU15                 233.90 msec cpu-clock                 #    0.883 CPUs utilized          
CPU16                 233.90 msec cpu-clock                 #    0.883 CPUs utilized          
CPU17                 233.90 msec cpu-clock                 #    0.883 CPUs utilized          
CPU18                 233.87 msec cpu-clock                 #    0.883 CPUs utilized          
CPU19                 233.84 msec cpu-clock                 #    0.883 CPUs utilized          
CPU20                 233.81 msec cpu-clock                 #    0.883 CPUs utilized          
CPU21                 233.78 msec cpu-clock                 #    0.883 CPUs utilized          
CPU22                 233.75 msec cpu-clock                 #    0.883 CPUs utilized          
CPU23                 233.72 msec cpu-clock                 #    0.883 CPUs utilized          
CPU24                 233.67 msec cpu-clock                 #    0.883 CPUs utilized          
CPU25                 233.63 msec cpu-clock                 #    0.882 CPUs utilized          
CPU26                 233.60 msec cpu-clock                 #    0.882 CPUs utilized          
CPU27                 233.56 msec cpu-clock                 #    0.882 CPUs utilized          
CPU28                 233.54 msec cpu-clock                 #    0.882 CPUs utilized          
CPU29                 233.55 msec cpu-clock                 #    0.882 CPUs utilized          
CPU30                 233.55 msec cpu-clock                 #    0.882 CPUs utilized          
CPU31                 233.55 msec cpu-clock                 #    0.882 CPUs utilized          
CPU32                 233.54 msec cpu-clock                 #    0.882 CPUs utilized          
CPU33                 233.54 msec cpu-clock                 #    0.882 CPUs utilized          
CPU34                 233.51 msec cpu-clock                 #    0.882 CPUs utilized          
CPU35                 233.49 msec cpu-clock                 #    0.882 CPUs utilized          
CPU36                 233.48 msec cpu-clock                 #    0.882 CPUs utilized          
CPU37                 233.48 msec cpu-clock                 #    0.882 CPUs utilized          
CPU38                 233.48 msec cpu-clock                 #    0.882 CPUs utilized          
CPU39                 233.48 msec cpu-clock                 #    0.882 CPUs utilized          
CPU40                 233.43 msec cpu-clock                 #    0.882 CPUs utilized          
CPU41                 233.47 msec cpu-clock                 #    0.882 CPUs utilized          
CPU42                 233.43 msec cpu-clock                 #    0.882 CPUs utilized          
CPU43                 233.44 msec cpu-clock                 #    0.882 CPUs utilized          
CPU44                 233.44 msec cpu-clock                 #    0.882 CPUs utilized          
CPU45                 233.42 msec cpu-clock                 #    0.882 CPUs utilized          
CPU46                 233.43 msec cpu-clock                 #    0.882 CPUs utilized          
CPU47                 233.43 msec cpu-clock                 #    0.882 CPUs utilized          
CPU48                 233.46 msec cpu-clock                 #    0.882 CPUs utilized          
CPU49                 233.46 msec cpu-clock                 #    0.882 CPUs utilized          
CPU50                 233.46 msec cpu-clock                 #    0.882 CPUs utilized          
CPU51                 233.46 msec cpu-clock                 #    0.882 CPUs utilized          
CPU52                 233.46 msec cpu-clock                 #    0.882 CPUs utilized          
CPU53                 233.46 msec cpu-clock                 #    0.882 CPUs utilized          
CPU54                 233.46 msec cpu-clock                 #    0.882 CPUs utilized          
CPU55                 233.46 msec cpu-clock                 #    0.882 CPUs utilized          
CPU56                 233.46 msec cpu-clock                 #    0.882 CPUs utilized          
CPU57                 233.45 msec cpu-clock                 #    0.882 CPUs utilized          
CPU58                 233.45 msec cpu-clock                 #    0.882 CPUs utilized          
CPU59                 233.44 msec cpu-clock                 #    0.882 CPUs utilized          
CPU60                 233.44 msec cpu-clock                 #    0.882 CPUs utilized          
CPU61                 233.47 msec cpu-clock                 #    0.882 CPUs utilized          
CPU62                 233.50 msec cpu-clock                 #    0.882 CPUs utilized          
CPU63                 233.53 msec cpu-clock                 #    0.882 CPUs utilized          
CPU0                       8      context-switches          #    0.033 K/sec                  
CPU1                       0      context-switches          #    0.000 K/sec                  
CPU2                       2      context-switches          #    0.008 K/sec                  
CPU3                       0      context-switches          #    0.000 K/sec                  
CPU4                       0      context-switches          #    0.000 K/sec                  
CPU5                       0      context-switches          #    0.000 K/sec                  
CPU6                       0      context-switches          #    0.000 K/sec                  
CPU7                       0      context-switches          #    0.000 K/sec                  
CPU8                       2      context-switches          #    0.008 K/sec                  
CPU9                       0      context-switches          #    0.000 K/sec                  
CPU10                      0      context-switches          #    0.000 K/sec                  
CPU11                      0      context-switches          #    0.000 K/sec                  
CPU12                      0      context-switches          #    0.000 K/sec                  
CPU13                      0      context-switches          #    0.000 K/sec                  
CPU14                      0      context-switches          #    0.000 K/sec                  
CPU15                      0      context-switches          #    0.000 K/sec                  
CPU16                  38973      context-switches          #    0.159 M/sec                  
CPU17                      5      context-switches          #    0.020 K/sec                  
CPU18                     15      context-switches          #    0.061 K/sec                  
CPU19                  40029      context-switches          #    0.164 M/sec                  
CPU20                     19      context-switches          #    0.078 K/sec                  
CPU21                     16      context-switches          #    0.065 K/sec                  
CPU22                     14      context-switches          #    0.057 K/sec                  
CPU23                     13      context-switches          #    0.053 K/sec                  
CPU24                     16      context-switches          #    0.065 K/sec                  
CPU25                      9      context-switches          #    0.037 K/sec                  
CPU26                  36788      context-switches          #    0.150 M/sec                  
CPU27                  40917      context-switches          #    0.167 M/sec                  
CPU28                     12      context-switches          #    0.049 K/sec                  
CPU29                      9      context-switches          #    0.037 K/sec                  
CPU30                  44578      context-switches          #    0.182 M/sec                  
CPU31                  39809      context-switches          #    0.163 M/sec                  
CPU32                      0      context-switches          #    0.000 K/sec                  
CPU33                      0      context-switches          #    0.000 K/sec                  
CPU34                      0      context-switches          #    0.000 K/sec                  
CPU35                      0      context-switches          #    0.000 K/sec                  
CPU36                      0      context-switches          #    0.000 K/sec                  
CPU37                      0      context-switches          #    0.000 K/sec                  
CPU38                      0      context-switches          #    0.000 K/sec                  
CPU39                      0      context-switches          #    0.000 K/sec                  
CPU40                      0      context-switches          #    0.000 K/sec                  
CPU41                      0      context-switches          #    0.000 K/sec                  
CPU42                      0      context-switches          #    0.000 K/sec                  
CPU43                      0      context-switches          #    0.000 K/sec                  
CPU44                      0      context-switches          #    0.000 K/sec                  
CPU45                      0      context-switches          #    0.000 K/sec                  
CPU46                      0      context-switches          #    0.000 K/sec                  
CPU47                      0      context-switches          #    0.000 K/sec                  
CPU48                     14      context-switches          #    0.057 K/sec                  
CPU49                      4      context-switches          #    0.016 K/sec                  
CPU50                     11      context-switches          #    0.045 K/sec                  
CPU51                  41413      context-switches          #    0.169 M/sec                  
CPU52                     12      context-switches          #    0.049 K/sec                  
CPU53                     13      context-switches          #    0.053 K/sec                  
CPU54                     23      context-switches          #    0.094 K/sec                  
CPU55                     33      context-switches          #    0.135 K/sec                  
CPU56                      8      context-switches          #    0.033 K/sec                  
CPU57                     15      context-switches          #    0.061 K/sec                  
CPU58                      9      context-switches          #    0.037 K/sec                  
CPU59                      9      context-switches          #    0.037 K/sec                  
CPU60                  40919      context-switches          #    0.167 M/sec                  
CPU61                  40214      context-switches          #    0.164 M/sec                  
CPU62                  42659      context-switches          #    0.174 M/sec                  
CPU63                  39455      context-switches          #    0.161 M/sec                  
CPU0                       1      cpu-migrations            #    0.004 K/sec                  
CPU1                       0      cpu-migrations            #    0.000 K/sec                  
CPU2                       0      cpu-migrations            #    0.000 K/sec                  
CPU3                       0      cpu-migrations            #    0.000 K/sec                  
CPU4                       0      cpu-migrations            #    0.000 K/sec                  
CPU5                       0      cpu-migrations            #    0.000 K/sec                  
CPU6                       0      cpu-migrations            #    0.000 K/sec                  
CPU7                       0      cpu-migrations            #    0.000 K/sec                  
CPU8                       0      cpu-migrations            #    0.000 K/sec                  
CPU9                       0      cpu-migrations            #    0.000 K/sec                  
CPU10                      0      cpu-migrations            #    0.000 K/sec                  
CPU11                      0      cpu-migrations            #    0.000 K/sec                  
CPU12                      0      cpu-migrations            #    0.000 K/sec                  
CPU13                      0      cpu-migrations            #    0.000 K/sec                  
CPU14                      0      cpu-migrations            #    0.000 K/sec                  
CPU15                      0      cpu-migrations            #    0.000 K/sec                  
CPU16                      7      cpu-migrations            #    0.029 K/sec                  
CPU17                      0      cpu-migrations            #    0.000 K/sec                  
CPU18                      4      cpu-migrations            #    0.016 K/sec                  
CPU19                      2      cpu-migrations            #    0.008 K/sec                  
CPU20                      4      cpu-migrations            #    0.016 K/sec                  
CPU21                      2      cpu-migrations            #    0.008 K/sec                  
CPU22                      2      cpu-migrations            #    0.008 K/sec                  
CPU23                      4      cpu-migrations            #    0.016 K/sec                  
CPU24                      2      cpu-migrations            #    0.008 K/sec                  
CPU25                      1      cpu-migrations            #    0.004 K/sec                  
CPU26                      1      cpu-migrations            #    0.004 K/sec                  
CPU27                      1      cpu-migrations            #    0.004 K/sec                  
CPU28                      1      cpu-migrations            #    0.004 K/sec                  
CPU29                      1      cpu-migrations            #    0.004 K/sec                  
CPU30                      1      cpu-migrations            #    0.004 K/sec                  
CPU31                      0      cpu-migrations            #    0.000 K/sec                  
CPU32                      0      cpu-migrations            #    0.000 K/sec                  
CPU33                      0      cpu-migrations            #    0.000 K/sec                  
CPU34                      0      cpu-migrations            #    0.000 K/sec                  
CPU35                      0      cpu-migrations            #    0.000 K/sec                  
CPU36                      0      cpu-migrations            #    0.000 K/sec                  
CPU37                      0      cpu-migrations            #    0.000 K/sec                  
CPU38                      0      cpu-migrations            #    0.000 K/sec                  
CPU39                      0      cpu-migrations            #    0.000 K/sec                  
CPU40                      0      cpu-migrations            #    0.000 K/sec                  
CPU41                      0      cpu-migrations            #    0.000 K/sec                  
CPU42                      0      cpu-migrations            #    0.000 K/sec                  
CPU43                      0      cpu-migrations            #    0.000 K/sec                  
CPU44                      0      cpu-migrations            #    0.000 K/sec                  
CPU45                      0      cpu-migrations            #    0.000 K/sec                  
CPU46                      0      cpu-migrations            #    0.000 K/sec                  
CPU47                      0      cpu-migrations            #    0.000 K/sec                  
CPU48                      3      cpu-migrations            #    0.012 K/sec                  
CPU49                      2      cpu-migrations            #    0.008 K/sec                  
CPU50                      1      cpu-migrations            #    0.004 K/sec                  
CPU51                      0      cpu-migrations            #    0.000 K/sec                  
CPU52                      1      cpu-migrations            #    0.004 K/sec                  
CPU53                      3      cpu-migrations            #    0.012 K/sec                  
CPU54                      3      cpu-migrations            #    0.012 K/sec                  
CPU55                      2      cpu-migrations            #    0.008 K/sec                  
CPU56                      0      cpu-migrations            #    0.000 K/sec                  
CPU57                      2      cpu-migrations            #    0.008 K/sec                  
CPU58                      1      cpu-migrations            #    0.004 K/sec                  
CPU59                      1      cpu-migrations            #    0.004 K/sec                  
CPU60                      0      cpu-migrations            #    0.000 K/sec                  
CPU61                      1      cpu-migrations            #    0.004 K/sec                  
CPU62                      1      cpu-migrations            #    0.004 K/sec                  
CPU63                      1      cpu-migrations            #    0.004 K/sec                  
CPU0                       0      page-faults               #    0.000 K/sec                  
CPU1                       0      page-faults               #    0.000 K/sec                  
CPU2                       0      page-faults               #    0.000 K/sec                  
CPU3                       0      page-faults               #    0.000 K/sec                  
CPU4                       0      page-faults               #    0.000 K/sec                  
CPU5                       0      page-faults               #    0.000 K/sec                  
CPU6                       0      page-faults               #    0.000 K/sec                  
CPU7                       0      page-faults               #    0.000 K/sec                  
CPU8                       0      page-faults               #    0.000 K/sec                  
CPU9                       0      page-faults               #    0.000 K/sec                  
CPU10                      0      page-faults               #    0.000 K/sec                  
CPU11                      0      page-faults               #    0.000 K/sec                  
CPU12                      0      page-faults               #    0.000 K/sec                  
CPU13                      0      page-faults               #    0.000 K/sec                  
CPU14                      0      page-faults               #    0.000 K/sec                  
CPU15                      0      page-faults               #    0.000 K/sec                  
CPU16                      2      page-faults               #    0.008 K/sec                  
CPU17                   3540      page-faults               #    0.014 M/sec                  
CPU18                      0      page-faults               #    0.000 K/sec                  
CPU19                      0      page-faults               #    0.000 K/sec                  
CPU20                      0      page-faults               #    0.000 K/sec                  
CPU21                      0      page-faults               #    0.000 K/sec                  
CPU22                      0      page-faults               #    0.000 K/sec                  
CPU23                      0      page-faults               #    0.000 K/sec                  
CPU24                      0      page-faults               #    0.000 K/sec                  
CPU25                      0      page-faults               #    0.000 K/sec                  
CPU26                      0      page-faults               #    0.000 K/sec                  
CPU27                      0      page-faults               #    0.000 K/sec                  
CPU28                      0      page-faults               #    0.000 K/sec                  
CPU29                      0      page-faults               #    0.000 K/sec                  
CPU30                      0      page-faults               #    0.000 K/sec                  
CPU31                      0      page-faults               #    0.000 K/sec                  
CPU32                      0      page-faults               #    0.000 K/sec                  
CPU33                      0      page-faults               #    0.000 K/sec                  
CPU34                      0      page-faults               #    0.000 K/sec                  
CPU35                      0      page-faults               #    0.000 K/sec                  
CPU36                      0      page-faults               #    0.000 K/sec                  
CPU37                      0      page-faults               #    0.000 K/sec                  
CPU38                      0      page-faults               #    0.000 K/sec                  
CPU39                      0      page-faults               #    0.000 K/sec                  
CPU40                      0      page-faults               #    0.000 K/sec                  
CPU41                      0      page-faults               #    0.000 K/sec                  
CPU42                      0      page-faults               #    0.000 K/sec                  
CPU43                      0      page-faults               #    0.000 K/sec                  
CPU44                      0      page-faults               #    0.000 K/sec                  
CPU45                      0      page-faults               #    0.000 K/sec                  
CPU46                      0      page-faults               #    0.000 K/sec                  
CPU47                      0      page-faults               #    0.000 K/sec                  
CPU48                      0      page-faults               #    0.000 K/sec                  
CPU49                      0      page-faults               #    0.000 K/sec                  
CPU50                      4      page-faults               #    0.016 K/sec                  
CPU51                      0      page-faults               #    0.000 K/sec                  
CPU52                      0      page-faults               #    0.000 K/sec                  
CPU53                      0      page-faults               #    0.000 K/sec                  
CPU54                      0      page-faults               #    0.000 K/sec                  
CPU55                      0      page-faults               #    0.000 K/sec                  
CPU56                      0      page-faults               #    0.000 K/sec                  
CPU57                      0      page-faults               #    0.000 K/sec                  
CPU58                      0      page-faults               #    0.000 K/sec                  
CPU59                      0      page-faults               #    0.000 K/sec                  
CPU60                      0      page-faults               #    0.000 K/sec                  
CPU61                      0      page-faults               #    0.000 K/sec                  
CPU62                      0      page-faults               #    0.000 K/sec                  
CPU63                      2      page-faults               #    0.008 K/sec                  
CPU0               146891507      cycles                    #    0.600 GHz                      (75.98%)
CPU1                23392324      cycles                    #    0.096 GHz                      (75.88%)
CPU2                27750151      cycles                    #    0.113 GHz                      (76.09%)
CPU3                24030904      cycles                    #    0.098 GHz                      (76.06%)
CPU4                21057325      cycles                    #    0.086 GHz                      (76.11%)
CPU5                22796691      cycles                    #    0.093 GHz                      (75.99%)
CPU6                24877031      cycles                    #    0.102 GHz                      (76.15%)
CPU7                21746262      cycles                    #    0.089 GHz                      (75.97%)
CPU8                27905829      cycles                    #    0.114 GHz                      (76.04%)
CPU9                28341197      cycles                    #    0.116 GHz                      (76.07%)
CPU10               21987254      cycles                    #    0.090 GHz                      (75.96%)
CPU11               22695948      cycles                    #    0.093 GHz                      (75.91%)
CPU12               20492822      cycles                    #    0.084 GHz                      (75.75%)
CPU13               22561740      cycles                    #    0.092 GHz                      (76.03%)
CPU14               22263669      cycles                    #    0.091 GHz                      (75.99%)
CPU15               22145309      cycles                    #    0.091 GHz                      (75.84%)
CPU16              376454839      cycles                    #    1.539 GHz                      (76.07%)
CPU17              575727870      cycles                    #    2.353 GHz                      (75.81%)
CPU18              273603702      cycles                    #    1.118 GHz                      (76.20%)
CPU19              327410045      cycles                    #    1.338 GHz                      (75.70%)
CPU20              262583337      cycles                    #    1.073 GHz                      (75.81%)
CPU21              314767856      cycles                    #    1.286 GHz                      (75.96%)
CPU22              317646831      cycles                    #    1.298 GHz                      (75.97%)
CPU23              231282149      cycles                    #    0.945 GHz                      (76.27%)
CPU24              314821417      cycles                    #    1.286 GHz                      (75.90%)
CPU25              316622877      cycles                    #    1.294 GHz                      (75.90%)
CPU26              341020599      cycles                    #    1.393 GHz                      (75.88%)
CPU27              329000508      cycles                    #    1.344 GHz                      (75.94%)
CPU28              323708088      cycles                    #    1.323 GHz                      (75.97%)
CPU29              317019668      cycles                    #    1.296 GHz                      (75.74%)
CPU30              347572833      cycles                    #    1.421 GHz                      (75.96%)
CPU31              334107255      cycles                    #    1.366 GHz                      (75.98%)
CPU32               18262461      cycles                    #    0.075 GHz                      (76.08%)
CPU33               20687858      cycles                    #    0.085 GHz                      (76.00%)
CPU34               25180903      cycles                    #    0.103 GHz                      (76.11%)
CPU35               22505656      cycles                    #    0.092 GHz                      (76.09%)
CPU36               21807373      cycles                    #    0.089 GHz                      (76.25%)
CPU37               23009907      cycles                    #    0.094 GHz                      (76.10%)
CPU38               23684344      cycles                    #    0.097 GHz                      (76.16%)
CPU39               21225095      cycles                    #    0.087 GHz                      (75.99%)
CPU40               22788956      cycles                    #    0.093 GHz                      (76.05%)
CPU41               22754291      cycles                    #    0.093 GHz                      (76.08%)
CPU42               21618759      cycles                    #    0.088 GHz                      (75.99%)
CPU43               21811078      cycles                    #    0.089 GHz                      (75.88%)
CPU44               19274895      cycles                    #    0.079 GHz                      (75.78%)
CPU45               20695648      cycles                    #    0.085 GHz                      (75.98%)
CPU46               22808044      cycles                    #    0.093 GHz                      (76.11%)
CPU47               20546620      cycles                    #    0.084 GHz                      (75.87%)
CPU48              301871321      cycles                    #    1.235 GHz                      (75.74%)
CPU49              292885388      cycles                    #    1.198 GHz                      (75.91%)
CPU50              315553956      cycles                    #    1.290 GHz                      (76.18%)
CPU51              337012844      cycles                    #    1.378 GHz                      (75.97%)
CPU52              315363029      cycles                    #    1.290 GHz                      (75.83%)
CPU53              177539048      cycles                    #    0.726 GHz                      (75.75%)
CPU54              134807484      cycles                    #    0.551 GHz                      (75.92%)
CPU55              317131237      cycles                    #    1.297 GHz                      (76.16%)
CPU56              313403077      cycles                    #    1.282 GHz                      (75.85%)
CPU57              313392171      cycles                    #    1.282 GHz                      (75.84%)
CPU58              321242030      cycles                    #    1.314 GHz                      (75.98%)
CPU59              314558272      cycles                    #    1.286 GHz                      (76.09%)
CPU60              342421071      cycles                    #    1.400 GHz                      (75.87%)
CPU61              340892368      cycles                    #    1.394 GHz                      (75.99%)
CPU62              337292236      cycles                    #    1.379 GHz                      (75.84%)
CPU63              342304552      cycles                    #    1.400 GHz                      (75.68%)
CPU0                61725057      instructions              #    0.48  insn per cycle           (76.03%)
CPU1                 3012666      instructions              #    0.03  insn per cycle           (75.83%)
CPU2                 1901909      instructions              #    0.03  insn per cycle           (75.69%)
CPU3                 1383217      instructions              #    0.03  insn per cycle           (75.88%)
CPU4                 1362309      instructions              #    0.03  insn per cycle           (75.87%)
CPU5                 1336916      instructions              #    0.04  insn per cycle           (75.93%)
CPU6                 1357462      instructions              #    0.02  insn per cycle           (75.77%)
CPU7                 1336894      instructions              #    0.02  insn per cycle           (75.81%)
CPU8                 2349857      instructions              #    0.06  insn per cycle           (75.71%)
CPU9                 2345561      instructions              #    0.06  insn per cycle           (75.74%)
CPU10                1359650      instructions              #    0.04  insn per cycle           (76.02%)
CPU11                1355170      instructions              #    0.04  insn per cycle           (75.97%)
CPU12                1332621      instructions              #    0.03  insn per cycle           (75.84%)
CPU13                1309025      instructions              #    0.04  insn per cycle           (76.09%)
CPU14                1321098      instructions              #    0.05  insn per cycle           (75.95%)
CPU15                1354306      instructions              #    0.03  insn per cycle           (76.01%)
CPU16              117321278      instructions              #    0.32  insn per cycle           (75.73%)
CPU17              477023592      instructions              #    1.04  insn per cycle           (75.86%)
CPU18               67829053      instructions              #    0.22  insn per cycle           (75.45%)
CPU19              106717239      instructions              #    0.33  insn per cycle           (76.12%)
CPU20               64723967      instructions              #    0.21  insn per cycle           (76.11%)
CPU21               92542057      instructions              #    0.29  insn per cycle           (75.61%)
CPU22              103618365      instructions              #    0.33  insn per cycle           (75.79%)
CPU23               55296954      instructions              #    0.18  insn per cycle           (75.81%)
CPU24               69975833      instructions              #    0.22  insn per cycle           (75.92%)
CPU25               76152069      instructions              #    0.24  insn per cycle           (75.81%)
CPU26              109185087      instructions              #    0.33  insn per cycle           (75.82%)
CPU27              109113051      instructions              #    0.33  insn per cycle           (76.03%)
CPU28               77346018      instructions              #    0.24  insn per cycle           (75.77%)
CPU29               75516853      instructions              #    0.23  insn per cycle           (76.09%)
CPU30              113752537      instructions              #    0.34  insn per cycle           (75.91%)
CPU31              105934527      instructions              #    0.32  insn per cycle           (75.82%)
CPU32                1275566      instructions              #    0.03  insn per cycle           (75.94%)
CPU33                1310392      instructions              #    0.03  insn per cycle           (75.78%)
CPU34                1368744      instructions              #    0.03  insn per cycle           (75.56%)
CPU35                1386232      instructions              #    0.03  insn per cycle           (75.96%)
CPU36                1303616      instructions              #    0.05  insn per cycle           (75.84%)
CPU37                1373751      instructions              #    0.05  insn per cycle           (75.72%)
CPU38                1344747      instructions              #    0.03  insn per cycle           (75.72%)
CPU39                1387633      instructions              #    0.06  insn per cycle           (75.88%)
CPU40                1387973      instructions              #    0.06  insn per cycle           (75.95%)
CPU41                1338690      instructions              #    0.06  insn per cycle           (75.65%)
CPU42                1395384      instructions              #    0.06  insn per cycle           (75.98%)
CPU43                1347040      instructions              #    0.06  insn per cycle           (76.17%)
CPU44                1366156      instructions              #    0.06  insn per cycle           (75.82%)
CPU45                1333270      instructions              #    0.06  insn per cycle           (76.12%)
CPU46                1407073      instructions              #    0.06  insn per cycle           (75.89%)
CPU47                1374547      instructions              #    0.06  insn per cycle           (75.97%)
CPU48               77243167      instructions              #    0.27  insn per cycle           (75.86%)
CPU49               82354635      instructions              #    0.19  insn per cycle           (76.01%)
CPU50               80989923      instructions              #    0.27  insn per cycle           (75.66%)
CPU51              106422818      instructions              #    0.34  insn per cycle           (75.92%)
CPU52               84972355      instructions              #    0.28  insn per cycle           (75.96%)
CPU53               37232092      instructions              #    0.12  insn per cycle           (75.84%)
CPU54               31770486      instructions              #    0.10  insn per cycle           (75.89%)
CPU55               91906185      instructions              #    0.29  insn per cycle           (75.84%)
CPU56               70499711      instructions              #    0.22  insn per cycle           (75.91%)
CPU57               75542989      instructions              #    0.23  insn per cycle           (75.98%)
CPU58               81790121      instructions              #    0.25  insn per cycle           (75.91%)
CPU59               76059512      instructions              #    0.23  insn per cycle           (75.85%)
CPU60              109093197      instructions              #    0.33  insn per cycle           (76.16%)
CPU61              106311344      instructions              #    0.32  insn per cycle           (75.71%)
CPU62              110980134      instructions              #    0.34  insn per cycle           (75.92%)
CPU63              103079811      instructions              #    0.31  insn per cycle           (75.96%)
CPU0                13192819      branches                  #   53.919 M/sec                    (75.62%)
CPU1                  516819      branches                  #    2.112 M/sec                    (75.98%)
CPU2                  409308      branches                  #    1.673 M/sec                    (75.81%)
CPU3                  311171      branches                  #    1.272 M/sec                    (75.71%)
CPU4                  306752      branches                  #    1.254 M/sec                    (75.88%)
CPU5                  298374      branches                  #    1.219 M/sec                    (75.83%)
CPU6                  306673      branches                  #    1.253 M/sec                    (75.93%)
CPU7                  297960      branches                  #    1.218 M/sec                    (75.75%)
CPU8                  494464      branches                  #    2.021 M/sec                    (75.85%)
CPU9                  509697      branches                  #    2.083 M/sec                    (75.92%)
CPU10                 304574      branches                  #    1.245 M/sec                    (75.68%)
CPU11                 309682      branches                  #    1.266 M/sec                    (75.76%)
CPU12                 300856      branches                  #    1.230 M/sec                    (76.04%)
CPU13                 300358      branches                  #    1.228 M/sec                    (75.99%)
CPU14                 298103      branches                  #    1.218 M/sec                    (75.76%)
CPU15                 306490      branches                  #    1.253 M/sec                    (76.00%)
CPU16               26124575      branches                  #  106.772 M/sec                    (75.86%)
CPU17               96212759      branches                  #  393.168 M/sec                    (76.11%)
CPU18               14391524      branches                  #   58.811 M/sec                    (76.12%)
CPU19               22578611      branches                  #   92.265 M/sec                    (75.76%)
CPU20               13695839      branches                  #   55.961 M/sec                    (75.66%)
CPU21               17782082      branches                  #   72.659 M/sec                    (76.10%)
CPU22               20655007      branches                  #   84.392 M/sec                    (75.97%)
CPU23               12095621      branches                  #   49.421 M/sec                    (75.82%)
CPU24               13883398      branches                  #   56.727 M/sec                    (75.80%)
CPU25               14999076      branches                  #   61.289 M/sec                    (75.88%)
CPU26               23126007      branches                  #   94.497 M/sec                    (75.90%)
CPU27               23445255      branches                  #   95.807 M/sec                    (75.81%)
CPU28               15535410      branches                  #   63.488 M/sec                    (76.18%)
CPU29               14816927      branches                  #   60.554 M/sec                    (75.80%)
CPU30               25317041      branches                  #  103.471 M/sec                    (75.97%)
CPU31               22696453      branches                  #   92.765 M/sec                    (75.83%)
CPU32                 295307      branches                  #    1.207 M/sec                    (75.73%)
CPU33                 296750      branches                  #    1.213 M/sec                    (75.96%)
CPU34                 315292      branches                  #    1.289 M/sec                    (75.85%)
CPU35                 315726      branches                  #    1.291 M/sec                    (75.47%)
CPU36                 300630      branches                  #    1.229 M/sec                    (75.76%)
CPU37                 313858      branches                  #    1.283 M/sec                    (75.95%)
CPU38                 311074      branches                  #    1.272 M/sec                    (75.85%)
CPU39                 313378      branches                  #    1.281 M/sec                    (75.65%)
CPU40                 309929      branches                  #    1.267 M/sec                    (75.70%)
CPU41                 302402      branches                  #    1.236 M/sec                    (75.98%)
CPU42                 310272      branches                  #    1.269 M/sec                    (75.76%)
CPU43                 306615      branches                  #    1.254 M/sec                    (75.65%)
CPU44                 311338      branches                  #    1.273 M/sec                    (75.98%)
CPU45                 301310      branches                  #    1.232 M/sec                    (75.89%)
CPU46                 323305      branches                  #    1.322 M/sec                    (75.81%)
CPU47                 310881      branches                  #    1.271 M/sec                    (75.92%)
CPU48               16239714      branches                  #   66.412 M/sec                    (75.80%)
CPU49               17289130      branches                  #   70.698 M/sec                    (75.86%)
CPU50               15872606      branches                  #   64.907 M/sec                    (75.84%)
CPU51               23784503      branches                  #   97.261 M/sec                    (75.88%)
CPU52               16724682      branches                  #   68.392 M/sec                    (75.73%)
CPU53                7690404      branches                  #   31.449 M/sec                    (75.86%)
CPU54                6582428      branches                  #   26.919 M/sec                    (76.01%)
CPU55               17764780      branches                  #   72.650 M/sec                    (75.74%)
CPU56               13819309      branches                  #   56.516 M/sec                    (75.73%)
CPU57               14947124      branches                  #   61.131 M/sec                    (75.75%)
CPU58               15994199      branches                  #   65.415 M/sec                    (75.92%)
CPU59               16083514      branches                  #   65.779 M/sec                    (75.92%)
CPU60               22730284      branches                  #   92.966 M/sec                    (75.76%)
CPU61               22303908      branches                  #   91.219 M/sec                    (76.10%)
CPU62               24208531      branches                  #   99.010 M/sec                    (75.88%)
CPU63               22250526      branches                  #   91.005 M/sec                    (76.01%)
CPU0                  188049      branch-misses             #    1.88% of all branches          (76.14%)
CPU1                   33530      branch-misses             #    0.62% of all branches          (76.12%)
CPU2                   38325      branch-misses             #    1.19% of all branches          (76.20%)
CPU3                   24195      branch-misses             #    1.22% of all branches          (76.17%)
CPU4                   24513      branch-misses             #    2.48% of all branches          (75.97%)
CPU5                   24611      branch-misses             #    3.11% of all branches          (76.10%)
CPU6                   24903      branch-misses             #    0.69% of all branches          (76.03%)
CPU7                   24890      branch-misses             #    0.76% of all branches          (76.38%)
CPU8                   47918      branch-misses             #    3.15% of all branches          (76.33%)
CPU9                   49731      branch-misses             #    3.41% of all branches          (76.25%)
CPU10                  24134      branch-misses             #    2.08% of all branches          (76.33%)
CPU11                  23914      branch-misses             #    2.90% of all branches          (76.39%)
CPU12                  25170      branch-misses             #    1.71% of all branches          (76.43%)
CPU13                  24432      branch-misses             #    2.85% of all branches          (75.99%)
CPU14                  24856      branch-misses             #    6.05% of all branches          (76.43%)
CPU15                  23866      branch-misses             #    1.16% of all branches          (76.33%)
CPU16                 495221      branch-misses             #    2.41% of all branches          (76.54%)
CPU17                2634924      branch-misses             #    4.64% of all branches          (76.42%)
CPU18                 222939      branch-misses             #    1.40% of all branches          (76.46%)
CPU19                 513276      branch-misses             #    3.59% of all branches          (76.66%)
CPU20                 217148      branch-misses             #    1.46% of all branches          (76.66%)
CPU21                 290463      branch-misses             #    1.63% of all branches          (76.59%)
CPU22                 314811      branch-misses             #    2.12% of all branches          (74.83%)
CPU23                 203890      branch-misses             #    1.47% of all branches          (74.70%)
CPU24                 249874      branch-misses             #    1.82% of all branches          (75.00%)
CPU25                 261477      branch-misses             #    1.78% of all branches          (75.08%)
CPU26                 505466      branch-misses             #    3.15% of all branches          (75.05%)
CPU27                 512992      branch-misses             #    3.00% of all branches          (74.89%)
CPU28                 280485      branch-misses             #    1.86% of all branches          (74.75%)
CPU29                 268234      branch-misses             #    1.53% of all branches          (75.06%)
CPU30                 588219      branch-misses             #    3.16% of all branches          (74.88%)
CPU31                 516902      branch-misses             #    2.80% of all branches          (75.10%)
CPU32                  20803      branch-misses             #    1.17% of all branches          (75.01%)
CPU33                  22511      branch-misses             #    0.85% of all branches          (75.02%)
CPU34                  23391      branch-misses             #    1.29% of all branches          (75.27%)
CPU35                  23903      branch-misses             #    0.97% of all branches          (75.31%)
CPU36                  23707      branch-misses             #    3.92% of all branches          (74.99%)
CPU37                  23170      branch-misses             #    4.56% of all branches          (75.11%)
CPU38                  22571      branch-misses             #    0.97% of all branches          (75.16%)
CPU39                  23344      branch-misses             #    6.98% of all branches          (75.41%)
CPU40                  23146      branch-misses             #    7.00% of all branches          (75.30%)
CPU41                  23293      branch-misses             #    7.21% of all branches          (75.31%)
CPU42                  23363      branch-misses             #    5.79% of all branches          (75.28%)
CPU43                  22192      branch-misses             #    6.86% of all branches          (75.34%)
CPU44                  23069      branch-misses             #    6.97% of all branches          (75.47%)
CPU45                  23951      branch-misses             #    7.27% of all branches          (75.09%)
CPU46                  23305      branch-misses             #    7.04% of all branches          (75.28%)
CPU47                  23686      branch-misses             #    7.25% of all branches          (75.36%)
CPU48                 273914      branch-misses             #    1.71% of all branches          (75.77%)
CPU49                 287376      branch-misses             #    0.57% of all branches          (75.36%)
CPU50                 270502      branch-misses             #    1.81% of all branches          (75.51%)
CPU51                 565735      branch-misses             #    3.79% of all branches          (75.42%)
CPU52                 283154      branch-misses             #    1.97% of all branches          (75.69%)
CPU53                 141412      branch-misses             #    0.81% of all branches          (75.81%)
CPU54                 111776      branch-misses             #    0.78% of all branches          (75.43%)
CPU55                 291380      branch-misses             #    1.92% of all branches          (75.52%)
CPU56                 246076      branch-misses             #    1.73% of all branches          (75.78%)
CPU57                 264986      branch-misses             #    1.60% of all branches          (75.78%)
CPU58                 283114      branch-misses             #    1.67% of all branches          (75.53%)
CPU59                 277876      branch-misses             #    1.71% of all branches          (75.50%)
CPU60                 521559      branch-misses             #    2.93% of all branches          (75.58%)
CPU61                 479245      branch-misses             #    2.70% of all branches          (75.65%)
CPU62                 532779      branch-misses             #    2.99% of all branches          (75.83%)
CPU63                 520349      branch-misses             #    2.79% of all branches          (75.83%)

           0.26475 +- 0.00394 seconds time elapsed  ( +-  1.49% )
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="check-next-results">
<h2>Check next results:<a class="headerlink" href="#check-next-results" title="Permalink to this headline">¶</a></h2>
<div class="section" id="perf-openblas-gaxpy-row-column-oriented-nivel-2">
<h3>perf OpenBLAS: <em>gaxpy row, column oriented</em> (nivel 2)<a class="headerlink" href="#perf-openblas-gaxpy-row-column-oriented-nivel-2" title="Permalink to this headline">¶</a></h3>
<p>Utilizaremos <code class="docutils literal notranslate"><span class="pre">perf</span></code> en lo que sigue para evaluar las métricas de IPC, <em>cache-references</em>, <em>cache-misses</em> y medir el tiempo de ejecución. Además, esto permitirá comparar los tiempos de ejecución del algoritmo <em>gaxpy</em> (nivel BLAS 2), con vectorización y sin vectorización.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">2020</span><span class="p">)</span>
<span class="n">m</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="mi">4</span>
<span class="n">n</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="mi">4</span>
<span class="n">A</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
<span class="n">file</span><span class="o">=</span><span class="s1">&#39;A.txt&#39;</span>
<span class="n">np</span><span class="o">.</span><span class="n">savetxt</span><span class="p">(</span><span class="n">file</span><span class="p">,</span><span class="n">A</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Arhivo sin vectorizar y utilizando listas para construir a la matriz y a los vectores:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%file</span> mult_matrix_vector.py
<span class="n">m</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="mi">4</span>
<span class="n">n</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="mi">4</span>
<span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="mf">2.5</span><span class="p">]</span><span class="o">*</span><span class="n">n</span>
<span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">m</span>
<span class="n">A</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">file</span><span class="o">=</span><span class="s1">&#39;A.txt&#39;</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">A</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">l</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)])</span>      
<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
        <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+=</span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Writing mult_matrix_vector.py
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="gaxpy-column-oriented-caso-no-vectorizado">
<h3><em>gaxpy column oriented</em> caso no vectorizado<a class="headerlink" href="#gaxpy-column-oriented-caso-no-vectorizado" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">bash</span>
perf stat -S -e cycles,instructions,cache-references,cache-misses -r 2 python3 mult_matrix_vector.py
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> Performance counter stats for &#39;python3 mult_matrix_vector.py&#39; (2 runs):

      271994249914      cycles                                                        ( +-  2.18% )  (75.00%)
      590762909258      instructions              #    2.17  insn per cycle           ( +-  0.17% )  (75.00%)
        2657542777      cache-references                                              ( +-  1.66% )  (75.01%)
         441152508      cache-misses              #   16.600 % of all cache refs      ( +-  2.06% )  (75.00%)

            102.15 +- 2.48 seconds time elapsed  ( +-  2.43% )
</pre></div>
</div>
</div>
</div>
<p>Métricas por core:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">bash</span>
perf stat -S --all-cpus -A -e cycles,instructions,cache-references,cache-misses -r 2 python3 mult_matrix_vector.py
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> Performance counter stats for &#39;system wide&#39; (2 runs):

CPU0              3578630443      cycles                                                        (75.01%)
CPU1              3605899218      cycles                                                        (75.01%)
CPU2              3524746112      cycles                                                        (75.01%)
CPU3              3589221497      cycles                                                        (75.00%)
CPU4              3535171266      cycles                                                        (75.01%)
CPU5              3591223324      cycles                                                        (75.00%)
CPU6              3537162601      cycles                                                        (75.01%)
CPU7              3628710964      cycles                                                        (75.01%)
CPU8              3479570426      cycles                                                        (75.00%)
CPU9              3634161821      cycles                                                        (75.01%)
CPU10             3630174692      cycles                                                        (75.00%)
CPU11             3880625753      cycles                                                        (75.00%)
CPU12             3552480169      cycles                                                        (75.00%)
CPU13             3610296320      cycles                                                        (75.00%)
CPU14             3674008708      cycles                                                        (75.01%)
CPU15             3665733244      cycles                                                        (75.01%)
CPU16             6813910657      cycles                                                        (75.00%)
CPU17             3688328384      cycles                                                        (75.00%)
CPU18             3688265224      cycles                                                        (75.00%)
CPU19             3741251424      cycles                                                        (75.00%)
CPU20             3865124613      cycles                                                        (75.00%)
CPU21            83358635487      cycles                                                        (75.00%)
CPU22             3656196664      cycles                                                        (75.00%)
CPU23             3647326929      cycles                                                        (75.00%)
CPU24             3674870846      cycles                                                        (75.00%)
CPU25             3620249123      cycles                                                        (75.00%)
CPU26             3763095517      cycles                                                        (75.00%)
CPU27             3753232412      cycles                                                        (75.00%)
CPU28             3656084972      cycles                                                        (75.00%)
CPU29             3649319629      cycles                                                        (75.00%)
CPU30             3739270785      cycles                                                        (75.00%)
CPU31             3760041482      cycles                                                        (75.00%)
CPU32             2948149349      cycles                                                        (75.01%)
CPU33             3004624838      cycles                                                        (75.01%)
CPU34             2942060521      cycles                                                        (75.01%)
CPU35             3028456942      cycles                                                        (75.00%)
CPU36             3003643141      cycles                                                        (75.01%)
CPU37             3122474624      cycles                                                        (75.00%)
CPU38             2978803776      cycles                                                        (75.00%)
CPU39             3066843393      cycles                                                        (75.00%)
CPU40             2911795941      cycles                                                        (75.00%)
CPU41             3010958395      cycles                                                        (75.00%)
CPU42             3092057823      cycles                                                        (75.00%)
CPU43             3085276334      cycles                                                        (75.00%)
CPU44             3021289409      cycles                                                        (75.00%)
CPU45             3108317638      cycles                                                        (75.00%)
CPU46             3081307028      cycles                                                        (75.00%)
CPU47             3118314391      cycles                                                        (75.00%)
CPU48             3072544726      cycles                                                        (75.00%)
CPU49             3104065556      cycles                                                        (75.00%)
CPU50             3125141441      cycles                                                        (75.00%)
CPU51             3174839815      cycles                                                        (75.00%)
CPU52             3156513626      cycles                                                        (75.00%)
CPU53           183686846682      cycles                                                        (75.00%)
CPU54             3105420655      cycles                                                        (75.00%)
CPU55             3113156091      cycles                                                        (75.00%)
CPU56             3147171204      cycles                                                        (75.00%)
CPU57             3080453124      cycles                                                        (75.01%)
CPU58             3234992187      cycles                                                        (75.01%)
CPU59             3236019232      cycles                                                        (75.01%)
CPU60             3101021008      cycles                                                        (75.01%)
CPU61             3127621372      cycles                                                        (75.01%)
CPU62             3198398350      cycles                                                        (75.01%)
CPU63             3231246410      cycles                                                        (75.01%)
CPU0               445401837      instructions              #    0.12  insn per cycle           (75.00%)
CPU1               375089498      instructions              #    0.10  insn per cycle           (75.00%)
CPU2               371069279      instructions              #    0.10  insn per cycle           (75.00%)
CPU3               368878368      instructions              #    0.10  insn per cycle           (75.01%)
CPU4               371981019      instructions              #    0.10  insn per cycle           (75.00%)
CPU5               390693306      instructions              #    0.11  insn per cycle           (75.00%)
CPU6               370452495      instructions              #    0.10  insn per cycle           (75.00%)
CPU7               376448600      instructions              #    0.10  insn per cycle           (75.00%)
CPU8               359140727      instructions              #    0.10  insn per cycle           (75.00%)
CPU9               367727151      instructions              #    0.10  insn per cycle           (75.00%)
CPU10              371111628      instructions              #    0.10  insn per cycle           (75.00%)
CPU11              538117317      instructions              #    0.13  insn per cycle           (75.00%)
CPU12              370806800      instructions              #    0.10  insn per cycle           (75.00%)
CPU13              374622751      instructions              #    0.10  insn per cycle           (75.00%)
CPU14              425733525      instructions              #    0.11  insn per cycle           (75.00%)
CPU15              374039218      instructions              #    0.10  insn per cycle           (75.00%)
CPU16             2876954774      instructions              #    0.42  insn per cycle           (75.00%)
CPU17              374554932      instructions              #    0.10  insn per cycle           (75.00%)
CPU18              369853846      instructions              #    0.10  insn per cycle           (75.00%)
CPU19              366634019      instructions              #    0.10  insn per cycle           (75.00%)
CPU20              413233384      instructions              #    0.11  insn per cycle           (75.00%)
CPU21           156177941209      instructions              #    3.64  insn per cycle           (75.00%)
CPU22              363140993      instructions              #    0.10  insn per cycle           (75.00%)
CPU23              367156164      instructions              #    0.10  insn per cycle           (75.00%)
CPU24              367041646      instructions              #    0.10  insn per cycle           (75.00%)
CPU25              367158876      instructions              #    0.10  insn per cycle           (75.01%)
CPU26              358085155      instructions              #    0.09  insn per cycle           (75.01%)
CPU27              360878071      instructions              #    0.09  insn per cycle           (75.01%)
CPU28              364876619      instructions              #    0.10  insn per cycle           (75.00%)
CPU29              369955596      instructions              #    0.10  insn per cycle           (75.01%)
CPU30              365469344      instructions              #    0.10  insn per cycle           (75.01%)
CPU31              358234364      instructions              #    0.09  insn per cycle           (75.01%)
CPU32              359473221      instructions              #    0.12  insn per cycle           (75.00%)
CPU33              360682215      instructions              #    0.12  insn per cycle           (75.00%)
CPU34              341887284      instructions              #    0.11  insn per cycle           (75.00%)
CPU35              357739554      instructions              #    0.12  insn per cycle           (75.01%)
CPU36              371992262      instructions              #    0.12  insn per cycle           (75.00%)
CPU37              435947794      instructions              #    0.14  insn per cycle           (75.00%)
CPU38              362216849      instructions              #    0.12  insn per cycle           (75.00%)
CPU39              371455337      instructions              #    0.12  insn per cycle           (75.00%)
CPU40              346231567      instructions              #    0.12  insn per cycle           (75.00%)
CPU41              353748447      instructions              #    0.12  insn per cycle           (75.00%)
CPU42              358300747      instructions              #    0.11  insn per cycle           (75.00%)
CPU43              359980833      instructions              #    0.11  insn per cycle           (75.00%)
CPU44              361501450      instructions              #    0.12  insn per cycle           (75.00%)
CPU45              729214480      instructions              #    0.22  insn per cycle           (75.00%)
CPU46              361319130      instructions              #    0.11  insn per cycle           (75.00%)
CPU47              359405785      instructions              #    0.11  insn per cycle           (75.00%)
CPU48              349001345      instructions              #    0.11  insn per cycle           (75.00%)
CPU49              353201778      instructions              #    0.11  insn per cycle           (75.00%)
CPU50              352533836      instructions              #    0.11  insn per cycle           (75.00%)
CPU51              354905538      instructions              #    0.11  insn per cycle           (75.00%)
CPU52              363936165      instructions              #    0.11  insn per cycle           (75.00%)
CPU53           430385363112      instructions              #    1.87  insn per cycle           (75.00%)
CPU54              349859095      instructions              #    0.11  insn per cycle           (75.00%)
CPU55              355794555      instructions              #    0.11  insn per cycle           (75.00%)
CPU56              353952894      instructions              #    0.11  insn per cycle           (75.00%)
CPU57              356412466      instructions              #    0.11  insn per cycle           (75.00%)
CPU58              350179815      instructions              #    0.11  insn per cycle           (75.00%)
CPU59              353354929      instructions              #    0.11  insn per cycle           (75.00%)
CPU60              356211649      instructions              #    0.11  insn per cycle           (75.00%)
CPU61              362129707      instructions              #    0.11  insn per cycle           (75.00%)
CPU62              351208136      instructions              #    0.11  insn per cycle           (75.00%)
CPU63              350488103      instructions              #    0.11  insn per cycle           (75.00%)
CPU0                40283890      cache-references                                              (75.00%)
CPU1                40019376      cache-references                                              (75.00%)
CPU2                39321166      cache-references                                              (75.00%)
CPU3                39716502      cache-references                                              (75.00%)
CPU4                39251761      cache-references                                              (75.00%)
CPU5                39998332      cache-references                                              (75.00%)
CPU6                39258646      cache-references                                              (75.00%)
CPU7                40243636      cache-references                                              (75.00%)
CPU8                37957401      cache-references                                              (75.00%)
CPU9                41597044      cache-references                                              (75.00%)
CPU10               38307310      cache-references                                              (75.00%)
CPU11               46053886      cache-references                                              (75.00%)
CPU12               38737119      cache-references                                              (75.00%)
CPU13               39086179      cache-references                                              (75.00%)
CPU14               38862607      cache-references                                              (75.00%)
CPU15               38801163      cache-references                                              (75.00%)
CPU16               64164646      cache-references                                              (75.00%)
CPU17               40402596      cache-references                                              (75.00%)
CPU18               41309296      cache-references                                              (75.00%)
CPU19               38442725      cache-references                                              (75.00%)
CPU20               42683033      cache-references                                              (75.00%)
CPU21              863219114      cache-references                                              (75.00%)
CPU22               37406529      cache-references                                              (75.00%)
CPU23               37519015      cache-references                                              (75.00%)
CPU24               36691463      cache-references                                              (75.00%)
CPU25               38146766      cache-references                                              (75.00%)
CPU26               39601686      cache-references                                              (75.00%)
CPU27               39424791      cache-references                                              (75.00%)
CPU28               39222547      cache-references                                              (75.00%)
CPU29               38496867      cache-references                                              (75.00%)
CPU30               37185982      cache-references                                              (75.00%)
CPU31               38968535      cache-references                                              (75.00%)
CPU32               42389468      cache-references                                              (75.00%)
CPU33               42520306      cache-references                                              (75.00%)
CPU34               40137590      cache-references                                              (75.00%)
CPU35               39674707      cache-references                                              (75.00%)
CPU36               39430792      cache-references                                              (75.00%)
CPU37               42108170      cache-references                                              (75.00%)
CPU38               40334230      cache-references                                              (75.00%)
CPU39               41752404      cache-references                                              (75.00%)
CPU40               39332668      cache-references                                              (75.00%)
CPU41               42271596      cache-references                                              (75.00%)
CPU42               40215827      cache-references                                              (75.00%)
CPU43               40692823      cache-references                                              (75.01%)
CPU44               39533691      cache-references                                              (75.00%)
CPU45               43972822      cache-references                                              (75.00%)
CPU46               40467056      cache-references                                              (75.00%)
CPU47               40828475      cache-references                                              (75.00%)
CPU48               41528399      cache-references                                              (75.01%)
CPU49               40238204      cache-references                                              (75.00%)
CPU50               38902775      cache-references                                              (75.00%)
CPU51               40915501      cache-references                                              (75.01%)
CPU52               41928625      cache-references                                              (75.00%)
CPU53             1786598964      cache-references                                              (75.00%)
CPU54               40088227      cache-references                                              (75.01%)
CPU55               40422291      cache-references                                              (75.00%)
CPU56               41210516      cache-references                                              (75.00%)
CPU57               39800652      cache-references                                              (75.00%)
CPU58               39781928      cache-references                                              (75.00%)
CPU59               38376209      cache-references                                              (75.00%)
CPU60               39179763      cache-references                                              (75.00%)
CPU61               39405936      cache-references                                              (75.00%)
CPU62               40990440      cache-references                                              (75.00%)
CPU63               38406523      cache-references                                              (75.00%)
CPU0                  493110      cache-misses              #    1.215 % of all cache refs      (75.00%)
CPU1                  106179      cache-misses              #    0.261 % of all cache refs      (75.00%)
CPU2                   80659      cache-misses              #    0.201 % of all cache refs      (75.00%)
CPU3                   79941      cache-misses              #    0.198 % of all cache refs      (75.00%)
CPU4                  103226      cache-misses              #    0.257 % of all cache refs      (75.00%)
CPU5                  145783      cache-misses              #    0.360 % of all cache refs      (75.00%)
CPU6                   83631      cache-misses              #    0.209 % of all cache refs      (75.00%)
CPU7                  128582      cache-misses              #    0.311 % of all cache refs      (75.00%)
CPU8                  297859      cache-misses              #    0.757 % of all cache refs      (75.00%)
CPU9                  112477      cache-misses              #    0.272 % of all cache refs      (75.00%)
CPU10                  62512      cache-misses              #    0.159 % of all cache refs      (75.00%)
CPU11                 621952      cache-misses              #    1.253 % of all cache refs      (75.00%)
CPU12                  80510      cache-misses              #    0.203 % of all cache refs      (75.00%)
CPU13                  89526      cache-misses              #    0.226 % of all cache refs      (75.00%)
CPU14                 194631      cache-misses              #    0.493 % of all cache refs      (75.00%)
CPU15                  66171      cache-misses              #    0.167 % of all cache refs      (75.00%)
CPU16                7847960      cache-misses              #   12.138 % of all cache refs      (75.00%)
CPU17                 174109      cache-misses              #    0.425 % of all cache refs      (75.00%)
CPU18                 162690      cache-misses              #    0.387 % of all cache refs      (75.00%)
CPU19                 156605      cache-misses              #    0.394 % of all cache refs      (75.01%)
CPU20                 479786      cache-misses              #    1.120 % of all cache refs      (75.00%)
CPU21              205643595      cache-misses              #   46.254 % of all cache refs      (75.00%)
CPU22                 168010      cache-misses              #    0.432 % of all cache refs      (75.00%)
CPU23                 126177      cache-misses              #    0.327 % of all cache refs      (75.00%)
CPU24                 130577      cache-misses              #    0.346 % of all cache refs      (75.00%)
CPU25                 117914      cache-misses              #    0.302 % of all cache refs      (75.00%)
CPU26                 110282      cache-misses              #    0.271 % of all cache refs      (75.00%)
CPU27                 103320      cache-misses              #    0.254 % of all cache refs      (75.00%)
CPU28                 220975      cache-misses              #    0.550 % of all cache refs      (75.00%)
CPU29                 193715      cache-misses              #    0.489 % of all cache refs      (75.00%)
CPU30                 167115      cache-misses              #    0.436 % of all cache refs      (75.00%)
CPU31                 128706      cache-misses              #    0.319 % of all cache refs      (75.00%)
CPU32                 168895      cache-misses              #    0.392 % of all cache refs      (75.00%)
CPU33                  95430      cache-misses              #    0.220 % of all cache refs      (75.00%)
CPU34                  82872      cache-misses              #    0.203 % of all cache refs      (75.00%)
CPU35                  84179      cache-misses              #    0.207 % of all cache refs      (75.00%)
CPU36                 132104      cache-misses              #    0.327 % of all cache refs      (75.00%)
CPU37                 431628      cache-misses              #    1.016 % of all cache refs      (75.00%)
CPU38                  94355      cache-misses              #    0.228 % of all cache refs      (75.00%)
CPU39                 136175      cache-misses              #    0.308 % of all cache refs      (75.00%)
CPU40                 265485      cache-misses              #    0.653 % of all cache refs      (75.00%)
CPU41                 103910      cache-misses              #    0.248 % of all cache refs      (75.00%)
CPU42                  60000      cache-misses              #    0.146 % of all cache refs      (75.00%)
CPU43                  57267      cache-misses              #    0.138 % of all cache refs      (75.00%)
CPU44                  82353      cache-misses              #    0.204 % of all cache refs      (75.00%)
CPU45                 222745      cache-misses              #    0.501 % of all cache refs      (75.00%)
CPU46                  68270      cache-misses              #    0.165 % of all cache refs      (75.00%)
CPU47                  66954      cache-misses              #    0.161 % of all cache refs      (75.00%)
CPU48                 225577      cache-misses              #    0.535 % of all cache refs      (75.00%)
CPU49                 121098      cache-misses              #    0.292 % of all cache refs      (75.00%)
CPU50                 176107      cache-misses              #    0.439 % of all cache refs      (75.00%)
CPU51                 130837      cache-misses              #    0.311 % of all cache refs      (75.00%)
CPU52                 150721      cache-misses              #    0.358 % of all cache refs      (75.00%)
CPU53              222049813      cache-misses              #   10.099 % of all cache refs      (75.00%)
CPU54                 145229      cache-misses              #    0.351 % of all cache refs      (75.00%)
CPU55                  97721      cache-misses              #    0.236 % of all cache refs      (75.00%)
CPU56                 130451      cache-misses              #    0.308 % of all cache refs      (75.00%)
CPU57                 106175      cache-misses              #    0.260 % of all cache refs      (75.00%)
CPU58                 208002      cache-misses              #    0.507 % of all cache refs      (75.00%)
CPU59                 179152      cache-misses              #    0.453 % of all cache refs      (75.00%)
CPU60                  89397      cache-misses              #    0.222 % of all cache refs      (75.00%)
CPU61                 210548      cache-misses              #    0.519 % of all cache refs      (75.00%)
CPU62                 122447      cache-misses              #    0.290 % of all cache refs      (75.00%)
CPU63                 164496      cache-misses              #    0.415 % of all cache refs      (75.00%)

            103.27 +- 2.15 seconds time elapsed  ( +-  2.09% )
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="gaxpy-column-oriented-caso-vectorizando">
<h3><em>gaxpy column oriented</em> caso vectorizando<a class="headerlink" href="#gaxpy-column-oriented-caso-vectorizando" title="Permalink to this headline">¶</a></h3>
<p>Archivo vectorizando con numpy:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%file</span> mult_matrix_vector_numpy.py
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">m</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="mi">4</span>
<span class="n">n</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="mi">4</span>
<span class="n">x</span> <span class="o">=</span> <span class="mf">2.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="n">file</span><span class="o">=</span><span class="s1">&#39;A.txt&#39;</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">y</span><span class="o">+=</span><span class="n">A</span><span class="p">[:,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Writing mult_matrix_vector_numpy.py
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">bash</span>
perf stat -S -e cycles,instructions,cache-references,cache-misses -r 2 python3 mult_matrix_vector_numpy.py
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> Performance counter stats for &#39;python3 mult_matrix_vector_numpy.py&#39; (2 runs):

      252492709980      cycles                                                        ( +-  0.03% )  (75.00%)
      588235668466      instructions              #    2.33  insn per cycle           ( +-  0.08% )  (74.99%)
        2343784574      cache-references                                              ( +-  0.13% )  (75.01%)
         359287809      cache-misses              #   15.329 % of all cache refs      ( +-  0.43% )  (75.01%)

            91.207 +- 0.124 seconds time elapsed  ( +-  0.14% )
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">bash</span>
perf stat -S --all-cpus -A -e cycles,instructions,cache-references,cache-misses -r 2 python3 mult_matrix_vector_numpy.py
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> Performance counter stats for &#39;system wide&#39; (2 runs):

CPU0              3559339595      cycles                                                        (75.00%)
CPU1              3622620309      cycles                                                        (75.00%)
CPU2              3698861782      cycles                                                        (75.01%)
CPU3              3659761440      cycles                                                        (75.00%)
CPU4              3630648008      cycles                                                        (75.01%)
CPU5              3635328509      cycles                                                        (75.00%)
CPU6              3626589292      cycles                                                        (75.01%)
CPU7              3651908127      cycles                                                        (75.00%)
CPU8              3547347368      cycles                                                        (75.00%)
CPU9              3599265876      cycles                                                        (75.00%)
CPU10             3718948933      cycles                                                        (75.00%)
CPU11             3941021889      cycles                                                        (75.00%)
CPU12             3641225133      cycles                                                        (75.00%)
CPU13             3645563282      cycles                                                        (75.00%)
CPU14             3723594233      cycles                                                        (75.00%)
CPU15             3724263433      cycles                                                        (75.00%)
CPU16             3496164807      cycles                                                        (75.00%)
CPU17           244320642901      cycles                                                        (75.00%)
CPU18             3723529557      cycles                                                        (75.00%)
CPU19             5618802338      cycles                                                        (75.00%)
CPU20             4811699717      cycles                                                        (75.00%)
CPU21             3360764372      cycles                                                        (75.00%)
CPU22             3434888049      cycles                                                        (75.00%)
CPU23             3407701363      cycles                                                        (75.00%)
CPU24             3461231775      cycles                                                        (75.00%)
CPU25             3387599849      cycles                                                        (75.00%)
CPU26             3511408948      cycles                                                        (75.01%)
CPU27             3517943269      cycles                                                        (75.00%)
CPU28             3402254180      cycles                                                        (75.00%)
CPU29             3407542199      cycles                                                        (75.00%)
CPU30             3501656442      cycles                                                        (75.01%)
CPU31             3528330150      cycles                                                        (75.01%)
CPU32             3050463754      cycles                                                        (75.00%)
CPU33             2868355595      cycles                                                        (75.00%)
CPU34             3284749399      cycles                                                        (75.01%)
CPU35             3134567368      cycles                                                        (75.00%)
CPU36             3112432768      cycles                                                        (75.01%)
CPU37             3199219494      cycles                                                        (75.00%)
CPU38             3110038093      cycles                                                        (75.01%)
CPU39             3155211338      cycles                                                        (75.00%)
CPU40             3027295778      cycles                                                        (75.00%)
CPU41             3085389177      cycles                                                        (75.00%)
CPU42             3228807075      cycles                                                        (75.00%)
CPU43             3204451543      cycles                                                        (75.00%)
CPU44             3147832242      cycles                                                        (75.00%)
CPU45             3296287640      cycles                                                        (75.00%)
CPU46             3189554892      cycles                                                        (75.00%)
CPU47             3252233722      cycles                                                        (75.00%)
CPU48             2928375129      cycles                                                        (75.00%)
CPU49             1887433109      cycles                                                        (75.00%)
CPU50             2909905397      cycles                                                        (75.00%)
CPU51             2999852329      cycles                                                        (75.00%)
CPU52             2901002420      cycles                                                        (75.00%)
CPU53             2808585284      cycles                                                        (75.00%)
CPU54             2910023282      cycles                                                        (75.00%)
CPU55             2900016958      cycles                                                        (75.00%)
CPU56             2946808652      cycles                                                        (75.00%)
CPU57             2886506440      cycles                                                        (75.00%)
CPU58             3033664326      cycles                                                        (75.00%)
CPU59             3036083556      cycles                                                        (75.00%)
CPU60             2891616481      cycles                                                        (75.00%)
CPU61             2919238585      cycles                                                        (75.00%)
CPU62             2997666289      cycles                                                        (75.00%)
CPU63             3029978228      cycles                                                        (75.00%)
CPU0               491215679      instructions              #    0.13  insn per cycle           (75.00%)
CPU1               547896028      instructions              #    0.15  insn per cycle           (75.00%)
CPU2               456157981      instructions              #    0.12  insn per cycle           (75.00%)
CPU3               458707381      instructions              #    0.11  insn per cycle           (75.00%)
CPU4               461166176      instructions              #    0.12  insn per cycle           (75.00%)
CPU5               477734722      instructions              #    0.12  insn per cycle           (75.00%)
CPU6               482035250      instructions              #    0.00  insn per cycle           (75.00%)
CPU7               483994470      instructions              #    0.13  insn per cycle           (75.00%)
CPU8               430565043      instructions              #    0.11  insn per cycle           (75.00%)
CPU9               456845288      instructions              #    0.12  insn per cycle           (75.00%)
CPU10              475300196      instructions              #    0.12  insn per cycle           (75.00%)
CPU11              642800462      instructions              #    0.15  insn per cycle           (75.00%)
CPU12              477374732      instructions              #    0.13  insn per cycle           (75.00%)
CPU13              440664205      instructions              #    0.12  insn per cycle           (75.00%)
CPU14              474836473      instructions              #    0.12  insn per cycle           (75.00%)
CPU15              451351372      instructions              #    0.12  insn per cycle           (75.00%)
CPU16              355930373      instructions              #    0.05  insn per cycle           (75.00%)
CPU17           584539729985      instructions              #    4.60  insn per cycle           (75.00%)
CPU18              500327515      instructions              #    0.12  insn per cycle           (75.00%)
CPU19             2007756180      instructions              #    0.31  insn per cycle           (75.00%)
CPU20             1464877742      instructions              #    0.32  insn per cycle           (75.00%)
CPU21              358148485      instructions              #    0.10  insn per cycle           (75.00%)
CPU22              339923254      instructions              #    0.08  insn per cycle           (75.00%)
CPU23              339577650      instructions              #    0.07  insn per cycle           (75.00%)
CPU24              340380136      instructions              #    0.06  insn per cycle           (75.00%)
CPU25              340896677      instructions              #    0.08  insn per cycle           (75.00%)
CPU26              339632183      instructions              #    0.06  insn per cycle           (75.00%)
CPU27              337991261      instructions              #    0.05  insn per cycle           (75.00%)
CPU28              337597707      instructions              #    0.08  insn per cycle           (75.00%)
CPU29              346660784      instructions              #    0.07  insn per cycle           (75.00%)
CPU30              341051540      instructions              #    0.08  insn per cycle           (75.00%)
CPU31              335614085      instructions              #    0.09  insn per cycle           (75.00%)
CPU32              441590496      instructions              #    0.13  insn per cycle           (75.00%)
CPU33              360967795      instructions              #    0.11  insn per cycle           (75.00%)
CPU34              592086583      instructions              #    0.14  insn per cycle           (75.00%)
CPU35              442704153      instructions              #    0.10  insn per cycle           (75.00%)
CPU36              454026299      instructions              #    0.12  insn per cycle           (75.00%)
CPU37              621412845      instructions              #    0.14  insn per cycle           (75.00%)
CPU38              469783117      instructions              #    0.17  insn per cycle           (75.00%)
CPU39              474902037      instructions              #    0.14  insn per cycle           (75.00%)
CPU40              422848688      instructions              #    0.13  insn per cycle           (75.00%)
CPU41              442138473      instructions              #    0.14  insn per cycle           (75.00%)
CPU42              478223894      instructions              #    0.14  insn per cycle           (75.00%)
CPU43              472132750      instructions              #    0.14  insn per cycle           (75.00%)
CPU44              465698627      instructions              #    0.14  insn per cycle           (75.00%)
CPU45              761994510      instructions              #    0.23  insn per cycle           (75.00%)
CPU46              442547837      instructions              #    0.13  insn per cycle           (75.00%)
CPU47              462871610      instructions              #    0.14  insn per cycle           (75.00%)
CPU48              329654570      instructions              #    0.09  insn per cycle           (75.00%)
CPU49              352884187      instructions              #    0.12  insn per cycle           (75.00%)
CPU50              327453848      instructions              #    0.10  insn per cycle           (75.00%)
CPU51              340227776      instructions              #    0.10  insn per cycle           (75.01%)
CPU52              326796054      instructions              #    0.10  insn per cycle           (75.01%)
CPU53              325315663      instructions              #    0.10  insn per cycle           (75.00%)
CPU54              326359996      instructions              #    0.09  insn per cycle           (75.00%)
CPU55              327958619      instructions              #    0.06  insn per cycle           (75.00%)
CPU56              327405477      instructions              #    0.08  insn per cycle           (75.00%)
CPU57              331315187      instructions              #    0.05  insn per cycle           (75.00%)
CPU58              330293788      instructions              #    0.05  insn per cycle           (75.00%)
CPU59              330858303      instructions              #    0.08  insn per cycle           (75.00%)
CPU60              329837545      instructions              #    0.09  insn per cycle           (75.00%)
CPU61              339116709      instructions              #    0.11  insn per cycle           (75.00%)
CPU62              330421374      instructions              #    0.09  insn per cycle           (75.00%)
CPU63              328857937      instructions              #    0.07  insn per cycle           (75.00%)
CPU0                35933902      cache-references                                              (75.01%)
CPU1                36413540      cache-references                                              (75.01%)
CPU2                38671244      cache-references                                              (75.01%)
CPU3                37192583      cache-references                                              (75.00%)
CPU4                37503234      cache-references                                              (75.01%)
CPU5                38063268      cache-references                                              (75.00%)
CPU6                36685789      cache-references                                              (75.01%)
CPU7                37670139      cache-references                                              (75.00%)
CPU8                36045188      cache-references                                              (75.00%)
CPU9                37164458      cache-references                                              (75.00%)
CPU10               36093825      cache-references                                              (75.00%)
CPU11               42747321      cache-references                                              (75.01%)
CPU12               36526232      cache-references                                              (75.00%)
CPU13               36349691      cache-references                                              (75.00%)
CPU14               35315460      cache-references                                              (75.00%)
CPU15               36755232      cache-references                                              (75.00%)
CPU16               38775841      cache-references                                              (75.00%)
CPU17             2346295319      cache-references                                              (75.00%)
CPU18               37959024      cache-references                                              (75.00%)
CPU19               48456133      cache-references                                              (75.01%)
CPU20               44258216      cache-references                                              (75.01%)
CPU21               36489278      cache-references                                              (75.00%)
CPU22               35499025      cache-references                                              (75.00%)
CPU23               34760011      cache-references                                              (75.00%)
CPU24               34593498      cache-references                                              (75.00%)
CPU25               35609494      cache-references                                              (75.00%)
CPU26               36656827      cache-references                                              (75.00%)
CPU27               37089992      cache-references                                              (75.00%)
CPU28               36703284      cache-references                                              (75.00%)
CPU29               36202990      cache-references                                              (75.00%)
CPU30               34986146      cache-references                                              (75.00%)
CPU31               36669251      cache-references                                              (75.00%)
CPU32               39888636      cache-references                                              (75.00%)
CPU33               38702557      cache-references                                              (75.00%)
CPU34               42634570      cache-references                                              (75.00%)
CPU35               37372359      cache-references                                              (75.00%)
CPU36               37728125      cache-references                                              (75.00%)
CPU37               38864221      cache-references                                              (75.00%)
CPU38               38465884      cache-references                                              (75.01%)
CPU39               39145248      cache-references                                              (75.00%)
CPU40               36909505      cache-references                                              (75.00%)
CPU41               37323890      cache-references                                              (75.00%)
CPU42               37593752      cache-references                                              (75.00%)
CPU43               38237870      cache-references                                              (75.00%)
CPU44               37323440      cache-references                                              (75.00%)
CPU45               40452167      cache-references                                              (75.00%)
CPU46               38848852      cache-references                                              (75.00%)
CPU47               38233568      cache-references                                              (75.00%)
CPU48               38831580      cache-references                                              (75.01%)
CPU49               22854003      cache-references                                              (75.01%)
CPU50               36312289      cache-references                                              (75.01%)
CPU51               41678883      cache-references                                              (75.00%)
CPU52               36773666      cache-references                                              (75.00%)
CPU53               36698073      cache-references                                              (75.01%)
CPU54               37261537      cache-references                                              (75.01%)
CPU55               38136619      cache-references                                              (75.01%)
CPU56               39540002      cache-references                                              (75.01%)
CPU57               37431645      cache-references                                              (75.01%)
CPU58               37028702      cache-references                                              (75.01%)
CPU59               36044261      cache-references                                              (75.01%)
CPU60               36612970      cache-references                                              (75.01%)
CPU61               36880323      cache-references                                              (75.01%)
CPU62               38456344      cache-references                                              (75.01%)
CPU63               36294445      cache-references                                              (75.00%)
CPU0                  315293      cache-misses              #    0.843 % of all cache refs      (75.00%)
CPU1                   94955      cache-misses              #    0.251 % of all cache refs      (75.00%)
CPU2                   94688      cache-misses              #    0.231 % of all cache refs      (75.00%)
CPU3                   84391      cache-misses              #    0.192 % of all cache refs      (75.00%)
CPU4                  105146      cache-misses              #    0.264 % of all cache refs      (75.00%)
CPU5                  102827      cache-misses              #    0.246 % of all cache refs      (75.00%)
CPU6                   99223      cache-misses              #    0.008 % of all cache refs      (75.00%)
CPU7                  105787      cache-misses              #    0.267 % of all cache refs      (75.00%)
CPU8                  289572      cache-misses              #    0.756 % of all cache refs      (75.00%)
CPU9                   93560      cache-misses              #    0.247 % of all cache refs      (75.00%)
CPU10                  58969      cache-misses              #    0.158 % of all cache refs      (75.00%)
CPU11                 211131      cache-misses              #    0.433 % of all cache refs      (75.00%)
CPU12                  70592      cache-misses              #    0.184 % of all cache refs      (75.00%)
CPU13                  78109      cache-misses              #    0.207 % of all cache refs      (75.00%)
CPU14                  66750      cache-misses              #    0.174 % of all cache refs      (75.00%)
CPU15                  67843      cache-misses              #    0.181 % of all cache refs      (75.00%)
CPU16                 224989      cache-misses              #    0.272 % of all cache refs      (75.01%)
CPU17              359722523      cache-misses              #   29.326 % of all cache refs      (75.00%)
CPU18                 425021      cache-misses              #    0.888 % of all cache refs      (75.01%)
CPU19                4580402      cache-misses              #    7.898 % of all cache refs      (75.00%)
CPU20                3046792      cache-misses              #    6.645 % of all cache refs      (75.00%)
CPU21                 168365      cache-misses              #    0.416 % of all cache refs      (75.01%)
CPU22                 158439      cache-misses              #    0.363 % of all cache refs      (75.00%)
CPU23                 112403      cache-misses              #    0.199 % of all cache refs      (75.01%)
CPU24                 116910      cache-misses              #    0.144 % of all cache refs      (75.01%)
CPU25                  96745      cache-misses              #    0.184 % of all cache refs      (75.01%)
CPU26                  90402      cache-misses              #    0.123 % of all cache refs      (75.00%)
CPU27                  87249      cache-misses              #    0.099 % of all cache refs      (75.01%)
CPU28                 227328      cache-misses              #    0.408 % of all cache refs      (75.01%)
CPU29                 165138      cache-misses              #    0.251 % of all cache refs      (75.01%)
CPU30                 187989      cache-misses              #    0.358 % of all cache refs      (75.01%)
CPU31                 107351      cache-misses              #    0.268 % of all cache refs      (75.00%)
CPU32                 171715      cache-misses              #    0.397 % of all cache refs      (75.00%)
CPU33                  79057      cache-misses              #    0.180 % of all cache refs      (75.00%)
CPU34                 142423      cache-misses              #    0.285 % of all cache refs      (75.00%)
CPU35                  86027      cache-misses              #    0.164 % of all cache refs      (75.00%)
CPU36                 113991      cache-misses              #    0.242 % of all cache refs      (75.00%)
CPU37                 353191      cache-misses              #    0.660 % of all cache refs      (75.00%)
CPU38                  80669      cache-misses              #    0.260 % of all cache refs      (75.00%)
CPU39                 129011      cache-misses              #    0.301 % of all cache refs      (75.00%)
CPU40                 262396      cache-misses              #    0.691 % of all cache refs      (75.00%)
CPU41                 100135      cache-misses              #    0.258 % of all cache refs      (75.00%)
CPU42                  59723      cache-misses              #    0.156 % of all cache refs      (75.00%)
CPU43                  64477      cache-misses              #    0.165 % of all cache refs      (75.00%)
CPU44                  78399      cache-misses              #    0.207 % of all cache refs      (75.00%)
CPU45                 143783      cache-misses              #    0.348 % of all cache refs      (75.00%)
CPU46                  72958      cache-misses              #    0.183 % of all cache refs      (75.00%)
CPU47                  76953      cache-misses              #    0.197 % of all cache refs      (75.00%)
CPU48                 136356      cache-misses              #    0.280 % of all cache refs      (75.00%)
CPU49                 157336      cache-misses              #    0.427 % of all cache refs      (75.00%)
CPU50                 149954      cache-misses              #    0.355 % of all cache refs      (75.00%)
CPU51                 122562      cache-misses              #    0.270 % of all cache refs      (75.00%)
CPU52                 136963      cache-misses              #    0.322 % of all cache refs      (75.00%)
CPU53                 151151      cache-misses              #    0.359 % of all cache refs      (75.00%)
CPU54                 119721      cache-misses              #    0.238 % of all cache refs      (75.00%)
CPU55                  87057      cache-misses              #    0.101 % of all cache refs      (75.00%)
CPU56                 146755      cache-misses              #    0.245 % of all cache refs      (75.00%)
CPU57                  78810      cache-misses              #    0.069 % of all cache refs      (75.00%)
CPU58                 197124      cache-misses              #    0.203 % of all cache refs      (75.01%)
CPU59                 151798      cache-misses              #    0.234 % of all cache refs      (75.00%)
CPU60                  85513      cache-misses              #    0.150 % of all cache refs      (75.00%)
CPU61                 183801      cache-misses              #    0.440 % of all cache refs      (75.00%)
CPU62                  99933      cache-misses              #    0.179 % of all cache refs      (75.01%)
CPU63                 133100      cache-misses              #    0.204 % of all cache refs      (75.01%)

            93.664 +- 0.413 seconds time elapsed  ( +-  0.44% )
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="gaxpy-row-oriented-caso-vectorizando">
<h3><em>gaxpy row oriented</em> caso vectorizando<a class="headerlink" href="#gaxpy-row-oriented-caso-vectorizando" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%file</span> mult_matrix_vector_numpy_row_oriented.py
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">m</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="mi">4</span>
<span class="n">n</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="mi">4</span>
<span class="n">x</span> <span class="o">=</span> <span class="mf">2.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="n">file</span><span class="o">=</span><span class="s1">&#39;A.txt&#39;</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
    <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+=</span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Writing mult_matrix_vector_numpy_row_oriented.py
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">bash</span>
perf stat -S -e cycles,instructions,cache-references,cache-misses -r 2 python3 mult_matrix_vector_numpy_row_oriented.py
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> Performance counter stats for &#39;python3 mult_matrix_vector_numpy_row_oriented.py&#39; (2 runs):

      256134434754      cycles                                                        ( +-  0.98% )  (75.01%)
      588336703466      instructions              #    2.30  insn per cycle           ( +-  0.15% )  (74.97%)
        2247446202      cache-references                                              ( +-  0.39% )  (74.99%)
         355207686      cache-misses              #   15.805 % of all cache refs      ( +-  0.31% )  (75.03%)

            91.614 +- 0.112 seconds time elapsed  ( +-  0.12% )
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">bash</span>
perf stat -S --all-cpus -A -e cycles,instructions,cache-references,cache-misses -r 2 python3 mult_matrix_vector_numpy_row_oriented.py
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> Performance counter stats for &#39;system wide&#39; (2 runs):

CPU0              3534676857      cycles                                                        (75.00%)
CPU1              3867238642      cycles                                                        (75.00%)
CPU2              2265829941      cycles                                                        (75.00%)
CPU3              3739389473      cycles                                                        (75.00%)
CPU4              3721173577      cycles                                                        (75.00%)
CPU5              3773710409      cycles                                                        (75.00%)
CPU6              3682262363      cycles                                                        (75.00%)
CPU7              3738741450      cycles                                                        (75.00%)
CPU8              3695276843      cycles                                                        (75.00%)
CPU9              3673069250      cycles                                                        (75.00%)
CPU10             3817412263      cycles                                                        (75.00%)
CPU11             3893264396      cycles                                                        (75.00%)
CPU12             3707548462      cycles                                                        (75.00%)
CPU13             3704622783      cycles                                                        (75.00%)
CPU14             3774098958      cycles                                                        (75.00%)
CPU15             3871392284      cycles                                                        (75.00%)
CPU16             3589147909      cycles                                                        (75.01%)
CPU17             3276463525      cycles                                                        (75.01%)
CPU18             3264576459      cycles                                                        (75.00%)
CPU19             3337592739      cycles                                                        (75.00%)
CPU20             5816172823      cycles                                                        (75.00%)
CPU21             3196988058      cycles                                                        (75.00%)
CPU22             3259326392      cycles                                                        (75.00%)
CPU23             3389815178      cycles                                                        (75.00%)
CPU24             3472509540      cycles                                                        (75.00%)
CPU25             3233069884      cycles                                                        (75.01%)
CPU26             3341322551      cycles                                                        (75.01%)
CPU27             3547500808      cycles                                                        (75.00%)
CPU28             3258655552      cycles                                                        (75.01%)
CPU29             3293498279      cycles                                                        (75.00%)
CPU30             3354327917      cycles                                                        (75.01%)
CPU31             3484863298      cycles                                                        (75.00%)
CPU32             3107941082      cycles                                                        (75.01%)
CPU33             3168344123      cycles                                                        (75.01%)
CPU34           243124118037      cycles                                                        (75.00%)
CPU35             3205357167      cycles                                                        (75.01%)
CPU36             3196310764      cycles                                                        (75.01%)
CPU37             3293335921      cycles                                                        (75.01%)
CPU38             3184752297      cycles                                                        (75.01%)
CPU39             3205376388      cycles                                                        (75.01%)
CPU40             3148025218      cycles                                                        (75.00%)
CPU41             3207286242      cycles                                                        (75.01%)
CPU42             3328945509      cycles                                                        (75.01%)
CPU43             3263028387      cycles                                                        (75.01%)
CPU44             3209890282      cycles                                                        (75.01%)
CPU45             3294554506      cycles                                                        (75.01%)
CPU46             3276320802      cycles                                                        (75.01%)
CPU47             3348354225      cycles                                                        (75.01%)
CPU48             2720616460      cycles                                                        (75.00%)
CPU49             2731193555      cycles                                                        (75.00%)
CPU50             2756161899      cycles                                                        (75.01%)
CPU51             2812700935      cycles                                                        (75.01%)
CPU52             2734664706      cycles                                                        (75.00%)
CPU53             2673877461      cycles                                                        (75.00%)
CPU54             2734791893      cycles                                                        (75.00%)
CPU55             2736837718      cycles                                                        (75.01%)
CPU56             2812996068      cycles                                                        (75.00%)
CPU57             2733096019      cycles                                                        (75.01%)
CPU58             2858869476      cycles                                                        (75.01%)
CPU59             2933529815      cycles                                                        (75.00%)
CPU60             2751067711      cycles                                                        (75.01%)
CPU61             3125551591      cycles                                                        (75.00%)
CPU62             2872590793      cycles                                                        (75.01%)
CPU63             2888024231      cycles                                                        (75.00%)
CPU0               439603683      instructions              #    0.12  insn per cycle           (75.01%)
CPU1               541787087      instructions              #    0.15  insn per cycle           (75.01%)
CPU2               508532678      instructions              #    0.00  insn per cycle           (75.00%)
CPU3               469672922      instructions              #    0.13  insn per cycle           (75.01%)
CPU4               455923055      instructions              #    0.12  insn per cycle           (75.01%)
CPU5               444791900      instructions              #    0.12  insn per cycle           (75.01%)
CPU6               448812685      instructions              #    0.12  insn per cycle           (75.01%)
CPU7               469371252      instructions              #    0.13  insn per cycle           (75.00%)
CPU8               473850845      instructions              #    0.13  insn per cycle           (75.00%)
CPU9               439135233      instructions              #    0.12  insn per cycle           (75.01%)
CPU10              476495302      instructions              #    0.13  insn per cycle           (75.01%)
CPU11              475133885      instructions              #    0.11  insn per cycle           (75.01%)
CPU12              433051443      instructions              #    0.12  insn per cycle           (75.01%)
CPU13              432155663      instructions              #    0.12  insn per cycle           (75.01%)
CPU14              434663148      instructions              #    0.12  insn per cycle           (75.01%)
CPU15              433522468      instructions              #    0.11  insn per cycle           (75.01%)
CPU16              547941172      instructions              #    0.16  insn per cycle           (75.00%)
CPU17              346623670      instructions              #    0.11  insn per cycle           (75.00%)
CPU18              331889629      instructions              #    0.10  insn per cycle           (75.01%)
CPU19              333247244      instructions              #    0.10  insn per cycle           (75.01%)
CPU20             2889879547      instructions              #    0.49  insn per cycle           (75.00%)
CPU21              345683907      instructions              #    0.11  insn per cycle           (75.00%)
CPU22              331766518      instructions              #    0.10  insn per cycle           (75.00%)
CPU23              400245262      instructions              #    0.12  insn per cycle           (75.01%)
CPU24              404640016      instructions              #    0.12  insn per cycle           (75.00%)
CPU25              329293710      instructions              #    0.10  insn per cycle           (75.00%)
CPU26              330118167      instructions              #    0.10  insn per cycle           (75.00%)
CPU27              375233492      instructions              #    0.11  insn per cycle           (75.00%)
CPU28              328520544      instructions              #    0.10  insn per cycle           (75.00%)
CPU29              343655549      instructions              #    0.10  insn per cycle           (75.00%)
CPU30              334101486      instructions              #    0.10  insn per cycle           (75.00%)
CPU31              380939241      instructions              #    0.11  insn per cycle           (75.01%)
CPU32              424015458      instructions              #    0.14  insn per cycle           (75.00%)
CPU33              435075226      instructions              #    0.14  insn per cycle           (75.00%)
CPU34           583323841280      instructions              #    4.76  insn per cycle           (75.00%)
CPU35              434421623      instructions              #    0.14  insn per cycle           (74.99%)
CPU36              440282394      instructions              #    0.14  insn per cycle           (75.00%)
CPU37              487113118      instructions              #    0.15  insn per cycle           (75.00%)
CPU38              456918684      instructions              #    0.14  insn per cycle           (75.00%)
CPU39              438580857      instructions              #    0.14  insn per cycle           (75.00%)
CPU40              447530383      instructions              #    0.14  insn per cycle           (75.00%)
CPU41              461710606      instructions              #    0.14  insn per cycle           (75.00%)
CPU42              467210271      instructions              #    0.14  insn per cycle           (75.00%)
CPU43              429146540      instructions              #    0.13  insn per cycle           (75.00%)
CPU44              426974136      instructions              #    0.13  insn per cycle           (75.00%)
CPU45              544727378      instructions              #    0.17  insn per cycle           (75.00%)
CPU46              425652048      instructions              #    0.13  insn per cycle           (75.00%)
CPU47              427841442      instructions              #    0.13  insn per cycle           (75.00%)
CPU48              324171910      instructions              #    0.12  insn per cycle           (75.00%)
CPU49              321230570      instructions              #    0.12  insn per cycle           (75.00%)
CPU50              322247838      instructions              #    0.12  insn per cycle           (75.00%)
CPU51              322748292      instructions              #    0.11  insn per cycle           (75.00%)
CPU52              321239509      instructions              #    0.12  insn per cycle           (75.00%)
CPU53              320976553      instructions              #    0.12  insn per cycle           (75.00%)
CPU54              321156531      instructions              #    0.12  insn per cycle           (75.00%)
CPU55              318020522      instructions              #    0.12  insn per cycle           (75.00%)
CPU56              324293126      instructions              #    0.12  insn per cycle           (75.00%)
CPU57              320763749      instructions              #    0.12  insn per cycle           (75.00%)
CPU58              321720779      instructions              #    0.11  insn per cycle           (75.00%)
CPU59              325102306      instructions              #    0.11  insn per cycle           (75.00%)
CPU60              323888382      instructions              #    0.11  insn per cycle           (75.00%)
CPU61              527739360      instructions              #    0.18  insn per cycle           (75.00%)
CPU62              331131152      instructions              #    0.12  insn per cycle           (75.00%)
CPU63              323684797      instructions              #    0.11  insn per cycle           (75.00%)
CPU0                33108232      cache-references                                              (75.00%)
CPU1                37100368      cache-references                                              (75.00%)
CPU2                23526696      cache-references                                              (75.00%)
CPU3                35803078      cache-references                                              (74.99%)
CPU4                36306537      cache-references                                              (75.00%)
CPU5                38466164      cache-references                                              (75.00%)
CPU6                36052996      cache-references                                              (75.00%)
CPU7                36708384      cache-references                                              (75.00%)
CPU8                36351011      cache-references                                              (75.00%)
CPU9                36099458      cache-references                                              (75.00%)
CPU10               35961214      cache-references                                              (75.00%)
CPU11               38448950      cache-references                                              (75.00%)
CPU12               35992327      cache-references                                              (75.00%)
CPU13               36306329      cache-references                                              (75.00%)
CPU14               35271801      cache-references                                              (75.00%)
CPU15               37938631      cache-references                                              (75.00%)
CPU16               37745311      cache-references                                              (75.00%)
CPU17               36768255      cache-references                                              (75.00%)
CPU18               37336981      cache-references                                              (75.00%)
CPU19               35581049      cache-references                                              (75.00%)
CPU20               57600736      cache-references                                              (75.00%)
CPU21               35359115      cache-references                                              (75.00%)
CPU22               34742644      cache-references                                              (75.00%)
CPU23               34495730      cache-references                                              (75.00%)
CPU24               35349027      cache-references                                              (75.00%)
CPU25               34499860      cache-references                                              (75.00%)
CPU26               36071056      cache-references                                              (75.01%)
CPU27               39393533      cache-references                                              (74.99%)
CPU28               35572338      cache-references                                              (75.00%)
CPU29               36477520      cache-references                                              (75.00%)
CPU30               33979565      cache-references                                              (75.00%)
CPU31               36613007      cache-references                                              (75.00%)
CPU32               40755619      cache-references                                              (75.00%)
CPU33               40142349      cache-references                                              (75.00%)
CPU34             2224001243      cache-references                                              (75.00%)
CPU35               36762948      cache-references                                              (75.01%)
CPU36               37577697      cache-references                                              (75.00%)
CPU37               39864833      cache-references                                              (75.00%)
CPU38               38339225      cache-references                                              (75.00%)
CPU39               37742980      cache-references                                              (75.00%)
CPU40               37288310      cache-references                                              (75.00%)
CPU41               37674375      cache-references                                              (75.00%)
CPU42               37700940      cache-references                                              (75.00%)
CPU43               37941574      cache-references                                              (75.00%)
CPU44               36736460      cache-references                                              (75.00%)
CPU45               39729387      cache-references                                              (75.00%)
CPU46               38054508      cache-references                                              (75.00%)
CPU47               39746821      cache-references                                              (75.00%)
CPU48               36679158      cache-references                                              (75.00%)
CPU49               37684474      cache-references                                              (75.00%)
CPU50               36409837      cache-references                                              (75.00%)
CPU51               38539583      cache-references                                              (75.00%)
CPU52               37792894      cache-references                                              (75.01%)
CPU53               37247106      cache-references                                              (75.00%)
CPU54               37270619      cache-references                                              (75.00%)
CPU55               37784212      cache-references                                              (75.00%)
CPU56               38574060      cache-references                                              (75.00%)
CPU57               37185254      cache-references                                              (75.00%)
CPU58               36478907      cache-references                                              (75.01%)
CPU59               38204134      cache-references                                              (74.99%)
CPU60               36790907      cache-references                                              (75.00%)
CPU61               37491922      cache-references                                              (75.00%)
CPU62               39585254      cache-references                                              (75.00%)
CPU63               36251749      cache-references                                              (75.00%)
CPU0                  335360      cache-misses              #    0.989 % of all cache refs      (75.00%)
CPU1                  532428      cache-misses              #    1.454 % of all cache refs      (75.00%)
CPU2                  220999      cache-misses              #    0.020 % of all cache refs      (75.00%)
CPU3                  128756      cache-misses              #    0.360 % of all cache refs      (75.01%)
CPU4                  168662      cache-misses              #    0.464 % of all cache refs      (75.00%)
CPU5                  170999      cache-misses              #    0.443 % of all cache refs      (75.00%)
CPU6                  241036      cache-misses              #    0.666 % of all cache refs      (75.01%)
CPU7                  199982      cache-misses              #    0.542 % of all cache refs      (75.00%)
CPU8                  235072      cache-misses              #    0.644 % of all cache refs      (75.00%)
CPU9                  135952      cache-misses              #    0.377 % of all cache refs      (75.00%)
CPU10                 108971      cache-misses              #    0.303 % of all cache refs      (75.00%)
CPU11                1130429      cache-misses              #    2.631 % of all cache refs      (75.00%)
CPU12                 109446      cache-misses              #    0.304 % of all cache refs      (75.00%)
CPU13                 140055      cache-misses              #    0.386 % of all cache refs      (75.00%)
CPU14                 102441      cache-misses              #    0.291 % of all cache refs      (75.01%)
CPU15                 105918      cache-misses              #    0.278 % of all cache refs      (75.00%)
CPU16                 261745      cache-misses              #    0.685 % of all cache refs      (75.00%)
CPU17                 125630      cache-misses              #    0.341 % of all cache refs      (75.01%)
CPU18                 117378      cache-misses              #    0.312 % of all cache refs      (75.00%)
CPU19                 155914      cache-misses              #    0.435 % of all cache refs      (75.01%)
CPU20                1793003      cache-misses              #    3.124 % of all cache refs      (75.01%)
CPU21                 133243      cache-misses              #    0.381 % of all cache refs      (75.01%)
CPU22                 150954      cache-misses              #    0.430 % of all cache refs      (75.00%)
CPU23                 139790      cache-misses              #    0.409 % of all cache refs      (75.00%)
CPU24                 142825      cache-misses              #    0.407 % of all cache refs      (75.00%)
CPU25                 106847      cache-misses              #    0.309 % of all cache refs      (75.00%)
CPU26                 106085      cache-misses              #    0.295 % of all cache refs      (75.00%)
CPU27                 111148      cache-misses              #    0.288 % of all cache refs      (75.01%)
CPU28                 125838      cache-misses              #    0.352 % of all cache refs      (75.00%)
CPU29                 230347      cache-misses              #    0.628 % of all cache refs      (75.00%)
CPU30                 184000      cache-misses              #    0.545 % of all cache refs      (75.00%)
CPU31                 132914      cache-misses              #    0.366 % of all cache refs      (75.00%)
CPU32                 200001      cache-misses              #    0.486 % of all cache refs      (75.00%)
CPU33                 159593      cache-misses              #    0.397 % of all cache refs      (75.00%)
CPU34              355046789      cache-misses              #   31.601 % of all cache refs      (75.00%)
CPU35                 128278      cache-misses              #    0.349 % of all cache refs      (75.00%)
CPU36                 144119      cache-misses              #    0.383 % of all cache refs      (75.00%)
CPU37                 697123      cache-misses              #    1.739 % of all cache refs      (75.00%)
CPU38                 143047      cache-misses              #    0.372 % of all cache refs      (75.00%)
CPU39                 263001      cache-misses              #    0.692 % of all cache refs      (75.00%)
CPU40                 197033      cache-misses              #    0.527 % of all cache refs      (75.00%)
CPU41                 127245      cache-misses              #    0.338 % of all cache refs      (75.00%)
CPU42                 125822      cache-misses              #    0.334 % of all cache refs      (75.00%)
CPU43                 115355      cache-misses              #    0.304 % of all cache refs      (75.00%)
CPU44                 120903      cache-misses              #    0.327 % of all cache refs      (75.00%)
CPU45                 341919      cache-misses              #    0.858 % of all cache refs      (75.00%)
CPU46                 126339      cache-misses              #    0.327 % of all cache refs      (75.00%)
CPU47                 137798      cache-misses              #    0.347 % of all cache refs      (75.00%)
CPU48                 157900      cache-misses              #    0.431 % of all cache refs      (75.01%)
CPU49                 106906      cache-misses              #    0.285 % of all cache refs      (75.01%)
CPU50                 166243      cache-misses              #    0.457 % of all cache refs      (75.00%)
CPU51                 147108      cache-misses              #    0.382 % of all cache refs      (75.00%)
CPU52                 163174      cache-misses              #    0.430 % of all cache refs      (75.00%)
CPU53                 114912      cache-misses              #    0.308 % of all cache refs      (75.00%)
CPU54                 122656      cache-misses              #    0.328 % of all cache refs      (75.00%)
CPU55                 103966      cache-misses              #    0.276 % of all cache refs      (75.00%)
CPU56                 144866      cache-misses              #    0.375 % of all cache refs      (75.00%)
CPU57                  99787      cache-misses              #    0.266 % of all cache refs      (75.00%)
CPU58                 211976      cache-misses              #    0.582 % of all cache refs      (75.00%)
CPU59                 193698      cache-misses              #    0.513 % of all cache refs      (75.01%)
CPU60                  99468      cache-misses              #    0.269 % of all cache refs      (75.00%)
CPU61                 488186      cache-misses              #    1.301 % of all cache refs      (75.01%)
CPU62                 150570      cache-misses              #    0.385 % of all cache refs      (75.00%)
CPU63                 153768      cache-misses              #    0.426 % of all cache refs      (75.01%)

            92.997 +- 0.159 seconds time elapsed  ( +-  0.17% )
</pre></div>
</div>
</div>
</div>
<div class="admonition-comentarios admonition">
<p class="admonition-title">Comentarios</p>
<ul class="simple">
<li><p>No se observa una gran diferencia entre el caso vectorizado y no vectorizado salvo que en el caso vectorizando se tiene un <span class="math notranslate nohighlight">\(\%\)</span> mayor de <em>cache-misses</em>. Sería conveniente realizar más repeticiones de esta misma operación o con diferentes operaciones de nivel 2 BLAS para realizar conclusiones más sólidas. Ver <a class="reference external" href="http://www.netlib.org/blas/#_level_2">level 2</a> para más ejemplos de algoritmos en el álgebra lineal en esta categoría.</p></li>
<li><p>Otra opción que se tiene es utilizar la siguiente implementación ya que <code class="docutils literal notranslate"><span class="pre">numpy</span></code> soporta operaciones del tipo matriz-vector sin necesidad de utilizar un <em>for loop</em>.</p></li>
</ul>
</div>
</div>
<div class="section" id="perf-openblas-nivel-3-multiplicacion-de-matrices">
<h3>perf OpenBLAS: nivel 3 multiplicación de matrices<a class="headerlink" href="#perf-openblas-nivel-3-multiplicacion-de-matrices" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%file</span> mult_matrix_matrix_numpy_openblas.py
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">m</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="mi">4</span>
<span class="n">r</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="mi">4</span>
<span class="n">n</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="mi">4</span>

<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">2020</span><span class="p">)</span>
<span class="n">m</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="mi">4</span>
<span class="n">r</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="mi">4</span>
<span class="n">A</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">r</span><span class="p">)</span>

<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">2021</span><span class="p">)</span>
<span class="n">r</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="mi">4</span>
<span class="n">n</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="mi">4</span>
<span class="n">B</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>

<span class="n">A</span><span class="nd">@B</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Writing mult_matrix_matrix_numpy_openblas.py
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">bash</span>
perf stat -S --all-cpus -A -e cycles,instructions,cache-references,cache-misses -r 7 python3 mult_matrix_matrix_numpy_openblas.py
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> Performance counter stats for &#39;system wide&#39; (7 runs):

S0-D0-C0           2        18418711959      cycles                                                        (75.00%)
S0-D0-C0           2        18369720566      instructions              #    1.00  insn per cycle           (75.06%)
S0-D0-C0           2          537701642      cache-references                                              (75.06%)
S0-D0-C0           2           24051039      cache-misses              #    4.473 % of all cache refs      (75.02%)
S0-D0-C1           2        18196672426      cycles                                                        (75.03%)
S0-D0-C1           2        18408825312      instructions              #    1.01  insn per cycle           (75.06%)
S0-D0-C1           2          525743359      cache-references                                              (75.07%)
S0-D0-C1           2           23125192      cache-misses              #    4.399 % of all cache refs      (75.01%)
S0-D0-C2           2        17745013942      cycles                                                        (75.04%)
S0-D0-C2           2        18325997854      instructions              #    1.03  insn per cycle           (75.06%)
S0-D0-C2           2          526665812      cache-references                                              (75.05%)
S0-D0-C2           2           22407034      cache-misses              #    4.255 % of all cache refs      (75.01%)
S0-D0-C3           2        17121222047      cycles                                                        (75.04%)
S0-D0-C3           2        18146087876      instructions              #    1.06  insn per cycle           (75.06%)
S0-D0-C3           2          490965446      cache-references                                              (75.06%)
S0-D0-C3           2           26610387      cache-misses              #    5.420 % of all cache refs      (75.01%)
S0-D0-C4           2        16890058309      cycles                                                        (75.04%)
S0-D0-C4           2        17885504024      instructions              #    1.06  insn per cycle           (75.06%)
S0-D0-C4           2          487993921      cache-references                                              (75.05%)
S0-D0-C4           2           23144032      cache-misses              #    4.743 % of all cache refs      (75.01%)
S0-D0-C5           2        17199231962      cycles                                                        (75.03%)
S0-D0-C5           2        18263131622      instructions              #    1.06  insn per cycle           (75.06%)
S0-D0-C5           2          496088789      cache-references                                              (75.06%)
S0-D0-C5           2           21848774      cache-misses              #    4.404 % of all cache refs      (75.01%)
S0-D0-C6           2        16349945326      cycles                                                        (75.03%)
S0-D0-C6           2        17917357673      instructions              #    1.10  insn per cycle           (75.06%)
S0-D0-C6           2          479652808      cache-references                                              (75.06%)
S0-D0-C6           2           24499853      cache-misses              #    5.108 % of all cache refs      (75.01%)
S0-D0-C7           2        16412097276      cycles                                                        (75.03%)
S0-D0-C7           2        17611472168      instructions              #    1.07  insn per cycle           (75.06%)
S0-D0-C7           2          469719191      cache-references                                              (75.06%)
S0-D0-C7           2           21824081      cache-misses              #    4.646 % of all cache refs      (75.01%)
S0-D0-C8           2        15249556261      cycles                                                        (75.03%)
S0-D0-C8           2        16618749720      instructions              #    1.09  insn per cycle           (75.06%)
S0-D0-C8           2          455682584      cache-references                                              (75.06%)
S0-D0-C8           2           25286843      cache-misses              #    5.549 % of all cache refs      (75.02%)
S0-D0-C9           2        16231214981      cycles                                                        (75.03%)
S0-D0-C9           2        17646720887      instructions              #    1.09  insn per cycle           (75.05%)
S0-D0-C9           2          473228118      cache-references                                              (75.06%)
S0-D0-C9           2           19449589      cache-misses              #    4.110 % of all cache refs      (75.02%)
S0-D0-C10          2        15892959983      cycles                                                        (75.03%)
S0-D0-C10          2        17337209550      instructions              #    1.09  insn per cycle           (75.06%)
S0-D0-C10          2          469461284      cache-references                                              (75.06%)
S0-D0-C10          2           28237009      cache-misses              #    6.015 % of all cache refs      (75.01%)
S0-D0-C11          2        14874401788      cycles                                                        (75.04%)
S0-D0-C11          2        16217229463      instructions              #    1.09  insn per cycle           (75.06%)
S0-D0-C11          2          452670920      cache-references                                              (75.05%)
S0-D0-C11          2           21648129      cache-misses              #    4.782 % of all cache refs      (75.02%)
S0-D0-C12          2        14543839541      cycles                                                        (75.03%)
S0-D0-C12          2        15959236359      instructions              #    1.10  insn per cycle           (75.06%)
S0-D0-C12          2          441998264      cache-references                                              (75.06%)
S0-D0-C12          2           26386041      cache-misses              #    5.970 % of all cache refs      (75.02%)
S0-D0-C13          2        18262472756      cycles                                                        (75.03%)
S0-D0-C13          2        18538540372      instructions              #    1.02  insn per cycle           (75.06%)
S0-D0-C13          2          535986137      cache-references                                              (75.06%)
S0-D0-C13          2           28397666      cache-misses              #    5.298 % of all cache refs      (75.02%)
S0-D0-C14          2        13209247629      cycles                                                        (75.03%)
S0-D0-C14          2        15254857451      instructions              #    1.15  insn per cycle           (75.06%)
S0-D0-C14          2          410995623      cache-references                                              (75.06%)
S0-D0-C14          2           24991392      cache-misses              #    6.081 % of all cache refs      (75.02%)
S0-D0-C15          2        12118816441      cycles                                                        (75.03%)
S0-D0-C15          2        14453817862      instructions              #    1.19  insn per cycle           (75.05%)
S0-D0-C15          2          371089450      cache-references                                              (75.05%)
S0-D0-C15          2           22741899      cache-misses              #    6.128 % of all cache refs      (75.02%)
S1-D0-C0           2        18232984530      cycles                                                        (75.03%)
S1-D0-C0           2        18449109986      instructions              #    1.01  insn per cycle           (75.05%)
S1-D0-C0           2          519913031      cache-references                                              (75.06%)
S1-D0-C0           2           23752828      cache-misses              #    4.569 % of all cache refs      (75.02%)
S1-D0-C1           2        25269014354      cycles                                                        (75.03%)
S1-D0-C1           2        39384365171      instructions              #    1.56  insn per cycle           (75.06%)
S1-D0-C1           2          651968755      cache-references                                              (75.05%)
S1-D0-C1           2           38228051      cache-misses              #    5.863 % of all cache refs      (75.03%)
S1-D0-C2           2        18444454550      cycles                                                        (75.03%)
S1-D0-C2           2        21204362696      instructions              #    1.15  insn per cycle           (75.06%)
S1-D0-C2           2          621058606      cache-references                                              (75.06%)
S1-D0-C2           2           40990630      cache-misses              #    6.600 % of all cache refs      (75.02%)
S1-D0-C3           2        18278696053      cycles                                                        (75.03%)
S1-D0-C3           2        20067036382      instructions              #    1.10  insn per cycle           (75.06%)
S1-D0-C3           2          585310801      cache-references                                              (75.06%)
S1-D0-C3           2           31863601      cache-misses              #    5.444 % of all cache refs      (75.02%)
S1-D0-C4           2        18431841316      cycles                                                        (75.03%)
S1-D0-C4           2        18669484458      instructions              #    1.01  insn per cycle           (75.06%)
S1-D0-C4           2          528305336      cache-references                                              (75.05%)
S1-D0-C4           2           29086972      cache-misses              #    5.506 % of all cache refs      (75.03%)
S1-D0-C5           2        18460857989      cycles                                                        (75.03%)
S1-D0-C5           2        18836165277      instructions              #    1.02  insn per cycle           (75.05%)
S1-D0-C5           2          532097512      cache-references                                              (75.06%)
S1-D0-C5           2           29550365      cache-misses              #    5.554 % of all cache refs      (75.03%)
S1-D0-C6           2        18490159829      cycles                                                        (75.02%)
S1-D0-C6           2        18996196633      instructions              #    1.03  insn per cycle           (75.05%)
S1-D0-C6           2          537973011      cache-references                                              (75.06%)
S1-D0-C6           2           34758081      cache-misses              #    6.461 % of all cache refs      (75.03%)
S1-D0-C7           2        18393424333      cycles                                                        (75.03%)
S1-D0-C7           2        19082601979      instructions              #    1.04  insn per cycle           (75.05%)
S1-D0-C7           2          540775846      cache-references                                              (75.06%)
S1-D0-C7           2           30967762      cache-misses              #    5.727 % of all cache refs      (75.03%)
S1-D0-C8           2        18439236440      cycles                                                        (75.03%)
S1-D0-C8           2        18698390120      instructions              #    1.01  insn per cycle           (75.05%)
S1-D0-C8           2          532154105      cache-references                                              (75.05%)
S1-D0-C8           2           30098986      cache-misses              #    5.656 % of all cache refs      (75.03%)
S1-D0-C9           2        18393128954      cycles                                                        (75.02%)
S1-D0-C9           2        20510456724      instructions              #    1.12  insn per cycle           (75.06%)
S1-D0-C9           2          596975317      cache-references                                              (75.05%)
S1-D0-C9           2           32463279      cache-misses              #    5.438 % of all cache refs      (75.03%)
S1-D0-C10          2        18384672465      cycles                                                        (75.02%)
S1-D0-C10          2        18518315158      instructions              #    1.01  insn per cycle           (75.05%)
S1-D0-C10          2          518920459      cache-references                                              (75.06%)
S1-D0-C10          2           22063526      cache-misses              #    4.252 % of all cache refs      (75.04%)
S1-D0-C11          2        18321366651      cycles                                                        (75.02%)
S1-D0-C11          2        20344437281      instructions              #    1.11  insn per cycle           (75.04%)
S1-D0-C11          2          592757359      cache-references                                              (75.06%)
S1-D0-C11          2           28883791      cache-misses              #    4.873 % of all cache refs      (75.03%)
S1-D0-C12          2        18438219285      cycles                                                        (75.02%)
S1-D0-C12          2        18558196540      instructions              #    1.01  insn per cycle           (75.04%)
S1-D0-C12          2          509104381      cache-references                                              (75.06%)
S1-D0-C12          2           22171256      cache-misses              #    4.355 % of all cache refs      (75.03%)
S1-D0-C13          2        18307643489      cycles                                                        (75.02%)
S1-D0-C13          2        18400984979      instructions              #    1.01  insn per cycle           (75.04%)
S1-D0-C13          2          515663807      cache-references                                              (75.05%)
S1-D0-C13          2           24967988      cache-misses              #    4.842 % of all cache refs      (75.04%)
S1-D0-C14          2        18361935174      cycles                                                        (75.02%)
S1-D0-C14          2        20383885122      instructions              #    1.11  insn per cycle           (75.03%)
S1-D0-C14          2          587106108      cache-references                                              (75.06%)
S1-D0-C14          2           33154210      cache-misses              #    5.647 % of all cache refs      (75.04%)
S1-D0-C15          2        18346242027      cycles                                                        (75.05%)
S1-D0-C15          2        18387811753      instructions              #    1.00  insn per cycle           (75.04%)
S1-D0-C15          2          520851546      cache-references                                              (75.07%)
S1-D0-C15          2           21406519      cache-misses              #    4.110 % of all cache refs      (75.01%)

             5.944 +- 0.128 seconds time elapsed  ( +-  2.15% )
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="comparacion-de-versiones-de-multiplicacion-de-matrices-utilizando-nivel-1-vs-nivel-2-de-blas">
<h3>Comparación de versiones de multiplicación de matrices utilizando nivel 1 vs nivel 2 de BLAS<a class="headerlink" href="#comparacion-de-versiones-de-multiplicacion-de-matrices-utilizando-nivel-1-vs-nivel-2-de-blas" title="Permalink to this headline">¶</a></h3>
<p>Utilizamos matrices <span class="math notranslate nohighlight">\(A, B \in \mathbb{R}^{10^3 \times 10^3}\)</span> pseudoaleatorias:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">2020</span><span class="p">)</span>
<span class="n">m</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="mi">3</span>
<span class="n">r</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="mi">3</span>

<span class="n">A</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">r</span><span class="p">)</span>
<span class="n">fileA_10_3</span><span class="o">=</span><span class="s1">&#39;A_10_3.txt&#39;</span>
<span class="n">np</span><span class="o">.</span><span class="n">savetxt</span><span class="p">(</span><span class="n">fileA_10_3</span><span class="p">,</span><span class="n">A</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">2021</span><span class="p">)</span>
<span class="n">m</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="mi">3</span>
<span class="n">r</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="mi">3</span>

<span class="n">B</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">r</span><span class="p">)</span>
<span class="n">fileB_10_3</span><span class="o">=</span><span class="s1">&#39;B_10_3.txt&#39;</span>
<span class="n">np</span><span class="o">.</span><span class="n">savetxt</span><span class="p">(</span><span class="n">fileB_10_3</span><span class="p">,</span><span class="n">B</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%file</span> mult_matrix_matrix_numpy_dot_product.py
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">m</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="mi">3</span>
<span class="n">n</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="mi">3</span>

<span class="n">fileA_10_3</span><span class="o">=</span><span class="s1">&#39;A_10_3.txt&#39;</span>
<span class="n">fileB_10_3</span><span class="o">=</span><span class="s1">&#39;B_10_3.txt&#39;</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">fileA_10_3</span><span class="p">)</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">fileB_10_3</span><span class="p">)</span>
<span class="n">C</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">m</span><span class="p">,</span><span class="n">n</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
                <span class="n">C</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">+=</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">B</span><span class="p">[:,</span><span class="n">j</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Writing mult_matrix_matrix_numpy_dot_product.py
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">bash</span>
perf stat -S --all-cpus -A -e cycles,instructions,cache-references,cache-misses -r 5 python3 mult_matrix_matrix_numpy_dot_product.py
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> Performance counter stats for &#39;system wide&#39; (5 runs):

       17727880724      cycles                                                        ( +-  2.67% )
       31196800089      instructions              #    1.76  insn per cycle           ( +-  0.18% )
         174120561      cache-references                                              ( +-  1.57% )
          14645042      cache-misses              #    8.411 % of all cache refs      ( +-  8.98% )

       3.817488998 seconds time elapsed                                          ( +-  0.55% )
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">bash</span>
perf stat -S --all-cpus -A --per-core -e cycles,instructions,cache-references,cache-misses -r 5 python3 mult_matrix_matrix_numpy_dot_product.py
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> Performance counter stats for &#39;system wide&#39; (5 runs):

S0-C0           2          582438322      cycles                                                      
S0-C0           2          225885082      instructions              #    0.39  insn per cycle         
S0-C0           2             274724      cache-references                                            
S0-C0           2             130031      cache-misses              #   47.332 % of all cache refs    
S0-C1           2          642407408      cycles                                                      
S0-C1           2          272043994      instructions              #    0.42  insn per cycle         
S0-C1           2             546749      cache-references                                            
S0-C1           2             324188      cache-misses              #   59.294 % of all cache refs    
S0-C2           2          596216226      cycles                                                      
S0-C2           2          226892804      instructions              #    0.38  insn per cycle         
S0-C2           2             446956      cache-references                                            
S0-C2           2             184440      cache-misses              #   41.266 % of all cache refs    
S0-C3           2        17956845889      cycles                                                      
S0-C3           2        30574523485      instructions              #    1.70  insn per cycle         
S0-C3           2          185655560      cache-references                                            
S0-C3           2           15107439      cache-misses              #    8.137 % of all cache refs    

       3.861269417 seconds time elapsed                                          ( +-  0.93% )
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%file</span> mult_matrix_matrix_numpy_dot_product_gaxpy.py
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">m</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="mi">3</span>
<span class="n">n</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="mi">3</span>
<span class="n">fileA_10_3</span><span class="o">=</span><span class="s1">&#39;A_10_3.txt&#39;</span>
<span class="n">fileB_10_3</span><span class="o">=</span><span class="s1">&#39;B_10_3.txt&#39;</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">fileA_10_3</span><span class="p">)</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">fileB_10_3</span><span class="p">)</span>
<span class="n">C</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">m</span><span class="p">,</span><span class="n">n</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
    <span class="n">C</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span><span class="nd">@B</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Overwriting mult_matrix_matrix_numpy_dot_product_gaxpy.py
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">bash</span>
perf stat -S --all-cpus -A -e cycles,instructions,cache-references,cache-misses -r 5 python3 mult_matrix_matrix_numpy_dot_product_gaxpy.py
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> Performance counter stats for &#39;system wide&#39; (5 runs):

       11010075589      cycles                                                        ( +-  0.66% )
       14922627515      instructions              #    1.36  insn per cycle           ( +-  0.26% )
         142059490      cache-references                                              ( +-  1.24% )
           8572872      cache-misses              #    6.035 % of all cache refs      ( +- 11.05% )

       1.455285799 seconds time elapsed                                          ( +-  0.44% )
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">bash</span>
perf stat -S --all-cpus -A --per-core -e cycles,instructions,cache-references,cache-misses -r 5 python3 mult_matrix_matrix_numpy_dot_product_gaxpy.py
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> Performance counter stats for &#39;system wide&#39; (5 runs):

S0-C0           2         1448177294      cycles                                                      
S0-C0           2          623468047      instructions              #    0.43  insn per cycle         
S0-C0           2           29581790      cache-references                                            
S0-C0           2             575180      cache-misses              #    1.944 % of all cache refs    
S0-C1           2         1477272782      cycles                                                      
S0-C1           2          656096587      instructions              #    0.44  insn per cycle         
S0-C1           2           29881953      cache-references                                            
S0-C1           2             608210      cache-misses              #    2.035 % of all cache refs    
S0-C2           2         1457641798      cycles                                                      
S0-C2           2          633875919      instructions              #    0.43  insn per cycle         
S0-C2           2           24959423      cache-references                                            
S0-C2           2            1281191      cache-misses              #    5.133 % of all cache refs    
S0-C3           2         6518413194      cycles                                                      
S0-C3           2        12982975813      instructions              #    1.99  insn per cycle         
S0-C3           2           53648618      cache-references                                            
S0-C3           2            2954550      cache-misses              #    5.507 % of all cache refs    

       1.449412595 seconds time elapsed                                          ( +-  0.43% )
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="otras-herramientas-para-medicion-de-uso-de-cpu-en-el-sistema-operativo-gnu-linux">
<h3>Otras herramientas para medición de uso de CPU en el sistema operativo GNU/Linux<a class="headerlink" href="#otras-herramientas-para-medicion-de-uso-de-cpu-en-el-sistema-operativo-gnu-linux" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/brendangregg/pmc-cloud-tools">pmc-cloud-tools</a></p></li>
</ul>
<div class="tip admonition">
<p class="admonition-title">Ejercicios</p>
<p>1.Resuelve los ejercicios y preguntas de la nota.</p>
</div>
<p><strong>Referencias:</strong></p>
<ol class="simple">
<li><p>M. Gorelick, I. Ozsvald, High Performance Python, O’Reilly Media, 2014.</p></li>
<li><p>E. Anderson, Z. Bai, C. Bischof, L. S. Blackford, J. Demmel, J. Dongarra, J. Du Croz,
A. Greenbaum, S. Hammarling, A. Mckenney and D. Sorensen, LAPACK Users Guide, Society for Industrial and Applied Mathematics, Philadelphia, PA, third ed., 1999.</p></li>
</ol>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "palmoreck/dockerfiles-for-binder",
            ref: "jupyterlab_optimizacion_2",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./V.optimizacion_de_codigo/5.2"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="../5.1/introduccion_optimizacion_de_codigo.html" title="previous page">5.1 Introducción a optimización de código</a>
    <a class='right-next' id="next-link" href="../../VI.algoritmos_optimizacion_convexa/6.1/Problemas_UCO.html" title="next page">6.1 Problemas tipo <em>Unconstrained Convex Optimization</em> (UCO)</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Erick Palacios Moreno<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../../_static/js/index.3da636dd464baa7582d2.js"></script>


    
  </body>
</html>