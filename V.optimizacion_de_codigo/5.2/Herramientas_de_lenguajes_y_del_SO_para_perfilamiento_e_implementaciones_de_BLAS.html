
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>5.2 Herramientas de lenguajes de programación y del sistema operativo para perfilamiento e implementaciones de BLAS</title>
    
  <link rel="stylesheet" href="../../_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe,.cell"
        const thebe_selector_input = "pre,.cell_input div.highlight"
        const thebe_selector_output = ".output,.cell_output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="6.1 Problemas tipo Unconstrained Convex Optimization (UCO)" href="../../VI.algoritmos_optimizacion_convexa/6.1/Problemas_UCO.html" />
    <link rel="prev" title="5.1 Introducción a optimización de código" href="../5.1/introduccion_optimizacion_de_codigo.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../../index.html">
  
  <img src="../../_static/logo.png" class="logo" alt="logo">
  
  
</a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../README.html">
   Optimización
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  I. Cómputo científico
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../I.computo_cientifico/1.1/Analisis_numerico_y_computo_cientifico.html">
   1.1 Análisis numérico y cómputo científico
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../I.computo_cientifico/1.2/Sistema_de_punto_flotante.html">
   1.2 Sistema de punto flotante
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../I.computo_cientifico/1.3/Normas_vectoriales_y_matriciales.html">
   1.3 Normas vectoriales y matriciales
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../I.computo_cientifico/1.4/Condicion_de_un_problema_y_estabilidad_de_un_algoritmo.html">
   1.4 Condición de un problema y estabilidad de un algoritmo
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../I.computo_cientifico/1.5/Definicion_de_funcion_continuidad_derivada.html">
   1.5 Definición de función, continuidad y derivada
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../I.computo_cientifico/1.6/Polinomios_de_Taylor_y_diferenciacion_numerica.html">
   1.6 Polinomios de Taylor y diferenciación numérica
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../I.computo_cientifico/1.7/Integracion_numerica.html">
   1.7 Integración Numérica
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  II. Cómputo matricial
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../II.computo_matricial/2.1/Operaciones_y_transformaciones_basicas_del_Algebra_Lineal_Numerica.html">
   2.1 Operaciones y transformaciones básicas del Álgebra Lineal Numérica
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../II.computo_matricial/2.2/Eigenvalores_y_eigenvectores.html">
   2.2 Eigenvalores y eigenvectores
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../II.computo_matricial/2.3/Algoritmos_y_aplicaciones_de_eigenvalores_eigenvectores_de_una_matriz.html">
   2.3 Algoritmos y aplicaciones de eigenvalores y eigenvectores de una matriz
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../II.computo_matricial/2.4/Valores_vectores_singulares_y_algoritmos_para_calcular_la_SVD.html">
   2.4 Valores, vectores singulares y algoritmos para calcular la SVD
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  III. Optimización convexa y ecuaciones no lineales
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../III.optimizacion_convexa/3.1/Definicion_de_problema_optimizacion_conjuntos_y_funciones_convexas.html">
   3.1 Definición de problemas de optimización, conjuntos y funciones convexas
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../III.optimizacion_convexa/3.2/Algoritmos_de_descenso_y_busqueda_de_linea_en_uco.html">
   3.2 Algoritmos de descenso y búsqueda de línea en
   <em>
    Unconstrained Convex Optimization
   </em>
   (UCO)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../III.optimizacion_convexa/3.3/Ejemplos_problemas_UCO_e_intro_CIEO_y_PI.html">
   3.3 Ejemplos de problemas UCO, introducción a
   <em>
    Constrained Inequality and Equality Optimization
   </em>
   (CIEO) y puntos interiores
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../III.optimizacion_convexa/3.4/Ecuaciones_no_lineales.html">
   3.4 Ecuaciones no lineales
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  IV. Optimización en redes y programación lineal
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../IV.optimizacion_en_redes_y_prog_lineal/4.1/Definiciones_generales_de_flujo_en_redes.html">
   4.1 Definiciones generales de flujo en redes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../IV.optimizacion_en_redes_y_prog_lineal/4.2/Programacion_lineal_y_metodo_simplex.html">
   4.2 Programación lineal (PL) y método símplex
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../IV.optimizacion_en_redes_y_prog_lineal/4.3/Ejemplo_metodo_simplex_de_redes.html">
   4.3 Ejemplo del método símplex de redes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../IV.optimizacion_en_redes_y_prog_lineal/4.4/Dualidad_lema_de_Farkas_condiciones_KKT_de_optimalidad.html">
   4.4 Dualidad, lema de Farkas y condiciones de Karush-Kuhn-Tucker (KKT) de optimalidad
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../IV.optimizacion_en_redes_y_prog_lineal/4.5/Metodo_primal_dual_de_BL.html">
   4.5 Método primal-dual de barrera logarítmica (BL)
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  V. Optimización de código
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../5.1/introduccion_optimizacion_de_codigo.html">
   5.1 Introducción a optimización de código
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   5.2 Herramientas de lenguajes de programación y del sistema operativo para perfilamiento e implementaciones de BLAS
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  VI. Algoritmos de optimización convexa
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../VI.algoritmos_optimizacion_convexa/6.1/Problemas_UCO.html">
   6.1 Problemas tipo
   <em>
    Unconstrained Convex Optimization
   </em>
   (UCO)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../VI.algoritmos_optimizacion_convexa/6.2/Problemas_CECO.html">
   6.2 Problemas tipo
   <em>
    Constrained Equality Convex Optimization
   </em>
   (CECO)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../VI.algoritmos_optimizacion_convexa/6.3/Problemas_CIECO.html">
   6.3 Problemas tipo
   <em>
    Constrained Equality and Inequality Convex Optimization
   </em>
   (CIECO)
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/V.optimizacion_de_codigo/5.2/Herramientas_de_lenguajes_y_del_SO_para_perfilamiento_e_implementaciones_de_BLAS.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/palmoreck/dockerfiles-for-binder/jupyterlab_optimizacion_2?urlpath=lab/tree/analisis-numerico-computo-cientifico/libro_optimizacion/temas/V.optimizacion_de_codigo/5.2/Herramientas_de_lenguajes_y_del_SO_para_perfilamiento_e_implementaciones_de_BLAS.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <button type="button" class="btn btn-secondary topbarbtn"
            onclick="initThebeSBT()" title="Launch Thebe" data-toggle="tooltip" data-placement="left"><i
                class="fas fa-play"></i><span style="margin-left: .4em;">Live Code</span></button>
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#perfilamiento-medicion-de-tiempo-en-python">
   Perfilamiento: medición de tiempo en
   <em>
    Python
   </em>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#modulo-time">
     Módulo: time
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#comando-de-magic-time">
     Comando de
     <em>
      magic
     </em>
     : %time
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#comando-de-magic-timeit">
     Comando de
     <em>
      magic
     </em>
     : %timeit
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#perfilamiento-medicion-de-uso-de-cpu-en-python">
   Perfilamiento: medición de uso de CPU en
   <em>
    Python
   </em>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#line-profiler">
     line_profiler
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cprofile">
     CProfile
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#perfilamiento-medicion-de-uso-de-memoria-en-python">
   Perfilamiento: medición de uso de memoria en
   <em>
    Python
   </em>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#memory-profiler">
     memory_profiler
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#heapy">
     heapy
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#basic-linear-algebra-subprograms-blas">
   <em>
    Basic Linear Algebra Subprograms
   </em>
   (BLAS)
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#operacion-del-producto-interno-estandar-o-producto-punto-nivel-1-de-blas">
     Operación del producto interno estándar o producto punto (nivel 1 de BLAS)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#ejemplo-y-algoritmo">
     Ejemplo y algoritmo
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#operacion-saxpy-nivel-1-de-blas">
     Operación
     <strong>
      saxpy
     </strong>
     (nivel 1 de BLAS)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Ejemplo y algoritmo
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#operacion-de-multiplicacion-matriz-vector-nivel-2-de-blas">
     Operación de multiplicación matriz-vector (nivel 2 de BLAS)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#ejemplo-y-algoritmo-gaxpy-row-oriented">
     Ejemplo y algoritmo gaxpy
     <em>
      row oriented
     </em>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#ejemplo-y-algoritmo-gaxpy-column-oriented">
     Ejemplo y algoritmo gaxpy
     <em>
      column oriented
     </em>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#openblas-y-numpy">
     OpenBLAS y
     <em>
      NumPy
     </em>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#resultados-utilizando-opt2-aws-educate-openblas-04-04-2021">
     Resultados utilizando
     <code class="docutils literal notranslate">
      <span class="pre">
       opt2-aws-educate-openblas-04-04-2021
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#resultados-utilizando-opt2-aws-educate-no-openblas-04-04-2021">
     Resultados utilizando
     <code class="docutils literal notranslate">
      <span class="pre">
       opt2-aws-educate-no-openblas-04-04-2021
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#openblas-y-librerias-de-computo-matricial-de-r">
     OpenBLAS y librerías de cómputo matricial de
     <em>
      R
     </em>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id2">
     Resultados utilizando
     <code class="docutils literal notranslate">
      <span class="pre">
       opt2-aws-educate-openblas-04-04-2021
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id3">
     Resultados utilizando
     <code class="docutils literal notranslate">
      <span class="pre">
       opt2-aws-educate-no-openblas-04-04-2021
      </span>
     </code>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#perfilamiento-medicion-de-tiempo-en-el-sistema-operativo-ubuntu-20-04">
   Perfilamiento: medición de tiempo en el sistema operativo Ubuntu 20.04
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#usr-bin-time">
     /usr/bin/time
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#perfilamiento-medicion-de-uso-de-cpu-en-el-sistema-operativo-gnu-linux">
   Perfilamiento: medición de uso de CPU en el sistema operativo GNU/Linux
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#perf">
     perf
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#perf-openblas">
     perf OpenBLAS
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#otras-herramientas-para-medicion-de-uso-de-cpu-en-el-sistema-operativo-gnu-linux">
     Otras herramientas para medición de uso de CPU en el sistema operativo GNU/Linux
    </a>
   </li>
  </ul>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="herramientas-de-lenguajes-de-programacion-y-del-sistema-operativo-para-perfilamiento-e-implementaciones-de-blas">
<span id="perfblas"></span><h1>5.2 Herramientas de lenguajes de programación y del sistema operativo para perfilamiento e implementaciones de BLAS<a class="headerlink" href="#herramientas-de-lenguajes-de-programacion-y-del-sistema-operativo-para-perfilamiento-e-implementaciones-de-blas" title="Permalink to this headline">¶</a></h1>
<div class="admonition-notas-para-contenedor-de-docker admonition">
<p class="admonition-title">Notas para contenedor de docker:</p>
<p>Comando de docker para ejecución de la nota de forma local:</p>
<p>nota: cambiar <code class="docutils literal notranslate"><span class="pre">&lt;ruta</span> <span class="pre">a</span> <span class="pre">mi</span> <span class="pre">directorio&gt;</span></code> por la ruta de directorio que se desea mapear a <code class="docutils literal notranslate"><span class="pre">/datos</span></code> dentro del contenedor de docker.</p>
<p><code class="docutils literal notranslate"><span class="pre">docker</span> <span class="pre">run</span> <span class="pre">--rm</span> <span class="pre">-v</span> <span class="pre">&lt;ruta</span> <span class="pre">a</span> <span class="pre">mi</span> <span class="pre">directorio&gt;:/datos</span> <span class="pre">--name</span> <span class="pre">jupyterlab_optimizacion_2</span> <span class="pre">-p</span> <span class="pre">8888:8888</span> <span class="pre">-p</span> <span class="pre">8787:8787</span> <span class="pre">-d</span> <span class="pre">palmoreck/jupyterlab_optimizacion_2:3.0.0</span></code></p>
<p>password para jupyterlab: <code class="docutils literal notranslate"><span class="pre">qwerty</span></code></p>
<p>Detener el contenedor de docker:</p>
<p><code class="docutils literal notranslate"><span class="pre">docker</span> <span class="pre">stop</span> <span class="pre">jupyterlab_optimizacion_2</span></code></p>
<p>Documentación de la imagen de docker <code class="docutils literal notranslate"><span class="pre">palmoreck/jupyterlab_optimizacion_2:3.0.0</span></code> en <a class="reference external" href="https://github.com/palmoreck/dockerfiles/tree/master/jupyterlab/optimizacion_2">liga</a>.</p>
</div>
<hr class="docutils" />
<div class="tip admonition">
<p class="admonition-title">Al final de esta nota el y la lectora:</p>
<ul class="simple">
<li></li>
</ul>
</div>
<p>En esta nota revisamos algunas herramientas de los lenguajes de programación y de los sistemas GNU/Linux para perfilamiento de código. También se revisan implementaciones de la especificación de <em>Basic Linear Algebra Subprograms</em> (BLAS) en sus diferentes niveles con ejemplos de paquetes en los lenguajes.</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Utilizamos la máquina <code class="docutils literal notranslate"><span class="pre">m4.16xlarge</span></code> pues en AWS no todas las instancias se pueden obtener algunas métricas con <code class="docutils literal notranslate"><span class="pre">perf</span></code>. Ver <a class="reference external" href="https://stackoverflow.com/questions/45683901/event-cache-misses-not-supported-by-perf-in-aws">stackoverflow1</a>, <a class="reference external" href="https://stackoverflow.com/questions/19763070/ubuntu-12-10-perf-stat-not-supported-cycles">stackoverflow2</a>, <a class="reference external" href="http://www.brendangregg.com/blog/2017-05-04/the-pmcs-of-ec2.html">the-pmcs-of-ec2</a></p>
</div>
<p>Se presentan códigos y sus ejecuciones en una máquina <code class="docutils literal notranslate"><span class="pre">m4.16xlarge</span></code> de la nube de <a class="reference external" href="https://aws.amazon.com/">AWS</a>. Se sugiere se utilice la AMI <code class="docutils literal notranslate"><span class="pre">opt2-aws-educate-openblas-04-04-2021</span></code> de la región <code class="docutils literal notranslate"><span class="pre">us-east-1</span></code> (Virginia) para reproducibilidad de resultados. Tal AMI se construyó a partir de una AMI <code class="docutils literal notranslate"><span class="pre">ubuntu</span> <span class="pre">20.04</span> <span class="pre">-</span> <span class="pre">ami-042e8287309f5df03</span></code> con el <a class="reference external" href="https://github.com/palmoreck/scripts_for_useful_tools_installations/blob/main/AWS/ubuntu_20.04/optimizacion_2/script_profiling_and_BLAS.sh">script_profiling_and_BLAS.sh</a></p>
<div class="admonition-comentario admonition">
<p class="admonition-title">Comentario</p>
<p>Si se utiliza la <em>AMI</em> <code class="docutils literal notranslate"><span class="pre">opt2-aws-educate-openblas-04-04-2021</span></code> colocar en <code class="docutils literal notranslate"><span class="pre">User</span> <span class="pre">data</span></code> el siguiente <em>script</em>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/bin/bash</span>
<span class="c1">##variables:</span>
<span class="nv">region</span><span class="o">=</span>us-east-1 <span class="c1">#make sure instance is in Virginia</span>
<span class="nv">name_instance</span><span class="o">=</span>OpenBLAS
<span class="nv">USER</span><span class="o">=</span>ubuntu
<span class="c1">##System update</span>
apt-get update -yq
<span class="c1">##Tag instance</span>
<span class="nv">INSTANCE_ID</span><span class="o">=</span><span class="k">$(</span>curl -s http://instance-data/latest/meta-data/instance-id<span class="k">)</span>
<span class="nv">PUBLIC_IP</span><span class="o">=</span><span class="k">$(</span>curl -s http://instance-data/latest/meta-data/public-ipv4<span class="k">)</span>
sudo -H -u <span class="nv">$USER</span> bash -c <span class="s2">&quot;/home/</span><span class="nv">$USER</span><span class="s2">/.local/bin/aws ec2 create-tags --resources </span><span class="nv">$INSTANCE_ID</span><span class="s2"> --tag Key=Name,Value=</span><span class="nv">$name_instance</span><span class="s2">-</span><span class="nv">$PUBLIC_IP</span><span class="s2"> --region=</span><span class="nv">$region</span><span class="s2">&quot;</span>
sudo -H -u <span class="nv">$USER</span> bash -c <span class="s2">&quot;cd / &amp;&amp; /home/</span><span class="nv">$USER</span><span class="s2">/.local/bin/jupyter lab --ip=0.0.0.0 --no-browser --config=/home/</span><span class="nv">$USER</span><span class="s2">/.jupyter/jupyter_notebook_config.py &amp;&quot;</span>
</pre></div>
</div>
</div>
<p>La máquina <code class="docutils literal notranslate"><span class="pre">m4.16xlarge</span></code> tiene las siguientes características:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">bash</span>
lscpu
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Architecture:                    x86_64
CPU op-mode(s):                  32-bit, 64-bit
Byte Order:                      Little Endian
Address sizes:                   46 bits physical, 48 bits virtual
CPU(s):                          64
On-line CPU(s) list:             0-63
Thread(s) per core:              2
Core(s) per socket:              16
Socket(s):                       2
NUMA node(s):                    2
Vendor ID:                       GenuineIntel
CPU family:                      6
Model:                           79
Model name:                      Intel(R) Xeon(R) CPU E5-2686 v4 @ 2.30GHz
Stepping:                        1
CPU MHz:                         2709.718
CPU max MHz:                     3000.0000
CPU min MHz:                     1200.0000
BogoMIPS:                        4600.02
Hypervisor vendor:               Xen
Virtualization type:             full
L1d cache:                       1 MiB
L1i cache:                       1 MiB
L2 cache:                        8 MiB
L3 cache:                        90 MiB
NUMA node0 CPU(s):               0-15,32-47
NUMA node1 CPU(s):               16-31,48-63
Vulnerability Itlb multihit:     KVM: Vulnerable
Vulnerability L1tf:              Mitigation; PTE Inversion
Vulnerability Mds:               Vulnerable: Clear CPU buffers attempted, no microcode; SMT Host state unknown
Vulnerability Meltdown:          Mitigation; PTI
Vulnerability Spec store bypass: Vulnerable
Vulnerability Spectre v1:        Mitigation; usercopy/swapgs barriers and __user pointer sanitization
Vulnerability Spectre v2:        Mitigation; Full generic retpoline, STIBP disabled, RSB filling
Vulnerability Srbds:             Not affected
Vulnerability Tsx async abort:   Vulnerable: Clear CPU buffers attempted, no microcode; SMT Host state unknown
Flags:                           fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush mmx fxsr sse sse2 ht syscall nx pdpe1gb rdtscp lm constant_tsc arch_perfmon rep_good nopl xtopology nonstop_tsc cpuid aperfmperf pni pclmulqdq monitor est ssse3 fma cx16 pcid sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand hypervisor lahf_lm abm cpuid_fault invpcid_single pti fsgsbase bmi1 hle avx2 smep bmi2 erms invpcid rtm xsaveopt ida
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">bash</span>
sudo lshw -C memory
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  *-firmware
       description: BIOS
       vendor: Xen
       physical id: 0
       version: 4.11.amazon
       date: 08/24/2006
       size: 96KiB
       capabilities: pci edd
  *-memory
       description: System Memory
       physical id: 1000
       size: 256GiB
       capabilities: ecc
       configuration: errordetection=multi-bit-ecc
     *-bank:0
          description: DIMM RAM
          physical id: 0
          slot: DIMM 0
          size: 16GiB
          width: 64 bits
     *-bank:1
          description: DIMM RAM
          physical id: 1
          slot: DIMM 1
          size: 16GiB
          width: 64 bits
     *-bank:2
          description: DIMM RAM
          physical id: 2
          slot: DIMM 2
          size: 16GiB
          width: 64 bits
     *-bank:3
          description: DIMM RAM
          physical id: 3
          slot: DIMM 3
          size: 16GiB
          width: 64 bits
     *-bank:4
          description: DIMM RAM
          physical id: 4
          slot: DIMM 4
          size: 16GiB
          width: 64 bits
     *-bank:5
          description: DIMM RAM
          physical id: 5
          slot: DIMM 5
          size: 16GiB
          width: 64 bits
     *-bank:6
          description: DIMM RAM
          physical id: 6
          slot: DIMM 6
          size: 16GiB
          width: 64 bits
     *-bank:7
          description: DIMM RAM
          physical id: 7
          slot: DIMM 7
          size: 16GiB
          width: 64 bits
     *-bank:8
          description: DIMM RAM
          physical id: 8
          slot: DIMM 8
          size: 16GiB
          width: 64 bits
     *-bank:9
          description: DIMM RAM
          physical id: 9
          slot: DIMM 9
          size: 16GiB
          width: 64 bits
     *-bank:10
          description: DIMM RAM
          physical id: a
          slot: DIMM 10
          size: 16GiB
          width: 64 bits
     *-bank:11
          description: DIMM RAM
          physical id: b
          slot: DIMM 11
          size: 16GiB
          width: 64 bits
     *-bank:12
          description: DIMM RAM
          physical id: c
          slot: DIMM 12
          size: 16GiB
          width: 64 bits
     *-bank:13
          description: DIMM RAM
          physical id: d
          slot: DIMM 13
          size: 16GiB
          width: 64 bits
     *-bank:14
          description: DIMM RAM
          physical id: e
          slot: DIMM 14
          size: 16GiB
          width: 64 bits
     *-bank:15
          description: DIMM RAM
          physical id: f
          slot: DIMM 15
          size: 16GiB
          width: 64 bits
</pre></div>
</div>
</div>
</div>
<div class="tip admonition">
<p class="admonition-title">Observación</p>
<p>En la celda anterior se utilizó el comando de <em>magic</em> <code class="docutils literal notranslate"><span class="pre">%%bash</span></code>. Algunos comandos de <em>magic</em> los podemos utilizar también con <em>import</em>’s. Ver <a class="reference external" href="https://ipython.readthedocs.io/en/stable/interactive/magics.html">ipython-magics</a></p>
</div>
<div class="section" id="perfilamiento-medicion-de-tiempo-en-python">
<h2>Perfilamiento: medición de tiempo en <em>Python</em><a class="headerlink" href="#perfilamiento-medicion-de-tiempo-en-python" title="Permalink to this headline">¶</a></h2>
<div class="section" id="modulo-time">
<h3>Módulo: <a class="reference external" href="https://docs.python.org/3/library/time.html#time.time">time</a><a class="headerlink" href="#modulo-time" title="Permalink to this headline">¶</a></h3>
<p>Imports y funciones de apoyo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">pytest</span> <span class="kn">import</span> <span class="n">approx</span>
<span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">quad</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">Rcf</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">n</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute numerical approximation using rectangle or mid-point</span>
<span class="sd">    method in an interval.</span>
<span class="sd">    Nodes are generated via formula: x_i = a+(i+1/2)h_hat for</span>
<span class="sd">    i=0,1,...,n-1 and h_hat=(b-a)/n</span>
<span class="sd">    Args:</span>
<span class="sd">    </span>
<span class="sd">        f (function): function expression of integrand.</span>
<span class="sd">        </span>
<span class="sd">        a (float): left point of interval.</span>
<span class="sd">        </span>
<span class="sd">        b (float): right point of interval.</span>
<span class="sd">        </span>
<span class="sd">        n (float): number of subintervals.</span>
<span class="sd">        </span>
<span class="sd">    Returns:</span>
<span class="sd">    </span>
<span class="sd">        sum_res (float): numerical approximation to integral</span>
<span class="sd">            of f in the interval a,b</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">h_hat</span><span class="o">=</span><span class="p">(</span><span class="n">b</span><span class="o">-</span><span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="n">n</span>
    <span class="n">nodes</span><span class="o">=</span><span class="p">[</span><span class="n">a</span><span class="o">+</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">h_hat</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">n</span><span class="p">)]</span>
    <span class="n">sum_res</span><span class="o">=</span><span class="mi">0</span>
    <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">nodes</span><span class="p">:</span>
        <span class="n">sum_res</span><span class="o">=</span><span class="n">sum_res</span><span class="o">+</span><span class="n">f</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">h_hat</span><span class="o">*</span><span class="n">sum_res</span>
</pre></div>
</div>
</div>
</div>
<p>Objetivo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="c1">#using math library</span>
<span class="n">a</span><span class="o">=</span><span class="mi">0</span>
<span class="n">b</span><span class="o">=</span><span class="mi">1</span>
<span class="n">obj</span><span class="p">,</span> <span class="n">err</span> <span class="o">=</span> <span class="n">quad</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.7468241328124271
</pre></div>
</div>
</div>
</div>
<p>Medición de tiempo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="mi">6</span>
<span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">res</span><span class="o">=</span><span class="n">Rcf</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
<span class="n">end_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">secs</span> <span class="o">=</span> <span class="n">end_time</span><span class="o">-</span><span class="n">start_time</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Rcf tomó&quot;</span><span class="p">,</span><span class="n">secs</span><span class="p">,</span><span class="s2">&quot;segundos&quot;</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Rcf tomó 0.44214773178100586 segundos
</pre></div>
</div>
</div>
</div>
<p>Prueba que se resuelve correctamente el problema:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">res</span> <span class="o">==</span> <span class="n">approx</span><span class="p">(</span><span class="n">obj</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="comando-de-magic-time">
<h3>Comando de <em>magic</em>: <a class="reference external" href="https://ipython.readthedocs.io/en/stable/interactive/magics.html#magic-time">%time</a><a class="headerlink" href="#comando-de-magic-time" title="Permalink to this headline">¶</a></h3>
<p>Nos regresa las mediciones siguientes:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">CPU</span> <span class="pre">times</span></code> que contiene:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">user</span></code>: mide la cantidad de tiempo de los <em>statements</em> que la CPU gastó para funciones que no están relacionadas con el <em>kernel</em> del sistema.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sys</span></code>: mide la cantidad de tiempo de los <em>statements</em> que la CPU gastó en funciones a nivel de kernel del sistema.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">total</span></code>: suma entre el <code class="docutils literal notranslate"><span class="pre">user</span></code> y <code class="docutils literal notranslate"><span class="pre">sys</span></code> para todos <strong>todos los <em>cores</em></strong>.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">Wall</span> <span class="pre">time</span></code>: mide el <em>wall clock</em> o <em>elapsed time</em> que se refiere al tiempo desde que inicia la ejecución de los <em>statements</em> hasta su finalización.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Out</span></code>: resultado.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">time</span> Rcf(f,a, b,n)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 365 ms, sys: 22.9 ms, total: 388 ms
Wall time: 386 ms
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.7468241328124773
</pre></div>
</div>
</div>
</div>
<div class="admonition-comentarios admonition">
<p class="admonition-title">Comentarios</p>
<ul class="simple">
<li><p>Para mediciones de tiempos que involucran cómputo en paralelo es posible que <code class="docutils literal notranslate"><span class="pre">total</span></code> exceda a <code class="docutils literal notranslate"><span class="pre">Wall</span> <span class="pre">time</span></code> por una diferencia notable pues es la suma de tiempos para todos los <em>cores</em>.</p></li>
<li><p>Recuérdese que algunos ejemplos de funciones relacionadas con el <em>kernel</em> del sistema es el alojamiento, lectura y escritura de variables en memoria, las relacionadas con el I/O de disco o <em>network</em>.</p></li>
<li><p>La diferencia entre <code class="docutils literal notranslate"><span class="pre">total</span></code> y <code class="docutils literal notranslate"><span class="pre">Wall</span> <span class="pre">time</span></code> da una idea de la cantidad de tiempo que se ocupó el sistema en la ejecución de <em>statements</em> que no involucran <code class="docutils literal notranslate"><span class="pre">user</span></code> ni a <code class="docutils literal notranslate"><span class="pre">sys</span></code> (por ejemplo un <em>statement</em> del tipo <code class="docutils literal notranslate"><span class="pre">sleep</span></code>) o en tareas no relacionadas con los <em>statements</em> medidos (por ejemplo si en el momento de la medición se estaban corriendo otros procesos).</p></li>
</ul>
</div>
<p>Al medir tiempos de ejecución, <strong>siempre</strong> hay variación en la medición por lo que se recomienda realizar las mediciones un número repetido de veces. Para este caso el comando de <em>magic</em> <code class="docutils literal notranslate"><span class="pre">%timeit</span></code> nos ayuda.</p>
</div>
<div class="section" id="comando-de-magic-timeit">
<h3>Comando de <em>magic</em>: <a class="reference external" href="https://ipython.readthedocs.io/en/stable/interactive/magics.html#magic-timeit">%timeit</a><a class="headerlink" href="#comando-de-magic-timeit" title="Permalink to this headline">¶</a></h3>
<p>A continuación se mide el tiempo de ejecución para la función <code class="docutils literal notranslate"><span class="pre">Rcf</span></code>. Se promedian los tiempos de <span class="math notranslate nohighlight">\(n=5\)</span> ejecuciones y se calcula su desviación estándar. Se reptite lo anterior <span class="math notranslate nohighlight">\(r=10\)</span> veces y se reporta el mejor resultado.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">timeit</span> -n 5 -r 10 Rcf(f,a, b,n)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>369 ms ± 1.99 ms per loop (mean ± std. dev. of 10 runs, 5 loops each)
</pre></div>
</div>
</div>
</div>
<div class="tip admonition">
<p class="admonition-title">Observación</p>
<p><span class="math notranslate nohighlight">\(ms\)</span> es milisecond, <span class="math notranslate nohighlight">\(\mu s\)</span> es microsecond y <span class="math notranslate nohighlight">\(ns\)</span> es nanosecond.</p>
</div>
<div class="admonition-comentarios admonition">
<p class="admonition-title">Comentarios</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">%timeit</span></code> se recomienda usar para secciones de código pequeñas. Si se observa una variación en las mediciones de tiempo entre distintas repeticiones entonces hay que realizar más repeticiones hasta tener un resultado estable.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">%timeit</span></code> desabilita temporalmente el <em>garbage collector</em> de <em>Python</em> (esto es, no habrá desalojamiento en memoria de objetos de Python que no se utilicen). Si el <em>garbage collector</em> es invocado en tus <em>statements</em>, esto puede ser una razón de posibles diferencias que se obtengan en las mediciones de tiempo.</p></li>
</ul>
</div>
</div>
</div>
<div class="section" id="perfilamiento-medicion-de-uso-de-cpu-en-python">
<h2>Perfilamiento: medición de uso de CPU en <em>Python</em><a class="headerlink" href="#perfilamiento-medicion-de-uso-de-cpu-en-python" title="Permalink to this headline">¶</a></h2>
<div class="section" id="line-profiler">
<h3><a class="reference external" href="https://pypi.org/project/line-profiler/">line_profiler</a><a class="headerlink" href="#line-profiler" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="cprofile">
<h3><a class="reference external" href="https://docs.python.org/2/library/profile.html">CProfile</a><a class="headerlink" href="#cprofile" title="Permalink to this headline">¶</a></h3>
<p><em>CProfile</em> es <code class="docutils literal notranslate"><span class="pre">built-in</span></code> en la <em>standard-library</em> de Python.</p>
</div>
</div>
<div class="section" id="perfilamiento-medicion-de-uso-de-memoria-en-python">
<h2>Perfilamiento: medición de uso de memoria en <em>Python</em><a class="headerlink" href="#perfilamiento-medicion-de-uso-de-memoria-en-python" title="Permalink to this headline">¶</a></h2>
<div class="section" id="memory-profiler">
<h3><a class="reference external" href="https://pypi.org/project/memory-profiler/">memory_profiler</a><a class="headerlink" href="#memory-profiler" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="heapy">
<h3><a class="reference external" href="https://pypi.org/project/guppy/">heapy</a><a class="headerlink" href="#heapy" title="Permalink to this headline">¶</a></h3>
</div>
</div>
<div class="section" id="basic-linear-algebra-subprograms-blas">
<h2><em>Basic Linear Algebra Subprograms</em> (BLAS)<a class="headerlink" href="#basic-linear-algebra-subprograms-blas" title="Permalink to this headline">¶</a></h2>
<p>De acuerdo a la especificación BLAS, hay diferentes niveles dependiendo del número de datos y cantidad de operaciones a realizar que involucran tales datos.</p>
<div class="section" id="operacion-del-producto-interno-estandar-o-producto-punto-nivel-1-de-blas">
<h3>Operación del producto interno estándar o producto punto (nivel 1 de BLAS)<a class="headerlink" href="#operacion-del-producto-interno-estandar-o-producto-punto-nivel-1-de-blas" title="Permalink to this headline">¶</a></h3>
<p>Consideramos <span class="math notranslate nohighlight">\(x,y \in \mathbb{R}^n\)</span>. El producto punto entre <span class="math notranslate nohighlight">\(x\)</span> y <span class="math notranslate nohighlight">\(y\)</span> es <span class="math notranslate nohighlight">\(c = x^Ty = \displaystyle \sum_{i=1}^n x_iy_i\)</span>.</p>
</div>
<div class="section" id="ejemplo-y-algoritmo">
<h3>Ejemplo y algoritmo<a class="headerlink" href="#ejemplo-y-algoritmo" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">c</span><span class="o">=</span><span class="mi">0</span>
<span class="n">n</span><span class="o">=</span><span class="mi">5</span>
<span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">n</span>
<span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="mf">1.5</span><span class="p">]</span><span class="o">*</span><span class="n">n</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">c</span> <span class="o">+=</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">c</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-7.5
</pre></div>
</div>
</div>
</div>
<div class="admonition-comentarios admonition">
<p class="admonition-title">Comentarios</p>
<ul class="simple">
<li><p>El producto punto de dos <span class="math notranslate nohighlight">\(n\)</span>-vectores involucran <span class="math notranslate nohighlight">\(n\)</span> multiplicaciones y <span class="math notranslate nohighlight">\(n\)</span> sumas para un total de <span class="math notranslate nohighlight">\(2n\)</span> operaciones o <a class="reference external" href="https://en.wikipedia.org/wiki/FLOPS">floating point operations per second</a> (flops). Usamos la notación <span class="math notranslate nohighlight">\(\mathcal{O}(\cdot)\)</span> para escribir que el producto punto es <span class="math notranslate nohighlight">\(\mathcal{O}(n)\)</span> y se lee “de orden <span class="math notranslate nohighlight">\(n\)</span> o proporcional a <span class="math notranslate nohighlight">\(n\)</span>” para indicar que la <strong>cantidad de trabajo</strong> tiene un comportamiento <strong>lineal</strong> con la dimensión <span class="math notranslate nohighlight">\(n\)</span>. También tal cantidad de trabajo opera sobre una <strong>cantidad lineal de datos</strong>.</p></li>
<li><p>Los <em>flops</em> que realiza un algoritmo es una forma de cuantificar el volumen de trabajo asociado con un cálculo. Un <em>flop</em> es una operación de punto flotante: suma, multiplicación o división. Por ejemplo, en la línea:</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">C</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">C</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="n">B</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>
</pre></div>
</div>
<p>se realizan <span class="math notranslate nohighlight">\(2\)</span> <em>flops</em>. Los flops sólo representan una componente para categorizar a los algoritmos de acuerdo al trabajo que realizan, otras componentes son la transferencia o movimientos de datos, <em>data movement/motion</em>, ejecución secuencial o en paralelo y el <em>data locality</em> y <em>data reuse</em> que realizan.</p>
<ul class="simple">
<li><p>En LAPACK encontramos <a class="reference external" href="http://www.netlib.org/lapack/explore-html/d0/d16/sdot_8f.html">sdot</a>, <a class="reference external" href="http://www.netlib.org/lapack/explore-html/d5/df6/ddot_8f.html">ddot</a>, <a class="reference external" href="http://www.netlib.org/lapack/explore-html/d7/d7b/cdotu_8f.html">cdotu</a> y <a class="reference external" href="http://www.netlib.org/lapack/explore-html/db/d2d/zdotu_8f.html">zdotu</a> para descripción de las funciones/subrutinas escritas en <a class="reference external" href="https://en.wikipedia.org/wiki/Fortran">Fortran</a> del producto punto en los casos de precisión simple, doble o números complejos respectivamente.</p></li>
</ul>
</div>
</div>
<div class="section" id="operacion-saxpy-nivel-1-de-blas">
<h3>Operación <strong>saxpy</strong> (nivel 1 de BLAS)<a class="headerlink" href="#operacion-saxpy-nivel-1-de-blas" title="Permalink to this headline">¶</a></h3>
<p>Consideramos <span class="math notranslate nohighlight">\(\alpha \in \mathbb{R}, x,y \in \mathbb{R}^n\)</span>. El nombre lo recibe por <em>scalar alpha x plus y</em>. En LAPACK <a class="reference external" href="http://www.netlib.org/lapack/explore-html/d8/daf/saxpy_8f.html">saxpy</a> se escribe en forma <em>update</em>:</p>
<div class="math notranslate nohighlight">
\[y=\alpha x + y \therefore y_i = \alpha x_i + y_i \forall i=1,...,n\]</div>
<div class="admonition-comentarios admonition">
<p class="admonition-title">Comentarios</p>
<ul class="simple">
<li><p>El símbolo “=” no se utiliza como igualdad de expresiones sino para denotar asignación (como en computación al escribir un algoritmo).</p></li>
<li><p>También encontramos en LAPACK <a class="reference external" href="http://www.netlib.org/lapack/explore-html/de/da2/caxpy_8f.html">caxpy</a> o <a class="reference external" href="http://www.netlib.org/lapack/explore-html/d9/dcd/daxpy_8f.html">daxpy</a> para el caso complejo y para números en doble precisión respectivamente.</p></li>
<li><p>Ésta operación realiza un trabajo de <span class="math notranslate nohighlight">\(\mathcal{O}(n)\)</span> sobre una cantidad de datos <span class="math notranslate nohighlight">\(\mathcal{O}(n)\)</span>.</p></li>
</ul>
</div>
</div>
<div class="section" id="id1">
<h3>Ejemplo y algoritmo<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span><span class="o">=</span><span class="mi">2</span>
<span class="n">n</span><span class="o">=</span><span class="mi">5</span>
<span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">n</span>
<span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">n</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="n">alpha</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[-4, -4, -4, -4, -4]
</pre></div>
</div>
</div>
</div>
<p>o en una forma <em>update</em>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span><span class="o">=</span><span class="mi">2</span>
<span class="n">n</span><span class="o">=</span><span class="mi">5</span>
<span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">n</span>
<span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="n">alpha</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[-1, 0, -5, -4, -3]
</pre></div>
</div>
</div>
</div>
<div class="admonition-comentario admonition">
<p class="admonition-title">Comentario</p>
<p>La operación de producto punto y <em>saxpy</em> son algoritmos catalogados como de <strong>nivel BLAS 1</strong>, ver <a class="reference external" href="https://en.wikipedia.org/wiki/Basic_Linear_Algebra_Subprograms">BLAS: Basic Linear Algebra Subprograms</a>. Éstos algoritmos se caracterizan por involucrar una cantidad de trabajo lineal sobre una cantidad lineal de datos. Ver <a class="reference external" href="http://www.netlib.org/blas/#_level_1">level 1</a> para más ejemplos de este tipo de algoritmos.</p>
</div>
</div>
<div class="section" id="operacion-de-multiplicacion-matriz-vector-nivel-2-de-blas">
<h3>Operación de multiplicación matriz-vector (nivel 2 de BLAS)<a class="headerlink" href="#operacion-de-multiplicacion-matriz-vector-nivel-2-de-blas" title="Permalink to this headline">¶</a></h3>
<p>Consideramos <span class="math notranslate nohighlight">\(A \in \mathbb{R}^{m \times n}, x \in \mathbb{R}^n, y \in \mathbb{R}^m\)</span>. La operación <span class="math notranslate nohighlight">\(y = y + Ax\)</span> es una operación <em>generalizada</em> saxpy, por ello se denomina <strong>gaxpy</strong> pero en LAPACK podemos encontrarla con nombres como <a class="reference external" href="http://www.netlib.org/lapack/explore-html/db/d58/sgemv_8f.html">sgemv</a>, <a class="reference external" href="http://www.netlib.org/lapack/explore-html/dc/da8/dgemv_8f.html">dgemv</a>, <a class="reference external" href="http://www.netlib.org/lapack/explore-html/d4/d8a/cgemv_8f.html">cgemv</a> o <a class="reference external" href="http://www.netlib.org/lapack/explore-html/db/d40/zgemv_8f.html">zgemv</a> para los casos de precisión simple, doble o números complejos respectivamente. Hay diferentes formas de visualizar y escribir el algoritmo de multiplicación matriz-vector. Por ejemplo para una matriz <span class="math notranslate nohighlight">\(A\)</span> con entradas:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span><span class="o">=</span><span class="mi">2</span>
<span class="n">n</span><span class="o">=</span><span class="mi">5</span>
<span class="n">A</span><span class="o">=</span><span class="p">[[</span><span class="mf">1.2</span><span class="p">]</span><span class="o">*</span><span class="n">n</span> <span class="k">if</span> <span class="n">i</span><span class="o">%</span><span class="k">2</span>==0 else [1]*n for i in range(m)]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[1.2, 1.2, 1.2, 1.2, 1.2], [1, 1, 1, 1, 1]]
</pre></div>
</div>
</div>
</div>
<p>se tiene:</p>
</div>
<div class="section" id="ejemplo-y-algoritmo-gaxpy-row-oriented">
<h3>Ejemplo y algoritmo gaxpy <em>row oriented</em><a class="headerlink" href="#ejemplo-y-algoritmo-gaxpy-row-oriented" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">n</span>
<span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">m</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+=</span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[12.0, 10]
</pre></div>
</div>
</div>
</div>
<p>Si <span class="math notranslate nohighlight">\(y\)</span> tiene valores distintos de <span class="math notranslate nohighlight">\(0\)</span>, se realiza un <em>update</em>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">n</span>
<span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">m</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+=</span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[11.0, 9]
</pre></div>
</div>
</div>
</div>
<div class="admonition-comentarios admonition">
<p class="admonition-title">Comentarios</p>
<ul class="simple">
<li><p>En la versión <em>row oriented</em> del algoritmo <em>gaxpy</em>, el <strong>inner loop</strong> realiza <strong>productos punto</strong> entre el <span class="math notranslate nohighlight">\(i\)</span>-ésimo renglón de <span class="math notranslate nohighlight">\(A\)</span> y el vector <span class="math notranslate nohighlight">\(x\)</span>. Se realizan <span class="math notranslate nohighlight">\(m\)</span> productos punto <span class="math notranslate nohighlight">\(A[i,:]^Tx\)</span></p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
    <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+=</span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span><span class="o">*</span><span class="n">x</span> <span class="c1">#producto punto</span>
    
</pre></div>
</div>
<p>donde: <span class="math notranslate nohighlight">\(A[i,:]\)</span> es el <span class="math notranslate nohighlight">\(i\)</span>-ésimo renglón de <span class="math notranslate nohighlight">\(A\)</span>. Así podemos reescribir de forma más compacta este algoritmo.</p>
<ul class="simple">
<li><p>Obsérvese que el acceso a la matriz <span class="math notranslate nohighlight">\(A\)</span> del algoritmo <em>gaxpy row oriented</em> es <strong>por renglón</strong>.</p></li>
</ul>
</div>
<p>También puede escribirse al algoritmo <em>gaxpy</em> en una forma orientada por columnas.</p>
</div>
<div class="section" id="ejemplo-y-algoritmo-gaxpy-column-oriented">
<h3>Ejemplo y algoritmo gaxpy <em>column oriented</em><a class="headerlink" href="#ejemplo-y-algoritmo-gaxpy-column-oriented" title="Permalink to this headline">¶</a></h3>
<p>Este algoritmo ayuda a visualizar al producto matriz-vector como una combinación lineal de las columnas de <span class="math notranslate nohighlight">\(A\)</span>:</p>
<div class="math notranslate nohighlight">
\[Ax = \displaystyle \sum_{j=1}^n A_jx_j\]</div>
<p>con <span class="math notranslate nohighlight">\(A_j\)</span> la <span class="math notranslate nohighlight">\(j\)</span>-ésima columna de <span class="math notranslate nohighlight">\(A\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">n</span>
<span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">m</span>
<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
        <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+=</span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[12.0, 10]
</pre></div>
</div>
</div>
</div>
<div class="admonition-comentarios admonition">
<p class="admonition-title">Comentarios</p>
<ul class="simple">
<li><p>El algoritmo de multiplicación matriz-vector (versión <em>row</em> o <em>column</em> oriented) involucra <span class="math notranslate nohighlight">\(\mathcal{O}(mn)\)</span> operaciones o una cantidad <strong>cuadrática</strong> de trabajo, que podemos entender como “si duplicamos cada dimensión de <span class="math notranslate nohighlight">\(A\)</span> entonces la cantidad de trabajo se incrementa por un factor de <span class="math notranslate nohighlight">\(4\)</span>”. Tal número de operaciones trabajan sobre una matriz o sobre una cantidad <strong>cuadrática</strong> de datos. A los algoritmos que realizan una cantidad cuadrática de trabajo sobre una cantidad cuadrática de datos se les cataloga de <strong>nivel BLAS 2</strong>. Ver <a class="reference external" href="http://www.netlib.org/blas/#_level_2">level 2</a> para más ejemplos de algoritmos en el álgebra lineal en esta categoría.</p></li>
<li><p>En el algoritmo <em>gaxpy column oriented</em> el acceso a la matriz <span class="math notranslate nohighlight">\(A\)</span> es por columna.</p></li>
<li><p>La versión <em>column oriented</em> se puede analizar desde el punto de vista puramente algorítmico como un intercambio entre las líneas con los índices <span class="math notranslate nohighlight">\(i\)</span> y <span class="math notranslate nohighlight">\(j\)</span> de cada <em>loop</em> y un acceso a los datos de la matriz por columna. O bien, se puede analizar desde el álgebra lineal indicando que el vector <span class="math notranslate nohighlight">\(y\)</span> está en el espacio generado por las columnas de <span class="math notranslate nohighlight">\(A\)</span> y cuyas coordenadas son dadas por las entradas del vector <span class="math notranslate nohighlight">\(x\)</span>:</p></li>
</ul>
<img src="https://dl.dropboxusercontent.com/s/6a2b7rjs4a71sni/combinacion_lineal_columnas_A.png?dl=0" heigth="700" width="700">
<ul class="simple">
<li><p>Obsérvese que el <strong>inner loop</strong> de la versión <em>column oriented</em> en <em>gaxpy</em> es un <strong>saxpy</strong> en la que el escalar está dado por una entrada de <span class="math notranslate nohighlight">\(x\)</span>. Esto lo podemos escribir de forma explícita definiendo <span class="math notranslate nohighlight">\(A[:,j]\)</span> a la <span class="math notranslate nohighlight">\(j\)</span>-ésima columna de <span class="math notranslate nohighlight">\(A\)</span> por lo que <span class="math notranslate nohighlight">\(A = [A[:,1] | A[:,2] | \dots | A[:,n]]\)</span>, entonces:</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="n">y</span><span class="o">+=</span><span class="n">A</span><span class="p">[:,</span><span class="n">j</span><span class="p">]</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
 
</pre></div>
</div>
<p>sin embargo como hemos visto en Python con su implementación más común CPython, no es posible realizar tal indexado:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">n</span>
<span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">m</span>
<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">y</span><span class="o">+=</span><span class="n">A</span><span class="p">[:,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
</pre></div>
</div>
<p>resulta en el error:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="ne">TypeError</span>                                 <span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">)</span>
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">17</span><span class="o">-</span><span class="mi">93</span><span class="n">f449af9194</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
      <span class="mi">2</span> <span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">m</span>
      <span class="mi">3</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
<span class="o">----&gt;</span> <span class="mi">4</span>     <span class="n">y</span><span class="o">+=</span><span class="n">A</span><span class="p">[:,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>

<span class="ne">TypeError</span><span class="p">:</span> <span class="nb">list</span> <span class="n">indices</span> <span class="n">must</span> <span class="n">be</span> <span class="n">integers</span> <span class="ow">or</span> <span class="n">slices</span><span class="p">,</span> <span class="ow">not</span> <span class="nb">tuple</span>

</pre></div>
</div>
<p>a menos que incorporemos alguna paquetería que permita la <strong>vectorización</strong> y el uso de índices para extracción de columnas (o renglones) de <span class="math notranslate nohighlight">\(A\)</span> como <em>NumPy</em>.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2. 2. 2. 2. 2.]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0. 0.]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.2</span><span class="p">,</span><span class="mf">1.2</span><span class="p">,</span><span class="mf">1.2</span><span class="p">,</span><span class="mf">1.2</span><span class="p">,</span><span class="mf">1.2</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[1.2 1.2 1.2 1.2 1.2]
 [1.  1.  1.  1.  1. ]]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">y</span><span class="o">+=</span><span class="n">A</span><span class="p">[:,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[12. 10.]
</pre></div>
</div>
</div>
</div>
<p>El algoritmo <em>gaxpy row oriented</em> puede escribirse de forma más compacta haciendo uso de la definición de producto punto estándar: <span class="math notranslate nohighlight">\(x^Ty\)</span> para dos vectores columna <span class="math notranslate nohighlight">\(x\)</span> y <span class="math notranslate nohighlight">\(y\)</span>. En el caso de una matriz <span class="math notranslate nohighlight">\(A\)</span> se tiene:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">:</span><span class="n">m</span>
    <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+=</span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span><span class="o">^</span><span class="n">T</span><span class="o">*</span><span class="n">x</span>
</pre></div>
</div>
<p>donde: <span class="math notranslate nohighlight">\(A[i,:]\)</span> es el <span class="math notranslate nohighlight">\(i\)</span>-ésimo renglón de <span class="math notranslate nohighlight">\(A\)</span>. En <em>Python</em>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="n">A</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.2</span><span class="p">,</span><span class="mf">1.2</span><span class="p">,</span><span class="mf">1.2</span><span class="p">,</span><span class="mf">1.2</span><span class="p">,</span><span class="mf">1.2</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
    <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+=</span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[12. 10.]
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="openblas-y-numpy">
<h3>OpenBLAS y <em>NumPy</em><a class="headerlink" href="#openblas-y-numpy" title="Permalink to this headline">¶</a></h3>
<p>En esta sección se sugiere para reproducibilidad de resultados utilizar la <em>AMI</em> descrita al inicio y la <em>AMI</em> <code class="docutils literal notranslate"><span class="pre">opt2-aws-educate-no-openblas-04-04-2021</span></code> de la región <code class="docutils literal notranslate"><span class="pre">us-east-1</span></code> (Virginia) en una máquina <code class="docutils literal notranslate"><span class="pre">m4.16xlarge</span></code> de la nube de <a class="reference external" href="https://aws.amazon.com/">AWS</a>. Tal AMI se construyó a partir de una <em>AMI</em> <code class="docutils literal notranslate"><span class="pre">ubuntu</span> <span class="pre">20.04</span> <span class="pre">-</span> <span class="pre">ami-042e8287309f5df03</span></code> con el <a class="reference external" href="https://github.com/palmoreck/scripts_for_useful_tools_installations/blob/main/AWS/ubuntu_20.04/optimizacion_2/script_no_OpenBLAS.sh">script_no_OpenBLAS.sh</a></p>
<div class="admonition-comentario admonition">
<p class="admonition-title">Comentario</p>
<p>Si se utiliza la <em>AMI</em> <code class="docutils literal notranslate"><span class="pre">opt2-aws-educate-no-openblas-04-04-2021</span></code> colocar en <code class="docutils literal notranslate"><span class="pre">User</span> <span class="pre">data</span></code> el siguiente <em>script</em>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/bin/bash</span>
<span class="c1">##variables:</span>
<span class="nv">region</span><span class="o">=</span>us-east-1 <span class="c1">#make sure instance is in Virginia</span>
<span class="nv">name_instance</span><span class="o">=</span>no-OpenBLAS
<span class="nv">USER</span><span class="o">=</span>ubuntu
<span class="c1">##System update</span>
apt-get update -yq
<span class="c1">##Tag instance</span>
<span class="nv">INSTANCE_ID</span><span class="o">=</span><span class="k">$(</span>curl -s http://instance-data/latest/meta-data/instance-id<span class="k">)</span>
<span class="nv">PUBLIC_IP</span><span class="o">=</span><span class="k">$(</span>curl -s http://instance-data/latest/meta-data/public-ipv4<span class="k">)</span>
sudo -H -u <span class="nv">$USER</span> bash -c <span class="s2">&quot;/home/</span><span class="nv">$USER</span><span class="s2">/.local/bin/aws ec2 create-tags --resources </span><span class="nv">$INSTANCE_ID</span><span class="s2"> --tag Key=Name,Value=</span><span class="nv">$name_instance</span><span class="s2">-</span><span class="nv">$PUBLIC_IP</span><span class="s2"> --region=</span><span class="nv">$region</span><span class="s2">&quot;</span>
sudo -H -u <span class="nv">$USER</span> bash -c <span class="s2">&quot;cd / &amp;&amp; /home/</span><span class="nv">$USER</span><span class="s2">/.local/bin/jupyter lab --ip=0.0.0.0 --no-browser --config=/home/</span><span class="nv">$USER</span><span class="s2">/.jupyter/jupyter_notebook_config.py &amp;&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="resultados-utilizando-opt2-aws-educate-openblas-04-04-2021">
<h3>Resultados utilizando <code class="docutils literal notranslate"><span class="pre">opt2-aws-educate-openblas-04-04-2021</span></code><a class="headerlink" href="#resultados-utilizando-opt2-aws-educate-openblas-04-04-2021" title="Permalink to this headline">¶</a></h3>
<p>Verificamos que <em>NumPy</em> está usando la implementación de la API de BLAS con OpenBLAS que se obtiene con <code class="docutils literal notranslate"><span class="pre">sudo</span> <span class="pre">apt-get</span> <span class="pre">install</span> <span class="pre">-y</span> <span class="pre">libopenblas-dev</span></code> (ver <a class="reference external" href="https://github.com/palmoreck/scripts_for_useful_tools_installations/blob/main/AWS/ubuntu_20.04/optimizacion_2/script_profiling_and_BLAS.sh">script_profiling_and_BLAS.sh</a>, <a class="reference external" href="https://github.com/palmoreck/scripts_for_useful_tools_installations/blob/main/AWS/ubuntu_20.04/optimizacion_2/script_no_OpenBLAS.sh">script_no_OpenBLAS.sh</a>)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">show_config</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>blas_mkl_info:
  NOT AVAILABLE
blis_info:
  NOT AVAILABLE
openblas_info:
    libraries = [&#39;openblas&#39;, &#39;openblas&#39;]
    library_dirs = [&#39;/usr/lib/x86_64-linux-gnu&#39;]
    language = c
    define_macros = [(&#39;HAVE_CBLAS&#39;, None)]
blas_opt_info:
    libraries = [&#39;openblas&#39;, &#39;openblas&#39;]
    library_dirs = [&#39;/usr/lib/x86_64-linux-gnu&#39;]
    language = c
    define_macros = [(&#39;HAVE_CBLAS&#39;, None)]
lapack_mkl_info:
  NOT AVAILABLE
openblas_lapack_info:
    libraries = [&#39;openblas&#39;, &#39;openblas&#39;]
    library_dirs = [&#39;/usr/lib/x86_64-linux-gnu&#39;]
    language = c
    define_macros = [(&#39;HAVE_CBLAS&#39;, None)]
lapack_opt_info:
    libraries = [&#39;openblas&#39;, &#39;openblas&#39;]
    library_dirs = [&#39;/usr/lib/x86_64-linux-gnu&#39;]
    language = c
    define_macros = [(&#39;HAVE_CBLAS&#39;, None)]
None
</pre></div>
</div>
</div>
</div>
<p>Hacemos una prueba de medición de tiempos:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">2020</span><span class="p">)</span>
<span class="n">m</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="mi">4</span>
<span class="n">r</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="mi">4</span>

<span class="n">A</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">r</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">2021</span><span class="p">)</span>
<span class="n">r</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="mi">4</span>
<span class="n">n</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="mi">4</span>

<span class="n">B</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="tip admonition">
<p class="admonition-title">Observación</p>
<p>Mientras se ejecuta la siguiente celda se sugiere en la terminal ejecutar en la línea de comando <code class="docutils literal notranslate"><span class="pre">htop</span></code>.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">timeit</span> -n 1 -r 7 A@B
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2.96 s ± 149 ms per loop (mean ± std. dev. of 2 runs, 1 loop each)
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="resultados-utilizando-opt2-aws-educate-no-openblas-04-04-2021">
<h3>Resultados utilizando <code class="docutils literal notranslate"><span class="pre">opt2-aws-educate-no-openblas-04-04-2021</span></code><a class="headerlink" href="#resultados-utilizando-opt2-aws-educate-no-openblas-04-04-2021" title="Permalink to this headline">¶</a></h3>
<p>Verificamos que <em>NumPy</em> <strong>no</strong> está usando la implementación de la API de BLAS con OpenBLAS que se obtiene con <code class="docutils literal notranslate"><span class="pre">sudo</span> <span class="pre">apt-get</span> <span class="pre">install</span> <span class="pre">-y</span> <span class="pre">libopenblas-dev</span></code> (ver <a class="reference external" href="https://github.com/palmoreck/scripts_for_useful_tools_installations/blob/main/AWS/ubuntu_20.04/optimizacion_2/script_profiling_and_BLAS.sh">script_profiling_and_BLAS.sh</a>, <a class="reference external" href="https://github.com/palmoreck/scripts_for_useful_tools_installations/blob/main/AWS/ubuntu_20.04/optimizacion_2/script_no_OpenBLAS.sh">script_no_OpenBLAS.sh</a>)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">show_config</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>blas_mkl_info:
  NOT AVAILABLE
blis_info:
  NOT AVAILABLE
openblas_info:
    libraries = [&#39;openblas&#39;, &#39;openblas&#39;]
    library_dirs = [&#39;/usr/local/lib&#39;]
    language = c
    define_macros = [(&#39;HAVE_CBLAS&#39;, None)]
blas_opt_info:
    libraries = [&#39;openblas&#39;, &#39;openblas&#39;]
    library_dirs = [&#39;/usr/local/lib&#39;]
    language = c
    define_macros = [(&#39;HAVE_CBLAS&#39;, None)]
lapack_mkl_info:
  NOT AVAILABLE
openblas_lapack_info:
    libraries = [&#39;openblas&#39;, &#39;openblas&#39;]
    library_dirs = [&#39;/usr/local/lib&#39;]
    language = c
    define_macros = [(&#39;HAVE_CBLAS&#39;, None)]
lapack_opt_info:
    libraries = [&#39;openblas&#39;, &#39;openblas&#39;]
    library_dirs = [&#39;/usr/local/lib&#39;]
    language = c
    define_macros = [(&#39;HAVE_CBLAS&#39;, None)]
None
</pre></div>
</div>
</div>
</div>
<p>Hacemos una prueba de medición de tiempos:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">2020</span><span class="p">)</span>
<span class="n">m</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="mi">4</span>
<span class="n">r</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="mi">4</span>

<span class="n">A</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">r</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">2021</span><span class="p">)</span>
<span class="n">r</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="mi">4</span>
<span class="n">n</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="mi">4</span>

<span class="n">B</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="tip admonition">
<p class="admonition-title">Observación</p>
<p>Mientras se ejecuta la siguiente celda se sugiere en la terminal ejecutar en la línea de comando <code class="docutils literal notranslate"><span class="pre">htop</span></code>.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">timeit</span> -n 1 -r 7 A@B
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3.22 s ± 167 ms per loop (mean ± std. dev. of 7 runs, 1 loop each)
</pre></div>
</div>
</div>
</div>
<div class="admonition-comentarios admonition">
<p class="admonition-title">Comentarios</p>
<ul class="simple">
<li><p>La implementación de la API de BLAS con OpenBLAS que se instala mediante <code class="docutils literal notranslate"><span class="pre">sudo</span> <span class="pre">apt-get</span> <span class="pre">install</span> <span class="pre">-y</span> <span class="pre">libopenblas-dev</span></code> y <em>NumPy</em> instalado vía <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">numpy</span> <span class="pre">--no-binary</span> <span class="pre">numpy</span></code> resulta para el algoritmo de multiplicación de matrices ser un poco más rápido que con la implementación de la API de BLAS integrada en la instalación de <em>NumPy</em> vía <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">numpy</span></code>.</p></li>
<li><p>Más <em>cores</em> reducen el tiempo de cómputo, para ver esto probar lo anterior con máquinas con menos <em>cores</em>.</p></li>
</ul>
</div>
</div>
<div class="section" id="openblas-y-librerias-de-computo-matricial-de-r">
<h3>OpenBLAS y librerías de cómputo matricial de <em>R</em><a class="headerlink" href="#openblas-y-librerias-de-computo-matricial-de-r" title="Permalink to this headline">¶</a></h3>
<p>En esta sección se sugiere para reproducibilidad de resultados utilizar la <em>AMI</em> descrita al inicio y la <em>AMI</em> <code class="docutils literal notranslate"><span class="pre">opt2-aws-educate-no-openblas-04-04-2021</span></code> de la región <code class="docutils literal notranslate"><span class="pre">us-east-1</span></code> (Virginia) en una máquina <code class="docutils literal notranslate"><span class="pre">m4.16xlarge</span></code> de la nube de <a class="reference external" href="https://aws.amazon.com/">AWS</a>. Tal AMI se construyó a partir de una <em>AMI</em> <code class="docutils literal notranslate"><span class="pre">ubuntu</span> <span class="pre">20.04</span> <span class="pre">-</span> <span class="pre">ami-042e8287309f5df03</span></code> con el <a class="reference external" href="https://github.com/palmoreck/scripts_for_useful_tools_installations/blob/main/AWS/ubuntu_20.04/optimizacion_2/script_no_OpenBLAS.sh">script_no_OpenBLAS.sh</a></p>
<div class="admonition-comentario admonition">
<p class="admonition-title">Comentario</p>
<p>Si se utiliza la <em>AMI</em> <code class="docutils literal notranslate"><span class="pre">opt2-aws-educate-no-openblas-04-04-2021</span></code> colocar en <code class="docutils literal notranslate"><span class="pre">User</span> <span class="pre">data</span></code> el siguiente <em>script</em>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/bin/bash</span>
<span class="c1">##variables:</span>
<span class="nv">region</span><span class="o">=</span>us-east-1 <span class="c1">#make sure instance is in Virginia</span>
<span class="nv">name_instance</span><span class="o">=</span>no-OpenBLAS
<span class="nv">USER</span><span class="o">=</span>ubuntu
<span class="c1">##System update</span>
apt-get update -yq
<span class="c1">##Tag instance</span>
<span class="nv">INSTANCE_ID</span><span class="o">=</span><span class="k">$(</span>curl -s http://instance-data/latest/meta-data/instance-id<span class="k">)</span>
<span class="nv">PUBLIC_IP</span><span class="o">=</span><span class="k">$(</span>curl -s http://instance-data/latest/meta-data/public-ipv4<span class="k">)</span>
sudo -H -u <span class="nv">$USER</span> bash -c <span class="s2">&quot;/home/</span><span class="nv">$USER</span><span class="s2">/.local/bin/aws ec2 create-tags --resources </span><span class="nv">$INSTANCE_ID</span><span class="s2"> --tag Key=Name,Value=</span><span class="nv">$name_instance</span><span class="s2">-</span><span class="nv">$PUBLIC_IP</span><span class="s2"> --region=</span><span class="nv">$region</span><span class="s2">&quot;</span>
sudo -H -u <span class="nv">$USER</span> bash -c <span class="s2">&quot;cd / &amp;&amp; /home/</span><span class="nv">$USER</span><span class="s2">/.local/bin/jupyter lab --ip=0.0.0.0 --no-browser --config=/home/</span><span class="nv">$USER</span><span class="s2">/.jupyter/jupyter_notebook_config.py &amp;&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="id2">
<h3>Resultados utilizando <code class="docutils literal notranslate"><span class="pre">opt2-aws-educate-openblas-04-04-2021</span></code><a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<p>Verificamos que las librerías de cómputo matricial de <em>R</em> están usando la implementación de la API de BLAS con OpenBLAS que se obtiene con <code class="docutils literal notranslate"><span class="pre">sudo</span> <span class="pre">apt-get</span> <span class="pre">install</span> <span class="pre">-y</span> <span class="pre">libopenblas-dev</span></code> (ver <a class="reference external" href="https://github.com/palmoreck/scripts_for_useful_tools_installations/blob/main/AWS/ubuntu_20.04/optimizacion_2/script_profiling_and_BLAS.sh">script_profiling_and_BLAS.sh</a>, <a class="reference external" href="https://github.com/palmoreck/scripts_for_useful_tools_installations/blob/main/AWS/ubuntu_20.04/optimizacion_2/script_no_OpenBLAS.sh">script_no_OpenBLAS.sh</a>)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sessionInfo</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>R version 4.0.5 (2021-03-31)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.2 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3
LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/liblapack.so.3

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

loaded via a namespace (and not attached):
 [1] fansi_0.4.2         digest_0.6.27       utf8_1.2.1         
 [4] crayon_1.4.1        IRdisplay_1.0       repr_1.1.3         
 [7] lifecycle_1.0.0     jsonlite_1.7.2      evaluate_0.14      
[10] pillar_1.5.1        rlang_0.4.10        uuid_0.1-4         
[13] ellipsis_0.3.1      IRkernel_1.1.1.9000 tools_4.0.5        
[16] compiler_4.0.5      base64enc_0.1-3     pbdZMQ_0.3-5       
[19] htmltools_0.5.1.1  
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">set</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">2020</span><span class="p">)</span>
<span class="n">m</span><span class="o">&lt;-</span><span class="mi">10</span><span class="o">**</span><span class="mi">4</span>
<span class="n">r</span><span class="o">&lt;-</span><span class="mi">10</span><span class="o">**</span><span class="mi">4</span>
<span class="n">A</span> <span class="o">&lt;-</span> <span class="n">matrix</span><span class="p">(</span><span class="n">runif</span><span class="p">(</span><span class="n">m</span><span class="o">*</span><span class="n">r</span><span class="p">),</span> <span class="n">m</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">set</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">2021</span><span class="p">)</span>
<span class="n">r</span><span class="o">&lt;-</span><span class="mi">10</span><span class="o">**</span><span class="mi">4</span>
<span class="n">n</span><span class="o">&lt;-</span><span class="mi">10</span><span class="o">**</span><span class="mi">4</span>
<span class="n">B</span> <span class="o">&lt;-</span> <span class="n">matrix</span><span class="p">(</span><span class="n">runif</span><span class="p">(</span><span class="n">r</span><span class="o">*</span><span class="n">n</span><span class="p">),</span> <span class="n">r</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">library</span><span class="p">(</span><span class="n">microbenchmark</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="admonition-comentario admonition">
<p class="admonition-title">Comentario</p>
<p>El paquete de <a class="reference external" href="https://www.rdocumentation.org/packages/microbenchmark/versions/1.4-7/topics/microbenchmark">microbenchmark</a> nos ayuda a la medición de estadísticas para pequeñas piezas de código.</p>
</div>
<div class="tip admonition">
<p class="admonition-title">Observación</p>
<p>Mientras se ejecuta la siguiente celda se sugiere en la terminal ejecutar en la línea de comando <code class="docutils literal notranslate"><span class="pre">htop</span></code>.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mbk</span><span class="o">&lt;-</span><span class="n">microbenchmark</span><span class="p">(</span>
    <span class="n">A</span><span class="o">%*%</span><span class="k">B</span>,
    <span class="n">times</span><span class="o">=</span><span class="mi">7</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">mbk</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Unit: seconds
    expr      min       lq     mean   median       uq      max neval
 A %*% B 2.600818 2.723897 2.952135 2.833146 3.038394 3.706399     7
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id3">
<h3>Resultados utilizando <code class="docutils literal notranslate"><span class="pre">opt2-aws-educate-no-openblas-04-04-2021</span></code><a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<p>Verificamos que las librerías de cómputo matricial de <em>R</em> <strong>no</strong> están usando la implementación de la API de BLAS con OpenBLAS que se obtiene con <code class="docutils literal notranslate"><span class="pre">sudo</span> <span class="pre">apt-get</span> <span class="pre">install</span> <span class="pre">-y</span> <span class="pre">libopenblas-dev</span></code> (ver <a class="reference external" href="https://github.com/palmoreck/scripts_for_useful_tools_installations/blob/main/AWS/ubuntu_20.04/optimizacion_2/script_profiling_and_BLAS.sh">script_profiling_and_BLAS.sh</a>, <a class="reference external" href="https://github.com/palmoreck/scripts_for_useful_tools_installations/blob/main/AWS/ubuntu_20.04/optimizacion_2/script_no_OpenBLAS.sh">script_no_OpenBLAS.sh</a>)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sessionInfo</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>R version 4.0.5 (2021-03-31)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.2 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

loaded via a namespace (and not attached):
 [1] fansi_0.4.2         digest_0.6.27       utf8_1.2.1         
 [4] crayon_1.4.1        IRdisplay_1.0       repr_1.1.3         
 [7] lifecycle_1.0.0     jsonlite_1.7.2      evaluate_0.14      
[10] pillar_1.5.1        rlang_0.4.10        uuid_0.1-4         
[13] ellipsis_0.3.1      IRkernel_1.1.1.9000 tools_4.0.5        
[16] compiler_4.0.5      base64enc_0.1-3     pbdZMQ_0.3-5       
[19] htmltools_0.5.1.1  
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">set</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">2020</span><span class="p">)</span>
<span class="n">m</span><span class="o">&lt;-</span><span class="mi">10</span><span class="o">**</span><span class="mi">4</span>
<span class="n">r</span><span class="o">&lt;-</span><span class="mi">10</span><span class="o">**</span><span class="mi">4</span>
<span class="n">A</span> <span class="o">&lt;-</span> <span class="n">matrix</span><span class="p">(</span><span class="n">runif</span><span class="p">(</span><span class="n">m</span><span class="o">*</span><span class="n">r</span><span class="p">),</span> <span class="n">m</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">set</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">2021</span><span class="p">)</span>
<span class="n">r</span><span class="o">&lt;-</span><span class="mi">10</span><span class="o">**</span><span class="mi">4</span>
<span class="n">n</span><span class="o">&lt;-</span><span class="mi">10</span><span class="o">**</span><span class="mi">4</span>
<span class="n">B</span> <span class="o">&lt;-</span> <span class="n">matrix</span><span class="p">(</span><span class="n">runif</span><span class="p">(</span><span class="n">r</span><span class="o">*</span><span class="n">n</span><span class="p">),</span> <span class="n">r</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">library</span><span class="p">(</span><span class="n">microbenchmark</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="tip admonition">
<p class="admonition-title">Observación</p>
<p>Mientras se ejecuta la siguiente celda se sugiere en la terminal ejecutar en la línea de comando <code class="docutils literal notranslate"><span class="pre">htop</span></code>.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mbk</span><span class="o">&lt;-</span><span class="n">microbenchmark</span><span class="p">(</span>
    <span class="n">A</span><span class="o">%*%</span><span class="k">B</span>,
    <span class="n">times</span><span class="o">=</span><span class="mi">1</span> <span class="c1">#just one time as it takes too much time</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">mbk</span><span class="p">)</span> <span class="c1">#after ten minutes didnt finish</span>
</pre></div>
</div>
</div>
</div>
<div class="admonition-comentarios admonition">
<p class="admonition-title">Comentarios</p>
<ul class="simple">
<li><p>La implementación de la API de BLAS con OpenBLAS que se instala mediante <code class="docutils literal notranslate"><span class="pre">sudo</span> <span class="pre">apt-get</span> <span class="pre">install</span> <span class="pre">-y</span> <span class="pre">libopenblas-dev</span></code> y las librerías de cómputo matricial de <em>R</em> que utilizan tal instalación resulta para el algoritmo de multiplicación de matrices ser mucho más rápido que con la implementación de la API de BLAS integrada en la instalación de <em>R</em>.</p></li>
<li><p>Más <em>cores</em> reducen el tiempo de cómputo, para ver esto probar lo anterior con máquinas con menos <em>cores</em>.</p></li>
</ul>
</div>
</div>
</div>
<div class="section" id="perfilamiento-medicion-de-tiempo-en-el-sistema-operativo-ubuntu-20-04">
<h2>Perfilamiento: medición de tiempo en el sistema operativo Ubuntu 20.04<a class="headerlink" href="#perfilamiento-medicion-de-tiempo-en-el-sistema-operativo-ubuntu-20-04" title="Permalink to this headline">¶</a></h2>
<div class="section" id="usr-bin-time">
<h3><a class="reference external" href="http://manpages.ubuntu.com/manpages/focal/man1/time.1.html">/usr/bin/time</a><a class="headerlink" href="#usr-bin-time" title="Permalink to this headline">¶</a></h3>
<p>Ver también: <a class="reference external" href="https://en.wikipedia.org/wiki/Time_(Unix)">Wikipedia: Time_Unix</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%file</span> Rcf.py
<span class="kn">import</span> <span class="nn">math</span>

<span class="kn">from</span> <span class="nn">pytest</span> <span class="kn">import</span> <span class="n">approx</span>
<span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">quad</span>
<span class="k">def</span> <span class="nf">Rcf</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">n</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute numerical approximation using rectangle or mid-point</span>
<span class="sd">    method in an interval.</span>
<span class="sd">    Nodes are generated via formula: x_i = a+(i+1/2)h_hat for</span>
<span class="sd">    i=0,1,...,n-1 and h_hat=(b-a)/n</span>
<span class="sd">    Args:</span>
<span class="sd">    </span>
<span class="sd">        f (function): function expression of integrand.</span>
<span class="sd">        </span>
<span class="sd">        a (float): left point of interval.</span>
<span class="sd">        </span>
<span class="sd">        b (float): right point of interval.</span>
<span class="sd">        </span>
<span class="sd">        n (float): number of subintervals.</span>
<span class="sd">        </span>
<span class="sd">    Returns:</span>
<span class="sd">    </span>
<span class="sd">        sum_res (float): numerical approximation to integral</span>
<span class="sd">            of f in the interval a,b</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">h_hat</span><span class="o">=</span><span class="p">(</span><span class="n">b</span><span class="o">-</span><span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="n">n</span>
    <span class="n">nodes</span><span class="o">=</span><span class="p">[</span><span class="n">a</span><span class="o">+</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">h_hat</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">n</span><span class="p">)]</span>
    <span class="n">sum_res</span><span class="o">=</span><span class="mi">0</span>
    <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">nodes</span><span class="p">:</span>
        <span class="n">sum_res</span><span class="o">=</span><span class="n">sum_res</span><span class="o">+</span><span class="n">f</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">h_hat</span><span class="o">*</span><span class="n">sum_res</span>
<span class="k">if</span> <span class="vm">__name__</span><span class="o">==</span><span class="s2">&quot;__main__&quot;</span><span class="p">:</span> <span class="c1">#añadimos este bloque para ejecución de la función Rcf</span>
    <span class="n">a</span><span class="o">=</span><span class="mi">0</span>
    <span class="n">b</span><span class="o">=</span><span class="mi">1</span>
    <span class="n">f</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">obj</span><span class="p">,</span> <span class="n">err</span> <span class="o">=</span> <span class="n">quad</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;objetivo: </span><span class="si">{:0.6e}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">obj</span><span class="p">))</span>
    <span class="n">n</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="mi">6</span>
    <span class="n">res</span><span class="o">=</span><span class="n">Rcf</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;aproximación: </span><span class="si">{:0.6e}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">res</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">res</span> <span class="o">==</span> <span class="n">approx</span><span class="p">(</span><span class="n">obj</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Writing Rcf.py
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">bash</span>
/usr/bin/time -p python3 Rcf.py
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>objetivo: 7.468241e-01
aproximación: 7.468241e-01
True
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>real 0.84
user 2.57
sys 2.20
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">bash</span>
/usr/bin/time -v python3 Rcf.py
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>objetivo: 7.468241e-01
aproximación: 7.468241e-01
True
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>	Command being timed: &quot;python3 Rcf.py&quot;
	User time (seconds): 2.55
	System time (seconds): 2.34
	Percent of CPU this job got: 612%
	Elapsed (wall clock) time (h:mm:ss or m:ss): 0:00.79
	Average shared text size (kbytes): 0
	Average unshared data size (kbytes): 0
	Average stack size (kbytes): 0
	Average total size (kbytes): 0
	Maximum resident set size (kbytes): 97688
	Average resident set size (kbytes): 0
	Major (requiring I/O) page faults: 0
	Minor (reclaiming a frame) page faults: 20846
	Voluntary context switches: 87
	Involuntary context switches: 877104
	Swaps: 0
	File system inputs: 0
	File system outputs: 0
	Socket messages sent: 0
	Socket messages received: 0
	Signals delivered: 0
	Page size (bytes): 4096
	Exit status: 0
</pre></div>
</div>
</div>
</div>
<div class="admonition-comentario admonition">
<p class="admonition-title">Comentario</p>
<p>Una breve explicación del <em>output</em> se puede encontrar <a class="reference external" href="http://manpages.ubuntu.com/manpages/focal/man1/time.1.html">/usr/bin/time</a>. Por ejemplo, para el caso de <code class="docutils literal notranslate"><span class="pre">Major</span> <span class="pre">(requiring</span> <span class="pre">I/O)</span></code> nos interesa que sea <span class="math notranslate nohighlight">\(0\)</span> pues indica que el sistema operativo tiene que cargar páginas de datos del disco pues tales datos ya no residen en RAM (por alguna razón).</p>
</div>
<div class="tip admonition">
<p class="admonition-title">Observación</p>
<p>La medición <code class="docutils literal notranslate"><span class="pre">real</span></code> que regresa <code class="docutils literal notranslate"><span class="pre">/usr/bin/time</span></code> es el equivalente al <code class="docutils literal notranslate"><span class="pre">Wall</span> <span class="pre">time</span></code> de <code class="docutils literal notranslate"><span class="pre">%time</span></code>.</p>
</div>
</div>
</div>
<div class="section" id="perfilamiento-medicion-de-uso-de-cpu-en-el-sistema-operativo-gnu-linux">
<h2>Perfilamiento: medición de uso de CPU en el sistema operativo GNU/Linux<a class="headerlink" href="#perfilamiento-medicion-de-uso-de-cpu-en-el-sistema-operativo-gnu-linux" title="Permalink to this headline">¶</a></h2>
<div class="section" id="perf">
<h3><a class="reference external" href="https://github.com/torvalds/linux/tree/master/tools/perf">perf</a><a class="headerlink" href="#perf" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="perf-openblas">
<h3>perf OpenBLAS<a class="headerlink" href="#perf-openblas" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%file</span> mult_matrix_matrix_numpy_openblas.py
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">m</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="mi">4</span>
<span class="n">r</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="mi">4</span>
<span class="n">n</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="mi">4</span>

<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">2020</span><span class="p">)</span>
<span class="n">m</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="mi">4</span>
<span class="n">r</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="mi">4</span>
<span class="n">A</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">r</span><span class="p">)</span>

<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">2021</span><span class="p">)</span>
<span class="n">r</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="mi">4</span>
<span class="n">n</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="mi">4</span>
<span class="n">B</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>

<span class="n">A</span><span class="nd">@B</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Writing mult_matrix_matrix_numpy_openblas.py
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">bash</span>
echo &quot;-1&quot; |sudo tee -a /proc/sys/kernel/perf_event_paranoid
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-1
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">bash</span>
perf stat -S -a --per-core -e cycles,instructions,cache-references,cache-misses -r 7 python3 mult_matrix_matrix_numpy_openblas.py
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> Performance counter stats for &#39;system wide&#39; (7 runs):

S0-D0-C0           2        18418711959      cycles                                                        (75.00%)
S0-D0-C0           2        18369720566      instructions              #    1.00  insn per cycle           (75.06%)
S0-D0-C0           2          537701642      cache-references                                              (75.06%)
S0-D0-C0           2           24051039      cache-misses              #    4.473 % of all cache refs      (75.02%)
S0-D0-C1           2        18196672426      cycles                                                        (75.03%)
S0-D0-C1           2        18408825312      instructions              #    1.01  insn per cycle           (75.06%)
S0-D0-C1           2          525743359      cache-references                                              (75.07%)
S0-D0-C1           2           23125192      cache-misses              #    4.399 % of all cache refs      (75.01%)
S0-D0-C2           2        17745013942      cycles                                                        (75.04%)
S0-D0-C2           2        18325997854      instructions              #    1.03  insn per cycle           (75.06%)
S0-D0-C2           2          526665812      cache-references                                              (75.05%)
S0-D0-C2           2           22407034      cache-misses              #    4.255 % of all cache refs      (75.01%)
S0-D0-C3           2        17121222047      cycles                                                        (75.04%)
S0-D0-C3           2        18146087876      instructions              #    1.06  insn per cycle           (75.06%)
S0-D0-C3           2          490965446      cache-references                                              (75.06%)
S0-D0-C3           2           26610387      cache-misses              #    5.420 % of all cache refs      (75.01%)
S0-D0-C4           2        16890058309      cycles                                                        (75.04%)
S0-D0-C4           2        17885504024      instructions              #    1.06  insn per cycle           (75.06%)
S0-D0-C4           2          487993921      cache-references                                              (75.05%)
S0-D0-C4           2           23144032      cache-misses              #    4.743 % of all cache refs      (75.01%)
S0-D0-C5           2        17199231962      cycles                                                        (75.03%)
S0-D0-C5           2        18263131622      instructions              #    1.06  insn per cycle           (75.06%)
S0-D0-C5           2          496088789      cache-references                                              (75.06%)
S0-D0-C5           2           21848774      cache-misses              #    4.404 % of all cache refs      (75.01%)
S0-D0-C6           2        16349945326      cycles                                                        (75.03%)
S0-D0-C6           2        17917357673      instructions              #    1.10  insn per cycle           (75.06%)
S0-D0-C6           2          479652808      cache-references                                              (75.06%)
S0-D0-C6           2           24499853      cache-misses              #    5.108 % of all cache refs      (75.01%)
S0-D0-C7           2        16412097276      cycles                                                        (75.03%)
S0-D0-C7           2        17611472168      instructions              #    1.07  insn per cycle           (75.06%)
S0-D0-C7           2          469719191      cache-references                                              (75.06%)
S0-D0-C7           2           21824081      cache-misses              #    4.646 % of all cache refs      (75.01%)
S0-D0-C8           2        15249556261      cycles                                                        (75.03%)
S0-D0-C8           2        16618749720      instructions              #    1.09  insn per cycle           (75.06%)
S0-D0-C8           2          455682584      cache-references                                              (75.06%)
S0-D0-C8           2           25286843      cache-misses              #    5.549 % of all cache refs      (75.02%)
S0-D0-C9           2        16231214981      cycles                                                        (75.03%)
S0-D0-C9           2        17646720887      instructions              #    1.09  insn per cycle           (75.05%)
S0-D0-C9           2          473228118      cache-references                                              (75.06%)
S0-D0-C9           2           19449589      cache-misses              #    4.110 % of all cache refs      (75.02%)
S0-D0-C10          2        15892959983      cycles                                                        (75.03%)
S0-D0-C10          2        17337209550      instructions              #    1.09  insn per cycle           (75.06%)
S0-D0-C10          2          469461284      cache-references                                              (75.06%)
S0-D0-C10          2           28237009      cache-misses              #    6.015 % of all cache refs      (75.01%)
S0-D0-C11          2        14874401788      cycles                                                        (75.04%)
S0-D0-C11          2        16217229463      instructions              #    1.09  insn per cycle           (75.06%)
S0-D0-C11          2          452670920      cache-references                                              (75.05%)
S0-D0-C11          2           21648129      cache-misses              #    4.782 % of all cache refs      (75.02%)
S0-D0-C12          2        14543839541      cycles                                                        (75.03%)
S0-D0-C12          2        15959236359      instructions              #    1.10  insn per cycle           (75.06%)
S0-D0-C12          2          441998264      cache-references                                              (75.06%)
S0-D0-C12          2           26386041      cache-misses              #    5.970 % of all cache refs      (75.02%)
S0-D0-C13          2        18262472756      cycles                                                        (75.03%)
S0-D0-C13          2        18538540372      instructions              #    1.02  insn per cycle           (75.06%)
S0-D0-C13          2          535986137      cache-references                                              (75.06%)
S0-D0-C13          2           28397666      cache-misses              #    5.298 % of all cache refs      (75.02%)
S0-D0-C14          2        13209247629      cycles                                                        (75.03%)
S0-D0-C14          2        15254857451      instructions              #    1.15  insn per cycle           (75.06%)
S0-D0-C14          2          410995623      cache-references                                              (75.06%)
S0-D0-C14          2           24991392      cache-misses              #    6.081 % of all cache refs      (75.02%)
S0-D0-C15          2        12118816441      cycles                                                        (75.03%)
S0-D0-C15          2        14453817862      instructions              #    1.19  insn per cycle           (75.05%)
S0-D0-C15          2          371089450      cache-references                                              (75.05%)
S0-D0-C15          2           22741899      cache-misses              #    6.128 % of all cache refs      (75.02%)
S1-D0-C0           2        18232984530      cycles                                                        (75.03%)
S1-D0-C0           2        18449109986      instructions              #    1.01  insn per cycle           (75.05%)
S1-D0-C0           2          519913031      cache-references                                              (75.06%)
S1-D0-C0           2           23752828      cache-misses              #    4.569 % of all cache refs      (75.02%)
S1-D0-C1           2        25269014354      cycles                                                        (75.03%)
S1-D0-C1           2        39384365171      instructions              #    1.56  insn per cycle           (75.06%)
S1-D0-C1           2          651968755      cache-references                                              (75.05%)
S1-D0-C1           2           38228051      cache-misses              #    5.863 % of all cache refs      (75.03%)
S1-D0-C2           2        18444454550      cycles                                                        (75.03%)
S1-D0-C2           2        21204362696      instructions              #    1.15  insn per cycle           (75.06%)
S1-D0-C2           2          621058606      cache-references                                              (75.06%)
S1-D0-C2           2           40990630      cache-misses              #    6.600 % of all cache refs      (75.02%)
S1-D0-C3           2        18278696053      cycles                                                        (75.03%)
S1-D0-C3           2        20067036382      instructions              #    1.10  insn per cycle           (75.06%)
S1-D0-C3           2          585310801      cache-references                                              (75.06%)
S1-D0-C3           2           31863601      cache-misses              #    5.444 % of all cache refs      (75.02%)
S1-D0-C4           2        18431841316      cycles                                                        (75.03%)
S1-D0-C4           2        18669484458      instructions              #    1.01  insn per cycle           (75.06%)
S1-D0-C4           2          528305336      cache-references                                              (75.05%)
S1-D0-C4           2           29086972      cache-misses              #    5.506 % of all cache refs      (75.03%)
S1-D0-C5           2        18460857989      cycles                                                        (75.03%)
S1-D0-C5           2        18836165277      instructions              #    1.02  insn per cycle           (75.05%)
S1-D0-C5           2          532097512      cache-references                                              (75.06%)
S1-D0-C5           2           29550365      cache-misses              #    5.554 % of all cache refs      (75.03%)
S1-D0-C6           2        18490159829      cycles                                                        (75.02%)
S1-D0-C6           2        18996196633      instructions              #    1.03  insn per cycle           (75.05%)
S1-D0-C6           2          537973011      cache-references                                              (75.06%)
S1-D0-C6           2           34758081      cache-misses              #    6.461 % of all cache refs      (75.03%)
S1-D0-C7           2        18393424333      cycles                                                        (75.03%)
S1-D0-C7           2        19082601979      instructions              #    1.04  insn per cycle           (75.05%)
S1-D0-C7           2          540775846      cache-references                                              (75.06%)
S1-D0-C7           2           30967762      cache-misses              #    5.727 % of all cache refs      (75.03%)
S1-D0-C8           2        18439236440      cycles                                                        (75.03%)
S1-D0-C8           2        18698390120      instructions              #    1.01  insn per cycle           (75.05%)
S1-D0-C8           2          532154105      cache-references                                              (75.05%)
S1-D0-C8           2           30098986      cache-misses              #    5.656 % of all cache refs      (75.03%)
S1-D0-C9           2        18393128954      cycles                                                        (75.02%)
S1-D0-C9           2        20510456724      instructions              #    1.12  insn per cycle           (75.06%)
S1-D0-C9           2          596975317      cache-references                                              (75.05%)
S1-D0-C9           2           32463279      cache-misses              #    5.438 % of all cache refs      (75.03%)
S1-D0-C10          2        18384672465      cycles                                                        (75.02%)
S1-D0-C10          2        18518315158      instructions              #    1.01  insn per cycle           (75.05%)
S1-D0-C10          2          518920459      cache-references                                              (75.06%)
S1-D0-C10          2           22063526      cache-misses              #    4.252 % of all cache refs      (75.04%)
S1-D0-C11          2        18321366651      cycles                                                        (75.02%)
S1-D0-C11          2        20344437281      instructions              #    1.11  insn per cycle           (75.04%)
S1-D0-C11          2          592757359      cache-references                                              (75.06%)
S1-D0-C11          2           28883791      cache-misses              #    4.873 % of all cache refs      (75.03%)
S1-D0-C12          2        18438219285      cycles                                                        (75.02%)
S1-D0-C12          2        18558196540      instructions              #    1.01  insn per cycle           (75.04%)
S1-D0-C12          2          509104381      cache-references                                              (75.06%)
S1-D0-C12          2           22171256      cache-misses              #    4.355 % of all cache refs      (75.03%)
S1-D0-C13          2        18307643489      cycles                                                        (75.02%)
S1-D0-C13          2        18400984979      instructions              #    1.01  insn per cycle           (75.04%)
S1-D0-C13          2          515663807      cache-references                                              (75.05%)
S1-D0-C13          2           24967988      cache-misses              #    4.842 % of all cache refs      (75.04%)
S1-D0-C14          2        18361935174      cycles                                                        (75.02%)
S1-D0-C14          2        20383885122      instructions              #    1.11  insn per cycle           (75.03%)
S1-D0-C14          2          587106108      cache-references                                              (75.06%)
S1-D0-C14          2           33154210      cache-misses              #    5.647 % of all cache refs      (75.04%)
S1-D0-C15          2        18346242027      cycles                                                        (75.05%)
S1-D0-C15          2        18387811753      instructions              #    1.00  insn per cycle           (75.04%)
S1-D0-C15          2          520851546      cache-references                                              (75.07%)
S1-D0-C15          2           21406519      cache-misses              #    4.110 % of all cache refs      (75.01%)

             5.944 +- 0.128 seconds time elapsed  ( +-  2.15% )
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="otras-herramientas-para-medicion-de-uso-de-cpu-en-el-sistema-operativo-gnu-linux">
<h3>Otras herramientas para medición de uso de CPU en el sistema operativo GNU/Linux<a class="headerlink" href="#otras-herramientas-para-medicion-de-uso-de-cpu-en-el-sistema-operativo-gnu-linux" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/brendangregg/pmc-cloud-tools">pmc-cloud-tools</a></p></li>
</ul>
<div class="tip admonition">
<p class="admonition-title">Ejercicios</p>
<p>1.Resuelve los ejercicios y preguntas de la nota.</p>
</div>
<p><strong>Referencias:</strong></p>
<ol class="simple">
<li><p>M. Gorelick, I. Ozsvald, High Performance Python, O’Reilly Media, 2014.</p></li>
<li><p>E. Anderson, Z. Bai, C. Bischof, L. S. Blackford, J. Demmel, J. Dongarra, J. Du Croz,
A. Greenbaum, S. Hammarling, A. Mckenney and D. Sorensen, LAPACK Users Guide, Society for Industrial and Applied Mathematics, Philadelphia, PA, third ed., 1999.</p></li>
</ol>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "palmoreck/dockerfiles-for-binder",
            ref: "jupyterlab_optimizacion_2",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./V.optimizacion_de_codigo/5.2"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="../5.1/introduccion_optimizacion_de_codigo.html" title="previous page">5.1 Introducción a optimización de código</a>
    <a class='right-next' id="next-link" href="../../VI.algoritmos_optimizacion_convexa/6.1/Problemas_UCO.html" title="next page">6.1 Problemas tipo <em>Unconstrained Convex Optimization</em> (UCO)</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Erick Palacios Moreno<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../../_static/js/index.3da636dd464baa7582d2.js"></script>


    
  </body>
</html>