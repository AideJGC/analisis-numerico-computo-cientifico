
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>5.1 Introducción optimización de código</title>
    
  <link rel="stylesheet" href="../../_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe,.cell"
        const thebe_selector_input = "pre,.cell_input div.highlight"
        const thebe_selector_output = ".output,.cell_output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="6.1 Problemas tipo Unconstrained Convex Optimization (UCO)" href="../../VI.algoritmos_optimizacion_convexa/6.1/Problemas_UCO.html" />
    <link rel="prev" title="4.5 Método primal-dual de barrera logarítmica (BL)" href="../../IV.optimizacion_en_redes_y_prog_lineal/4.5/Metodo_primal_dual_de_BL.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../../index.html">
  
  <img src="../../_static/logo.png" class="logo" alt="logo">
  
  
</a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../README.html">
   Optimización
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  I. Cómputo científico
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../I.computo_cientifico/1.1/Analisis_numerico_y_computo_cientifico.html">
   1.1 Análisis numérico y cómputo científico
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../I.computo_cientifico/1.2/Sistema_de_punto_flotante.html">
   1.2 Sistema de punto flotante
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../I.computo_cientifico/1.3/Normas_vectoriales_y_matriciales.html">
   1.3 Normas vectoriales y matriciales
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../I.computo_cientifico/1.4/Condicion_de_un_problema_y_estabilidad_de_un_algoritmo.html">
   1.4 Condición de un problema y estabilidad de un algoritmo
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../I.computo_cientifico/1.5/Definicion_de_funcion_continuidad_derivada.html">
   1.5 Definición de función, continuidad y derivada
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../I.computo_cientifico/1.6/Polinomios_de_Taylor_y_diferenciacion_numerica.html">
   1.6 Polinomios de Taylor y diferenciación numérica
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../I.computo_cientifico/1.7/Integracion_numerica.html">
   1.7 Integración Numérica
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  II. Cómputo matricial
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../II.computo_matricial/2.1/Operaciones_y_transformaciones_basicas_del_Algebra_Lineal_Numerica.html">
   2.1 Operaciones y transformaciones básicas del Álgebra Lineal Numérica
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../II.computo_matricial/2.2/Eigenvalores_y_eigenvectores.html">
   2.2 Eigenvalores y eigenvectores
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../II.computo_matricial/2.3/Algoritmos_y_aplicaciones_de_eigenvalores_eigenvectores_de_una_matriz.html">
   2.3 Algoritmos y aplicaciones de eigenvalores y eigenvectores de una matriz
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../II.computo_matricial/2.4/Valores_vectores_singulares_y_algoritmos_para_calcular_la_SVD.html">
   2.4 Valores, vectores singulares y algoritmos para calcular la SVD
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  III. Optimización convexa y ecuaciones no lineales
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../III.optimizacion_convexa/3.1/Definicion_de_problema_optimizacion_conjuntos_y_funciones_convexas.html">
   3.1 Definición de problemas de optimización, conjuntos y funciones convexas
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../III.optimizacion_convexa/3.2/Algoritmos_de_descenso_y_busqueda_de_linea_en_uco.html">
   3.2 Algoritmos de descenso y búsqueda de línea en
   <em>
    Unconstrained Convex Optimization
   </em>
   (UCO)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../III.optimizacion_convexa/3.3/Ejemplos_problemas_UCO_e_intro_CIEO_y_PI.html">
   3.3 Ejemplos de problemas UCO, introducción a
   <em>
    Constrained Inequality and Equality Optimization
   </em>
   (CIEO) y puntos interiores
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../III.optimizacion_convexa/3.4/Ecuaciones_no_lineales.html">
   3.4 Ecuaciones no lineales
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  IV. Optimización en redes y programación lineal
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../IV.optimizacion_en_redes_y_prog_lineal/4.1/Definiciones_generales_de_flujo_en_redes.html">
   4.1 Definiciones generales de flujo en redes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../IV.optimizacion_en_redes_y_prog_lineal/4.2/Programacion_lineal_y_metodo_simplex.html">
   4.2 Programación lineal (PL) y método símplex
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../IV.optimizacion_en_redes_y_prog_lineal/4.3/Ejemplo_metodo_simplex_de_redes.html">
   4.3 Ejemplo del método símplex de redes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../IV.optimizacion_en_redes_y_prog_lineal/4.4/Dualidad_lema_de_Farkas_condiciones_KKT_de_optimalidad.html">
   4.4 Dualidad, lema de Farkas y condiciones de Karush-Kuhn-Tucker (KKT) de optimalidad
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../IV.optimizacion_en_redes_y_prog_lineal/4.5/Metodo_primal_dual_de_BL.html">
   4.5 Método primal-dual de barrera logarítmica (BL)
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  V. Optimización de código
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   5.1 Introducción optimización de código
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  VI. Algoritmos de optimización convexa
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../VI.algoritmos_optimizacion_convexa/6.1/Problemas_UCO.html">
   6.1 Problemas tipo
   <em>
    Unconstrained Convex Optimization
   </em>
   (UCO)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../VI.algoritmos_optimizacion_convexa/6.2/Problemas_CECO.html">
   6.2 Problemas tipo
   <em>
    Constrained Equality Convex Optimization
   </em>
   (CECO)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../VI.algoritmos_optimizacion_convexa/6.3/Problemas_CIECO.html">
   6.3 Problemas tipo
   <em>
    Constrained Equality and Inequality Convex Optimization
   </em>
   (CIECO)
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/V.optimizacion_de_codigo/5.1/introduccion_optimizacion_de_codigo.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/palmoreck/dockerfiles-for-binder/jupyterlab_optimizacion_2?urlpath=lab/tree/analisis-numerico-computo-cientifico/libro_optimizacion/temas/V.optimizacion_de_codigo/5.1/introduccion_optimizacion_de_codigo.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <button type="button" class="btn btn-secondary topbarbtn"
            onclick="initThebeSBT()" title="Launch Thebe" data-toggle="tooltip" data-placement="left"><i
                class="fas fa-play"></i><span style="margin-left: .4em;">Live Code</span></button>
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#temas-a-considerar-en-un-programa-de-maquina-de-alto-rendimiento">
   Temas a considerar en un programa de máquina de alto rendimiento
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#herramientas-que-tenemos-a-nuestra-disposicion-para-un-programa-de-maquina-de-alto-rendimiento">
   Herramientas que tenemos a nuestra disposición para un programa de máquina de alto rendimiento
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#vectorizacion-blas-y-el-uso-del-cache-eficientemente">
   Vectorización, BLAS y el uso del caché eficientemente.
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#implementaciones-de-la-api-standard-de-blas-y-lapack">
     Implementaciones de la API standard de BLAS y LAPACK
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#que-es-el-perfilamiento-y-por-que-es-necesario">
   ¿Qué es el perfilamiento y por qué es necesario?
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#unit-testing">
     <em>
      Unit testing
     </em>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#por-que-compilar-a-codigo-de-maquina">
   ¿Por qué compilar a código de máquina?
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#por-que-puede-ser-lenta-la-ejecucion-de-un-bloque-de-codigo-en-python-o-en-algun-otro-lenguaje-tipo-interprete">
     ¿Por qué puede ser lenta la ejecución de un bloque de código en Python (o en algún otro lenguaje tipo intérprete)?
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#sobre-los-terminos-concurrencia-paralelo-y-distribuido">
   Sobre los términos concurrencia, paralelo y distribuido
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#paralelo">
     Paralelo
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#distribuido">
     Distribuido
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#concurrencia">
     Concurrencia
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#por-que-el-computo-en-paralelo">
     ¿Por qué el cómputo en paralelo?
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#programas-cuya-ejecucion-es-en-paralelo">
     Programas cuya ejecución es en paralelo
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cuando-es-recomendable-pensar-en-ejecutar-en-paralelo-tu-programa">
     ¿Cuando es recomendable pensar en ejecutar en paralelo tu programa?
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#si-tengo-n-procesadores-espero-un-speedup-de-nx">
     Si tengo n procesadores ¿espero un
     <em>
      speedup
     </em>
     de
     <span class="math notranslate nohighlight">
      \(nx\)
     </span>
     ?
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-que-nos-referimos-al-escribir-overhead-en-un-programa-cuya-ejecucion-es-en-paralelo">
     ¿A qué nos referimos al escribir
     <em>
      overhead
     </em>
     en un programa cuya ejecución es en paralelo?
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cuales-enfoques-puedo-utilizar-para-escribir-programas-en-paralelo">
     ¿Cuáles enfoques puedo utilizar para escribir programas en paralelo?
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-que-nos-referimos-con-el-termino-embarrassingly-parallel-problem">
     ¿A qué nos referimos con el término
     <em>
      embarrassingly parallel problem
     </em>
     ?
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#como-inicio-en-la-programacion-en-paralelo-de-mi-codigo">
     ¿Cómo inicio en la programación en paralelo de mi código?
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#ejemplo-en-la-regla-del-rectangulo-compuesta-en-una-maquina-multicore-para-cpu">
     Ejemplo en la regla del rectángulo compuesta en una máquina
     <em>
      multicore
     </em>
     para CPU
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#software">
     ¿Software?
    </a>
   </li>
  </ul>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="introduccion-optimizacion-de-codigo">
<span id="introoptcodigo"></span><h1>5.1 Introducción optimización de código<a class="headerlink" href="#introduccion-optimizacion-de-codigo" title="Permalink to this headline">¶</a></h1>
<div class="admonition-notas-para-contenedor-de-docker admonition">
<p class="admonition-title">Notas para contenedor de docker:</p>
<p>Comando de docker para ejecución de la nota de forma local:</p>
<p>nota: cambiar <code class="docutils literal notranslate"><span class="pre">&lt;ruta</span> <span class="pre">a</span> <span class="pre">mi</span> <span class="pre">directorio&gt;</span></code> por la ruta de directorio que se desea mapear a <code class="docutils literal notranslate"><span class="pre">/datos</span></code> dentro del contenedor de docker.</p>
<p><code class="docutils literal notranslate"><span class="pre">docker</span> <span class="pre">run</span> <span class="pre">--rm</span> <span class="pre">-v</span> <span class="pre">&lt;ruta</span> <span class="pre">a</span> <span class="pre">mi</span> <span class="pre">directorio&gt;:/datos</span> <span class="pre">--name</span> <span class="pre">jupyterlab_optimizacion_2</span> <span class="pre">-p</span> <span class="pre">8888:8888</span> <span class="pre">-p</span> <span class="pre">8787:8787</span> <span class="pre">-d</span> <span class="pre">palmoreck/jupyterlab_optimizacion_2:3.0.0</span></code></p>
<p>password para jupyterlab: <code class="docutils literal notranslate"><span class="pre">qwerty</span></code></p>
<p>Detener el contenedor de docker:</p>
<p><code class="docutils literal notranslate"><span class="pre">docker</span> <span class="pre">stop</span> <span class="pre">jupyterlab_optimizacion_2</span></code></p>
<p>Documentación de la imagen de docker <code class="docutils literal notranslate"><span class="pre">palmoreck/jupyterlab_optimizacion_2:3.0.0</span></code> en <a class="reference external" href="https://github.com/palmoreck/dockerfiles/tree/master/jupyterlab/optimizacion_2">liga</a>.</p>
</div>
<hr class="docutils" />
<div class="tip admonition">
<p class="admonition-title">Al final de esta nota el y la lectora:</p>
<ul class="simple">
<li></li>
</ul>
</div>
<p>La implementación de los métodos o algoritmos en el contexto de grandes cantidades de datos o <em>big data</em> es crítica al ir a la práctica pues de esto depende que nuestra(s) máquina(s) tarde meses, semanas, días u horas para resolver problemas que se presentan en este contexto. En este contexto la <a class="reference external" href="https://en.wikipedia.org/wiki/Program_optimization">optimización de código o de software</a> nos ayuda a la eficiencia.</p>
<div class="section" id="temas-a-considerar-en-un-programa-de-maquina-de-alto-rendimiento">
<h2>Temas a considerar en un programa de máquina de alto rendimiento<a class="headerlink" href="#temas-a-considerar-en-un-programa-de-maquina-de-alto-rendimiento" title="Permalink to this headline">¶</a></h2>
<p>Para tener un alto performance en un programa de máquina, deben considerarse las siguientes preguntas:</p>
<ul class="simple">
<li><p>¿Qué tanto aprovecha mi programa aspectos como <em><strong>data reuse</strong></em> y <em><strong>data locality</strong></em>?</p></li>
</ul>
<p>La respuesta nos lleva a pensar en el número de instrucciones por ciclo y el número de ciclos que realiza el procesador. Entiéndase un ciclo por los pasos de leer una instrucción, determinar acciones a realizar por tal instrucción y ejecutar las acciones, ver <a class="reference external" href="https://en.wikipedia.org/wiki/Instruction_cycle">liga</a>.</p>
<ul class="simple">
<li><p>¿Cómo es mi <em><strong>data layout</strong></em> en el almacenamiento? (forma en la que están almacenados o dispuestos los datos)</p></li>
</ul>
<p>Dependiendo de la respuesta podemos elegir una arquitectura de computadoras u otra y así también un algoritmo u otro.</p>
<ul class="simple">
<li><p>¿Cuánto <em><strong>data movement</strong></em> o <em><strong>data motion</strong></em> realiza mi programa? (flujo de datos entre los distintos niveles de jerarquía de almacenamiento o entre las máquinas en un clúster de máquinas)</p></li>
</ul>
<p>La respuesta implica analizar el tráfico de datos entre las <strong>jerarquías de almacenamiento</strong> (o máquinas si estamos en un clúster de máquinas) y potenciales <strong>bottlenecks</strong>.</p>
</div>
<div class="section" id="herramientas-que-tenemos-a-nuestra-disposicion-para-un-programa-de-maquina-de-alto-rendimiento">
<h2>Herramientas que tenemos a nuestra disposición para un programa de máquina de alto rendimiento<a class="headerlink" href="#herramientas-que-tenemos-a-nuestra-disposicion-para-un-programa-de-maquina-de-alto-rendimiento" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Vectorización que pueden realizar los procesadores.</p></li>
<li><p>Perfilamiento de código para lograr la eficiencia deseada.</p></li>
<li><p>Programación en lenguajes compilados en lugar de intérpretes (o combinando intérpretes con lenguajes compilados)</p></li>
<li><p>Conocimiento de los propósitos con los que fueron diseñados los procesadores para explotar su capacidad. Aquí decidimos si usamos <strong>código secuencial</strong> o <strong>código en paralelo</strong>.</p></li>
</ul>
<p>…además necesitamos conocer las diferentes <strong>arquitecturas</strong> que pueden utilizarse para cómputo en paralelo.</p>
<ul class="simple">
<li><p>¿Alguien ya resolvió mi bottleneck?</p></li>
<li><p>Experiencia en el lenguaje de programación seleccionado.</p></li>
</ul>
</div>
<div class="section" id="vectorizacion-blas-y-el-uso-del-cache-eficientemente">
<h2>Vectorización, BLAS y el uso del caché eficientemente.<a class="headerlink" href="#vectorizacion-blas-y-el-uso-del-cache-eficientemente" title="Permalink to this headline">¶</a></h2>
<p>El cómputo matricial está construído sobre una jerarquía de operaciones del álgebra lineal:</p>
<ul class="simple">
<li><p>Productos punto involucran operaciones escalares de suma y multiplicación (nivel BLAS 1).</p></li>
<li><p>La multiplicación matriz-vector está hecha de productos punto (nivel BLAS 2).</p></li>
<li><p>La multiplicación matriz-matriz utiliza colecciones de productos matriz-vector (nivel BLAS 3).</p></li>
</ul>
<p>Las operaciones anteriores se describen en el álgebra lineal con la teoría de espacios vectoriales pero también es posible describirlas en una forma algorítmica. Ambas descripciones se complementan una a la otra.</p>
<p>Ver <a class="reference external" href="http://www.netlib.org/lapack/explore-html/dir_fa94b7b114d387a7a8beb2e3e22bf78d.html">Linear Algebra Package: LAPACK</a> para nombres que se utilizan para operaciones con escalares, vectores o matrices. Ver <a class="reference external" href="https://github.com/Reference-LAPACK/lapack">Reference-LAPACK / lapack</a>.</p>
<div class="section" id="implementaciones-de-la-api-standard-de-blas-y-lapack">
<h3>Implementaciones de la API standard de BLAS y LAPACK<a class="headerlink" href="#implementaciones-de-la-api-standard-de-blas-y-lapack" title="Permalink to this headline">¶</a></h3>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Ver <a class="reference external" href="https://en.wikipedia.org/wiki/Application_programming_interface">Application Programming Interface: API</a> para una explicación de lo que es una API.</p>
</div>
<p>En <a class="reference external" href="https://wiki.debian.org/DebianScience/LinearAlgebraLibraries">Handle different versions of BLAS and LAPACK</a> se explica que <a class="reference external" href="https://en.wikipedia.org/wiki/Basic_Linear_Algebra_Subprograms">BLAS: Basic Linear Algebra Subprograms</a> y <a class="reference external" href="http://www.netlib.org/lapack/explore-html/dir_fa94b7b114d387a7a8beb2e3e22bf78d.html">Linear Algebra Package: LAPACK</a> además de ser implementaciones, también son API <em>standard</em> para operaciones básicas del álgebra lineal. Muchas implementaciones de la API existen. Un ejemplo de implementaciones son las incluidas al instalar R o Python. Otras son las que se pueden instalar vía línea de comando:</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Ver <a class="reference external" href="https://packages.debian.org/libblas3">libblas3</a> <a class="reference external" href="https://packages.debian.org/libblas-dev">libblas-dev</a> <a class="reference external" href="https://packages.debian.org/liblapack3">liblapack3</a> <a class="reference external" href="https://packages.debian.org/liblapack-dev">liblapack-dev</a>.</p>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo apt-get install -y libblas3 libblas-dev liblapack3 liblapack-dev
</pre></div>
</div>
<p>en un sistema operativo Ubuntu por ejemplo.</p>
<p>Sin embargo existen otras implementaciones de la API que están optimizadas para la arquitectura de nuestras máquinas, por ejemplo:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/xianyi/OpenBLAS">OpenBLAS</a></p></li>
<li><p><a class="reference external" href="http://math-atlas.sourceforge.net">Atlas</a></p></li>
</ul>
</div>
</div>
<div class="section" id="que-es-el-perfilamiento-y-por-que-es-necesario">
<h2>¿Qué es el perfilamiento y por qué es necesario?<a class="headerlink" href="#que-es-el-perfilamiento-y-por-que-es-necesario" title="Permalink to this headline">¶</a></h2>
<blockquote class="epigraph">
<div><p>Programmers waste enormous amounts of time thinking about, or worrying about, the speed of noncritical parts of their programs, and these attempts at efficiency actually have a strong negative impact when debugging and maintenance are considered</p>
<p class="attribution">—D. Knuth</p>
</div></blockquote>
<blockquote class="epigraph">
<div><p>We should forget about small efficiencies, say about 97% of the time: premature optimization is the root of all evil. Yet we should not pass up our opportunities in that critical 3%”. A good programmer … will be wise to look carefully at the critical code; but only after that code has been identified</p>
<p class="attribution">—D. Knuth</p>
</div></blockquote>
<p>El perfilamiento de código nos ayuda a encontrar <em><strong>bottlenecks</strong></em> de nuestro código ya sea en el uso de CPU, RAM, <em>network bandwidth</em> u operaciones hacia el disco de <em>Input</em>/<em>Output</em> (I/O).</p>
<p>Una mala práctica que es común al iniciar en la programación* es intentar optimizar el código (y por optimización piénsese en algún caso, por ejemplo mejorar el tiempo de ejecución de un bloque de código) a ciegas, intentando cambiar líneas de código por intuición y no por evidencias o mediciones. Esto aunque puede funcionar en algunas ocasiones no conduce la mayoría de las veces a corregir los problemas de los bottlenecks del código (o bien en programas o ¡sistemas enteros!). La optimización guiada por la intuición conduce a un mayor tiempo en el desarrollo para un pequeño incremento en el performance.</p>
<p>*Aún teniendo experiencia en programación identificar <em>bottlenecks</em> en los códigos es difícil…</p>
<p>Si bien es importante que el código resuelva un problema definido, también es importante perfilarlo. Considérese el caso en el que un código resuelve bien un problema en un día completo, es importante entonces perfilarlo para realizar mediciones (CPU, memoria p.ej.) de los lugares en los que el código gasta la mayor parte de tiempo (en general recursos).</p>
<p>A largo plazo el perfilamiento de código te dará las decisiones más pragmáticas posibles con el menor esfuerzo total.</p>
<p>Al perfilar tu código no olvides lo siguiente:</p>
<ul class="simple">
<li><p>Medir el tiempo total de tus códigos para decidir si se requiere optimizarlos.</p></li>
<li><p>Perfilar tus códigos para decidir en dónde se iniciará con la optimización. También ayuda definir hipótesis para decidir en qué bloques perfilar primero.</p></li>
<li><p>Escribir <em>tests</em> para asegurarse que se resuelve el problema de forma correcta al igual que antes de perfilarlo y optimizarlo.</p></li>
<li><p>Cualquier recurso medible puede ser perfilado (no sólo el uso de CPU p.ej.)</p></li>
<li><p>Perfilar típicamente añade overhead en la ejecución del código (disminución de tiempo de 10x o 100x es común).</p></li>
</ul>
<p>También considera el tiempo que inviertes para optimizar tu código y si vale la pena la inversión de tiempo que realizas en esto pues hay códigos que casi no son utilizados y otros que sí. No pierdas de vista:</p>
<img src="https://imgs.xkcd.com/comics/is_it_worth_the_time.png" heigth="400" width="400"><p>pues es fácil caer en tratar de remover todos los bottlenecks. Sé una persona práctica, define un tiempo objetivo para tu código y optimiza sólo para llegar a ese objetivo.</p>
<p>Algunas <em><strong>strategies to profile your code successfully</strong></em> extraídas de <a class="reference external" href="https://www.oreilly.com/library/view/high-performance-python/9781492055013/">high performance python</a> para un perfilamiento de código exitoso:</p>
<ul class="simple">
<li><p>Disable TurboBoost in the BIOS (a cool CPU may run the same block of code faster than a hot CPU).</p></li>
<li><p>Disable the operating system’s ability to override the SpeedStep (you will find this in your BIOS if you’re allowed to control it).</p></li>
<li><p>Only use mains power (never battery power) &lt;- a laptop on battery power is likely to more agressively control CPU speed than a laptop on mains power.</p></li>
<li><p>Disable background tools like backups and Dropbox while running experiments.</p></li>
<li><p>Run the experiments many times to obtain a stable measurement.</p></li>
<li><p>Possibly drop to run level 1 (Unix) so that no other tasks are running.</p></li>
<li><p>Reboot and rerun the experiments to double-confirm the results.</p></li>
</ul>
<div class="section" id="unit-testing">
<h3><em>Unit testing</em><a class="headerlink" href="#unit-testing" title="Permalink to this headline">¶</a></h3>
<p>Además del perfilamiento del código, el <em>unit testing</em> ayuda a <strong>validar</strong> que cada unidad del software trabaje y se desempeñe como fue diseñada (una unidad puede ser una función, programa, procedimiento, método). El <em>unit testing</em> es importante pues se debe cuidar que el código genere resultados correctos. Puede realizarse independientemente del perfilamiento y si se ha hecho perfilamiento es muy indispensable que se haga un unit testing.</p>
<ul class="simple">
<li><p><em><strong>Unit testing during optimization to maintain correctness:</strong></em> … <em>after spending a day optimizing her code, having disabled unit tests because they were inconvenient, only to discover that her significant speedup result was due to breaking a part of the algorithm she was improving…</em></p></li>
<li><p><em>…If you try to performance test code deep inside a larger project without separating it from the larger project, you are likely to witness side effects that will sidetrack your efforts. It is likely to be harder to unit test a larger project when you’re making fine-grained changes, and this may further hamper your efforts. Side effects could include other threads and processes impacting CPU and memory usage and network and disk activity, which will skew your results.</em></p></li>
</ul>
</div>
</div>
<div class="section" id="por-que-compilar-a-codigo-de-maquina">
<h2>¿Por qué compilar a código de máquina?<a class="headerlink" href="#por-que-compilar-a-codigo-de-maquina" title="Permalink to this headline">¶</a></h2>
<p>De las opciones más sencillas que tenemos a nuestra disposición para resolver <em>bottlenecks</em> en nuestro programa es hacer que nuestro código haga menos trabajo.</p>
<p>Compilando nuestro código a código de máquina para que el código en los lenguajes tipo intérpretes ejecuten menos instrucciones es una opción a seguir.</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Ver <a class="reference external" href="https://en.wikipedia.org/wiki/Interpreter_(computing)">liga</a> para revisar lo que es un lenguaje tipo intérprete.</p>
</div>
<div class="section" id="por-que-puede-ser-lenta-la-ejecucion-de-un-bloque-de-codigo-en-python-o-en-algun-otro-lenguaje-tipo-interprete">
<h3>¿Por qué puede ser lenta la ejecución de un bloque de código en Python (o en algún otro lenguaje tipo intérprete)?<a class="headerlink" href="#por-que-puede-ser-lenta-la-ejecucion-de-un-bloque-de-codigo-en-python-o-en-algun-otro-lenguaje-tipo-interprete" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Verificación de tipo de datos (si son <code class="docutils literal notranslate"><span class="pre">int</span></code>, <code class="docutils literal notranslate"><span class="pre">double</span></code> o <code class="docutils literal notranslate"><span class="pre">string</span></code>).</p></li>
<li><p>Los objetos temporales que se crean por tipo de dato (un objeto tipo <code class="docutils literal notranslate"><span class="pre">int</span></code> en Python tiene asociado un objeto de alto nivel con el que interactuamos pero que causa overhead).</p></li>
<li><p>Las llamadas a funciones de alto nivel (por ejemplo las que ayudan a almacenar al objeto en memoria)</p></li>
</ul>
<p>son tres de las fuentes que hacen a un lenguaje tipo intérprete como <code class="docutils literal notranslate"><span class="pre">Python</span></code> <code class="docutils literal notranslate"><span class="pre">R</span></code> o <code class="docutils literal notranslate"><span class="pre">Matlab</span></code> lento. También otras fuentes son:</p>
<ul class="simple">
<li><p>Desde el punto de vista de la memoria de la máquina, el número de referencias a un objeto y las copias entre objetos.</p></li>
<li><p>No es posible vectorizar un cálculo sin el uso de extensiones (por ejemplo paquetes como <code class="docutils literal notranslate"><span class="pre">numpy</span></code>).</p></li>
</ul>
<div class="admonition-comentarios admonition">
<p class="admonition-title">Comentarios</p>
<ul class="simple">
<li><p>Hay paquetes que permiten la compilación hacia lenguajes más eficientes como Fortran o C (lenguajes que deben realizar compilación), por ejemplo <a class="reference external" href="https://cython.org/">cython</a> o <a class="reference external" href="http://www.rcpp.org/">rcpp</a>.</p></li>
<li><p>Escribir directamente en C en un equipo de desarrollo de <em>software</em> indudablemente cambiará la velocidad de su trabajo si no conocen tal lenguaje.</p></li>
<li><p>En la práctica si se tiene un <em>bottleneck</em> que no ha podido resolverse con herramientas como el cómputo en paralelo o vectorización, se recomienda utilizar paquetes para regiones pequeñas del código y resolver el <em>bottleneck</em> del programa.</p></li>
</ul>
</div>
</div>
</div>
<div class="section" id="sobre-los-terminos-concurrencia-paralelo-y-distribuido">
<h2>Sobre los términos concurrencia, paralelo y distribuido<a class="headerlink" href="#sobre-los-terminos-concurrencia-paralelo-y-distribuido" title="Permalink to this headline">¶</a></h2>
<p>La distinción entre los términos de paralelo y distribuido es borrosa y en ocasiones es díficil de distinguir.</p>
<div class="section" id="paralelo">
<h3>Paralelo<a class="headerlink" href="#paralelo" title="Permalink to this headline">¶</a></h3>
<p>El término <strong>paralelo</strong> típicamente se relaciona con programas cuya ejecución involucra <em>cores</em> o nodos que físicamente son cercanos y comparten memoria o están conectados por una red (<em>network</em>).</p>
<div class="tip admonition">
<p class="admonition-title">Observación</p>
<p>El término <em>core</em> hoy en día lo usamos como sinónimo de procesador.</p>
</div>
</div>
<div class="section" id="distribuido">
<h3>Distribuido<a class="headerlink" href="#distribuido" title="Permalink to this headline">¶</a></h3>
<p>Los programas <strong>distribuidos</strong> son ejecutados por nodos o máquinas separadas a  distancia y una de sus características es que no necesariamente fueron iniciados por un nodo central o <em>master</em> por lo que su ejecución es independiente de los demás nodos.</p>
</div>
<div class="section" id="concurrencia">
<h3>Concurrencia<a class="headerlink" href="#concurrencia" title="Permalink to this headline">¶</a></h3>
<p>El término de <strong>concurrencia</strong> se refiere a que las múltiples tareas que debe realizar un programa pueden estar en progreso en cualquier instante.</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Ver <a class="reference external" href="https://en.wikipedia.org/wiki/Kernel_(operating_system)">kernel operating system</a> para definición del kernel de una máquina.</p>
</div>
<p>Por ejemplo: cada vez que tu código lee un archivo o escribe a un dispositivo, debe pausar su ejecución para contactar al kernel del sistema operativo, solicitar que se ejecute tal operación, y esperar a que se complete (otra operación que requiere contactar al kernel es alojamiento de memoria).</p>
<p>Estas operaciones son órdenes de magnitud más lentas que las instrucciones u operaciones ejecutadas en la CPU y el tiempo que el programa espera a que se completen tales operaciones se le llama <em>I/O wait</em>.</p>
<p>La concurrencia nos ayuda a utilizar este tiempo perdido al permitir ejecutar operaciones mientras que una operación I/O se complete.</p>
<p>Un programa concurrente en lugar de ejecutarse de forma secuencial, esto es, pasar de una línea a otra línea, tiene código escrito para ejecutar distintas líneas conforme sucedan “eventos”. Aquí se involucra una forma de programación llamada <strong>asíncrona</strong>, por ejemplo si una operación tipo I/O es solicitada, el programa ejecuta otras funciones mientras espera que se complete la operación I/O.</p>
<div class="admonition-comentario admonition">
<p class="admonition-title">Comentario</p>
<p>Cambiar de función a función en un programa asíncrono también genera costo pues el kernel debe invertir tiempo en hacer todo el <em>set up</em> para ejecutar a la función. La concurrencia funciona bien en programas con alto I/O wait.</p>
</div>
</div>
<div class="section" id="por-que-el-computo-en-paralelo">
<h3>¿Por qué el cómputo en paralelo?<a class="headerlink" href="#por-que-el-computo-en-paralelo" title="Permalink to this headline">¶</a></h3>
<p>La industria entre los años <span class="math notranslate nohighlight">\(2003-2005\)</span> en lugar de fabricar procesadores monolíticos (clásico <a class="reference external" href="https://en.wikipedia.org/wiki/Von_Neumann_architecture">Von Neumann</a>) que fueran más rápidos y complejos, decidió fabricar múltiples, simples procesadores, <em>cores</em>, en un sólo chip para incrementar el poder de procesamiento, disminuir el Von Neumann bottleneck y aumentar el clock speed.</p>
<p>Esto fue motivado pues desde el año <span class="math notranslate nohighlight">\(2002\)</span> el incremento del performance de los procesadores con un sólo CPU fue de un <span class="math notranslate nohighlight">\(20\%\)</span> por año vs un <span class="math notranslate nohighlight">\(50\%\)</span> por año entre <span class="math notranslate nohighlight">\(1986\)</span> y <span class="math notranslate nohighlight">\(2002\)</span>. Lo anterior se debió a los problemas de la construcción de procesadores monolíticos o de un <em>core</em> relacionados con la disipación del calor por un mayor consumo de energía al hacer más pequeños los transistores.</p>
<p>Hoy en día podemos encontrar en nuestros celulares, laptops, computadoras de escritorio y servidores arquitecturas que cuentan con múltiples <em>cores</em> o núcleos para procesamiento.</p>
<img src="https://dl.dropboxusercontent.com/s/k11qub01w4nvksi/CPU_multicore.png?dl=0" heigth="500" width="500">
<p>Muchos de los dispositivos anteriores además tienen un(os) procesador(es) gráficos.</p>
<img src="https://dl.dropboxusercontent.com/s/lw9kia12qhwp95r/GPU.png?dl=0" heigth="500" width="500">
<p>En una buena cantidad de aplicaciones tenemos que implementar algoritmos considerando tal disponibilidad de <em>cores</em> para reducir el tiempo de procesamiento. Esto conduce a reimplementar o en otros casos a repensar al algoritmo en sí.</p>
<p>Y otro aspecto a tomar en cuenta en esta implementación es la transferencia de datos que existe en la jerarquía de memoria de una máquina</p>
<img src="https://dl.dropboxusercontent.com/s/ahxsnpgp4rjdvw3/jerarquias_de_almacenamiento.png?dl=0" heigth="400" width="400">
<div class="admonition-definicion admonition">
<p class="admonition-title">Definición</p>
<p>Los algoritmos que utilizan un sólo <em>core</em> para procesamiento les nombramos <strong>secuenciales</strong>, los que utilizan múltiples <em>cores</em> son <strong>paralelos</strong>.</p>
</div>
</div>
<div class="section" id="programas-cuya-ejecucion-es-en-paralelo">
<h3>Programas cuya ejecución es en paralelo<a class="headerlink" href="#programas-cuya-ejecucion-es-en-paralelo" title="Permalink to this headline">¶</a></h3>
<p>La decisión de reescribir tu programa secuencial en un programa en paralelo depende mucho de considerar cuatro situaciones:</p>
<ul class="simple">
<li><p>Tener el hardware para ejecución en paralelo del programa.</p></li>
<li><p>Comunicarle al programa que está en un hardware para ejecución en paralelo de instrucciones.</p></li>
<li><p>Tener un método que aproveche el hardware paralelo de forma eficiente.</p></li>
<li><p>Tiempo invertido en la reescritura de un código secuencial a uno en paralelo vs ganancias en tiempo de ejecución.</p></li>
</ul>
<p>Lo primero es fácilmente alcanzable pues hoy en día tenemos celulares con múltiples <em>cores</em> o procesadores. Lo segundo es más dependiente del lenguaje e implementación de éste lenguaje en el que se esté programando. El tercer punto es quizás el más complicado de lograr pues en ocasiones implica repensar el método, disminuir la comunicación lo más posible entre los procesadores, el balanceo de carga o <em><strong>load balancing</strong></em> debe evaluarse y el perfilamiento o el <em>debugging</em> es más difícil en la programación en paralelo que en la forma secuencial. El cuarto punto es esencial para la decisión.</p>
</div>
<div class="section" id="cuando-es-recomendable-pensar-en-ejecutar-en-paralelo-tu-programa">
<h3>¿Cuando es recomendable pensar en ejecutar en paralelo tu programa?<a class="headerlink" href="#cuando-es-recomendable-pensar-en-ejecutar-en-paralelo-tu-programa" title="Permalink to this headline">¶</a></h3>
<p>Si tus instrucciones a realizar pueden ser divididas en múltiples <em>cores</em> o nodos sin tanto esfuerzo de ingeniería (levantar un clúster de cero es difícil…) o no te lleva mucho tiempo el rediseño de tus métodos para decisiones prácticas (paralelizar el método de despomposición en valores singulares, SVD, es difícil de realizar…) entonces es una opción a considerar. Se recomienda mantener el nivel de paralelización lo más simple posible (aunque no se esté utilizando el 100% de todos tus <em>cores</em>) de modo que el desarrollo de <em>software</em> sea rápido.</p>
</div>
<div class="section" id="si-tengo-n-procesadores-espero-un-speedup-de-nx">
<h3>Si tengo n procesadores ¿espero un <em>speedup</em> de <span class="math notranslate nohighlight">\(nx\)</span>?<a class="headerlink" href="#si-tengo-n-procesadores-espero-un-speedup-de-nx" title="Permalink to this headline">¶</a></h3>
<p>Normalmente <strong>no</strong> se tiene un mejoramiento en la velocidad de <span class="math notranslate nohighlight">\(n\)</span> veces (<span class="math notranslate nohighlight">\(nx\)</span>) (por ejemplo, si tienes una máquina de <span class="math notranslate nohighlight">\(8\)</span> <em>cores</em> es poco probable que observes un <span class="math notranslate nohighlight">\(8x\)</span> <em>speedup</em>).</p>
<p>Las razones de esto tienen que ver con que al paralelizar instrucciones típicamente se incrementa el <em>overhead</em> de la comunicación entre los procesos o threads y decrece la memoria RAM disponible que puede ser usada por subprocesos o threads.</p>
<p>También dentro de las razones se encuentran la <a class="reference external" href="https://en.wikipedia.org/wiki/Amdahl%27s_law">ley de Amdahl</a> que nos dice que si sólo una parte del código puede ser paralelizado, no importa cuántos cores tengas, en términos totales el código no se ejecutará más rápido en presencia de secciones secuenciales que dominarán el tiempo de ejecución.</p>
</div>
<div class="section" id="a-que-nos-referimos-al-escribir-overhead-en-un-programa-cuya-ejecucion-es-en-paralelo">
<h3>¿A qué nos referimos al escribir <em>overhead</em> en un programa cuya ejecución es en paralelo?<a class="headerlink" href="#a-que-nos-referimos-al-escribir-overhead-en-un-programa-cuya-ejecucion-es-en-paralelo" title="Permalink to this headline">¶</a></h3>
<p>A todo lo que implica ejecutar el programa en paralelo que no está presente en la ejecución en una forma secuencial. Por ejemplo, iniciar procesos implica comunicación con el kernel del sistema operativo y por tanto, tiempo.</p>
</div>
<div class="section" id="cuales-enfoques-puedo-utilizar-para-escribir-programas-en-paralelo">
<h3>¿Cuáles enfoques puedo utilizar para escribir programas en paralelo?<a class="headerlink" href="#cuales-enfoques-puedo-utilizar-para-escribir-programas-en-paralelo" title="Permalink to this headline">¶</a></h3>
<p>Hay <span class="math notranslate nohighlight">\(2\)</span> enfoques muy utilizados para escribir programas en paralelo:</p>
<ul class="simple">
<li><p>Paralelizar las tareas entre los cores. Su característica principal es la ejecución de instrucciones distintas en los cores. Por ejemplo: al llegar la persona invitada a casa, María le ofrecerá de tomar y Luis le abrirá la puerta.</p></li>
<li><p>Paralelización de los datos entre los cores. Su característica principal es la ejecución de mismas instrucciones en datos que fueron divididos por alguna metodología previa. Por ejemplo: tú repartes la mitad del pastel a las mesas 1,2 y 3, y yo la otra mitad a las mesas 4,5 y 6.</p></li>
</ul>
<div class="admonition-comentarios admonition">
<p class="admonition-title">Comentarios</p>
<ul class="simple">
<li><p>No son enfoques excluyentes, esto es, podemos encontrar ambos en un mismo programa. La elección de alguno de éstos enfoques depende del problema y del software que será usado para tal enfoque.</p></li>
<li><p>Obsérvese que en el ejemplo de María y Luis necesitan <strong>coordinarse</strong>, <strong>comunicarse</strong> y <strong>sincronizarse</strong> para tener éxito en recibir a la invitada.</p></li>
<li><p>Obsérvese que en el ejemplo de repartir el pastel se requiere un buen <strong>load balancing</strong> pues no queremos que yo le reparta a <span class="math notranslate nohighlight">\(5\)</span> mesas y tú le repartas a sólo una!.</p></li>
</ul>
</div>
</div>
<div class="section" id="a-que-nos-referimos-con-el-termino-embarrassingly-parallel-problem">
<h3>¿A qué nos referimos con el término <em>embarrassingly parallel problem</em>?<a class="headerlink" href="#a-que-nos-referimos-con-el-termino-embarrassingly-parallel-problem" title="Permalink to this headline">¶</a></h3>
<p>A los problemas en los que la comunicación entre procesos o threads es cero. Por ejemplo sumar un array <code class="docutils literal notranslate"><span class="pre">a</span></code> con un array <code class="docutils literal notranslate"><span class="pre">b</span></code>.</p>
<p>Y en general si evitamos compartir el estado (pensando a la palabra “estado” como un término más general que sólo comunicación) en un sistema paralelo nos hará la vida más fácil (el <em>speedup</em> será bueno, el <em>debugging</em> será sencillo, el perfilamiento será más fácil de realizar…).</p>
</div>
<div class="section" id="como-inicio-en-la-programacion-en-paralelo-de-mi-codigo">
<h3>¿Cómo inicio en la programación en paralelo de mi código?<a class="headerlink" href="#como-inicio-en-la-programacion-en-paralelo-de-mi-codigo" title="Permalink to this headline">¶</a></h3>
<p>Ian Foster en su libro <em>Designing and Building Parallel Programs</em> da una serie de pasos que ayudan a la programación en paralelo:</p>
<ul class="simple">
<li><p><em>Partitioning. Divide the computation to be performed and the data operated on by the computation into small tasks. The focus here should be on identifying tasks that can be executed in parallel.</em></p></li>
<li><p><em>Communication. Determine what communication needs to be carried out among the tasks identified in the previous step.</em></p></li>
<li><p><em>Agglomeration or aggregation. Combine tasks and communications identified in the first step into larger tasks. For example, if task A must be executed before task B can be executed, it may make sense to aggregate them into a single composite task.</em></p></li>
<li><p><em>Mapping. Assign the composite tasks identified in the previous step to processes/threads. This should be done so that communication is minimized, and each process/thread gets roughly the same amount of work.</em></p></li>
</ul>
<div class="admonition-comentario admonition">
<p class="admonition-title">Comentario</p>
<p>En ocasiones es mejor dejar las tareas simples y redundantes que complicarlas y no redundantes. Por ejemplo, si en el programa en paralelo varios procesadores o threads hacen tarea redundante pero me evitan la comunicación, prefiero este programa a uno en el que haga  trabajo no redundate y muy específico a cada procesador o thread pero que la comunicación a realizar sea muy complicada o compleja.</p>
</div>
</div>
<div class="section" id="ejemplo-en-la-regla-del-rectangulo-compuesta-en-una-maquina-multicore-para-cpu">
<h3>Ejemplo en la regla del rectángulo compuesta en una máquina <em>multicore</em> para CPU<a class="headerlink" href="#ejemplo-en-la-regla-del-rectangulo-compuesta-en-una-maquina-multicore-para-cpu" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p><em>Partitioning</em>: la tarea a realizar es el cálculo de un área de un rectángulo para un subintervalo.</p></li>
</ol>
<img src="https://dl.dropboxusercontent.com/s/5nqciu6ca5xzdh9/parallel_processing_Rcf_1.png?dl=0" heigth="300" width="400"><ol class="simple">
<li><p><em>Communication</em> y <em>mapping</em>: los subintervalos deben repartirse entre los <em>cores</em> y se debe comunicar esta repartición por algún medio (por ejemplo con variables en memoria).</p></li>
<li><p><em>Aggregation</em>: un <em>core</em> puede calcular más de un área de un rectángulo si recibe más de un subintervalo.</p></li>
</ol>
<img src="https://dl.dropboxusercontent.com/s/lpcwd9mejb90rq3/parallel_processing_Rcf_2.png?dl=0" heigth="200" width="300">
<ol class="simple">
<li><p><em>Communication</em> y <em>mapping</em>: el área de los rectángulos calculados por cada procesador deben sumarse para calcular la aproximación a la integral.</p></li>
</ol>
<img src="https://dl.dropboxusercontent.com/s/mfo5rfzjnonn8lq/parallel_processing_Rcf_3.png?dl=0" heigth="400" width="500">
</div>
<div class="section" id="software">
<h3>¿Software?<a class="headerlink" href="#software" title="Permalink to this headline">¶</a></h3>
<p>Depende si lo que deseamos usar son <em>cores</em> en una CPU tenemos:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://docs.dask.org/en/latest/">Dask</a>, <a class="reference external" href="https://docs.python.org/3.1/library/multiprocessing.html">multiprocessing</a>, <a class="reference external" href="https://www.rdocumentation.org/packages/parallel/versions/3.6.2">parallel</a>,  <a class="reference external" href="http://www.openmp.org/">openMP</a>, <a class="reference external" href="https://thrust.github.io/">Thrust</a> …</p></li>
</ul>
<p>Si deseamos usar <em>cores</em> en una GPU tenemos:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html">CUDA C</a>, <a class="reference external" href="https://docs.cupy.dev/en/stable/">CuPy</a>, <a class="reference external" href="https://documen.tician.de/pycuda/">PyCUDA</a>, <a class="reference external" href="https://www.rdocumentation.org/packages/gputools/versions/1.1">gputools</a>, <a class="reference external" href="https://thrust.github.io/">Thrust</a> ….</p></li>
</ul>
<div class="tip admonition">
<p class="admonition-title">Ejercicios</p>
<p>1.Resuelve los ejercicios y preguntas de la nota.</p>
</div>
<p><strong>Preguntas de comprehensión:</strong></p>
<p>1)Menciona la ley de Amdahl.</p>
<p>2)¿Qué significan los términos concurrencia, paralelo, distribuido?</p>
<p>3)¿Cuáles son los enfoques que se utilizan para escribir programas en paralelo?</p>
<p>4)Define a cuál enfoque corresponde (de acuerdo a la pregunta 13) cada uno de los siguientes incisos:</p>
<p>a) Supón que tienes 2 cores y un arreglo de tamaño 100</p>
<p>if(rango_core módulo 2 == 0 )
operar en los elementos 50 a 99
else
operar en los elementos 0 a 49</p>
<p>Donde módulo es una operación que nos devuelve el residuo al dividir un número entre otro.</p>
<p>b) Tenemos tres trabajadores: Aurora, Pedro, Daniel</p>
<p>if(mi_nombre es Pedro)
lavo el baño
else
voy de compras</p>
<p>5)En el cómputo en paralelo debemos realizar coordinación entre procesos o threads y considerar el load balancing. Menciona tipos de coordinación que existen y ¿a qué se refiere el load balancing?</p>
<p>6)¿Cuáles son los pasos a seguir, que de acuerdo a Ian Foster, se puede seguir para el diseño de programas en paralelo?</p>
<p><strong>Referencias:</strong></p>
<ol class="simple">
<li><p>M. Gorelick, I. Ozsvald, High Performance Python, O’Reilly Media, 2014.</p></li>
<li><p>E. Anderson, Z. Bai, C. Bischof, L. S. Blackford, J. Demmel, J. Dongarra, J. Du Croz,
A. Greenbaum, S. Hammarling, A. Mckenney and D. Sorensen, LAPACK Users Guide, Society for Industrial and Applied Mathematics, Philadelphia, PA, third ed., 1999.</p></li>
<li><p>P. Pacheco, An Introduction to Parallel Programming, Morgan Kaufmann, 2011.</p></li>
<li><p>https://xkcd.com/</p></li>
</ol>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "palmoreck/dockerfiles-for-binder",
            ref: "jupyterlab_optimizacion_2",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./V.optimizacion_de_codigo/5.1"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="../../IV.optimizacion_en_redes_y_prog_lineal/4.5/Metodo_primal_dual_de_BL.html" title="previous page">4.5 Método primal-dual de barrera logarítmica (BL)</a>
    <a class='right-next' id="next-link" href="../../VI.algoritmos_optimizacion_convexa/6.1/Problemas_UCO.html" title="next page">6.1 Problemas tipo <em>Unconstrained Convex Optimization</em> (UCO)</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Erick Palacios Moreno<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../../_static/js/index.3da636dd464baa7582d2.js"></script>


    
  </body>
</html>