

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>3.2 Optimización numérica y aprendizaje de máquina.</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous">
    <link href="../../_static/css/index.css" rel="stylesheet">
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/jupyter-sphinx.css" />
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/sphinx-book-theme.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/mystnb.js"></script>
    <script src="../../_static/sphinx-book-theme.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.18.0/dist/embed-amd.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe,.cell"
        const thebe_selector_input = "pre,.cell_input div.highlight"
        const thebe_selector_output = ".output,.cell_output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="3.3 Ecuaciones no lineales" href="../3.3/Ecuaciones_no_lineales.html" />
    <link rel="prev" title="3.1 Definición de problemas de optimización, conjuntos y funciones convexas" href="../3.1/Definicion_de_problema_optimizacion_conjuntos_y_funciones_convexas.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="docsearch:language" content="en">



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../../index.html">
  
  <img src="../../_static/logo.png" class="logo" alt="logo">
  
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../README.html">
   Optimización
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  I. Cómputo científico
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../I.computo_cientifico/1.1/Analisis_numerico_y_computo_cientifico.html">
   1.1 Análisis numérico y cómputo científico
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../I.computo_cientifico/1.2/Sistema_de_punto_flotante.html">
   1.2 Sistema de punto flotante
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../I.computo_cientifico/1.3/Normas_vectoriales_y_matriciales.html">
   1.3 Normas vectoriales y matriciales
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../I.computo_cientifico/1.4/Condicion_de_un_problema_y_estabilidad_de_un_algoritmo.html">
   1.4 Condición de un problema y estabilidad de un algoritmo
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../I.computo_cientifico/1.5/Definicion_de_funcion_continuidad_derivada.html">
   1.5 Definición de función, continuidad y derivada
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../I.computo_cientifico/1.6/Polinomios_de_Taylor_y_diferenciacion_numerica.html">
   1.6 Polinomios de Taylor y diferenciación numérica
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../I.computo_cientifico/1.7/Integracion_numerica.html">
   1.7 Integración Numérica
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  II. Cómputo matricial
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../II.computo_matricial/2.1/Operaciones_y_transformaciones_basicas_del_Algebra_Lineal_Numerica.html">
   2.1 Operaciones y transformaciones básicas del Álgebra Lineal Numérica
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../II.computo_matricial/2.2/Eigenvalores_y_eigenvectores.html">
   2.2 Eigenvalores y eigenvectores
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../II.computo_matricial/2.3/Algoritmos_y_aplicaciones_de_eigenvalores_eigenvectores_de_una_matriz.html">
   2.3 Algoritmos y aplicaciones de eigenvalores y eigenvectores de una matriz
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../II.computo_matricial/2.4/Valores_vectores_singulares_y_algoritmos_para_calcular_la_SVD.html">
   2.4 Valores, vectores singulares y algoritmos para calcular la SVD
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  III. Optimización convexa
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../3.1/Definicion_de_problema_optimizacion_conjuntos_y_funciones_convexas.html">
   3.1 Definición de problemas de optimización, conjuntos y funciones convexas
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   3.2 Optimización numérica y aprendizaje de máquina.
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../3.3/Ecuaciones_no_lineales.html">
   3.3 Ecuaciones no lineales
  </a>
 </li>
</ul>

</nav>

 <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    
    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/III.optimizacion_convexa/3.2/Optimizacion_numerica_y_aprendizaje_de_maquina.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
    
</div>
        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/palmoreck/dockerfiles-for-binder/jupyterlab_optimizacion?urlpath=lab/tree/analisis-numerico-computo-cientifico/libro_optimizacion/temas/III.optimizacion_convexa/3.2/Optimizacion_numerica_y_aprendizaje_de_maquina.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <button type="button" class="btn btn-secondary topbarbtn"
            onclick="initThebeSBT()" title="Launch Thebe" data-toggle="tooltip" data-placement="left"><i
                class="fas fa-play"></i><span style="margin-left: .4em;">Live Code</span></button>
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> On this page
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#relacion-entre-optimizacion-numerica-y-aprendizaje-de-maquina">
   Relación entre optimización numérica y aprendizaje de máquina
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#large-scale-machine-learning">
   Large scale machine learning
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#ejemplos-de-problemas-de-optimizacion-y-su-relacion-con-ecuaciones-no-lineales">
   Ejemplos de problemas de optimización y su relación con ecuaciones no lineales
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#ejemplo">
     Ejemplo
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#por-que-fue-un-poco-complicado-determinar-el-conjunto-de-minimos-de-f">
     ¿Por qué fue un poco complicado determinar el conjunto de mínimos de
     <span class="math notranslate nohighlight">
      \(f\)
     </span>
     ?
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#ejemplo-importante">
     Ejemplo importante
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Ejemplo
    </a>
   </li>
  </ul>
 </li>
</ul>

        </nav>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="optimizacion-numerica-y-aprendizaje-de-maquina">
<span id="onam"></span><h1>3.2 Optimización numérica y aprendizaje de máquina.<a class="headerlink" href="#optimizacion-numerica-y-aprendizaje-de-maquina" title="Permalink to this headline">¶</a></h1>
<div class="admonition-notas-para-contenedor-de-docker admonition">
<p class="admonition-title">Notas para contenedor de docker:</p>
<p>Comando de docker para ejecución de la nota de forma local:</p>
<p>nota: cambiar <code class="docutils literal notranslate"><span class="pre">&lt;ruta</span> <span class="pre">a</span> <span class="pre">mi</span> <span class="pre">directorio&gt;</span></code> por la ruta de directorio que se desea mapear a <code class="docutils literal notranslate"><span class="pre">/datos</span></code> dentro del contenedor de docker.</p>
<p><code class="docutils literal notranslate"><span class="pre">docker</span> <span class="pre">run</span> <span class="pre">--rm</span> <span class="pre">-v</span> <span class="pre">&lt;ruta</span> <span class="pre">a</span> <span class="pre">mi</span> <span class="pre">directorio&gt;:/datos</span> <span class="pre">--name</span> <span class="pre">jupyterlab_optimizacion</span> <span class="pre">-p</span> <span class="pre">8888:8888</span> <span class="pre">-d</span> <span class="pre">palmoreck/jupyterlab_optimizacion:2.1.4</span></code></p>
<p>password para jupyterlab: <code class="docutils literal notranslate"><span class="pre">qwerty</span></code></p>
<p>Detener el contenedor de docker:</p>
<p><code class="docutils literal notranslate"><span class="pre">docker</span> <span class="pre">stop</span> <span class="pre">jupyterlab_optimizacion</span></code></p>
<p>Documentación de la imagen de docker <code class="docutils literal notranslate"><span class="pre">palmoreck/jupyterlab_optimizacion:2.1.4</span></code> en <a class="reference external" href="https://github.com/palmoreck/dockerfiles/tree/master/jupyterlab/optimizacion">liga</a>.</p>
</div>
<hr class="docutils" />
<p>Nota generada a partir de .</p>
<div class="tip admonition">
<p class="admonition-title">Al final de esta nota el y la lectora:</p>
<ul class="simple">
<li></li>
</ul>
</div>
<div class="section" id="relacion-entre-optimizacion-numerica-y-aprendizaje-de-maquina">
<h2>Relación entre optimización numérica y aprendizaje de máquina<a class="headerlink" href="#relacion-entre-optimizacion-numerica-y-aprendizaje-de-maquina" title="Permalink to this headline">¶</a></h2>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>La implementación de los métodos o algoritmos en el contexto de grandes cantidades de datos o big data es crítica al ir a la práctica pues de esto depende que nuestra(s) máquina(s) tarde meses, semanas, días u horas para resolver problemas que se presentan en este contexto. En este contexto la <strong>optimización de código</strong> nos ayuda a la eficiencia.</p>
</div>
<p>La ciencia de datos apunta al desarrollo de técnicas y se apoya de aplicaciones de <em>machine learning</em> para la extracción de conocimiento útil tomando como fuente de información las grandes cantidades de datos. Algunas de las aplicaciones son:</p>
<ul class="simple">
<li><p>Clasificación de documentos o textos: detección de <em>spam</em>.</p></li>
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/Natural_language_processing">Procesamiento de lenguaje natural</a>:  <a class="reference external" href="https://en.wikipedia.org/wiki/Named-entity_recognition">named-entity recognition</a>.</p></li>
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/Speech_recognition">Reconocimiento de voz</a>.</p></li>
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/Computer_vision">Visión por computadora</a>: reconocimiento de rostros o imágenes.</p></li>
<li><p>Detección de fraude.</p></li>
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/Pattern_recognition">Reconocimiento de patrones</a>.</p></li>
<li><p>Diagnóstico médico.</p></li>
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/Recommender_system">Sistemas de recomendación</a>.</p></li>
</ul>
<p>Las aplicaciones anteriores involucran problemas como son:</p>
<ul class="simple">
<li><p>Clasificación.</p></li>
<li><p>Regresión.</p></li>
<li><p><em>Ranking</em>.</p></li>
<li><p><em>Clustering</em>.</p></li>
<li><p>Reducción de la dimensionalidad.</p></li>
</ul>
<p>En cada una de las aplicaciones o problemas anteriores se utilizan <strong>funciones de pérdida</strong> que guían el proceso de aprendizaje. Tal proceso involucra <strong>optimización parámetros</strong> de la función de pérdida. Por ejemplo, si la función de pérdida en un problema de regresión es una pérdida cuadrática <span class="math notranslate nohighlight">\(\mathcal{L}(y,\hat{y}) = (\hat{y}-y)^2\)</span> con <span class="math notranslate nohighlight">\(\hat{y} = \hat{\beta}_0 + \hat{\beta_1}x\)</span>, entonces el vector de parámetros a optimizar (aprender) es <span class="math notranslate nohighlight">\(\beta= \left[ \begin{array}{c} \beta_0\\ \beta_1 \end{array} \right]\)</span>.</p>
<div class="sidebar">
<p class="sidebar-title">Un poco de historia…</p>
<p>La IA o Inteligencia Artificial es una rama de la Ciencia de la Computación que atrajo un gran interés en 1950.</p>
<p>Colloquially, the term artificial intelligence is often used to describe machines (or computers) that mimic “cognitive” functions that humans associate with the human mind, such as learning and problem solving (<a class="reference external" href="https://en.wikipedia.org/wiki/Artificial_Intelligence:_A_Modern_Approach">S. J. Russel, P. Norvig, 1995</a>)</p>
</div>
<p><em>Machine learning</em> no sólo se apoya de la optimización pues es un área de Inteligencia Artificial que utiliza técnicas estadísticas para el diseño de sistemas capaces de aplicaciones como las escritas anteriormente, de modo que hoy en día tenemos <em>statistical machine learning</em>. No obstante, uno de los <strong>pilares</strong> de <em>machine learning</em> o <em>statistical machine learning</em> es la optimización.</p>
<p><em>Machine learning</em> o <em>statistical machine learning</em> se apoya de las formulaciones y algoritmos en optimización. Sin embargo, también ha contribuido a ésta área desarrollando nuevos enfoques en los métodos o algoritmos para el tratamiento de grandes cantidades de datos o <em>big data</em> y estableciendo retos significativos no presentes en problemas clásicos de optimización. De hecho, al revisar literatura que intersecta estas dos disciplinas encontramos comunidades científicas que desarrollan o utilizan métodos o algoritmos exactos (ver <a class="reference external" href="https://en.wikipedia.org/wiki/Exact_algorithm">Exact algorithm</a>) y otras que utilizan métodos de optimización estocástica (ver <a class="reference external" href="https://en.wikipedia.org/wiki/Stochastic_optimization">Stochastic optimization</a> y <a class="reference external" href="https://en.wikipedia.org/wiki/Stochastic_approximation">Stochastic approximation</a>) basados en métodos o algoritmos aproximados (ver <a class="reference external" href="https://en.wikipedia.org/wiki/Approximation_algorithm">Approximation algorithm</a>). Hoy en día es común encontrar estudios que hacen referencia a <strong>modelos o métodos de aprendizaje</strong>.</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>La regularización sigue el principio de la navaja de Occam, ver <a class="reference external" href="https://en.wikipedia.org/wiki/Occam%27s_razor">Occam’s razor</a>: para cualquier conjunto de observaciones en general se prefieren explicaciones simples a explicaciones más complicadas. Aunque la técnica de regularización es conocida en optimización, han sido varias las aplicaciones de <em>machine learning</em> las que la han posicionado como clave.</p>
</div>
<p>Como ejemplo de lo anterior considérese la técnica de <strong>regularización</strong> que en <em>machine learning</em> se utiliza para encontrar soluciones que generalicen y provean una explicación no compleja del fenómeno en estudio.</p>
</div>
<div class="section" id="large-scale-machine-learning">
<h2>Large scale machine learning<a class="headerlink" href="#large-scale-machine-learning" title="Permalink to this headline">¶</a></h2>
<div class="sidebar">
<p class="sidebar-title">Un poco de historia…</p>
<p>Un ejemplo de esto se observa en métodos de optimización desarrollados en la década de los <span class="math notranslate nohighlight">\(50\)</span>’s. Mientras que métodos tradicionales en optimización basados en el cálculo del gradiente y la Hessiana de una función son efectivos para problemas de aprendizaje <em>small-scale</em> (en los que  utilizamos un enfoque en <em><strong>batch</strong></em> o por lote), en el contexto del aprendizaje <em>large-scale</em>, el <strong>método de gradiente estocástico</strong> se posicionó en el centro de discusiones a inicios del siglo XXI.</p>
<p>El método de gradiente estocástico fue propuesto por Robbins y Monro en 1951, es un <strong>algoritmo estocástico</strong>. Ver <a class="reference external" href="https://en.wikipedia.org/wiki/Stochastic_gradient_descent">Stochastic gradient descent</a>.</p>
</div>
<p>El inicio del siglo XXI estuvo marcado, entre otros temas, por un incremento significativo en la generación de información. Esto puede contrastarse con el desarrollo de los procesadores de las máquinas, el cual tuvo un menor <em>performance</em> al del siglo XX. Asimismo, las mejoras en dispositivos de almacenamiento o <em>storage</em> y sistemas de <em>networking</em> abarató costos de almacenamiento y permitió tal incremento de información.  En este contexto, los modelos y métodos de <em>statistical machine learning</em> se vieron limitados por el tiempo de cómputo y no por el tamaño de muestra. La conclusión de esto fue una inclinación en la comunidad científica por el diseño o uso de métodos o modelos para procesar grandes cantidades de datos usando recursos computacionales comparativamente menores.</p>
</div>
<div class="section" id="ejemplos-de-problemas-de-optimizacion-y-su-relacion-con-ecuaciones-no-lineales">
<h2>Ejemplos de problemas de optimización y su relación con ecuaciones no lineales<a class="headerlink" href="#ejemplos-de-problemas-de-optimizacion-y-su-relacion-con-ecuaciones-no-lineales" title="Permalink to this headline">¶</a></h2>
<p>En optimización, la búsqueda del (o los) <strong>óptimo(s)</strong> involucran el cálculo de información de primer o segundo orden, ver <a class="reference internal" href="../../I.computo_cientifico/1.5/Definicion_de_funcion_continuidad_derivada.html#fcd"><span class="std std-ref">Definición de función, continuidad y derivada</span></a>, de la función <span class="math notranslate nohighlight">\(f_o\)</span> de acuerdo a lo revisado en los <a class="reference internal" href="../3.1/Definicion_de_problema_optimizacion_conjuntos_y_funciones_convexas.html#resutteoconv"><span class="std std-ref">resultados útiles de teoría de convexidad</span></a>.</p>
<div class="section" id="ejemplo">
<h3>Ejemplo<a class="headerlink" href="#ejemplo" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[\displaystyle \min_{x \in \mathbb{R}^2} x_1^4+2x_1^2x_2+x_2^2\]</div>
<p>Los candidatos a ser mínimos los encontramos al plantear:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\nabla f_o(x) = 
\left [
\begin{array}{c}
4x_1^3+4x_1x_2\\
2x_1^2+2x_2
\end{array}
\right ]=0
\end{split}\]</div>
<p>la cual es una ecuación de dos variables y dos incógnitas <strong>no lineal</strong>. Resolviendo para <span class="math notranslate nohighlight">\(x_2\)</span> se obtiene la relación: <span class="math notranslate nohighlight">\(x_2 = -x_1^2\)</span>. Entonces todos los puntos con coordenadas <span class="math notranslate nohighlight">\(x = (x_1, x_2)\)</span> que satisfacen tal relación cumplen <span class="math notranslate nohighlight">\(\nabla f_o(x) = 0\)</span>. ¿Todos serán mínimos locales?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">sympy</span>
<span class="kn">from</span> <span class="nn">sympy.tensor.array</span> <span class="kn">import</span> <span class="n">derive_by_array</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">fsolve</span>
<span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">fmin</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s2">&quot;x1, x2&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="n">x1</span><span class="o">**</span><span class="mi">4</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">x1</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">x2</span><span class="o">+</span><span class="n">x2</span><span class="o">**</span><span class="mi">2</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">f_numpy</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Gradiente</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gf</span> <span class="o">=</span> <span class="n">derive_by_array</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="p">[</span><span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">gf</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>⎡    3                2       ⎤
⎣4⋅x₁  + 4⋅x₁⋅x₂  2⋅x₁  + 2⋅x₂⎦
</pre></div>
</div>
</div>
</div>
<p><strong>Gráfica de la superficie <span class="math notranslate nohighlight">\(f_o\)</span></strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x1_plot</span><span class="p">,</span><span class="n">x2_plot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">100</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">100</span><span class="p">))</span>
<span class="n">z_plot</span> <span class="o">=</span> <span class="n">x1_plot</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">x1_plot</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">x2_plot</span> <span class="o">+</span> <span class="n">x2_plot</span><span class="o">**</span><span class="mi">2</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x1_np</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">x2_np</span> <span class="o">=</span> <span class="mi">0</span> 
<span class="n">z_np</span> <span class="o">=</span> <span class="n">f_numpy</span><span class="p">([</span><span class="n">x1_np</span><span class="p">,</span> <span class="n">x2_np</span><span class="p">])</span>
<span class="n">point</span> <span class="o">=</span> <span class="p">(</span><span class="n">x1_np</span><span class="p">,</span> <span class="n">x2_np</span><span class="p">,</span> <span class="n">z_np</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">point</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>(0, 0, 0)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create the figure</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="c1"># Add an axes</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">gca</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot_surface</span><span class="p">(</span><span class="n">x1_plot</span><span class="p">,</span> <span class="n">x2_plot</span><span class="p">,</span> <span class="n">z_plot</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">point</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">point</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">point</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Optimizacion_numerica_y_aprendizaje_de_maquina_37_0.png" src="../../_images/Optimizacion_numerica_y_aprendizaje_de_maquina_37_0.png" />
</div>
</div>
<p id="gcnivelnoconvexa"><strong>Gráfica de las curvas de nivel de <span class="math notranslate nohighlight">\(f_o\)</span></strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x1_plot</span><span class="p">,</span><span class="n">x2_plot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">100</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span><span class="mi">100</span><span class="p">))</span>
<span class="n">z_plot</span> <span class="o">=</span> <span class="n">x1_plot</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">x1_plot</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">x2_plot</span> <span class="o">+</span> <span class="n">x2_plot</span><span class="o">**</span><span class="mi">2</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">x1_plot</span><span class="p">,</span><span class="n">x2_plot</span><span class="p">,</span><span class="n">z_plot</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">point</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">point</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Optimizacion_numerica_y_aprendizaje_de_maquina_41_0.png" src="../../_images/Optimizacion_numerica_y_aprendizaje_de_maquina_41_0.png" />
</div>
</div>
<p><strong>Resolvamos con <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.fsolve.html#scipy.optimize.fsolve">scipy.optimize.fsolve</a> la ecuación no lineal <span class="math notranslate nohighlight">\(\nabla f_o(x) = 0\)</span></strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">eqn</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="o">=</span><span class="n">x</span>
    <span class="k">return</span> <span class="p">[</span><span class="mi">4</span><span class="o">*</span><span class="n">x1</span><span class="o">**</span><span class="mi">3</span><span class="o">+</span><span class="mi">4</span><span class="o">*</span><span class="n">x1</span><span class="o">*</span><span class="n">x2</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">x1</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">x2</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Eligiendo diferentes puntos iniciales</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">root1</span> <span class="o">=</span> <span class="n">fsolve</span><span class="p">(</span><span class="n">eqn</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">root2</span> <span class="o">=</span> <span class="n">fsolve</span><span class="p">(</span><span class="n">eqn</span><span class="p">,</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">root3</span> <span class="o">=</span> <span class="n">fsolve</span><span class="p">(</span><span class="n">eqn</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dic_roots</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;root1&quot;</span><span class="p">:</span> <span class="n">root1</span><span class="p">,</span>
             <span class="s2">&quot;root2&quot;</span><span class="p">:</span> <span class="n">root2</span><span class="p">,</span>
             <span class="s2">&quot;root3&quot;</span><span class="p">:</span> <span class="n">root3</span><span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">dic_roots</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>   root1  root2  root3
0    1.0   -1.0    2.0
1   -1.0   -1.0   -4.0
</pre></div>
</div>
</div>
</div>
<p><strong>Obsérvese que todos los puntos anteriores satisfacen la relación <span class="math notranslate nohighlight">\(x_2 = -x_1^2\)</span>. Al evaluar el gradiente en cada punto obtenemos cero (o cercano a cero):</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">eval_root</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">r</span><span class="p">:</span> <span class="p">[</span><span class="n">partial_derivative</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="s2">&quot;x1&quot;</span><span class="p">:</span> <span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;x2&quot;</span><span class="p">:</span><span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">]})</span> <span class="k">for</span> <span class="n">partial_derivative</span> <span class="ow">in</span> <span class="n">gf</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dic</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;root1&quot;</span><span class="p">:</span> <span class="n">eval_root</span><span class="p">(</span><span class="n">root1</span><span class="p">),</span>
       <span class="s2">&quot;root2&quot;</span><span class="p">:</span> <span class="n">eval_root</span><span class="p">(</span><span class="n">root2</span><span class="p">),</span>
       <span class="s2">&quot;root3&quot;</span><span class="p">:</span> <span class="n">eval_root</span><span class="p">(</span><span class="n">root3</span><span class="p">)}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">dic</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>                  root1                  root2 root3
0  4.44089209850063e-16   4.44089209850063e-16     0
1  2.22044604925031e-16  -2.22044604925031e-16     0
</pre></div>
</div>
</div>
</div>
<p><strong>¿Cómo podemos identificar si son mínimos? … usamos a la Hessiana de <span class="math notranslate nohighlight">\(f_o\)</span></strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Hf</span> <span class="o">=</span> <span class="n">derive_by_array</span><span class="p">(</span><span class="n">gf</span><span class="p">,</span> <span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">Hf</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>⎡     2             ⎤
⎢12⋅x₁  + 4⋅x₂  4⋅x₁⎥
⎢                   ⎥
⎣    4⋅x₁        2  ⎦
</pre></div>
</div>
</div>
</div>
<p><strong>Podemos revisar eigenvalores de la Hessiana</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">eval2_root</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">r</span><span class="p">:</span> <span class="p">[</span><span class="n">second_partial_derivative</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="s2">&quot;x1&quot;</span><span class="p">:</span> <span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;x2&quot;</span><span class="p">:</span><span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">]})</span> <span class="k">for</span> <span class="n">second_partial_derivative</span> <span class="ow">in</span> <span class="n">Hf</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Hf_root1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">eval2_root</span><span class="p">(</span><span class="n">root1</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<span class="n">Hf_root2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">eval2_root</span><span class="p">(</span><span class="n">root2</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<span class="n">Hf_root3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">eval2_root</span><span class="p">(</span><span class="n">root3</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eigvals</span><span class="p">(</span><span class="n">Hf_root1</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[10.  0.]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eigvals</span><span class="p">(</span><span class="n">Hf_root2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[ 1.0000000e+01 -4.4408921e-16]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eigvals</span><span class="p">(</span><span class="n">Hf_root3</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[34.  0.]
</pre></div>
</div>
</div>
</div>
<p><strong>Las Hessianas evaluadas en <code class="docutils literal notranslate"><span class="pre">root1</span></code> y <code class="docutils literal notranslate"><span class="pre">root3</span></code> son semidefinidas positivas (y también <code class="docutils literal notranslate"><span class="pre">root2</span></code> si consideramos que <span class="math notranslate nohighlight">\(10^{-16}\)</span> es un número cercano a <span class="math notranslate nohighlight">\(0\)</span>), entonces no podemos concluir que son mínimos locales de <span class="math notranslate nohighlight">\(f\)</span>…</strong></p>
<p><strong>Podemos utilizar el siguiente criterio para <span class="math notranslate nohighlight">\(2\)</span> dimensiones:</strong></p>
<div class="admonition-comentario admonition">
<p class="admonition-title">Comentario</p>
<p>Sea <span class="math notranslate nohighlight">\(f \in \mathcal{C}^2(\text{intdom}f)\)</span> y <span class="math notranslate nohighlight">\(x \in \mathbb{R}^2\)</span> un punto crítico o estacionario de <span class="math notranslate nohighlight">\(f\)</span>:</p>
<ul class="simple">
<li><p>Si <span class="math notranslate nohighlight">\(\frac{\partial^2f(x)}{\partial x_1^2} &lt; 0\)</span> y <span class="math notranslate nohighlight">\(\det(\nabla^2 f(x)) &gt;0\)</span> entonces <span class="math notranslate nohighlight">\(f\)</span> tiene un <strong>máximo local</strong> en <span class="math notranslate nohighlight">\(x\)</span>.</p></li>
<li><p>Si <span class="math notranslate nohighlight">\(\frac{\partial^2f(x)}{\partial x_1^2} &gt; 0\)</span> y <span class="math notranslate nohighlight">\(\det(\nabla^2 f(x)) &gt;0\)</span> entonces <span class="math notranslate nohighlight">\(f\)</span> tiene un <strong>mínimo local</strong> en <span class="math notranslate nohighlight">\(x\)</span>.</p></li>
<li><p>Si <span class="math notranslate nohighlight">\(\det(\nabla^2 f(x)) &lt; 0\)</span> entonces <span class="math notranslate nohighlight">\(f\)</span> tiene un <strong>punto silla o <a class="reference external" href="https://en.wikipedia.org/wiki/Saddle_point"><em>saddle point</em></a></strong> en <span class="math notranslate nohighlight">\(x\)</span>.</p></li>
<li><p>Si <span class="math notranslate nohighlight">\(\det(\nabla^2 f(x)) = 0\)</span> no podemos concluir si <span class="math notranslate nohighlight">\(x\)</span> es extremo.</p></li>
</ul>
</div>
<div class="tip admonition">
<p class="admonition-title">Observaciones</p>
<ul class="simple">
<li><p>Al determinante de la Hessiana de <span class="math notranslate nohighlight">\(f\)</span> se le nombra <strong>Hessiano</strong> de <span class="math notranslate nohighlight">\(f\)</span>.</p></li>
<li><p>Lo anterior es un caso particular de los resultados descritos en <a class="reference internal" href="../3.1/Definicion_de_problema_optimizacion_conjuntos_y_funciones_convexas.html#spcriticos"><span class="std std-ref">sobre puntos críticos</span></a>.</p></li>
</ul>
</div>
<p><strong>En el ejemplo el Hessiano es:</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">sympy</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="n">Hf</span><span class="p">)</span><span class="o">.</span><span class="n">det</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>    2       
8⋅x₁  + 8⋅x₂
</pre></div>
</div>
</div>
</div>
<p><strong>El cual se anula para los puntos que cumplen: <span class="math notranslate nohighlight">\(x_2 = -x_1^2\)</span></strong></p>
<p><span class="math notranslate nohighlight">\(8x_1^2 + 8x_2 = 8 x_1^2 + 8(-x_1^2) = 0\)</span></p>
<p><strong>Por lo que no podemos concluir…</strong></p>
<p><strong>Si queremos usar una función de <em>SciPy</em> tenemos: <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.fmin.html">scipy.optimize.fmin</a></strong></p>
<p><strong>Elegimos un punto inicial</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">res_fmin</span> <span class="o">=</span> <span class="n">fmin</span><span class="p">(</span><span class="n">f_numpy</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>Optimization terminated successfully.
         Current function value: 0.000000
         Iterations: 56
         Function evaluations: 110
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">res_fmin</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[-0.06346131 -0.0040273 ]
</pre></div>
</div>
</div>
</div>
<p><strong>Evaluamos la Hessiana</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Hf_min</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">eval2_root</span><span class="p">(</span><span class="n">res_fmin</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">eval_root</span><span class="p">(</span><span class="n">res_fmin</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[-9.02580453280601e-9, 7.11126587876060e-8]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eigvals</span><span class="p">(</span><span class="n">Hf_min</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[1.39970484e-07 2.03221870e+00]
</pre></div>
</div>
</div>
</div>
<p><strong>La Hessiana es semidefinida positiva y por lo tanto <span class="math notranslate nohighlight">\(x^*=\left [\begin{array}{c} -0.06346 \\ -0.00402 \end{array} \right]\)</span> no podemos concluir que es mínimo local estricto.</strong></p>
<p><strong>Coloquemos los puntos que cumplen <span class="math notranslate nohighlight">\(x_2=-x_1^2\)</span> en la gráfica de la superficie</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x1_plot</span><span class="p">,</span><span class="n">x2_plot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">100</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">100</span><span class="p">))</span>
<span class="n">z_plot</span> <span class="o">=</span> <span class="n">x1_plot</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">x1_plot</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">x2_plot</span> <span class="o">+</span> <span class="n">x2_plot</span><span class="o">**</span><span class="mi">2</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">point1</span> <span class="o">=</span> <span class="p">(</span><span class="n">root1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">root1</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">f_numpy</span><span class="p">(</span><span class="n">root1</span><span class="p">))</span>
<span class="n">point2</span> <span class="o">=</span> <span class="p">(</span><span class="n">root2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">root2</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">f_numpy</span><span class="p">(</span><span class="n">root2</span><span class="p">))</span>
<span class="n">point3</span> <span class="o">=</span> <span class="p">(</span><span class="n">root3</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">root3</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">f_numpy</span><span class="p">(</span><span class="n">root3</span><span class="p">))</span>
<span class="c1">#another point:</span>
<span class="n">point4</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x1_plot2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create the figure</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="c1"># Add an axes</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">gca</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot_surface</span><span class="p">(</span><span class="n">x1_plot</span><span class="p">,</span> <span class="n">x2_plot</span><span class="p">,</span> <span class="n">z_plot</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">point</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">point</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">point</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">point1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">point1</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">point1</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">point2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">point2</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">point2</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">point3</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">point3</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">point3</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">point4</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">point4</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">point4</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1_plot2</span><span class="p">,</span> <span class="o">-</span><span class="n">x1_plot2</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Optimizacion_numerica_y_aprendizaje_de_maquina_85_0.png" src="../../_images/Optimizacion_numerica_y_aprendizaje_de_maquina_85_0.png" />
</div>
</div>
<p><strong>Por la forma de la gráfica</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x1_plot</span><span class="p">,</span><span class="n">x2_plot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">100</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">100</span><span class="p">))</span>
<span class="n">z_plot</span> <span class="o">=</span> <span class="n">x1_plot</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">x1_plot</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">x2_plot</span> <span class="o">+</span> <span class="n">x2_plot</span><span class="o">**</span><span class="mi">2</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create the figure</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="c1"># Add an axes</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">gca</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot_surface</span><span class="p">(</span><span class="n">x1_plot</span><span class="p">,</span> <span class="n">x2_plot</span><span class="p">,</span> <span class="n">z_plot</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Optimizacion_numerica_y_aprendizaje_de_maquina_88_0.png" src="../../_images/Optimizacion_numerica_y_aprendizaje_de_maquina_88_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">z_plot</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>0
</pre></div>
</div>
</div>
</div>
<p><strong>El mínimo valor de <span class="math notranslate nohighlight">\(f\)</span> es <span class="math notranslate nohighlight">\(0\)</span> por lo que tenemos un conjunto de mínimos dados por la curva <span class="math notranslate nohighlight">\(x_2=-x_1^2\)</span>.</strong></p>
</div>
<div class="section" id="por-que-fue-un-poco-complicado-determinar-el-conjunto-de-minimos-de-f">
<h3>¿Por qué fue un poco complicado determinar el conjunto de mínimos de <span class="math notranslate nohighlight">\(f\)</span>?<a class="headerlink" href="#por-que-fue-un-poco-complicado-determinar-el-conjunto-de-minimos-de-f" title="Permalink to this headline">¶</a></h3>
<p><strong><span class="math notranslate nohighlight">\(f(x)=x_1^4+2x_1^2x_2+x_2^2\)</span> no es una función convexa en su <span class="math notranslate nohighlight">\(\text{dom}f\)</span>, esto es, no satisface la desigualdad:</strong></p>
<div class="math notranslate nohighlight">
\[f(\theta x + (1-\theta) y) \leq \theta f(x) + (1-\theta)f(y)\]</div>
<p><strong>para puntos <span class="math notranslate nohighlight">\(x,y\)</span> en su dominio y <span class="math notranslate nohighlight">\(\forall \theta \in [0,1]\)</span></strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pointx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">pointy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">theta</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">point_convex_combination</span> <span class="o">=</span> <span class="n">theta</span><span class="o">*</span><span class="n">pointx</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">theta</span><span class="p">)</span><span class="o">*</span><span class="n">pointy</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">f_numpy</span><span class="p">(</span><span class="n">point_convex_combination</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>1.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">theta</span><span class="o">*</span><span class="n">f_numpy</span><span class="p">(</span><span class="n">pointx</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">theta</span><span class="p">)</span><span class="o">*</span><span class="n">f_numpy</span><span class="p">(</span><span class="n">pointy</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>4.0
</pre></div>
</div>
</div>
</div>
<p><strong>también viendo algunas de sus curvas de nivel en <a class="reference internal" href="#gcnivelnoconvexa"><span class="std std-ref">gráfica de las curvas de nivel de fo</span></a> podemos ver que no es convexa.</strong></p>
</div>
<div class="section" id="ejemplo-importante">
<h3>Ejemplo importante<a class="headerlink" href="#ejemplo-importante" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[\displaystyle \min_{x \in \mathbb{R}^2} \frac{1}{2}x^TPx+q^Tx+r\]</div>
<p>donde: <span class="math notranslate nohighlight">\(P=\left [\begin{array}{cc} 5 &amp; 4\\ 4 &amp; 5 \end{array} \right ]\)</span>, <span class="math notranslate nohighlight">\(q=\left [\begin{array}{c} -1\\ 1 \end{array} \right]\)</span>, <span class="math notranslate nohighlight">\(r=3\)</span>.</p>
<p>Obsérvese que haciendo las multiplicaciones de matriz-vector y productos punto se reescribe el problema como:</p>
<div class="math notranslate nohighlight">
\[\displaystyle \min_{x \in \mathbb{R}^2} \frac{5}{2}x_1^2 + \frac{5}{2}x_2^2+4x_1x_2 -x_1 + x_2+3\]</div>
<p>Entonces:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\nabla f_o(x) = Px +q =\left [ \begin{array}{cc}
5 &amp; 4\\
4 &amp; 5
\end{array}
\right ]
\left [ \begin{array}{c}
x_1\\
x_2
\end{array}
\right ]
+ \left [ \begin{array}{c}
-1\\
1
\end{array}
\right ]=
\left [ \begin{array}{cc}
5x_1+4x_2-1\\
4x_1+5x_2+1
\end{array}
\right ]
=0
\end{split}\]</div>
<p>que es una <strong>ecuación en dos variables con dos incógnitas lineal</strong>.</p>
<div class="admonition-comentarios admonition">
<p class="admonition-title">Comentarios</p>
<p>En algunos casos especiales es posible resolver la ecuación no lineal <span class="math notranslate nohighlight">\(\nabla f_o(x) = 0\)</span> para <span class="math notranslate nohighlight">\(x\)</span> de forma analítica o cerrada. Este es el caso de este ejemplo cuya solución está dada por <span class="math notranslate nohighlight">\(x^* = -P^{-1}q\)</span>.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">P</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]])</span>
<span class="n">q</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="o">-</span><span class="n">q</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[ 1. -1.]
</pre></div>
</div>
</div>
</div>
<div class="admonition-definicion admonition">
<p class="admonition-title">Definición</p>
<p>Típicamente se utiliza un método iterativo: calcular una secuencia de puntos <span class="math notranslate nohighlight">\(x^{(0)}, x^{(1)}, \dots \in \text{dom}f_o\)</span> con <span class="math notranslate nohighlight">\(f_o(x^{(k)}) \rightarrow p^*\)</span> si <span class="math notranslate nohighlight">\(k \rightarrow \infty\)</span>. El conjunto de puntos <span class="math notranslate nohighlight">\(x^{(0)}, x^{(1)},\dots\)</span> se nombra <strong>secuencia de minimización</strong> para el problema de optimización. El algoritmo termina si <span class="math notranslate nohighlight">\(f_o(x^{(k)})-p^* \leq \epsilon\)</span> con <span class="math notranslate nohighlight">\(\epsilon &gt;0\)</span> una tolerancia dada. Tales métodos se conocen con el nombre de <strong>métodos de descenso</strong>.</p>
</div>
</div>
<div class="section" id="id1">
<h3>Ejemplo<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[\displaystyle \min_{x \in \mathbb{R}^4} (x_1-2)^2+(2-x_2)^2+x_3^2+x_4^4\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">x3</span><span class="p">,</span> <span class="n">x4</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s2">&quot;x1, x2, x3, x4&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="p">(</span><span class="n">x1</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="mi">2</span><span class="o">-</span><span class="n">x2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x3</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x4</span><span class="o">**</span><span class="mi">4</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gf</span> <span class="o">=</span> <span class="n">derive_by_array</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">x3</span><span class="p">,</span> <span class="n">x4</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">gf</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>⎡                              3⎤
⎣2⋅x₁ - 4  2⋅x₂ - 4  2⋅x₃  4⋅x₄ ⎦
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Hf</span> <span class="o">=</span> <span class="n">derive_by_array</span><span class="p">(</span><span class="n">gf</span><span class="p">,</span> <span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">x3</span><span class="p">,</span> <span class="n">x4</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">Hf</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>⎡2  0  0    0   ⎤
⎢               ⎥
⎢0  2  0    0   ⎥
⎢               ⎥
⎢0  0  2    0   ⎥
⎢               ⎥
⎢              2⎥
⎣0  0  0  12⋅x₄ ⎦
</pre></div>
</div>
</div>
</div>
<p>Como <span class="math notranslate nohighlight">\(f\)</span> es una función convexa, se tiene que su óptimo se obtiene igualando y resolviendo la <strong>ecuación no lineal</strong> <span class="math notranslate nohighlight">\(\nabla f(x) = 0\)</span> :</p>
<div class="math notranslate nohighlight">
\[\begin{split}\nabla f(x) = 
\left[ \begin{array}{c}
2x_1-4 \\
2x_2-4\\
2x_3\\
4x_4^3
\end{array}
\right]
= 0
\end{split}\]</div>
<p>El óptimo <span class="math notranslate nohighlight">\(x^* \in \mathbb{R}^4\)</span> está dado por:</p>
<div class="math notranslate nohighlight">
\[\begin{split}x^*=
\left[ \begin{array}{c}
2\\
2\\
0\\
0
\end{array}
\right]
\end{split}\]</div>
<p><strong>¿Cómo encontramos numéricamente el óptimo?</strong></p>
<p><strong>Preguntas de comprehensión.</strong></p>
<ol class="simple">
<li></li>
</ol>
<p><strong>Referencias:</strong></p>
<ol class="simple">
<li></li>
<li></li>
</ol>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "palmoreck/dockerfiles-for-binder",
            ref: "jupyterlab_optimizacion",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./III.optimizacion_convexa/3.2"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="../3.1/Definicion_de_problema_optimizacion_conjuntos_y_funciones_convexas.html" title="previous page">3.1 Definición de problemas de optimización, conjuntos y funciones convexas</a>
    <a class='right-next' id="next-link" href="../3.3/Ecuaciones_no_lineales.html" title="next page">3.3 Ecuaciones no lineales</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Erick Palacios Moreno<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    <script src="../../_static/js/index.js"></script>
    
  </body>
</html>