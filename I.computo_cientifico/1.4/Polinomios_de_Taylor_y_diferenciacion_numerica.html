

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>1.4 Polinomios de Taylor y diferenciación numérica</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous">
    <link href="../../_static/css/index.css" rel="stylesheet">
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/jupyter-sphinx.css" />
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/sphinx-book-theme.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/mystnb.js"></script>
    <script src="../../_static/sphinx-book-theme.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.18.0/dist/embed-amd.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe,.cell"
        const thebe_selector_input = "pre,.cell_input div.highlight"
        const thebe_selector_output = ".output,.cell_output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="prev" title="1.3 Condición de un problema y estabilidad de un algoritmo" href="../1.3/Condicion_de_un_problema_y_estabilidad_de_un_algoritmo.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="docsearch:language" content="en">



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../../index.html">
  
  <img src="../../_static/logo.png" class="logo" alt="logo">
  
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../README.html">
   Optimización
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  I. Cómputo científico
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../1.1/Analisis_numerico_y_computo_cientifico.html">
   1.1 Análisis numérico y cómputo científico
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../1.2/Sistema_de_punto_flotante.html">
   1.2 Sistema de punto flotante
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../1.3/Condicion_de_un_problema_y_estabilidad_de_un_algoritmo.html">
   1.3 Condición de un problema y estabilidad de un algoritmo
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   1.4 Polinomios de Taylor y diferenciación numérica
  </a>
 </li>
</ul>

</nav>

 <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    
    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/I.computo_cientifico/1.4/Polinomios_de_Taylor_y_diferenciacion_numerica.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
    
</div>
        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/palmoreck/dockerfiles-for-binder/https://github.com/palmoreck/dockerfiles-for-binder/tree/jupyterlab_optimizacion?urlpath=lab/tree/I.computo_cientifico/1.4/Polinomios_de_Taylor_y_diferenciacion_numerica.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <button type="button" class="btn btn-secondary topbarbtn"
            onclick="initThebeSBT()" title="Launch Thebe" data-toggle="tooltip" data-placement="left"><i
                class="fas fa-play"></i><span style="margin-left: .4em;">Live Code</span></button>
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> On this page
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#problema-como-aproximar-una-funcion-f-en-un-punto-x-1">
   Problema: ¿Cómo aproximar una función
   <span class="math notranslate nohighlight">
    \(f\)
   </span>
   en un punto
   <span class="math notranslate nohighlight">
    \(x_1\)
   </span>
   ?
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#aproximacion-a-una-funcion-por-el-teorema-de-taylor">
   Aproximación a una función por el teorema de Taylor
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#teorema-de-taylor-para-una-funcion-f-mathbb-r-n-rightarrow-mathbb-r">
     Teorema de Taylor para una función
     <span class="math notranslate nohighlight">
      \(f: \mathbb{R}^n \rightarrow \mathbb{R}\)
     </span>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#diferenciacion-numerica-por-diferencias-finitas">
   Diferenciación numérica por diferencias finitas
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#analisis-del-error-por-redondeo-y-truncamiento-en-aproximacion-por-diferencias-finitas-hacia-delante">
     Análisis del error por redondeo y truncamiento en aproximación por diferencias finitas hacia delante
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#diferenciacion-numerica-para-una-funcion-f-mathbb-r-n-rightarrow-mathbb-r">
     Diferenciación numérica para una función
     <span class="math notranslate nohighlight">
      \(f: \mathbb{R}^n \rightarrow \mathbb{R}\)
     </span>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#definiciones-utilizadas-en-el-curso-algunas-de-ellas">
   Definiciones utilizadas en el curso (algunas de ellas…)
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#funcion-diferenciable">
     Función Diferenciable
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#caso-f-mathbb-r-rightarrow-mathbb-r">
     Caso
     <span class="math notranslate nohighlight">
      \(f: \mathbb{R} \rightarrow \mathbb{R}\)
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#caso-f-mathbb-r-n-rightarrow-mathbb-r-m">
     Caso
     <span class="math notranslate nohighlight">
      \(f: \mathbb{R}^n \rightarrow \mathbb{R}^m\)
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#regla-de-la-cadena">
     Regla de la cadena
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#caso-particular">
     Caso particular:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#segunda-derivada-de-una-funcion-f-mathbb-r-n-rightarrow-mathbb-r">
     Segunda derivada de una función
     <span class="math notranslate nohighlight">
      \(f: \mathbb{R}^n \rightarrow \mathbb{R}\)
     </span>
     .
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#regla-de-la-cadena-para-la-segunda-derivada">
     Regla de la cadena para la segunda derivada
    </a>
   </li>
  </ul>
 </li>
</ul>

        </nav>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <p><strong>Notas para contenedor de docker:</strong></p>
<p>Comando de docker para ejecución de la nota de forma local:</p>
<p>nota: cambiar <code class="docutils literal notranslate"><span class="pre">&lt;ruta</span> <span class="pre">a</span> <span class="pre">mi</span> <span class="pre">directorio&gt;</span></code> por la ruta de directorio que se desea mapear a <code class="docutils literal notranslate"><span class="pre">/datos</span></code> dentro del contenedor de docker.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">docker</span> <span class="n">run</span> <span class="o">--</span><span class="n">rm</span> <span class="o">-</span><span class="n">v</span> <span class="o">&lt;</span><span class="n">ruta</span> <span class="n">a</span> <span class="n">mi</span> <span class="n">directorio</span><span class="o">&gt;</span><span class="p">:</span><span class="o">/</span><span class="n">datos</span> <span class="o">--</span><span class="n">name</span> <span class="n">jupyterlab_optimizacion</span> <span class="o">-</span><span class="n">p</span> <span class="mi">8888</span><span class="p">:</span><span class="mi">8888</span> <span class="o">-</span><span class="n">d</span> <span class="n">palmoreck</span><span class="o">/</span><span class="n">jupyterlab_optimizacion</span><span class="p">:</span><span class="mf">2.1</span><span class="o">.</span><span class="mi">4</span>
</pre></div>
</div>
<p>password para jupyterlab: <code class="docutils literal notranslate"><span class="pre">qwerty</span></code></p>
<p>Detener el contenedor de docker:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">docker</span> <span class="n">stop</span> <span class="n">jupyterlab_optimizacion</span>
</pre></div>
</div>
<p>Documentación de la imagen de docker <code class="docutils literal notranslate"><span class="pre">palmoreck/jupyterlab_optimizacion:2.1.4</span></code> en <a class="reference external" href="https://github.com/palmoreck/dockerfiles/tree/master/jupyterlab/optimizacion">liga</a>.</p>
<hr class="docutils" />
<p>Nota generada a partir de la <a class="reference external" href="https://www.dropbox.com/s/jfrxanjls8kndjp/Diferenciacion_e_Integracion.pdf?dl=0">liga1</a>, <a class="reference external" href="https://www.dropbox.com/s/mmd1uzvwhdwsyiu/4.3.2.Teoria_de_convexidad_Funciones_convexas.pdf?dl=0">liga2</a> e inicio de <a class="reference external" href="https://www.dropbox.com/s/ko86cce1olbtsbk/4.3.1.Teoria_de_convexidad_Conjuntos_convexos.pdf?dl=0">liga3</a>.</p>
<div class="section" id="polinomios-de-taylor-y-diferenciacion-numerica">
<h1>1.4 Polinomios de Taylor y diferenciación numérica<a class="headerlink" href="#polinomios-de-taylor-y-diferenciacion-numerica" title="Permalink to this headline">¶</a></h1>
<div class="section" id="problema-como-aproximar-una-funcion-f-en-un-punto-x-1">
<h2>Problema: ¿Cómo aproximar una función <span class="math notranslate nohighlight">\(f\)</span> en un punto <span class="math notranslate nohighlight">\(x_1\)</span>?<a class="headerlink" href="#problema-como-aproximar-una-funcion-f-en-un-punto-x-1" title="Permalink to this headline">¶</a></h2>
<p>Si <span class="math notranslate nohighlight">\(f\)</span> es continuamente diferenciable en <span class="math notranslate nohighlight">\(x_0\)</span> y <span class="math notranslate nohighlight">\(f^{(1)}, f^{(2)}\)</span> existen y están acotadas en <span class="math notranslate nohighlight">\(x_0\)</span> entonces:</p>
<div class="math notranslate nohighlight">
\[f(x_1) \approx f(x_0) + f^{(1)}(x_0)(x_1-x_0)\]</div>
<p>y se llama <strong>aproximación de orden 1</strong>. Ver final de esta nota para definición de continuidad, diferenciabilidad y propiedades</p>
<p><strong>Obs:</strong> obsérvese que lo anterior requiere de los valores: <span class="math notranslate nohighlight">\(x_0, x_1, f(x_0), f^{(1)}(x_0)\)</span>. Esta aproximación tiene un error de <strong>orden</strong> <span class="math notranslate nohighlight">\(2\)</span> pues su error es <strong>proporcional</strong> al cuadrado del ancho del intervalo: <span class="math notranslate nohighlight">\(h=x_1-x_0\)</span>, esto es, si reducimos a la mitad <span class="math notranslate nohighlight">\(h\)</span> entonces el error se reduce en una cuarta parte.</p>
<p>Otra aproximación más simple sería:</p>
<div class="math notranslate nohighlight">
\[f(x_1) \approx f(x_0)\]</div>
<p>lo cual sólo requiere del conocimiento de <span class="math notranslate nohighlight">\(f(x_0)\)</span> y se llama aproximación de <strong>orden</strong> <span class="math notranslate nohighlight">\(0\)</span>, sin embargo esta aproximación tiene un error de <strong>orden</strong> <span class="math notranslate nohighlight">\(1\)</span> pues este es proporcional a <span class="math notranslate nohighlight">\(h\)</span> , esto es, al reducir a la mitad <span class="math notranslate nohighlight">\(h\)</span> se reduce a la mitad el error.</p>
<p>Estos errores los llamamos errores por <strong>truncamiento</strong>. Utilizamos la notación “O grande” <span class="math notranslate nohighlight">\(\mathcal{O}(\cdot)\)</span> para escribir lo anterior:</p>
<div class="math notranslate nohighlight">
\[f(x)-f(x_0)=\mathcal{O}(h)\]</div>
<p>con la variable <span class="math notranslate nohighlight">\(h=x-x_0\)</span>. Análogamente:</p>
<div class="math notranslate nohighlight">
\[f(x)-(f(x_0)+f^{(1)}(x_0)(x-x_0)) = \mathcal{O}(h^2).\]</div>
<p><strong>Obs:</strong> no confundir órdenes de  una aproximación con órdenes de error.</p>
<p>Otras aproximaciones a una función se pueden realizar con:</p>
<ul class="simple">
<li><p>Interpoladores polinomiales (representación por Vandermonde, Newton, Lagrange).</p></li>
</ul>
</div>
<div class="section" id="aproximacion-a-una-funcion-por-el-teorema-de-taylor">
<h2>Aproximación a una función por el teorema de Taylor<a class="headerlink" href="#aproximacion-a-una-funcion-por-el-teorema-de-taylor" title="Permalink to this headline">¶</a></h2>
<p>En esta sección se presenta el teorema de Taylor, el cual, bajo ciertas hipótesis nos proporciona una expansión de una función alrededor de un punto. Este teorema será utilizado en <strong>diferenciación e integración numérica</strong>. El teorema es el siguiente:</p>
<p>Sea <span class="math notranslate nohighlight">\(f: \mathbb{R} \rightarrow \mathbb{R}\)</span>, <span class="math notranslate nohighlight">\(f \in \mathcal{C}^n([a,b])\)</span> tal que <span class="math notranslate nohighlight">\(f^{(n+1)}\)</span> existe en [a,b]. Si <span class="math notranslate nohighlight">\(x_0 \in [a,b]\)</span> entonces <span class="math notranslate nohighlight">\(\forall x \in [a,b]\)</span> se tiene: <span class="math notranslate nohighlight">\(f(x) = P_n(x) + R_n(x)\)</span> donde:</p>
<div class="math notranslate nohighlight">
\[P_n(x) = \displaystyle \sum_{k=0}^n \frac{f^{(k)}(x_0)(x-x_0)^k}{k!} \quad (f^{(0)} = f)\]</div>
<p><strong>Comentarios:</strong></p>
<ul class="simple">
<li><p>El teorema de Taylor nos dice que cualquier función suave (función en <span class="math notranslate nohighlight">\(\mathcal{C}^n)\)</span> se le puede aproximar por un polinomio en el intervalo <span class="math notranslate nohighlight">\([a,b]\)</span>, de hecho <span class="math notranslate nohighlight">\(f(x) \approx P_n(x)\)</span>.</p></li>
<li><p>El teorema de Taylor es una generalización del <a class="reference external" href="https://en.wikipedia.org/wiki/Mean_value_theorem">teorema del valor medio para derivadas</a></p></li>
<li><p><span class="math notranslate nohighlight">\(P_n(x)\)</span> se le llama polinomio de Taylor alrededor de <span class="math notranslate nohighlight">\(x_0\)</span> de orden <span class="math notranslate nohighlight">\(n\)</span> y <span class="math notranslate nohighlight">\(R_n(x)\)</span> es llamado residuo de Taylor alrededor de <span class="math notranslate nohighlight">\(x_0\)</span> de orden <span class="math notranslate nohighlight">\(n+1\)</span>, tiene otras expresiones para representarlo y la que se utiliza en el enunciado anterior es en su forma de Lagrange (ver <a class="reference external" href="https://en.wikipedia.org/wiki/Taylor%27s_theorem">liga</a> para otras expresiones del residuo).</p></li>
<li><p><span class="math notranslate nohighlight">\(\xi_x\)</span> es un punto entre <span class="math notranslate nohighlight">\(x_0, x\)</span> desconocido y está en función de <span class="math notranslate nohighlight">\(x\)</span> (por eso se le escribe un subíndice).</p></li>
<li><p>Una forma del teorema de Taylor es escribirlo definiendo a la variable <span class="math notranslate nohighlight">\(h=x-x_0\)</span>:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[f(x) = f(x_0+h) = P_n(h) + R_n(h) = \displaystyle \sum_{k=0}^n \frac{f^{(k)}(x_0)h^k}{k!} + \frac{f^{(n+1)}(\xi_h)h^{n+1}}{(n+1)!}\]</div>
<p>y si <span class="math notranslate nohighlight">\(f^{(n+1)}\)</span> es acotada, escribimos: <span class="math notranslate nohighlight">\(R_n(h) = \mathcal{O}(h^{n+1})\)</span>.</p>
<p><strong>Ejemplo: graficar la función y los polinomios de Taylor constante, lineal y cuadrático en una sola gráfica con <code class="docutils literal notranslate"><span class="pre">ggplot2</span></code> en el intervalo [1,2] para la función <span class="math notranslate nohighlight">\(\frac{1}{x}\)</span> con centro en <span class="math notranslate nohighlight">\(x_0=1.5\)</span>. ¿Cuánto es la aproximación de los polinomios en x=1.9? (para esta pregunta calcula el error relativo de tus aproximaciones).</strong></p>
<p>Obtengamos los polinomios de Taylor de orden <span class="math notranslate nohighlight">\(n\)</span> con <span class="math notranslate nohighlight">\(n \in \{0,1,2\}\)</span> y centro en <span class="math notranslate nohighlight">\(x_0=1.5\)</span> para la función <span class="math notranslate nohighlight">\(\frac{1}{x}\)</span> en el intervalo <span class="math notranslate nohighlight">\([1,2]\)</span>. Los polinomios de Taylor son:</p>
<div class="math notranslate nohighlight">
\[P_0(x) = f(x_0) = \frac{2}{3} \quad \text{(constante)}\]</div>
<div class="math notranslate nohighlight">
\[P_1(x) = f(x_0) + f^{(1)}(x_0)(x-x_0) = \frac{2}{3} - \frac{1}{x_0^2}(x-x_0) \quad \text{(lineal)}\]</div>
<div class="math notranslate nohighlight">
\[P_2(x) = f(x_0) + f^{(1)}(x_0)(x-x_0) + \frac{f^{(2)}(x_0)(x-x_0)^2}{2} = \frac{2}{3} - \frac{1}{x_0^2}(x-x_0) + \frac{2}{x_0^3}(x-x_0)^2 \quad \text{(cuadrático)}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">library</span><span class="p">(</span><span class="n">ggplot2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">options</span><span class="p">(</span><span class="nb">repr</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">width</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="nb">repr</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">height</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span> <span class="c1">#esta línea sólo se ejecuta para jupyterlab con R</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Aprox_Taylor</span> <span class="o">&lt;-</span> <span class="n">function</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">centro</span><span class="p">,</span><span class="n">n</span><span class="p">){</span>
    <span class="n">length_x</span> <span class="o">=</span> <span class="n">length</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">evaluacion</span> <span class="o">=</span> <span class="n">rep</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">length_x</span><span class="p">)</span>
    <span class="k">for</span><span class="p">(</span><span class="n">j</span> <span class="ow">in</span> <span class="mi">1</span><span class="p">:</span><span class="n">length_x</span><span class="p">){</span>
        <span class="n">constante</span> <span class="o">=</span> <span class="n">centro</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">evaluacion</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">constante</span>
        <span class="k">for</span><span class="p">(</span><span class="n">k</span> <span class="ow">in</span> <span class="mi">1</span><span class="p">:</span><span class="n">n</span><span class="p">)</span>
            <span class="n">constante</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="n">centro</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">-</span><span class="n">centro</span><span class="p">)</span><span class="o">*</span><span class="n">constante</span>
            <span class="n">evaluacion</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">evaluacion</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">+</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">constante</span>
    <span class="p">}</span>
    <span class="n">evaluacion</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x0</span><span class="o">&lt;-</span><span class="mf">1.5</span>
<span class="n">x</span><span class="o">&lt;-</span> <span class="n">seq</span><span class="p">(</span><span class="n">from</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">to</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">by</span><span class="o">=.</span><span class="mi">005</span><span class="p">)</span>
<span class="n">n</span><span class="o">&lt;-</span><span class="n">c</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">f</span><span class="o">&lt;-</span><span class="n">function</span><span class="p">(</span><span class="n">z</span><span class="p">)</span><span class="mi">1</span><span class="o">/</span><span class="n">z</span>
<span class="n">y</span><span class="o">&lt;-</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">y_Taylor_0</span><span class="o">&lt;-</span><span class="mi">1</span><span class="o">/</span><span class="n">x0</span><span class="o">*</span><span class="n">rep</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">length</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="n">y_Taylor_1</span><span class="o">&lt;-</span><span class="n">Aprox_Taylor</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">x0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">y_Taylor_2</span><span class="o">&lt;-</span><span class="n">Aprox_Taylor</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">x0</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gg</span> <span class="o">&lt;-</span> <span class="n">ggplot</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gg</span><span class="o">+</span>
<span class="n">geom_line</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;f(x)&#39;</span><span class="p">))</span> <span class="o">+</span> 
<span class="n">geom_line</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">y_Taylor_0</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;constante&#39;</span><span class="p">))</span><span class="o">+</span>
<span class="n">geom_line</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">y_Taylor_1</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;lineal&#39;</span><span class="p">))</span> <span class="o">+</span> 
<span class="n">geom_line</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">y_Taylor_2</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;cuadratico&#39;</span><span class="p">))</span> <span class="o">+</span> 
<span class="n">geom_point</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x0</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">f</span><span class="p">(</span><span class="n">x0</span><span class="p">)),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Polinomios_de_Taylor_y_diferenciacion_numerica_27_0.png" src="../../_images/Polinomios_de_Taylor_y_diferenciacion_numerica_27_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">err_relativo</span><span class="o">&lt;-</span><span class="n">function</span><span class="p">(</span><span class="n">aprox</span><span class="p">,</span><span class="n">obj</span><span class="p">){</span>
    <span class="nb">abs</span><span class="p">(</span><span class="n">aprox</span><span class="o">-</span><span class="n">obj</span><span class="p">)</span><span class="o">/</span><span class="nb">abs</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x_obj</span><span class="o">=</span><span class="mf">1.9</span>
<span class="n">f_x_obj</span><span class="o">=</span><span class="n">f</span><span class="p">(</span><span class="n">x_obj</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;error relativo polinomio constante&#39;</span><span class="p">)</span>
<span class="n">err_relativo</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">x0</span><span class="p">,</span><span class="n">f_x_obj</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;error relativo polinomio lineal&#39;</span><span class="p">)</span>
<span class="n">err_relativo</span><span class="p">(</span><span class="n">Aprox_Taylor</span><span class="p">(</span><span class="n">x_obj</span><span class="p">,</span><span class="n">x0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">f_x_obj</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;error relativo polinomio cuadrático&#39;</span><span class="p">)</span>
<span class="n">err_relativo</span><span class="p">(</span><span class="n">Aprox_Taylor</span><span class="p">(</span><span class="n">x_obj</span><span class="p">,</span><span class="n">x0</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">f_x_obj</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[1] &quot;error relativo polinomio constante&quot;
</pre></div>
</div>
<div class="output text_html">0.266666666666667</div><div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[1] &quot;error relativo polinomio lineal&quot;
</pre></div>
</div>
<div class="output text_html">0.408888888888889</div><div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[1] &quot;error relativo polinomio cuadrático&quot;
</pre></div>
</div>
<div class="output text_html">0.536888888888889</div></div>
</div>
<p><strong>Pregunta:</strong> ¿por qué se tiene mejor aproximación con un polinomio constante o lineal que con un polinomio cuadrático? ¿no deberíamos tener menor error al añadir más y más términos en el polinomio de Taylor? ¿de qué depende tener una buena aproximación al utilizar polinomios de Taylor para una función <span class="math notranslate nohighlight">\(f\)</span> en general?.</p>
<p><strong>Ejercicio:</strong> Aproximar <span class="math notranslate nohighlight">\(f(1)\)</span> con polinomios de Taylor de orden <span class="math notranslate nohighlight">\(0,1,2,3,4\)</span> si <span class="math notranslate nohighlight">\(f(x)=-0.1x^4-0.15x^3-0.5x^2-0.25x+1.2\)</span> con centro en <span class="math notranslate nohighlight">\(x0=0\)</span>. Calcula errores relativos de tus aproximaciones. Realiza las gráficas de cada polinomio en el intervalo <span class="math notranslate nohighlight">\([0,1]\)</span> con <code class="docutils literal notranslate"><span class="pre">ggplot2</span></code>. Observa que <span class="math notranslate nohighlight">\(R_5(x)\)</span> es cero.</p>
<div class="section" id="teorema-de-taylor-para-una-funcion-f-mathbb-r-n-rightarrow-mathbb-r">
<h3>Teorema de Taylor para una función <span class="math notranslate nohighlight">\(f: \mathbb{R}^n \rightarrow \mathbb{R}\)</span><a class="headerlink" href="#teorema-de-taylor-para-una-funcion-f-mathbb-r-n-rightarrow-mathbb-r" title="Permalink to this headline">¶</a></h3>
<p>Sea <span class="math notranslate nohighlight">\(f: \mathbb{R}^n \rightarrow \mathbb{R}\)</span> diferenciable en <span class="math notranslate nohighlight">\(\text{dom}f\)</span>. Si <span class="math notranslate nohighlight">\(x_0, x \in \text{dom}f\)</span> y <span class="math notranslate nohighlight">\(x_0+t(x-x_0) \in \text{dom}f, \forall t \in (0,1),\)</span>  entonces <span class="math notranslate nohighlight">\(\forall x \in \text{dom}f\)</span> se tiene <span class="math notranslate nohighlight">\(f(x) = P_0(x) + R_0(x)\)</span> donde:</p>
<div class="math notranslate nohighlight">
\[P_0(x) = f(x_0)\]</div>
<div class="math notranslate nohighlight">
\[R_0(x) = \nabla f(x_0+t_x(x-x_0))^T(x-x_0)\]</div>
<p>para alguna <span class="math notranslate nohighlight">\(t_x \in (0,1)\)</span> y <span class="math notranslate nohighlight">\(\nabla f(\cdot)\)</span> gradiente de <span class="math notranslate nohighlight">\(f\)</span> (ver al final de esta nota la definición de gradiente). Esta se llama <strong>aproximación de orden <span class="math notranslate nohighlight">\(0\)</span></strong> para <span class="math notranslate nohighlight">\(f\)</span> con centro en <span class="math notranslate nohighlight">\(x_0\)</span>. Si <span class="math notranslate nohighlight">\(\nabla f(\cdot)\)</span> es acotado en <span class="math notranslate nohighlight">\(\text{dom}f\)</span> entonces se escribe: <span class="math notranslate nohighlight">\(R_0(x)=\mathcal{O}(||x-x_0||)\)</span>.</p>
<p>Si además <span class="math notranslate nohighlight">\(f\)</span> es continuamente diferenciable en <span class="math notranslate nohighlight">\(\text{dom}f\)</span>(su derivada es continua, ver al final de esta nota definición de continuidad), <span class="math notranslate nohighlight">\(f^{(2)}\)</span> existe en <span class="math notranslate nohighlight">\(\text{dom}f\)</span>, se tiene <span class="math notranslate nohighlight">\(f(x) = P_1(x) + R_1(x)\)</span> donde:</p>
<div class="math notranslate nohighlight">
\[P_1(x) = f(x_0) + \nabla f(x_0)^T(x-x_0)\]</div>
<div class="math notranslate nohighlight">
\[R_1(x) = \frac{1}{2}(x-x_0)^T \nabla ^2f(x_0+t_x(x-x_0))(x-x_0)\]</div>
<p>para alguna <span class="math notranslate nohighlight">\(t_x \in (0,1)\)</span> y <span class="math notranslate nohighlight">\(\nabla^2 f(\cdot)\)</span> Hessiana de <span class="math notranslate nohighlight">\(f\)</span> (ver al final de esta nota definición de la matriz Hessiana). Esta se llama <strong>aproximación de orden <span class="math notranslate nohighlight">\(1\)</span></strong> para <span class="math notranslate nohighlight">\(f\)</span> con centro en <span class="math notranslate nohighlight">\(x_0\)</span>. Si <span class="math notranslate nohighlight">\(\nabla^2f(\cdot)\)</span> es acotada en <span class="math notranslate nohighlight">\(\text{dom}f\)</span> entonces se escribe: <span class="math notranslate nohighlight">\(R_1(x) = \mathcal{O}(||x-x_0||^2)\)</span>.</p>
<p>Si <span class="math notranslate nohighlight">\(f^{(2)}\)</span> es continuamente diferenciable y <span class="math notranslate nohighlight">\(f^{(3)}\)</span> existe y es acotada en <span class="math notranslate nohighlight">\(\text{dom}f\)</span>, se tiene <span class="math notranslate nohighlight">\(f(x)=P_2(x) + R_2(x)\)</span> donde:</p>
<div class="math notranslate nohighlight">
\[P_2(x) = f(x_0) + \nabla f(x_0)^T(x-x_0) + \frac{1}{2}(x-x_0)^T \nabla ^2f(x_0)(x-x_0)\]</div>
<div class="math notranslate nohighlight">
\[R_2(x)= \mathcal{O}(||x-x_0||^3).\]</div>
<p>Esta se llama <strong>aproximación de orden <span class="math notranslate nohighlight">\(2\)</span></strong> para <span class="math notranslate nohighlight">\(f\)</span> con centro en <span class="math notranslate nohighlight">\(x_0\)</span>.</p>
<p><strong>Obs:</strong> en este caso <span class="math notranslate nohighlight">\(f^{(3)}\)</span> es un tensor.</p>
<p><strong>Comentarios:</strong></p>
<ul class="simple">
<li><p>Tomando <span class="math notranslate nohighlight">\(h=x-x_0\)</span>, se reescribe el teorema como sigue, por ejemplo para la aproximación de orden <span class="math notranslate nohighlight">\(1\)</span> incluyendo su residuo:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[f(x) = f(x_0 + h) = \underbrace{f(x_0) + \nabla f(x_0)^Th}_{\textstyle P_1(h)} + \underbrace{\frac{1}{2}h^T \nabla ^2f(x_0+t_xh)h}_{\textstyle R_1(h)}.\]</div>
<p>Si <span class="math notranslate nohighlight">\(f^{(2)}\)</span> es acotada en <span class="math notranslate nohighlight">\(\text{dom}f\)</span>, escribimos: <span class="math notranslate nohighlight">\(R_1(h)=\mathcal{O}(||h||^2)\)</span>.</p>
</div>
</div>
<div class="section" id="diferenciacion-numerica-por-diferencias-finitas">
<h2>Diferenciación numérica por diferencias finitas<a class="headerlink" href="#diferenciacion-numerica-por-diferencias-finitas" title="Permalink to this headline">¶</a></h2>
<p>Las fórmulas de aproximación a las derivadas por diferencias finitas pueden obtenerse con los polinomios de Taylor, presentes en el teorema del mismo autor, por ejemplo:</p>
<p>Sea <span class="math notranslate nohighlight">\(f \in \mathcal{C}^1([a,b])\)</span> y <span class="math notranslate nohighlight">\(f^{(2)}\)</span> existe y está acotada <span class="math notranslate nohighlight">\(\forall x \in [a,b]\)</span> entonces, si <span class="math notranslate nohighlight">\(x+h \in [a,b]\)</span> con <span class="math notranslate nohighlight">\(h&gt;0\)</span> por el teorema de Taylor:</p>
<div class="math notranslate nohighlight">
\[f(x+h) = f(x) + f^{(1)}(x)h + f^{(2)}(\xi_{x+h})\frac{h^2}{2}\]</div>
<div class="math notranslate nohighlight">
\[f^{(1)}(x) = \frac{f(x+h)-f(x)}{h} - f^{(2)}(\xi_{x+h})\frac{h}{2}.\]</div>
<p>y escribimos:</p>
<div class="math notranslate nohighlight">
\[f^{(1)}(x) = \frac{f(x+h)-f(x)}{h} + \mathcal{O}(h).\]</div>
<p>La aproximación <span class="math notranslate nohighlight">\(\frac{f(x+h)-f(x)}{h}\)</span> es una fórmula por diferencias hacia delante con error de orden <span class="math notranslate nohighlight">\(1\)</span>. Gráficamente se tiene:</p>
<img src="https://dl.dropboxusercontent.com/s/r1ypkxkwa9g3pmk/dif_hacia_delante.png?dl=0" heigth="500" width="500"><p>Con las mismas suposiciones es posible obtener la fórmula para la aproximación por diferencias hacia atrás:</p>
<div class="math notranslate nohighlight">
\[f^{(1)}(x) = \frac{f(x)-f(x-h)}{h} + \mathcal{O}(h), h &gt;0.\]</div>
<img src="https://dl.dropboxusercontent.com/s/mxmc8kohurlu9sp/dif_hacia_atras.png?dl=0" heigth="500" width="500"><p>Considerando <span class="math notranslate nohighlight">\(f \in \mathcal{C}^2([a,b]), f^{(3)}\)</span> existe y está acotada <span class="math notranslate nohighlight">\(\forall x \in [a,b]\)</span> si <span class="math notranslate nohighlight">\(x-h, x+h \in [a,b]\)</span> y <span class="math notranslate nohighlight">\(h&gt;0\)</span> entonces:</p>
<div class="math notranslate nohighlight">
\[f^{(1)}(x) = \frac{f(x+h)-f(x-h)}{2h} + \mathcal{O}(h^2), h &gt;0.\]</div>
<p>y el cociente <span class="math notranslate nohighlight">\(\frac{f(x+h)-f(x-h)}{2h}\)</span> es la aproximación por diferencias centradas con error de orden <span class="math notranslate nohighlight">\(2\)</span>. Gráficamente:</p>
<img src="https://dl.dropboxusercontent.com/s/jwi0y1t5z58pydz/dif_centradas.png?dl=0" heigth="500" width="500"><p><strong>Obs:</strong> la aproximación por diferencias finitas a la primer derivada de la función tiene un error de orden <span class="math notranslate nohighlight">\(\mathcal{O}(h)\)</span> por lo que una elección de <span class="math notranslate nohighlight">\(h\)</span> igual a <span class="math notranslate nohighlight">\(.1 = 10^{-1}\)</span> generará aproximaciones con alrededor de un dígito correcto.</p>
<p><strong>Obs:</strong> la diferenciación numérica por diferencias finitas no es un proceso con una alta exactitud pues los problemas del redondeo de la aritmética en la máquina se hacen presentes en el mismo (ver nota <a class="reference external" href="https://github.com/ITAM-DS/analisis-numerico-computo-cientifico/blob/master/temas/I.computo_cientifico/1.2.Sistema_de_punto_flotante.ipynb">1.2.Sistema_de_punto_flotante</a>). Como ejemplo de esta situación realicemos el siguiente ejemplo.</p>
<p><strong>Ejemplo: realizar una gráfica de log(error relativo) vs log(h) (h en el eje horizontal) con <code class="docutils literal notranslate"><span class="pre">ggplot2</span></code> para aproximar la primera derivada de <span class="math notranslate nohighlight">\(f(x)=e^{-x}\)</span> en <span class="math notranslate nohighlight">\(x=1\)</span> con <span class="math notranslate nohighlight">\(h \in \{10^{-16}, 10^{-14}, \dots , 10^{-1}\}\)</span> y diferencias hacia delante. Valor a aproximar: <span class="math notranslate nohighlight">\(f^{(1)}(1) = -e^{-1}\)</span></strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="o">&lt;-</span><span class="n">function</span><span class="p">(</span><span class="n">x</span><span class="p">){</span>
    <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">)</span>
<span class="p">}</span>
<span class="n">aprox_1a_derivada</span><span class="o">&lt;-</span><span class="n">function</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">h</span><span class="p">){</span>
    <span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">h</span><span class="p">)</span><span class="o">-</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">/</span><span class="n">h</span>
<span class="p">}</span>

<span class="n">df</span><span class="o">&lt;-</span><span class="n">function</span><span class="p">(</span><span class="n">x</span><span class="p">){</span>
    <span class="o">-</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">err_absoluto</span><span class="o">&lt;-</span><span class="n">function</span><span class="p">(</span><span class="n">aprox</span><span class="p">,</span><span class="n">obj</span><span class="p">){</span>
    <span class="nb">abs</span><span class="p">(</span><span class="n">aprox</span><span class="o">-</span><span class="n">obj</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">err_relativo</span><span class="o">&lt;-</span><span class="n">function</span><span class="p">(</span><span class="n">aprox</span><span class="p">,</span><span class="n">obj</span><span class="p">){</span>
    <span class="nb">abs</span><span class="p">(</span><span class="n">aprox</span><span class="o">-</span><span class="n">obj</span><span class="p">)</span><span class="o">/</span><span class="nb">abs</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">x</span><span class="o">&lt;-</span><span class="mi">1</span>

<span class="n">h</span><span class="o">&lt;-</span><span class="mi">10</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">16</span><span class="p">))</span>

<span class="n">err_absoluto_res</span><span class="o">&lt;-</span><span class="n">err_absoluto</span><span class="p">(</span><span class="n">aprox_1a_derivada</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">h</span><span class="p">),</span><span class="n">df</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="n">err_relativo_res</span><span class="o">&lt;-</span><span class="n">err_relativo</span><span class="p">(</span><span class="n">aprox_1a_derivada</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">h</span><span class="p">),</span><span class="n">df</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>


<span class="n">gf</span><span class="o">&lt;-</span><span class="n">ggplot</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gf</span><span class="o">+</span>
<span class="n">geom_line</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">log</span><span class="p">(</span><span class="n">h</span><span class="p">),</span><span class="n">y</span><span class="o">=</span><span class="n">log</span><span class="p">(</span><span class="n">err_absoluto_res</span><span class="p">)))</span><span class="o">+</span>
<span class="n">ggtitle</span><span class="p">(</span><span class="s1">&#39;Aproximación a la primera derivada por diferencias finitas&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Polinomios_de_Taylor_y_diferenciacion_numerica_57_0.png" src="../../_images/Polinomios_de_Taylor_y_diferenciacion_numerica_57_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gf</span><span class="o">+</span>
<span class="n">geom_line</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">log</span><span class="p">(</span><span class="n">h</span><span class="p">),</span><span class="n">y</span><span class="o">=</span><span class="n">log</span><span class="p">(</span><span class="n">err_relativo_res</span><span class="p">)))</span><span class="o">+</span>
<span class="n">ggtitle</span><span class="p">(</span><span class="s1">&#39;Aproximación a la primera derivada por diferencias finitas&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Polinomios_de_Taylor_y_diferenciacion_numerica_58_0.png" src="../../_images/Polinomios_de_Taylor_y_diferenciacion_numerica_58_0.png" />
</div>
</div>
<p><strong>Ejercicio: realizar una gráfica de log(error relativo) vs log(h) (h en el eje horizontal) con <code class="docutils literal notranslate"><span class="pre">ggplot2</span></code> para aproximar la segunda derivada de <span class="math notranslate nohighlight">\(f(x)=e^{-x}\)</span> en <span class="math notranslate nohighlight">\(x=1\)</span> con <span class="math notranslate nohighlight">\(h \in \{10^{-16}, 10^{-14}, \dots , 10^{-1}\}\)</span> y diferencias hacia delante. Valor a aproximar: <span class="math notranslate nohighlight">\(f^{(2)}(1) = e^{-1}\)</span></strong>. Usar:</p>
<div class="math notranslate nohighlight">
\[\frac{d^2f(x)}{dx} = \frac{f(x+2h)-2f(x+h)+f(x)}{h^2} + \mathcal{O}(h)\]</div>
<p><strong>Encontrar valor(es) de <span class="math notranslate nohighlight">\(h\)</span> que minimiza(n) al error absoluto y relativo.</strong></p>
<p>La aproximación anterior es una aproximación a la segunda derivada por diferencias hacia delante. Las versiones hacia atrás y centradas en general para una función <span class="math notranslate nohighlight">\(f: \mathbb{R} \rightarrow \mathbb{R}\)</span> son respectivamente:</p>
<div class="math notranslate nohighlight">
\[\frac{d^2f(x)}{dx} \approx \frac{f(x)-2f(x-h)+f(x-2h)}{h^2} + \mathcal{O}(h)\]</div>
<div class="math notranslate nohighlight">
\[\frac{d^2f(x)}{dx} \approx \frac{f(x+h)-2f(x)+f(x-h)}{h^2} + \mathcal{O}(h^2)\]</div>
<div class="section" id="analisis-del-error-por-redondeo-y-truncamiento-en-aproximacion-por-diferencias-finitas-hacia-delante">
<h3>Análisis del error por redondeo y truncamiento en aproximación por diferencias finitas hacia delante<a class="headerlink" href="#analisis-del-error-por-redondeo-y-truncamiento-en-aproximacion-por-diferencias-finitas-hacia-delante" title="Permalink to this headline">¶</a></h3>
<p>El ejemplo anterior muestra (vía una gráfica) que el método numérico de diferenciación numérica no es estable numéricamente respecto al redondeo (ver nota <a class="reference external" href="https://github.com/ITAM-DS/analisis-numerico-computo-cientifico/blob/master/temas/I.computo_cientifico/1.3.Condicion_de_un_problema_y_estabilidad_de_un_algoritmo.ipynb">1.3.Condicion_de_un_problema_y_estabilidad_de_un_algoritmo</a> para definición de estabilidad de un algoritmo) y también se puede corroborar realizando un análisis del error. En esta sección consideramos la aproximación a la primer derivada por diferencias finitas hacia delante:</p>
<div class="math notranslate nohighlight">
\[\frac{f(x+h)-f(x)}{h}\]</div>
<p>Suponemos que <span class="math notranslate nohighlight">\(\hat{f}(x)\)</span> aproxima a <span class="math notranslate nohighlight">\(f(x)\)</span> y por errores de redondeo <span class="math notranslate nohighlight">\(\hat{f}(x) = f(x)(1 + \epsilon_{f(x)})\)</span> con <span class="math notranslate nohighlight">\(|\epsilon_{f(x)}| \leq \epsilon_{maq}\)</span> error de redondeo al evaluar <span class="math notranslate nohighlight">\(f\)</span> en <span class="math notranslate nohighlight">\(x\)</span>. <span class="math notranslate nohighlight">\(\hat{f}(x)\)</span> es la aproximación en un SPFN (ver nota <a class="reference external" href="https://github.com/ITAM-DS/analisis-numerico-computo-cientifico/blob/master/temas/I.computo_cientifico/1.2.Sistema_de_punto_flotante.ipynb">1.2.Sistema_de_punto_flotante</a>). Además supóngase que <span class="math notranslate nohighlight">\(x,x+h,h \in \mathcal{Fl}\)</span> . Entonces en la aproximación a la primer derivada por diferencias  hacia delante:</p>
<p><span class="math notranslate nohighlight">\(f^{(1)}(x) = \frac{f(x+h)-f(x)}{h} + \mathcal{O}(h)\)</span> y calculando el error absoluto:</p>
<div class="math notranslate nohighlight">
\[\text{ErrAbs}\left ( \frac{\hat{f}(x+h)-\hat{f}(x)}{h} \right ) = \left |f^{(1)}(x) - \frac{\hat{f}(x+h)-\hat{f}(x)}{h} \right | = \left | \frac{f(x+h)-f(x)}{h} + \mathcal{O}(h) - \left ( \frac{f(x+h)(1+\epsilon_{f(x+h)})-f(x)(1+\epsilon_{f(x)})}{h} \right ) \right | =  \left |\mathcal{O}(h) - \frac{f(x+h)\epsilon_{f(x+h)}-f(x)\epsilon_{f(x)}}{h} \right | \leq \mathcal{O}(h) + \frac{C\epsilon_{maq}}{h}\]</div>
<p>suponiendo en el último paso que <span class="math notranslate nohighlight">\(|f(x+h)\epsilon_{f(x+h)} - f(x)\epsilon_{f(x)}| \leq C \epsilon_{maq}\)</span> con <span class="math notranslate nohighlight">\(C&gt;0\)</span> constante que acota a la función <span class="math notranslate nohighlight">\(f\)</span> en el intervalo <span class="math notranslate nohighlight">\([a,b]\)</span>. Obsérvese que <span class="math notranslate nohighlight">\(\frac{\hat{f}(x+h)-\hat{f}(x)}{h}\)</span> es la aproximación a la primer derivada por diferencias hacia delante que se obtiene en la computadora, por lo que la cantidad <span class="math notranslate nohighlight">\(\left |f^{(1)}(x) - \frac{\hat{f}(x+h)-\hat{f}(x)}{h} \right |\)</span> es el error absoluto de la aproximación por diferencias hacia delante.</p>
<p>El error relativo es:</p>
<div class="math notranslate nohighlight">
\[\text{ErrRel}\left (\frac{\hat{f}(x+h)-\hat{f}(x)}{h} \right) = \frac{\text{ErrAbs}\left ( \frac{\hat{f}(x+h)-\hat{f}(x)}{h} \right )}{|f^{(1)}(x)|} \leq \frac{\mathcal{O}(h) + \frac{C\epsilon_{maq}}{h}}{|f^{(1)}(x)|} = K_1h + K_2\frac{1}{h}\]</div>
<p>con <span class="math notranslate nohighlight">\(K_1, K_2 &gt;0\)</span> constantes.</p>
<p>Entonces la función <span class="math notranslate nohighlight">\(g(h) = \mathcal{O}(h) + \mathcal{O}\left (\frac{1}{h} \right)\)</span> acota al error absoluto y al error relativo y se tiene:</p>
<ul class="simple">
<li><p>Si <span class="math notranslate nohighlight">\(h \rightarrow 0\)</span> la componente <span class="math notranslate nohighlight">\(\mathcal{O} \left ( \frac{1}{h} \right )\)</span> domina a la componente <span class="math notranslate nohighlight">\(\mathcal{O}(h)\)</span>, la cual tiende a <span class="math notranslate nohighlight">\(0\)</span>.</p></li>
<li><p>Si <span class="math notranslate nohighlight">\(h \rightarrow \infty\)</span> la componente <span class="math notranslate nohighlight">\(\mathcal{O}(h)\)</span> domina a <span class="math notranslate nohighlight">\(\mathcal{O} \left ( \frac{1}{h} \right )\)</span>, la cual tiende a <span class="math notranslate nohighlight">\(0\)</span>.</p></li>
</ul>
<p>Por las dos observaciones anteriores, existe un valor de <span class="math notranslate nohighlight">\(h\)</span> que minimiza a los errores. Tal valor se observa en las gráficas anteriores y es igual a:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">c</span><span class="p">(</span><span class="n">h</span><span class="p">[</span><span class="n">which</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">err_absoluto_res</span><span class="p">)],</span><span class="n">h</span><span class="p">[</span><span class="n">which</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">err_relativo_res</span><span class="p">)]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[1] 1e-08 1e-08
</pre></div>
</div>
</div>
</div>
<p><strong>Ejercicio:</strong> obtener de forma analítica el valor de <span class="math notranslate nohighlight">\(h\)</span> que minimiza la función <span class="math notranslate nohighlight">\(g(h)\)</span> anterior. Tip: utilizar criterio de primera y segunda derivada para encontrar mínimo global.</p>
<p><strong>Conclusiones y comentarios:</strong></p>
<ul class="simple">
<li><p>La componente <span class="math notranslate nohighlight">\(\mathcal{O}(h)\)</span> es el error por truncamiento, la cual resulta del teorema de Taylor. El teorema de Taylor nos indica que añadir términos en el polinomio de Taylor si la <span class="math notranslate nohighlight">\(x\)</span> a aproximar es cercana al centro, las derivadas de <span class="math notranslate nohighlight">\(f\)</span> son acotadas y <span class="math notranslate nohighlight">\(h \rightarrow 0\)</span> entonces el error por truncamiento debe tender a <span class="math notranslate nohighlight">\(0\)</span>. Lo anterior no ocurre en la implementación numérica (corroborado de forma analítica y visual) del método por diferenciación numérica para la primer derivada por la presencia de la componente <span class="math notranslate nohighlight">\(\mathcal{O}\left(\frac{1}{h}\right)\)</span> en los errores. Tal componente proviene del error por redondeo.</p></li>
<li><p>Obsérvese que el error relativo máximo es del <span class="math notranslate nohighlight">\(100\%\)</span> lo que indica que no se tiene ninguna cifra correcta en la aproximación:</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">max</span><span class="p">(</span><span class="n">err_relativo_res</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">1</div></div>
</div>
<p>y esto ocurre para un valor de <span class="math notranslate nohighlight">\(h\)</span> igual a:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">h</span><span class="p">[</span><span class="n">which</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">err_relativo_res</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">1e-16</div></div>
</div>
<p><strong>pregunta:</strong> ¿por qué se alcanza el máximo error relativo en el valor de <span class="math notranslate nohighlight">\(h=10^{-16}\)</span>?.</p>
<p>Con esto se tiene que la diferenciación numérica es un método <strong>inestable numéricamente respecto al redondeo</strong>. Ver nota <a class="reference external" href="https://github.com/ITAM-DS/analisis-numerico-computo-cientifico/blob/master/temas/I.computo_cientifico/1.3.Condicion_de_un_problema_y_estabilidad_de_un_algoritmo.ipynb">1.3.Condicion_de_un_problema_y_estabilidad_de_un_algoritmo</a>.</p>
<ul class="simple">
<li><p>Un análisis de error similar se utiliza para el método de diferencias finitas por diferencias centradas para aproximar la primera derivada. En este caso el valor de <span class="math notranslate nohighlight">\(h\)</span> que minimiza a los errores es del orden <span class="math notranslate nohighlight">\(h^* = 10^{-6}\)</span>.</p></li>
</ul>
</div>
<div class="section" id="diferenciacion-numerica-para-una-funcion-f-mathbb-r-n-rightarrow-mathbb-r">
<h3>Diferenciación numérica para una función <span class="math notranslate nohighlight">\(f: \mathbb{R}^n \rightarrow \mathbb{R}\)</span><a class="headerlink" href="#diferenciacion-numerica-para-una-funcion-f-mathbb-r-n-rightarrow-mathbb-r" title="Permalink to this headline">¶</a></h3>
<p>Supongamos <span class="math notranslate nohighlight">\(f\)</span> es dos veces diferenciable en <span class="math notranslate nohighlight">\(\text{dom}f\)</span>. Si <span class="math notranslate nohighlight">\(f: \mathbb{R}^n \rightarrow \mathbb{R}\)</span> entonces su derivada se llama <strong>gradiente</strong>, el cual es una función <span class="math notranslate nohighlight">\(\nabla f: \mathbb{R}^n \rightarrow \mathbb{R}^n\)</span> y su segunda derivada se llama <strong>Hessiana</strong>, la cual es una función <span class="math notranslate nohighlight">\(f: \mathbb{R}^n \rightarrow \mathbb{R}^{n\times n}\)</span> (ver final de esta nota para definición de derivadas en funciones <span class="math notranslate nohighlight">\(f: \mathbb{R}^n \rightarrow \mathbb{R}^m\)</span>). Ambas funciones al evaluarse resultan en un vector en <span class="math notranslate nohighlight">\(\mathbb{R}^n\)</span> y en una matriz en <span class="math notranslate nohighlight">\(\mathbb{R}^{n\times n}\)</span> respectivamente.</p>
<p>Podemos utilizar las fórmulas de aproximación en diferenciación numérica con diferencias finitas para el caso <span class="math notranslate nohighlight">\(f: \mathbb{R} \rightarrow \mathbb{R}\)</span> revisadas anteriormente para aproximar al gradiente y a la Hessiana.</p>
<p>Para el caso del gradiente se tiene por <strong>diferenciación hacia delante</strong>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\nabla f(x) = 
\begin{array}{l}
\left[ \begin{array}{c}
\frac{\partial f(x)}{\partial x_1}\\
\vdots\\
\frac{\partial f(x)}{\partial x_n}
\end{array}
\right] \approx, \nabla \hat{f}(x) =\left[ 
\begin{array}{c} 
\frac{f(x+he_1) - f(x)}{h}\\
\vdots\\
\frac{f(x+he_n) - f(x)}{h}
\end{array}
\right]
\end{array} \in \mathbb{R}^n\end{split}\]</div>
<p>con <span class="math notranslate nohighlight">\(e_j\)</span> <span class="math notranslate nohighlight">\(j\)</span>-ésimo vector canónico que tiene un número <span class="math notranslate nohighlight">\(1\)</span> en la posición <span class="math notranslate nohighlight">\(j\)</span> y <span class="math notranslate nohighlight">\(0\)</span> en las entradas restantes para <span class="math notranslate nohighlight">\(j=1,\dots,n\)</span>. Se cumple <span class="math notranslate nohighlight">\(||\nabla f(x) - \nabla \hat{f}(x)|| = \mathcal{O}(h)\)</span>. Y para el caso de la Hessiana:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\nabla^2f(x) = \left[\begin{array}{cccc}
\frac{\partial^2f(x)}{\partial x_1^2} &amp;\frac{\partial^2f(x)}{\partial x_2 \partial x_1}&amp;\dots&amp;\frac{\partial^2f(x)}{\partial x_n \partial x_1}\\
\frac{\partial^2f(x)}{\partial x_1 \partial x_2} &amp;\frac{\partial^2f(x)}{\partial x_2^2} &amp;\dots&amp;\frac{\partial^2f(x)}{\partial x_n \partial x_2}\\
\vdots &amp;\vdots&amp; \ddots&amp;\vdots\\
\frac{\partial^2f(x)}{\partial x_1 \partial x_n} &amp;\frac{\partial^2f(x)}{\partial x_2 \partial x_n}&amp;\dots&amp;\frac{\partial^2f(x)}{\partial x_n^2} \\
\end{array}
\right],
\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}
\nabla^2 \hat{f}(x) = \left[\begin{array}{cccc}
\frac{f(x+2he_1)-2f(x+he_1)+f(x)}{h^2} &amp;\frac{f(x+he_1+he_2)-f(x+he_1)-f(x+he_2)+f(x)}{h^2}&amp;\dots&amp;\frac{f(x+he_1+he_n)-f(x+he_1)-f(x+he_n)+f(x)}{h^2}\\
\frac{f(x+he_1+he_2)-f(x+he_2)-f(x+he_1)+f(x)}{h^2}&amp;\frac{f(x+2he_2)-2f(x+he_2)+f(x)}{h^2}  &amp;\dots&amp;\frac{f(x+he_2+he_n)-f(x+he_2)-f(x+he_n)+f(x)}{h^2}\\
\vdots &amp;\vdots&amp; \ddots&amp;\vdots\\
\frac{f(x+he_1+he_n)-f(x+he_n)-f(x+he_1)+f(x)}{h^2}&amp;\frac{f(x+he_2+he_n)-f(x+he_n)-f(x+he_2)+f(x)}{h^2}&amp;\dots&amp;\frac{f(x+2he_n)-2f(x+he_n)+f(x)}{h^2}\\
\end{array}
\right]
\end{split}\]</div>
<p>Se cumple: <span class="math notranslate nohighlight">\(||\nabla^2f(x)-\nabla\hat{f}^2(x)||=\mathcal{O}(h)\)</span>.</p>
<p><strong>Ejemplo:</strong></p>
<p>Aproximar <span class="math notranslate nohighlight">\(\nabla f(x), \nabla^2f(x)\)</span> con diferencias hacia delante y <span class="math notranslate nohighlight">\(h \in \{10^{-16}, 10^{-14}, \dots , 10^{-1}\}\)</span> para <span class="math notranslate nohighlight">\(f: \mathbb{R}^4 \rightarrow \mathbb{R}\)</span>, dada por <span class="math notranslate nohighlight">\(f(x) = (x_1^2-x_2^2)^2+x_1^2+(x_3^2-x_4^2)^2+x_3^2\)</span> en el punto <span class="math notranslate nohighlight">\(x_0=(1.5,1.5,1.5,1.5)^T\)</span>. Realizar una gráfica de <span class="math notranslate nohighlight">\(\log(\)</span>Err_rel) vs <span class="math notranslate nohighlight">\(\log(\)</span>h)</p>
<p>Para esta función se tiene:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\nabla f(x) = 
\left[ \begin{array}{c}
4x_1(x_1^2-x_2^2) + 2x_1\\
-4x_2(x_1^2-x_2^2)\\
4x_3(x_3^2-x_4^2)+2x_3\\
-4x_4(x_3^2-x_4^2)
\end{array}
\right] ,
\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}\nabla^2f(x)=
 \left[\begin{array}{cccc}
12x_1^2-4x_2^2+2 &amp;-8x_1x_2&amp;0&amp;0\\
-8x_1x_2 &amp;-4x_1^2+12x_2^2&amp;0&amp;0\\
0 &amp;0&amp;12x_3^2-4x_4^2+2&amp;-8x_3x_4\\
0&amp;0&amp;-8x_3x_4&amp;-4x_3^2+12x_4^2\\
\end{array}
\right]
\end{split}\]</div>
<p>Y evaluando en <span class="math notranslate nohighlight">\(x_0\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#gradiente de f calculado de forma simbólica</span>
<span class="n">gf</span><span class="o">&lt;-</span><span class="n">function</span><span class="p">(</span><span class="n">x</span><span class="p">){</span>
    <span class="n">c</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
      <span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">^</span><span class="mi">2</span><span class="p">),</span>
      <span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
      <span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">^</span><span class="mi">2</span><span class="p">))</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x_0</span><span class="o">&lt;-</span><span class="n">c</span><span class="p">(</span><span class="mf">1.5</span><span class="p">,</span><span class="mf">1.5</span><span class="p">,</span><span class="mf">1.5</span><span class="p">,</span><span class="mf">1.5</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">gf</span><span class="p">(</span><span class="n">x_0</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[1] 3 0 3 0
</pre></div>
</div>
</div>
</div>
<div class="math notranslate nohighlight">
\[\begin{split}\nabla f(x_0) = 
\left[ \begin{array}{c}
3\\
0\\
3\\
0
\end{array}
\right],
\end{split}\]</div>
<p>para la Hessiana:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#Hessiana de f calculada de forma simbólica</span>
<span class="n">gf2</span><span class="o">&lt;-</span><span class="n">function</span><span class="p">(</span><span class="n">x</span><span class="p">){</span>
    <span class="n">matrix</span><span class="p">(</span><span class="n">c</span><span class="p">(</span><span class="mi">12</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">8</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span>
             <span class="o">-</span><span class="mi">8</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">12</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span>
             <span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">12</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">8</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span>
             <span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">8</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">12</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">^</span><span class="mi">2</span><span class="p">),</span><span class="n">nrow</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">ncol</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">gf2</span><span class="p">(</span><span class="n">x_0</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>     [,1] [,2] [,3] [,4]
[1,]   20  -18    0    0
[2,]  -18   18    0    0
[3,]    0    0   20  -18
[4,]    0    0  -18   18
</pre></div>
</div>
</div>
</div>
<div class="math notranslate nohighlight">
\[\begin{split}\nabla^2f(x_0)=
 \left[\begin{array}{cccc}
20 &amp;-18&amp;0&amp;0\\
-18&amp;18&amp;0&amp;0\\
0 &amp;0&amp;20&amp;-18\\
0&amp;0&amp;-18&amp;18\\
\end{array}
\right]
\end{split}\]</div>
<p>Calculando el gradiente y la Hessiana de forma numérica con la aproximación por diferencias hacia delante:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#definición de función y punto en el que se calculan las aproximaciones</span>
<span class="n">f_ej</span><span class="o">&lt;-</span><span class="n">function</span><span class="p">(</span><span class="n">x</span><span class="p">){</span>
    <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">^</span><span class="mi">2</span>
<span class="p">}</span>
<span class="n">x0</span><span class="o">&lt;-</span><span class="n">rep</span><span class="p">(</span><span class="mf">1.5</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#Función auxiliar para incrementar una entrada de un vector</span>
<span class="c1">#por una cantidad h</span>
<span class="n">inc_index</span><span class="o">&lt;-</span><span class="n">function</span><span class="p">(</span><span class="n">vec</span><span class="p">,</span><span class="n">index</span><span class="p">,</span><span class="n">h</span><span class="p">){</span>
    <span class="n">vec</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">&lt;-</span><span class="n">vec</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">+</span><span class="n">h</span>
    <span class="n">vec</span><span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#Función para aproximar el gradiente de f</span>
<span class="c1">#f: función a la que se le aproximará su gradiente</span>
<span class="c1">#x: punto en el que se aproximará el gradiente de f</span>
<span class="c1">#h: valor de h para diferencias hacia delante</span>
<span class="c1">#gf: aproximación al gradiente de f por diferencias hacia delante</span>
<span class="n">gf_numeric</span><span class="o">&lt;-</span><span class="n">function</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">h</span><span class="p">){</span>
    <span class="n">n</span><span class="o">&lt;-</span><span class="n">length</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">gf</span><span class="o">&lt;-</span><span class="n">rep</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
    <span class="k">for</span><span class="p">(</span><span class="n">i</span> <span class="ow">in</span> <span class="mi">1</span><span class="p">:</span><span class="n">n</span><span class="p">){</span>
        <span class="n">gf</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">inc_index</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">h</span><span class="p">))</span><span class="o">-</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
    <span class="p">}</span>
    <span class="n">gf</span><span class="o">/</span><span class="n">h</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#Función para aproximar la Hessiana de f</span>
<span class="c1">#f: función a la que se le aproximará su Hessiana</span>
<span class="c1">#x: punto en el que se aproximará la Hessiana de f</span>
<span class="c1">#h: valor de h para diferencias hacia delante</span>
<span class="c1">#Hf: aproximación a la Hessiana de f por diferencias hacia delante</span>
<span class="n">gf2_numeric</span><span class="o">&lt;-</span><span class="n">function</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">h</span><span class="p">){</span>
    <span class="n">n</span><span class="o">&lt;-</span><span class="n">length</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">Hf</span><span class="o">&lt;-</span><span class="n">matrix</span><span class="p">(</span><span class="n">rep</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">n</span><span class="o">^</span><span class="mi">2</span><span class="p">),</span><span class="n">nrow</span><span class="o">=</span><span class="n">n</span><span class="p">,</span><span class="n">ncol</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
    <span class="n">f_x</span><span class="o">&lt;-</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">for</span><span class="p">(</span><span class="n">i</span> <span class="ow">in</span> <span class="mi">1</span><span class="p">:</span><span class="n">n</span><span class="p">){</span>
        <span class="n">x_inc_in_i</span><span class="o">&lt;-</span><span class="n">inc_index</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">h</span><span class="p">)</span>
        <span class="n">f_x_inc_in_i</span><span class="o">&lt;-</span><span class="n">f</span><span class="p">(</span><span class="n">x_inc_in_i</span><span class="p">)</span>
        <span class="k">for</span><span class="p">(</span><span class="n">j</span> <span class="ow">in</span> <span class="n">i</span><span class="p">:</span><span class="n">n</span><span class="p">){</span>
            <span class="c1">#otra forma para dif:</span>
            <span class="c1">#dif&lt;-f(inc_index(inc_index(x,j,h),i,h))-f_x_inc_in_i-f(inc_index(x,j,h))+f_x</span>
            <span class="n">dif</span><span class="o">&lt;-</span><span class="n">f</span><span class="p">(</span><span class="n">inc_index</span><span class="p">(</span><span class="n">x_inc_in_i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">h</span><span class="p">))</span><span class="o">-</span><span class="n">f_x_inc_in_i</span><span class="o">-</span><span class="n">f</span><span class="p">(</span><span class="n">inc_index</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">h</span><span class="p">))</span><span class="o">+</span><span class="n">f_x</span>
            <span class="n">Hf</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">&lt;-</span><span class="n">dif</span>
            <span class="k">if</span><span class="p">(</span><span class="n">j</span><span class="o">!=</span><span class="n">i</span><span class="p">)</span>
                <span class="n">Hf</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">]</span><span class="o">&lt;-</span><span class="n">dif</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="n">Hf</span><span class="o">/</span><span class="n">h</span><span class="o">^</span><span class="mi">2</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">h</span><span class="o">&lt;-</span><span class="mi">10</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">16</span><span class="p">))</span><span class="c1">#un conjunto de valores de h para diferencias hacia delante</span>
<span class="n">err_absoluto</span><span class="o">&lt;-</span><span class="n">function</span><span class="p">(</span><span class="n">aprox</span><span class="p">,</span><span class="n">obj</span><span class="p">){</span>
    <span class="n">norm</span><span class="p">(</span><span class="n">aprox</span><span class="o">-</span><span class="n">obj</span><span class="p">,</span><span class="s2">&quot;2&quot;</span><span class="p">)</span> <span class="c1">#cálculo de norma vectorial o matricial, depende de lo que recibe</span>
                        <span class="c1">#la función en sus parámetros aprox y obj</span>
<span class="p">}</span>

<span class="n">err_relativo</span><span class="o">&lt;-</span><span class="n">function</span><span class="p">(</span><span class="n">aprox</span><span class="p">,</span><span class="n">obj</span><span class="p">){</span>
    <span class="n">norm</span><span class="p">(</span><span class="n">aprox</span><span class="o">-</span><span class="n">obj</span><span class="p">,</span><span class="s2">&quot;2&quot;</span><span class="p">)</span><span class="o">/</span><span class="n">norm</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span><span class="s2">&quot;2&quot;</span><span class="p">)</span><span class="c1">#cálculo de norma vectorial o matricial, depende de lo que recibe</span>
                                     <span class="c1">#la función en sus parámetros aprox y obj</span>
<span class="p">}</span>

<span class="n">gf_numeric_list</span><span class="o">&lt;-</span><span class="n">lapply</span><span class="p">(</span><span class="n">h</span><span class="p">,</span><span class="n">gf_numeric</span><span class="p">,</span><span class="n">f</span><span class="o">=</span><span class="n">f_ej</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="n">x0</span><span class="p">)</span>
<span class="n">gf2_numeric_list</span><span class="o">&lt;-</span><span class="n">lapply</span><span class="p">(</span><span class="n">h</span><span class="p">,</span><span class="n">gf2_numeric</span><span class="p">,</span><span class="n">f</span><span class="o">=</span><span class="n">f_ej</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="n">x0</span><span class="p">)</span>


<span class="n">err_absoluto_gf_res</span><span class="o">&lt;-</span><span class="n">sapply</span><span class="p">(</span><span class="n">gf_numeric_list</span><span class="p">,</span><span class="n">err_absoluto</span><span class="p">,</span><span class="n">obj</span><span class="o">=</span><span class="n">gf</span><span class="p">(</span><span class="n">x_0</span><span class="p">))</span>
<span class="n">err_relativo_gf_res</span><span class="o">&lt;-</span><span class="n">sapply</span><span class="p">(</span><span class="n">gf_numeric_list</span><span class="p">,</span><span class="n">err_relativo</span><span class="p">,</span><span class="n">obj</span><span class="o">=</span><span class="n">gf</span><span class="p">(</span><span class="n">x_0</span><span class="p">))</span>

<span class="n">err_absoluto_gf2_res</span><span class="o">&lt;-</span><span class="n">sapply</span><span class="p">(</span><span class="n">gf2_numeric_list</span><span class="p">,</span><span class="n">err_absoluto</span><span class="p">,</span><span class="n">obj</span><span class="o">=</span><span class="n">gf2</span><span class="p">(</span><span class="n">x_0</span><span class="p">))</span>
<span class="n">err_relativo_gf2_res</span><span class="o">&lt;-</span><span class="n">sapply</span><span class="p">(</span><span class="n">gf2_numeric_list</span><span class="p">,</span><span class="n">err_relativo</span><span class="p">,</span><span class="n">obj</span><span class="o">=</span><span class="n">gf2</span><span class="p">(</span><span class="n">x_0</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gg</span><span class="o">&lt;-</span><span class="n">ggplot</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gg</span><span class="o">+</span>
<span class="n">geom_line</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">log</span><span class="p">(</span><span class="n">h</span><span class="p">),</span><span class="n">y</span><span class="o">=</span><span class="n">log</span><span class="p">(</span><span class="n">err_relativo_gf_res</span><span class="p">)))</span><span class="o">+</span>
<span class="n">ggtitle</span><span class="p">(</span><span class="s1">&#39;Aproximación al gradiente por diferencias finitas&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Polinomios_de_Taylor_y_diferenciacion_numerica_105_0.png" src="../../_images/Polinomios_de_Taylor_y_diferenciacion_numerica_105_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">c</span><span class="p">(</span><span class="n">h</span><span class="p">[</span><span class="n">which</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">err_relativo_gf_res</span><span class="p">)],</span><span class="n">h</span><span class="p">[</span><span class="n">which</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">err_absoluto_gf_res</span><span class="p">)]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[1] 1e-08 1e-08
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gg</span><span class="o">+</span>
<span class="n">geom_line</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">log</span><span class="p">(</span><span class="n">h</span><span class="p">),</span><span class="n">y</span><span class="o">=</span><span class="n">log</span><span class="p">(</span><span class="n">err_relativo_gf2_res</span><span class="p">)))</span><span class="o">+</span>
<span class="n">ggtitle</span><span class="p">(</span><span class="s1">&#39;Aproximación a la Hessiana por diferencias finitas&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Polinomios_de_Taylor_y_diferenciacion_numerica_107_0.png" src="../../_images/Polinomios_de_Taylor_y_diferenciacion_numerica_107_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">c</span><span class="p">(</span><span class="n">h</span><span class="p">[</span><span class="n">which</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">err_relativo_gf2_res</span><span class="p">)],</span><span class="n">h</span><span class="p">[</span><span class="n">which</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">err_absoluto_gf2_res</span><span class="p">)]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[1] 1e-06 1e-06
</pre></div>
</div>
</div>
</div>
<p><strong>Ejercicio: aproximar <span class="math notranslate nohighlight">\(\nabla f(x), \nabla^2f(x)\)</span> con diferencias hacia delante y <span class="math notranslate nohighlight">\(h \in \{10^{-16}, 10^{-14}, \dots , 10^{-1}\}\)</span> para <span class="math notranslate nohighlight">\(f: \mathbb{R}^3 \rightarrow \mathbb{R}\)</span>, dada por <span class="math notranslate nohighlight">\(f(x) = x_1x_2\exp(x_1^2+x_3^2-5)\)</span> en el punto <span class="math notranslate nohighlight">\(x_0=(1,3,-2)^T\)</span> Realizar una gráfica de <span class="math notranslate nohighlight">\(\log(\)</span>Err_rel) vs <span class="math notranslate nohighlight">\(\log(\)</span>h).</strong></p>
</div>
</div>
<hr class="docutils" />
<div class="section" id="definiciones-utilizadas-en-el-curso-algunas-de-ellas">
<h2>Definiciones utilizadas en el curso (algunas de ellas…)<a class="headerlink" href="#definiciones-utilizadas-en-el-curso-algunas-de-ellas" title="Permalink to this headline">¶</a></h2>
<p>Notación: <span class="math notranslate nohighlight">\(f: A \rightarrow B\)</span> es una función de un conjunto <span class="math notranslate nohighlight">\(\text{dom}f \subseteq A\)</span> en un conjunto <span class="math notranslate nohighlight">\(B\)</span>.</p>
<p><strong>Obs:</strong> <span class="math notranslate nohighlight">\(\text{dom}f\)</span> (el dominio de <span class="math notranslate nohighlight">\(f\)</span>) podría ser un subconjunto propio de <span class="math notranslate nohighlight">\(A\)</span>, esto es, algunos elementos de <span class="math notranslate nohighlight">\(A\)</span> y otros no, son mapeados a elementos de <span class="math notranslate nohighlight">\(B\)</span>.</p>
<p>En lo que sigue se considera al espacio <span class="math notranslate nohighlight">\(\mathbb{R}^n\)</span> y se asume que conjuntos y subconjuntos están en este espacio.</p>
<p>Un punto <span class="math notranslate nohighlight">\(x\)</span> se nombra <strong>punto límite</strong> de un conjunto <span class="math notranslate nohighlight">\(X\)</span>, si existe una sucesión <span class="math notranslate nohighlight">\(\{x_k\} \subset X\)</span> que converge a <span class="math notranslate nohighlight">\(x\)</span>. El conjunto de puntos límites se nombra <strong>cerradura</strong> o <em>closure</em> de <span class="math notranslate nohighlight">\(X\)</span> y se denota como <span class="math notranslate nohighlight">\(\text{cl}X\)</span>.</p>
<p>Un conjunto <span class="math notranslate nohighlight">\(X\)</span> se nombra <strong>cerrado</strong> si es igual a su cerradura.</p>
<p>En lo siguiente <span class="math notranslate nohighlight">\(\text{intdom}f\)</span> es el <strong>interior</strong>* del dominio de <span class="math notranslate nohighlight">\(f\)</span>.</p>
<p>*El interior es el conjunto de <strong>puntos interiores</strong>: un punto <span class="math notranslate nohighlight">\(x\)</span> de un conjunto <span class="math notranslate nohighlight">\(X\)</span> se llama interior si existe una <strong>vecindad</strong> de <span class="math notranslate nohighlight">\(x\)</span> (conjunto abierto* que contiene a <span class="math notranslate nohighlight">\(x\)</span>) contenida en <span class="math notranslate nohighlight">\(X\)</span>.</p>
<p>*Un conjunto <span class="math notranslate nohighlight">\(X\)</span> se dice que es <strong>abierto</strong> si <span class="math notranslate nohighlight">\(\forall x \in X\)</span> existe una bola abierta* centrada en <span class="math notranslate nohighlight">\(x\)</span> y contenida en <span class="math notranslate nohighlight">\(X\)</span>. Es equivalente escribir que <span class="math notranslate nohighlight">\(X\)</span> es <strong>abierto</strong> si su complemento <span class="math notranslate nohighlight">\(\mathbb{R}^n \ X\)</span> es cerrado.</p>
<p>*Una <strong>bola abierta</strong> con radio <span class="math notranslate nohighlight">\(\epsilon&gt;0\)</span> y centrada en <span class="math notranslate nohighlight">\(x\)</span> es el conjunto: <span class="math notranslate nohighlight">\(B_\epsilon(x) =\{y \in \mathbb{R}^n : ||y-x|| &lt; \epsilon\}\)</span>.</p>
<p><strong>Continuidad</strong></p>
<p><span class="math notranslate nohighlight">\(f: \mathbb{R}^n \rightarrow \mathbb{R}^m\)</span> es continua en <span class="math notranslate nohighlight">\(x \in \text{dom}f\)</span> si $\forall \epsilon &gt;0 \exists \delta &gt; 0 $ tal que:</p>
<div class="math notranslate nohighlight">
\[y \in \text{dom}f, ||y-x||_2 \leq \delta \implies ||f(y)-f(x)||_2 \leq \epsilon\]</div>
<p><strong>Obs:</strong></p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(f\)</span> continua en un punto <span class="math notranslate nohighlight">\(x\)</span> del dominio de <span class="math notranslate nohighlight">\(f\)</span> entonces <span class="math notranslate nohighlight">\(f(y)\)</span> es arbitrariamente cercana a <span class="math notranslate nohighlight">\(f(x)\)</span> para <span class="math notranslate nohighlight">\(y\)</span> en el dominio de <span class="math notranslate nohighlight">\(f\)</span> cercana a <span class="math notranslate nohighlight">\(x\)</span>.</p></li>
<li><p>Otra forma de definir que <span class="math notranslate nohighlight">\(f\)</span> sea continua en <span class="math notranslate nohighlight">\(x \in \text{dom}f\)</span> es con sucesiones y límites: si <span class="math notranslate nohighlight">\(\{x_i\}_{i \in \mathbb{N}} \subseteq \text{dom}f\)</span> es una sucesión de puntos en el dominio de <span class="math notranslate nohighlight">\(f\)</span> que converge a <span class="math notranslate nohighlight">\(x \in \text{dom}f\)</span>, <span class="math notranslate nohighlight">\(\displaystyle \lim_{i \rightarrow \infty}x_i = x\)</span>, y <span class="math notranslate nohighlight">\(f\)</span> es continua en <span class="math notranslate nohighlight">\(x\)</span> entonces la sucesión <span class="math notranslate nohighlight">\(\{f(x_i)\}_{i \in \mathbb{N}}\)</span> converge a <span class="math notranslate nohighlight">\(f(x)\)</span>: <span class="math notranslate nohighlight">\(\displaystyle \lim_{i \rightarrow \infty}f(x_i) = f(x) = f \left(\displaystyle \lim_{i \rightarrow \infty} x_i \right )\)</span>.</p></li>
</ul>
<p><strong>Notación:</strong> <span class="math notranslate nohighlight">\(\mathcal{C}([a,b])=\{\text{funciones } f:\mathbb{R} \rightarrow \mathbb{R} \text{ continuas en el intervalo [a,b]}\}\)</span> y <span class="math notranslate nohighlight">\(\mathcal{C}(\text{dom}f) = \{\text{funciones } f:\mathbb{R}^n \rightarrow \mathbb{R}^m \text{ continuas en su dominio}\}\)</span>.</p>
<div class="section" id="funcion-diferenciable">
<h3>Función Diferenciable<a class="headerlink" href="#funcion-diferenciable" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="caso-f-mathbb-r-rightarrow-mathbb-r">
<h3>Caso <span class="math notranslate nohighlight">\(f: \mathbb{R} \rightarrow \mathbb{R}\)</span><a class="headerlink" href="#caso-f-mathbb-r-rightarrow-mathbb-r" title="Permalink to this headline">¶</a></h3>
<p><span class="math notranslate nohighlight">\(f\)</span> es diferenciable en <span class="math notranslate nohighlight">\(x_0 \in (a,b)\)</span> si <span class="math notranslate nohighlight">\(\displaystyle \lim_{x \rightarrow x_0} \frac{f(x)-f(x_0)}{x-x_0}\)</span> existe y escribimos:</p>
<div class="math notranslate nohighlight">
\[f^{(1)}(x_0) = \displaystyle \lim_{x \rightarrow x_0} \frac{f(x)-f(x_0)}{x-x_0}.\]</div>
<p><span class="math notranslate nohighlight">\(f\)</span> es diferenciable en <span class="math notranslate nohighlight">\([a,b]\)</span> si es diferenciable en cada punto de <span class="math notranslate nohighlight">\([a,b]\)</span>. Análogamente definiendo la variable <span class="math notranslate nohighlight">\(h=x-x_0\)</span> se tiene:</p>
<p><span class="math notranslate nohighlight">\(f^{(1)}(x_0) = \displaystyle \lim_{h \rightarrow 0} \frac{f(x_0+h)-f(x_0)}{h}\)</span> que típicamente se escribe como:</p>
<div class="math notranslate nohighlight">
\[f^{(1)}(x) = \displaystyle \lim_{h \rightarrow 0} \frac{f(x+h)-f(x)}{h}.\]</div>
<p><strong>Comentario:</strong> si <span class="math notranslate nohighlight">\(f\)</span> es diferenciable en <span class="math notranslate nohighlight">\(x_0\)</span> entonces <span class="math notranslate nohighlight">\(f(x) \approx f(x_0) + f^{(1)}(x_0)(x-x_0)\)</span>. Gráficamente:</p>
<img src="https://dl.dropboxusercontent.com/s/3t13ku6pk1pjwxo/f_diferenciable.png?dl=0" heigth="500" width="500">
<p><strong>Notación:</strong> <span class="math notranslate nohighlight">\(\mathcal{C}^n([a,b])=\{\text{funciones } f:\mathbb{R} \rightarrow \mathbb{R} \text{ con } n \text{ derivadas continuas en el intervalo [a,b]}\}\)</span>.</p>
</div>
<div class="section" id="caso-f-mathbb-r-n-rightarrow-mathbb-r-m">
<h3>Caso <span class="math notranslate nohighlight">\(f: \mathbb{R}^n \rightarrow \mathbb{R}^m\)</span><a class="headerlink" href="#caso-f-mathbb-r-n-rightarrow-mathbb-r-m" title="Permalink to this headline">¶</a></h3>
<p><span class="math notranslate nohighlight">\(f\)</span> es diferenciable en <span class="math notranslate nohighlight">\(x \in \text{intdom}f\)</span> si existe una matriz <span class="math notranslate nohighlight">\(Df(x) \in \mathbb{R}^{m\times n}\)</span> tal que:</p>
<div class="math notranslate nohighlight">
\[\displaystyle \lim_{z \rightarrow x, z \neq x} \frac{||f(z)-f(x)-Df(x)(z-x)||_2}{||z-x||_2} = 0, z \in \text{dom}f\]</div>
<p>en este caso <span class="math notranslate nohighlight">\(Df(x)\)</span> se llama la derivada de <span class="math notranslate nohighlight">\(f\)</span> en <span class="math notranslate nohighlight">\(x\)</span>.</p>
<p><strong>Obs:</strong> sólo puede existir a lo más una matriz que satisfaga el límite anterior.</p>
<p><strong>Comentarios:</strong></p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(Df(x)\)</span> también es llamada la <strong>Jacobiana</strong> de <span class="math notranslate nohighlight">\(f\)</span>.</p></li>
<li><p>Se dice que <span class="math notranslate nohighlight">\(f\)</span> es diferenciable si <span class="math notranslate nohighlight">\(\text{dom}f\)</span> es abierto y es diferenciable en cada punto de <span class="math notranslate nohighlight">\(domf.\)</span></p></li>
<li><p>La función: <span class="math notranslate nohighlight">\(f(x) + Df(x)(z-x)\)</span> es afín y se le llama <strong>aproximación de orden <span class="math notranslate nohighlight">\(1\)</span></strong> de <span class="math notranslate nohighlight">\(f\)</span> en <span class="math notranslate nohighlight">\(x\)</span> (o también cerca de <span class="math notranslate nohighlight">\(x\)</span>). Para <span class="math notranslate nohighlight">\(z\)</span> cercana a <span class="math notranslate nohighlight">\(x\)</span> ésta aproximación es cercana a <span class="math notranslate nohighlight">\(f(z)\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(Df(x)\)</span> puede encontrarse con la definición de límite anterior o con las derivadas parciales: <span class="math notranslate nohighlight">\(Df(x)_{ij} = \frac{\partial f_i(x)}{\partial x_j}, i=1,\dots,m, j=1,\dots,n\)</span> definidas como:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\frac{\partial f_i(x)}{\partial x_j} = \displaystyle \lim_{h \rightarrow 0} \frac{f_i(x+he_j)-f_i(x)}{h}\]</div>
<p>donde: <span class="math notranslate nohighlight">\(f_i : \mathbb{R}^n \rightarrow \mathbb{R}\)</span>, <span class="math notranslate nohighlight">\(i=1,\dots,m,j=1,\dots,n\)</span> y <span class="math notranslate nohighlight">\(e_j\)</span> <span class="math notranslate nohighlight">\(j\)</span>-ésimo vector canónico que tiene un número <span class="math notranslate nohighlight">\(1\)</span> en la posición <span class="math notranslate nohighlight">\(j\)</span> y <span class="math notranslate nohighlight">\(0\)</span> en las entradas restantes.</p>
<ul class="simple">
<li><p>Si <span class="math notranslate nohighlight">\(f: \mathbb{R}^n \rightarrow \mathbb{R}, Df(x) \in \mathbb{R}^{1\times n}\)</span>, su transpuesta se llama <strong>gradiente</strong>, el cual es un vector columna, se denota <span class="math notranslate nohighlight">\(\nabla f(x)\)</span> y sus componentes son derivadas parciales:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}\nabla f(x) = Df(x)^T = 
    \left[ \begin{array}{c}
    \frac{\partial f(x)}{\partial x_1}\\
    \vdots\\
    \frac{\partial f(x)}{\partial x_n}
    \end{array}
    \right] = \left[ 
    \begin{array}{c} 
    \displaystyle \lim_{h \rightarrow 0} \frac{f(x+he_1) - f(x)}{h}\\
    \vdots\\
    \displaystyle \lim_{h \rightarrow 0} \frac{f(x+he_n) - f(x)}{h}
    \end{array}
    \right] \in \mathbb{R}^{n\times 1}.\end{split}\]</div>
<p><strong>Comentarios:</strong></p>
<ul class="simple">
<li><p>En este contexto, la aproximación de primer orden a <span class="math notranslate nohighlight">\(f\)</span> en <span class="math notranslate nohighlight">\(x\)</span> es: <span class="math notranslate nohighlight">\(f(x) + \nabla f(x)^T(z-x)\)</span> para <span class="math notranslate nohighlight">\(z\)</span> cercana a <span class="math notranslate nohighlight">\(x\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(\mathcal{C}^n(\text{dom}f) = \{\text{funciones } f:\mathbb{R}^n \rightarrow \mathbb{R}^m \text{ con } n \text{ derivadas continuas en su dominio}\}\)</span>.</p></li>
</ul>
</div>
<div class="section" id="regla-de-la-cadena">
<h3>Regla de la cadena<a class="headerlink" href="#regla-de-la-cadena" title="Permalink to this headline">¶</a></h3>
<p>Si <span class="math notranslate nohighlight">\(f:\mathbb{R}^n \rightarrow \mathbb{R}^m\)</span> es diferenciable en <span class="math notranslate nohighlight">\(x\in \text{intdom}f\)</span> y <span class="math notranslate nohighlight">\(g:\mathbb{R}^m \rightarrow \mathbb{R}^p\)</span> es diferenciable en <span class="math notranslate nohighlight">\(f(x)\in \text{intdom}g\)</span>, se define la composición <span class="math notranslate nohighlight">\(h:\mathbb{R}^n \rightarrow \mathbb{R}^p\)</span> por <span class="math notranslate nohighlight">\(h(z) = g(f(z))\)</span>, la cual es diferenciable en <span class="math notranslate nohighlight">\(x\)</span>, con derivada:</p>
<div class="math notranslate nohighlight">
\[Dh(x)=Dg(f(x))Df(x)\in \mathbb{R}^{p\times n}.\]</div>
<p><strong>Ejemplo:</strong> Sean <span class="math notranslate nohighlight">\(g:\mathbb{R} \rightarrow \mathbb{R}\)</span>, <span class="math notranslate nohighlight">\(f:\mathbb{R}^n \rightarrow \mathbb{R}\)</span>, <span class="math notranslate nohighlight">\(h:\mathbb{R}^n \rightarrow \mathbb{R}\)</span> con <span class="math notranslate nohighlight">\(h(z) = g(f(z))\)</span> entonces:</p>
<div class="math notranslate nohighlight">
\[Dh(x) = Dg(f(x))Df(x) = \frac{dg(f(x))}{dx}(\nabla f(x))^T \in \mathbb{R}^{1\times n}\]</div>
<p>y la transpuesta de <span class="math notranslate nohighlight">\(Dh(x)\)</span> es: <span class="math notranslate nohighlight">\(\nabla h(x) = (Dh(x))^T = \frac{dg(f(x))}{dx} \nabla f(x) \in \mathbb{R}^{n\times 1}\)</span>.</p>
</div>
<div class="section" id="caso-particular">
<h3>Caso particular:<a class="headerlink" href="#caso-particular" title="Permalink to this headline">¶</a></h3>
<p>Si <span class="math notranslate nohighlight">\(f: \mathbb{R}^n \rightarrow \mathbb{R}^m\)</span>, <span class="math notranslate nohighlight">\(f(x) = Ax +b\)</span> con <span class="math notranslate nohighlight">\(A \in \mathbb{R}^{m\times n},b \in \mathbb{R}^m\)</span>, <span class="math notranslate nohighlight">\(g:\mathbb{R}^m \rightarrow \mathbb{R}^p\)</span> y <span class="math notranslate nohighlight">\(h(z)=g(f(z))=g(Az+b)\)</span> con <span class="math notranslate nohighlight">\(\text{dom}h=\{x \in \mathbb{R}^n | Ax+b \in \text{dom}g\}\)</span> entonces la derivada de <span class="math notranslate nohighlight">\(h\)</span> en <span class="math notranslate nohighlight">\(x\)</span> es: <span class="math notranslate nohighlight">\(Dh(x) = Dg(f(x))Df(x)=Dg(Ax+b)A\)</span></p>
<p><strong>Obs:</strong> Si <span class="math notranslate nohighlight">\(f:\mathbb{R}^n \rightarrow \mathbb{R}^m, g:\mathbb{R}^m \rightarrow \mathbb{R}, h:\mathbb{R}^n \rightarrow \mathbb{R}\)</span> entonces: <span class="math notranslate nohighlight">\(\nabla h(x) = (Dh(x))^T = A^T(Dg(Ax+b))^T=A^T\nabla g(Ax+b) \in \mathbb{R}^{n\times 1}\)</span>.</p>
<p><strong>Ejemplo:</strong></p>
<ol class="simple">
<li><p>Sean <span class="math notranslate nohighlight">\(g:\mathbb{R}^n \rightarrow \mathbb{R}, x, v \in \mathbb{R}^n\)</span> y <span class="math notranslate nohighlight">\(\hat{g}: \mathbb{R} \rightarrow \mathbb{R}\)</span> con <span class="math notranslate nohighlight">\(\hat{g}(t)=g(x+tv)\)</span>, esto es, <span class="math notranslate nohighlight">\(\hat{g}\)</span> es <span class="math notranslate nohighlight">\(g\)</span> restringida a la línea <span class="math notranslate nohighlight">\(\{x+tv |t \in \mathbb{R} \}\)</span>, entonces:</p></li>
</ol>
<div class="math notranslate nohighlight">
\[(\nabla \hat{g}(t))^T = D\hat{g}(t) = \hat{g}^{(1)}(t) = (\nabla g(x+tv))^Tv.\]</div>
<p><strong>Comentario:</strong> el escalar <span class="math notranslate nohighlight">\(\hat{g}^{(1)}(0) = (\nabla g(x))^Tv\)</span> se llama <strong>derivada direccional</strong> de <span class="math notranslate nohighlight">\(g\)</span> en <span class="math notranslate nohighlight">\(x\)</span> en la dirección <span class="math notranslate nohighlight">\(v\)</span>.</p>
<ol class="simple">
<li><p>Sea <span class="math notranslate nohighlight">\(h: \mathbb{R}^n \rightarrow \mathbb{R}, h(x) = \log \left( \displaystyle \sum_{i=1}^m \exp(a_i^Tx+b_i) \right)\)</span> con <span class="math notranslate nohighlight">\(x\in \mathbb{R}^n,a_i\in \mathbb{R}^n \forall i=1,\dots,m\)</span> y <span class="math notranslate nohighlight">\(b_i \in \mathbb{R} \forall i=1,\dots,m\)</span> entonces: <span class="math notranslate nohighlight">\(Dh(x)=Dg(f(x))Df(x)\)</span> con <span class="math notranslate nohighlight">\(g: \mathbb{R}^m \rightarrow \mathbb{R}\)</span> dada por <span class="math notranslate nohighlight">\(g(y)=\log \left( \displaystyle \sum_{i=1}^m \exp(y_i) \right ), f(x)=Ax+b, A=(a_i)_{i=1}^m \in \mathbb{R}^{m\times n}, b \in \mathbb{R}^m.\)</span> y <span class="math notranslate nohighlight">\(h(x)=g(f(x))\)</span>. Entonces:</p></li>
</ol>
<div class="math notranslate nohighlight">
\[\begin{split}
Dh(x)=\left(\displaystyle \sum_{i=1}^m\exp(a_i^Tx+b_i) \right)^{-1}\left[ \begin{array}{c}
    \exp(a_1^Tx+b_1)\\
    \vdots\\
    \exp(a_m^Tx+b_m)
    \end{array}
    \right]A=(1^Tz)^{-1}z^TA
\end{split}\]</div>
<p>donde: <span class="math notranslate nohighlight">\(z=\left[ \begin{array}{c}
    \exp(a_1^Tx+b_1)\\
    \vdots\\
    \exp(a_m^Tx+b_m)
    \end{array}\right]\)</span>. Por lo tanto <span class="math notranslate nohighlight">\(\nabla h(x) = (1^Tz)^{-1}A^Tz\)</span>.</p>
</div>
<div class="section" id="segunda-derivada-de-una-funcion-f-mathbb-r-n-rightarrow-mathbb-r">
<h3>Segunda derivada de una función <span class="math notranslate nohighlight">\(f: \mathbb{R}^n \rightarrow \mathbb{R}\)</span>.<a class="headerlink" href="#segunda-derivada-de-una-funcion-f-mathbb-r-n-rightarrow-mathbb-r" title="Permalink to this headline">¶</a></h3>
<p>Sea <span class="math notranslate nohighlight">\(f:\mathbb{R}^n \rightarrow \mathbb{R}\)</span>. La segunda derivada o matriz <strong>Hessiana</strong> de <span class="math notranslate nohighlight">\(f\)</span> en <span class="math notranslate nohighlight">\(x \in \text{intdom}f\)</span> existe si <span class="math notranslate nohighlight">\(f\)</span> es dos veces diferenciable en <span class="math notranslate nohighlight">\(x\)</span>, se denota <span class="math notranslate nohighlight">\(\nabla^2f(x)\)</span> y sus componentes son segundas derivadas parciales:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\nabla^2f(x) = \left[\begin{array}{cccc}
\frac{\partial^2f(x)}{\partial x_1^2} &amp;\frac{\partial^2f(x)}{\partial x_2 \partial x_1}&amp;\dots&amp;\frac{\partial^2f(x)}{\partial x_n \partial x_1}\\
\frac{\partial^2f(x)}{\partial x_1 \partial x_2} &amp;\frac{\partial^2f(x)}{\partial x_2^2} &amp;\dots&amp;\frac{\partial^2f(x)}{\partial x_n \partial x_2}\\
\vdots &amp;\vdots&amp; \ddots&amp;\vdots\\
\frac{\partial^2f(x)}{\partial x_1 \partial x_n} &amp;\frac{\partial^2f(x)}{\partial x_2 \partial x_n}&amp;\dots&amp;\frac{\partial^2f(x)}{\partial x_n^2} \\
\end{array}
\right]
\end{split}\]</div>
<p><strong>Comentarios:</strong></p>
<ul class="simple">
<li><p>La aproximación de segundo orden a <span class="math notranslate nohighlight">\(f\)</span> en <span class="math notranslate nohighlight">\(x\)</span> (o también para puntos cercanos a <span class="math notranslate nohighlight">\(x\)</span>) es la función cuadrática:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[f(x) + (\nabla f(x))^T(z-x)+\frac{1}{2}(z-x)^T\nabla^2f(x)(z-x)\]</div>
<p>la cual es una función de <span class="math notranslate nohighlight">\(z\)</span>.</p>
<ul class="simple">
<li><p>Se cumple:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\displaystyle \lim_{z \rightarrow x, z \neq x} \frac{|f(z)-[f(x)+(\nabla f(x))^T(z-x)+\frac{1}{2}(z-x)^T\nabla^2f(x)(z-x)]|}{||z-x||_2} = 0, z \in \text{dom}f\]</div>
<ul class="simple">
<li><p>Se tiene lo siguiente:</p>
<ul>
<li><p><span class="math notranslate nohighlight">\(\nabla f\)</span> es una función llamada gradient mapping (o simplemente gradiente).</p></li>
<li><p><span class="math notranslate nohighlight">\(\nabla f:\mathbb{R}^n \rightarrow \mathbb{R}^n\)</span> tiene regla de correspondencia <span class="math notranslate nohighlight">\(\nabla f(x)\)</span> (evaluar en <span class="math notranslate nohighlight">\(x\)</span> la matriz <span class="math notranslate nohighlight">\((Df(\cdot))^T\)</span>).</p></li>
<li><p>Si <span class="math notranslate nohighlight">\(f\)</span> es dos veces diferenciable entonces: <span class="math notranslate nohighlight">\(D\nabla f(x) = \nabla^2f(x)\)</span>.</p></li>
<li><p><strong>Importante:</strong> si <span class="math notranslate nohighlight">\(f \in \mathcal{C}^2(\text{dom}f)\)</span> entonces la Hessiana es una matriz simétrica.</p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="regla-de-la-cadena-para-la-segunda-derivada">
<h3>Regla de la cadena para la segunda derivada<a class="headerlink" href="#regla-de-la-cadena-para-la-segunda-derivada" title="Permalink to this headline">¶</a></h3>
<p><strong>Caso 1:</strong> Sean <span class="math notranslate nohighlight">\(f:\mathbb{R}^n \rightarrow \mathbb{R}, g:\mathbb{R} \rightarrow \mathbb{R}, h:\mathbb{R}^n \rightarrow \mathbb{R}\)</span> con  <span class="math notranslate nohighlight">\(h(x) = g(f(x))\)</span>, entonces: <span class="math notranslate nohighlight">\(\nabla^2h(x) = D\nabla h(x)\)</span> y <span class="math notranslate nohighlight">\(\nabla h(x)=(Dh(x))^T = (Dg(f(x))Df(x))^T=\frac{dg(x)}{dx}\nabla f(x)\)</span> por lo que:</p>
<p><span class="math notranslate nohighlight">\(\nabla^2 h(x) = D\nabla h(x)=D \left(\frac{dg(f(x))}{dx}\nabla f(x)\right) = \frac{dg(f(x))}{dx}\nabla^2 f(x)+\left(\frac{d^2g(f(x))}{dx}\nabla f(x) (\nabla f(x))^T \right)^T=\frac{dg(f(x))}{dx}\nabla^2 f(x)+\frac{d^2g(f(x))}{dx} \nabla f(x) (\nabla f(x))^T\)</span></p>
<p><strong>Caso 2:</strong> Sean <span class="math notranslate nohighlight">\(f:\mathbb{R}^n \rightarrow \mathbb{R}^m, f(x) = Ax+b, A \in \mathbb{R}^{m\times n}, b \in \mathbb{R}^m\)</span> y <span class="math notranslate nohighlight">\(h(x) = g(f(x))\)</span> con <span class="math notranslate nohighlight">\(g:\mathbb{R}^m \rightarrow \mathbb{R}^p, h:\mathbb{R}^n \rightarrow \mathbb{R}^p\)</span>, entonces:</p>
<div class="math notranslate nohighlight">
\[\nabla h(x) = (Dh(x))^T = (Dg(f(x))Df(x))^T = (Dg(Ax+b)A)^T = A^TDg(Ax+b).\]</div>
<p><strong>Obs:</strong> si <span class="math notranslate nohighlight">\(p=1\)</span> se tiene: <span class="math notranslate nohighlight">\(\nabla^2h(x) = D \nabla h(x) = A^T \nabla^2g(Ax+b)A.\)</span></p>
<p><strong>Ejemplos:</strong></p>
<ul class="simple">
<li><p>Sea <span class="math notranslate nohighlight">\(\hat{g}(t) = g(x+tv)\)</span> con <span class="math notranslate nohighlight">\(x,v \in \mathbb{R}^n, t \in \mathbb{R}\)</span> y <span class="math notranslate nohighlight">\(g:\mathbb{R}^n \rightarrow \mathbb{R}\)</span>, <span class="math notranslate nohighlight">\(\hat{g}: \mathbb{R} \rightarrow \mathbb{R}\)</span> es decir, <span class="math notranslate nohighlight">\(\hat{g}\)</span> es <span class="math notranslate nohighlight">\(g\)</span> restringida a la línea <span class="math notranslate nohighlight">\(\{x+tv|t \in \mathbb{R}\}\)</span>, entonces:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[(\nabla \hat{g}(t))^T = D\hat{g}(t) = \frac{\hat{g}(t)}{dt} = Dg(x+tv)v = \nabla g(x+tv)^Tv\]</div>
<p>y:</p>
<div class="math notranslate nohighlight">
\[\nabla^2 \hat{g}(t) = \frac{d^2\hat{g}(t)}{dt^2} = D\nabla g(x+tv)v=v^T\nabla^2g(x+tv)v.\]</div>
<ul class="simple">
<li><p>Sean <span class="math notranslate nohighlight">\(h: \mathbb{R}^n \rightarrow \mathbb{R}, h(x) = \log \left( \displaystyle \sum_{i=1}^m \exp(a_i^Tx+b_i)\right)\)</span> con <span class="math notranslate nohighlight">\(x \in \mathbb{R}^n, a_i \in \mathbb{R}^n \forall i=1,\dots,m\)</span> y <span class="math notranslate nohighlight">\(b_i \in \mathbb{R} \forall i=1,\dots,m\)</span>. Entonces: <span class="math notranslate nohighlight">\(Dh(x)=Dg(f(x))Df(x)\)</span> con <span class="math notranslate nohighlight">\(g(y) = \log \left( \displaystyle \sum_{i=1}^m \exp(y_i)\right ), f(x) = Ax+b, A=(a_i)_{i=1}^m \in \mathbb{R}^{m\times n}, b \in \mathbb{R}^m, h(x) = g(f(x))\)</span>.</p></li>
</ul>
<p>Como se desarrolló anteriormente <span class="math notranslate nohighlight">\(\nabla h(x) = (1^Tz)^{-1}A^Tz\)</span> con <span class="math notranslate nohighlight">\(z=\left[ \begin{array}{c}
    \exp(a_1^Tx+b_1)\\
    \vdots\\
    \exp(a_m^Tx+b_m)
    \end{array}\right]\)</span>.</p>
<div class="math notranslate nohighlight">
\[\therefore \nabla^2 h(x) = D\nabla h(x) = A^T \nabla^2g(Ax+b)A\text{ (por caso }2)\]</div>
<p>donde: $\nabla^2g(y)=(1^Ty)^{-1}\text{diag}(y)-(1^Ty)^{-2}yy^T $ (por caso <span class="math notranslate nohighlight">\(1\)</span> tomando <span class="math notranslate nohighlight">\(\log:\mathbb{R} \rightarrow \mathbb{R}, \sum \exp: \mathbb{R}^m \rightarrow \mathbb{R}\)</span>)</p>
<div class="math notranslate nohighlight">
\[\therefore  \nabla^2 h(x) = A^T\left[(1^Tz)^{-1}\text{diag}(z)-(1^Tz)^{-2}zz^T \right]A\]</div>
<p>con <span class="math notranslate nohighlight">\(\text{diag}(c)\)</span> matriz diagonal con elementos en su diagonal iguales a las entradas del vector <span class="math notranslate nohighlight">\(c\)</span>.</p>
<p><strong>Ejercicios</strong></p>
<ol class="simple">
<li><p>Resuelve los ejercicios y preguntas de la nota.</p></li>
</ol>
<p><strong>Referencias</strong></p>
<ol class="simple">
<li><p>R. L. Burden, J. D. Faires, Numerical Analysis, Brooks/Cole Cengage Learning, 2005.</p></li>
<li><p>M. T. Heath, Scientific Computing. An Introductory Survey, McGraw-Hill, 2002.</p></li>
<li><p>S. P. Boyd, L. Vandenberghe, Convex Optimization. Cambridge University Press, 2004.</p></li>
<li><p>Nota <a class="reference external" href="https://github.com/ITAM-DS/analisis-numerico-computo-cientifico/blob/master/temas/I.computo_cientifico/1.2.Sistema_de_punto_flotante.ipynb">1.2.Sistema de punto flotante</a>.</p></li>
<li><p>Nota <a class="reference external" href="https://github.com/ITAM-DS/analisis-numerico-computo-cientifico/blob/master/temas/I.computo_cientifico/1.3.Condicion_de_un_problema_y_estabilidad_de_un_algoritmo.ipynb">1.3.Condicion_de_un_problema_y_estabilidad_de_un_algoritmo</a>.</p></li>
</ol>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "palmoreck/dockerfiles-for-binder",
            ref: "https://github.com/palmoreck/dockerfiles-for-binder/tree/jupyterlab_optimizacion",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "r"
        },
        kernelOptions: {
            kernelName: "ir",
            path: "./I.computo_cientifico/1.4"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'ir'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="../1.3/Condicion_de_un_problema_y_estabilidad_de_un_algoritmo.html" title="previous page">1.3 Condición de un problema y estabilidad de un algoritmo</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Erick Palacios Moreno<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    <script src="../../_static/js/index.js"></script>
    
  </body>
</html>