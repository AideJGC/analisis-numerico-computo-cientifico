

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title></title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous">
    <link href="_static/css/index.css" rel="stylesheet">
    <link rel="stylesheet" href="_static/sphinx-book-theme.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/jupyter-sphinx.css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/sphinx-book-theme.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/mystnb.js"></script>
    <script src="_static/sphinx-book-theme.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.18.0/dist/embed-amd.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe,.cell"
        const thebe_selector_input = "pre,.cell_input div.highlight"
        const thebe_selector_output = ".output,.cell_output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="docsearch:language" content="en">



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-2 bd-sidebar site-navigation show" id="site-navigation">
    
</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    
</div>
        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> On this page
        </div>
        <nav id="bd-toc-nav">
            
        </nav>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="optimizacion">
<h1>Optimización<a class="headerlink" href="#optimizacion" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><p>Parte 1: temas del cómputo Científico y del Álgebra Lineal Numérica.</p></li>
<li><p>Parte 2: ecuaciones no lineales y Optimización.</p></li>
</ul>
<p>Dar click en <a class="reference external" href="https://drive.google.com/file/d/1dj7bU5uN_ngEhUxhKL9YzCfPGLVc8Z0j/view?usp=sharing">liga</a> para el temario.</p>
<p>Url del repositorio: <a class="reference external" href="https://github.com/ITAM-DS/analisis-numerico-computo-cientifico">https://github.com/ITAM-DS/analisis-numerico-computo-cientifico</a></p>
<p>Liga para crear <em>issues</em> en repositorio: <a class="reference external" href="https://github.com/ITAM-DS/analisis-numerico-computo-cientifico/issues/new?title=Issue%20on&amp;body=Your%20issue%20content%20here">liga para issues</a></p>
<div class="toctree-wrapper compound">
<span id="document-I.computo_cientifico/1.1/Analisis_numerico_y_computo_cientifico"></span><p>Nota generada a partir de <a class="reference external" href="https://www.dropbox.com/s/z5ifw3ti66gukdy/1.1.Analisis_numerico_y_computo_cientifico.pdf?dl=0">liga</a></p>
<div class="section" id="analisis-numerico-y-computo-cientifico">
<h2>1.1 Análisis numérico y cómputo científico<a class="headerlink" href="#analisis-numerico-y-computo-cientifico" title="Permalink to this headline">¶</a></h2>
<div class="section" id="introduccion">
<h3>Introducción<a class="headerlink" href="#introduccion" title="Permalink to this headline">¶</a></h3>
<p>El cómputo científico (ver <a class="reference external" href="https://en.wikipedia.org/wiki/Computational_science">liga</a>) es parte de lo que se conoce como ciencia de la computación, cuya investigación incluye las fases:</p>
<ol class="simple">
<li><p>Desarrollo de un modelo matemático para un fenómeno de interés.</p></li>
<li><p>Desarrollo de un algoritmo.</p></li>
<li><p>Implementación del algoritmo en un software.</p></li>
<li><p>Simulaciones numéricas del fenómeno con el software.</p></li>
<li><p>Representación de los resultados calculados (gráficas o herramientas visuales).</p></li>
<li><p>Interpretación y validación de los resultados.</p></li>
</ol>
<p>y se realizan los puntos anteriores en una forma repetida (<span class="math notranslate nohighlight">\(1\)</span>-<span class="math notranslate nohighlight">\(6\)</span>) dependiendo de los resultados obtenidos en <span class="math notranslate nohighlight">\(6\)</span>.</p>
<p>El cómputo científico se encarga de las fases <span class="math notranslate nohighlight">\(2\)</span> a <span class="math notranslate nohighlight">\(4\)</span>: desarrollo, implementación y uso de los algoritmos numéricos y software para aplicaciones. Ejemplos de aplicaciones las encontramos en análisis y ajuste de modelos a datos, optimización y machine learning, entre otras.</p>
</div>
<div class="section" id="id1">
<h3>Análisis numérico y cómputo científico.<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>Nuestro curso involucra temas del análisis numérico el cual se enfoca al diseño y análisis de algoritmos para resolver problemas que surgen en la ciencia de la computación e ingeniería. Por esto, al análisis numérico se le ha llamado también cómputo científico y se distingue de otras áreas de la ciencia de la computación en que trabaja con <strong>cantidades continuas</strong>, cantidades como velocidad y temperatura presentes naturalmente son algunos ejemplos.</p>
<p>Tales cantidades las encontramos en muchos problemas de matemáticas los cuales no se resuelven en principio con un número finito de pasos, sino que deben resolverse por un proceso iterativo que converja a la solución, teóricamente infinito. Sin embargo, en la práctica, no se realizan procesos infinitos y además no se resuelven problemas de manera exacta; se obtienen respuestas aproximadamente correctas, “suficientemente cercanas o precisas” al resultado deseado. Así, el análisis numérico debe trabajar con recursos finitos y cantidades discretas.</p>
<p>Lo anterior subraya uno de los aspectos más importantes del cómputo científico: encontrar algoritmos iterativos que <strong>converjan</strong> “rápidamente”, así como dar una estimación de la <strong>exactitud</strong> de las aproximaciones calculadas. Así, un segundo tema que distingue al análisis numérico de otras áreas de la ciencia de la computación es el relacionado con las <strong>aproximaciones</strong> y sus efectos. Es indispensable que tales aproximaciones sean controladas por algoritmos “buenos”, esto es, que sean <strong>eficientes</strong> (hacer más con menos), sean <strong>confiables</strong> y <strong>exactos</strong> ante la serie de aproximaciones realizadas: sean <strong>estables</strong>.</p>
<p>La eficiencia se relaciona directamente con el <strong>costo computacional</strong>, el cual típicamente se mide a partir del número de operaciones que realiza el algoritmo (aunque otra componente común para medir el costo computacional, es la transferencia de datos entre las diferentes jerarquías de memoria en una máquina) y la <strong>estabilidad</strong> se refiere a no amplificar los <strong>errores</strong> generados por las aproximaciones o resultados calculados durante la ejecución del algoritmo. Asimismo, la estabilidad se relaciona con la pregunta: ¿si se perturban los datos de entrada, el algoritmo calcula una solución “cercana” a los datos no perturbados? (esta pregunta tiene que ver con el <strong>análisis de sensibilidad</strong> en un algoritmo ante perturbaciones en los datos de entrada).</p>
</div>
<div class="section" id="fuentes-de-error">
<h3>Fuentes de error<a class="headerlink" href="#fuentes-de-error" title="Permalink to this headline">¶</a></h3>
<p>Algunas fuentes de error que nos encontramos al resolver un problema surgen por:</p>
<ul class="simple">
<li><p>Uso de modelos (simplificación u omisión).</p></li>
<li><p>Mediciones con instrumentos.</p></li>
<li><p>Cálculos previos.</p></li>
</ul>
<p>Las fuentes anteriores típicamente están fuera de nuestro control. En el cómputo científico se estudian dos fuentes que influyen directamente en el algoritmo utilizado para resolver un problema y sí podemos controlarlas:</p>
<ul class="simple">
<li><p>Truncamiento: relacionado con el uso de procesos o cantidades finitas.</p></li>
<li><p>Redondeo: relacionado con la representación de los números y la aritmética realizada en una máquina.</p></li>
</ul>
<p>Estas fuentes de error influyen en la exactitud de un cálculo y las perturbaciones que resulten de estas fuentes, serán amplificadas (o no) por la <strong>naturaleza del problema</strong> y el <strong>tipo de algoritmo utilizado</strong>. Al estudio de la exactitud y estabilidad de un algoritmo por fuentes de error se le llama <strong>análisis del error</strong>.</p>
</div>
<div class="section" id="analisis-del-error">
<h3>Análisis del error<a class="headerlink" href="#analisis-del-error" title="Permalink to this headline">¶</a></h3>
<p>En general un problema puede verse como evaluar una función <span class="math notranslate nohighlight">\(f: \mathbb{R} \rightarrow \mathbb{R}\)</span>. Por ejemplo, sea <span class="math notranslate nohighlight">\(x\)</span> el dato de entrada, considérese el problema de evaluar <span class="math notranslate nohighlight">\(f(x)\)</span>, el dato de salida.</p>
<p>Al trabajar con la máquina, nos encontramos que la representación de un número real en general no es exacta, por ello tenemos una aproximación <span class="math notranslate nohighlight">\(\hat{x}\)</span> a la cantidad <span class="math notranslate nohighlight">\(x\)</span> (error por redondeo) y nuestra forma de calcular <span class="math notranslate nohighlight">\(f\)</span> es por medio de un algoritmo <span class="math notranslate nohighlight">\(\hat{f}\)</span>, entonces, el error al evaluar <span class="math notranslate nohighlight">\(f\)</span> es:</p>
<div class="math notranslate nohighlight">
\[\text{Error total} = \hat{f}(\hat{x}) - f(x) = \underbrace{\hat{f}(\hat{x})-f(\hat{x})}_\text{Error Computacional} + \underbrace{f(\hat{x})-f(x)}_\text{Error en datos}.\]</div>
<p>El primer término es generado por el algoritmo utilizado: <span class="math notranslate nohighlight">\(\hat{f}\)</span> (cálculos y aproximaciones realizadas por el algoritmo utilizando <span class="math notranslate nohighlight">\(\hat{x}\)</span>) y el segundo es debido a mediciones o redondeos realizados por la máquina o personas o instrumentos, observa que este término no se ve influenciado por el algoritmo utilizado y es un error que no controlamos.</p>
<p>El error computacional tiene dos componentes: uno por <strong>truncamiento</strong> y otro por <strong>redondeo</strong>:</p>
<ul class="simple">
<li><p>El truncamiento es la diferencia entre el resultado veradero y el resultado que se obtiene con un algoritmo usando aritmética exacta. Por ejemplo, reemplazar una serie infinita (resultado verdadero) con una serie truncada (algoritmo: truncar serie infinita) y evaluar la serie truncada con <strong>aritmética exacta</strong> (por ejemplo usar <span class="math notranslate nohighlight">\(\frac{1}{3}\)</span> en los cálculos en lugar de <span class="math notranslate nohighlight">\(0.333\)</span>).</p></li>
<li><p>El error por redondeo es la diferencia entre el resultado obtenido por un algoritmo utilizando aritmética exacta y el resultado producido por el mismo algoritmo usando <strong>aritmética de máquina</strong>.</p></li>
</ul>
<div class="tip admonition">
<p class="admonition-title">Observación</p>
<p>Obsérvese que en la descomposición del error total de arriba se utiliza en el error computacional <span class="math notranslate nohighlight">\(\hat{x}\)</span>. En la nota <a class="reference internal" href="README.html#cpea"><span class="std std-ref">Condición de un problema y estabilidad de un algoritmo</span></a> se define la estabilidad de un algoritmo utilizando <span class="math notranslate nohighlight">\(x\)</span> en lugar de <span class="math notranslate nohighlight">\(\hat{x}\)</span> pues se desea medir la cercanía entre <span class="math notranslate nohighlight">\(x\)</span> y <span class="math notranslate nohighlight">\(\hat{x}\)</span> determinada por el sistema de punto flotante (errores por redondeo).</p>
</div>
<div class="admonition-comentario admonition">
<p class="admonition-title">Comentario</p>
<p>Aunque los errores por truncamiento y por redondeo son componentes del error total, típicamente un tipo de error domina sobre otro. Hacer la distinción entre ellos, nos ayuda a entender el comportamiento de los algoritmos y los factores que influyen en su <strong>exactitud</strong>.</p>
</div>
</div>
<div class="section" id="nota-sobre-exactitud-y-precision">
<h3>Nota sobre exactitud y precisión.<a class="headerlink" href="#nota-sobre-exactitud-y-precision" title="Permalink to this headline">¶</a></h3>
<p>Los errores en los cálculos y las medidas se pueden caracterizar respecto a su exactitud y precisión. La exactitud se refiere a que tan cercano está el valor calculado o medido del valor verdadero. La precisión se refiere a qué tan cercanos se encuentran unos de otros diversos valores calculados o medidos. Obsérvese el siguiente diagrama:</p>
<img src="https://www.dl.dropboxusercontent.com/s/azkoe49xfg3a90d/1.1.exactitud_precision.png?dl=0" heigth="500" width="500"><p><strong>Preguntas de comprehensión</strong></p>
<p>1)¿Cuáles son las características del análisis numérico y cómputo científico?</p>
<p>2)¿Qué propiedades debe tener un buen algoritmo?</p>
<p>3)¿Cuáles fuentes de error principalmente son estudiadas por el análisis numérico y cómputo científico al resolver un problema?</p>
<p>4)Menciona las diferencias entre los términos exactitud y precisión.</p>
<p><strong>Referencias:</strong></p>
<ol class="simple">
<li><p>M. T. Heath, Scientific Computing. An Introductory Survey, McGraw-Hill, 2002.</p></li>
</ol>
</div>
</div>
<span id="document-I.computo_cientifico/1.2/Sistema_de_punto_flotante"></span><div class="admonition-notas-para-contenedor-de-docker admonition">
<p class="admonition-title">Notas para contenedor de docker:</p>
<p>Comando de docker para ejecución de la nota de forma local:</p>
<p>nota: cambiar <code class="docutils literal notranslate"><span class="pre">&lt;ruta</span> <span class="pre">a</span> <span class="pre">mi</span> <span class="pre">directorio&gt;</span></code> por la ruta de directorio que se desea mapear a <code class="docutils literal notranslate"><span class="pre">/datos</span></code> dentro del contenedor de docker.</p>
<p><code class="docutils literal notranslate"><span class="pre">docker</span> <span class="pre">run</span> <span class="pre">--rm</span> <span class="pre">-v</span> <span class="pre">&lt;ruta</span> <span class="pre">a</span> <span class="pre">mi</span> <span class="pre">directorio&gt;:/datos</span> <span class="pre">--name</span> <span class="pre">jupyterlab_optimizacion</span> <span class="pre">-p</span> <span class="pre">8888:8888</span> <span class="pre">-d</span> <span class="pre">palmoreck/jupyterlab_optimizacion:2.1.4</span></code></p>
<p>password para jupyterlab: <code class="docutils literal notranslate"><span class="pre">qwerty</span></code></p>
<p>Detener el contenedor de docker:</p>
<p><code class="docutils literal notranslate"><span class="pre">docker</span> <span class="pre">stop</span> <span class="pre">jupyterlab_optimizacion</span></code></p>
<p>Documentación de la imagen de docker <code class="docutils literal notranslate"><span class="pre">palmoreck/jupyterlab_optimizacion:2.1.4</span></code> en <a class="reference external" href="https://github.com/palmoreck/dockerfiles/tree/master/jupyterlab/optimizacion">liga</a>.</p>
</div>
<hr class="docutils" />
<p>Nota generada a partir de <a class="reference external" href="https://www.dropbox.com/s/9fsupm3bhwmv7cb/1.2.Sistema_de_punto_flotante.pdf?dl=0">liga</a></p>
<div class="section" id="sistema-de-punto-flotante">
<span id="spf"></span><h2>1.2 Sistema de punto flotante<a class="headerlink" href="#sistema-de-punto-flotante" title="Permalink to this headline">¶</a></h2>
<div class="section" id="representacion-de-los-numeros-en-la-computadora">
<h3>Representación de los números en la computadora<a class="headerlink" href="#representacion-de-los-numeros-en-la-computadora" title="Permalink to this headline">¶</a></h3>
<p>Las computadoras utilizan una determinada cantidad de cifras de un número real para realizar operaciones. Además, utilizan una representación de los números en bases no usadas por las personas para realizar cálculos comunes, ejemplos son la <strong>2, 8 o 16</strong>.  En contraste, la mayoría de las personas utilizamos la base <strong>10</strong> para representar a los números y realizar cálculos.</p>
<p>A continuación se muestran construcciones que se han hecho para representar los números en una computadora.</p>
<div class="section" id="enteros">
<h4>Enteros<a class="headerlink" href="#enteros" title="Permalink to this headline">¶</a></h4>
<p>Tenemos distintos métodos para la representación de los enteros en una computadora, pero uno que es más utilizado es el de “magnitud con signo” en el que se utiliza un bit para el signo del número y los bits restantes para almacenar al número. El primer bit se le da el valor de <span class="math notranslate nohighlight">\(0\)</span> para  codificar al signo <code class="docutils literal notranslate"><span class="pre">+</span></code> y el valor <span class="math notranslate nohighlight">\(1\)</span> codifica al bit <code class="docutils literal notranslate"><span class="pre">-</span></code>. Entonces el número <span class="math notranslate nohighlight">\(-173\)</span> se almacena con la cadena de <span class="math notranslate nohighlight">\(16\)</span> bits:</p>
<table class="colwidths-auto docutils align-default">
<thead>
<tr class="row-odd"><th class="text-align:center head"><p></p></th>
<th class="text-align:center head"><p></p></th>
<th class="text-align:center head"><p></p></th>
<th class="text-align:center head"><p></p></th>
<th class="text-align:center head"><p></p></th>
<th class="text-align:center head"><p></p></th>
<th class="text-align:center head"><p></p></th>
<th class="text-align:center head"><p></p></th>
<th class="text-align:center head"><p></p></th>
<th class="text-align:center head"><p></p></th>
<th class="text-align:center head"><p></p></th>
<th class="text-align:center head"><p></p></th>
<th class="text-align:center head"><p></p></th>
<th class="text-align:center head"><p></p></th>
<th class="text-align:center head"><p></p></th>
<th class="text-align:center head"><p></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:center"><p>1</p></td>
<td class="text-align:center"><p>0</p></td>
<td class="text-align:center"><p>0</p></td>
<td class="text-align:center"><p>0</p></td>
<td class="text-align:center"><p>0</p></td>
<td class="text-align:center"><p>0</p></td>
<td class="text-align:center"><p>0</p></td>
<td class="text-align:center"><p>0</p></td>
<td class="text-align:center"><p>1</p></td>
<td class="text-align:center"><p>0</p></td>
<td class="text-align:center"><p>1</p></td>
<td class="text-align:center"><p>0</p></td>
<td class="text-align:center"><p>1</p></td>
<td class="text-align:center"><p>1</p></td>
<td class="text-align:center"><p>0</p></td>
<td class="text-align:center"><p>1</p></td>
</tr>
</tbody>
</table>
<p>Utilizamos la notación posicional para convertir este número binario a base 10: el primer bit es <span class="math notranslate nohighlight">\(1\)</span> por lo que se tiene un signo negativo. Luego:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{eqnarray}
0*2^{14} + 0*2^{13} + \dots+ 1*2^7+0*2^6+ 1*2^5+0*2^4+1*2^3+1*2^2+0*2^1+1*2^0 &amp;=&amp; \nonumber \\
1*2^7+ 1*2^5+1*2^3+1*2^2+1*2^0 &amp;=&amp; \nonumber \\
173 \nonumber
\end{eqnarray}
\end{split}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//%</span><span class="n">cflags</span><span class="p">:</span><span class="o">-</span><span class="n">lm</span>
<span class="c1">#include&lt;stdio.h&gt;</span>
<span class="c1">#include&lt;math.h&gt;</span>
<span class="nb">int</span> <span class="n">main</span><span class="p">(){</span>
    <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;suma: </span><span class="si">%f</span><span class="s2">&quot;</span><span class="p">,</span><span class="nb">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span><span class="o">+</span><span class="nb">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="o">+</span><span class="nb">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">+</span><span class="nb">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="nb">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">));</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>suma: 173.000000
</pre></div>
</div>
</div>
</div>
<div class="admonition-ejercicio admonition">
<p class="admonition-title">Ejercicio</p>
<p>Determina el rango de enteros de base <span class="math notranslate nohighlight">\(10\)</span> que puede representarse en una computadora de <span class="math notranslate nohighlight">\(16\)</span> bits utilizando el primer bit para el signo</p>
</div>
</div>
<div class="section" id="reales">
<h4>Reales<a class="headerlink" href="#reales" title="Permalink to this headline">¶</a></h4>
<p>Dadas las limitaciones en el almacenamiento de una computadora (hardware), sólo se representa un subconjunto de los números reales en ella, tal conjunto se denota como <span class="math notranslate nohighlight">\(\mathcal{F}\mathcal{l}\)</span> y contiene números racionales:</p>
<div class="math notranslate nohighlight">
\[\mathcal{F}\mathcal{l} \subset \mathbb{Q} \subset \mathbb{R}.\]</div>
<div class="sidebar">
<p class="sidebar-title">Un poco de historia…</p>
<p>En 1985 la IEEE publicó un estándar de nombre <a class="reference external" href="https://standards.ieee.org/standard/754-1985.html">Binary Floating Point Arithmetic Standard 754-1985</a> y ha habido más estándares publicados, siendo el más reciente el <a class="reference external" href="https://standards.ieee.org/standard/754-2019.html">IEEE 754-2019</a>. El estándar <span class="math notranslate nohighlight">\(754-1985\)</span> proveía estándares para números de punto flotante binarios y decimales, formatos para intercambio de datos, algoritmos para operaciones de redondeo y manejo de excepciones. Los formatos se especificaron para precisiones simple, doble y extendida y tales estándares son seguidos por las manufactureras de computadoras que utilizan el hardware de punto flotante:</p>
<p>“…A family of commercially feasible ways for new systems to perform binary floating-point arithmetic is defined. This standard specifies basic and extended floating-point number formats; add, subtract, multiply, divide, square root, remainder, and compare operations; conversions between integer and floating-point formats; conversions between different floating-point formats; conversions between basic-format floating-point numbers and decimal strings; and floating-point exceptions and their handling, including nonnumbers…” (estándar <span class="math notranslate nohighlight">\(754-1985\)</span>)</p>
</div>
</div>
</div>
<div class="section" id="sistema-de-punto-flotante-spf">
<h3>Sistema de punto flotante (SPF)<a class="headerlink" href="#sistema-de-punto-flotante-spf" title="Permalink to this headline">¶</a></h3>
<p>En un sistema de punto flotante se define:</p>
<ol class="simple">
<li><p>Rango de un exponente definido por un límite inferior y uno superior.</p></li>
<li><p>Base del sistema.</p></li>
<li><p>Precisión.</p></li>
</ol>
<p>Así, un número <span class="math notranslate nohighlight">\(x\)</span> en el SPF, <span class="math notranslate nohighlight">\(x \in \mathcal{F}\mathcal{l}\)</span>, se representa de la forma:</p>
<div class="math notranslate nohighlight">
\[\pm 0.d_1d_2 \dots d_k \times \beta^n .\]</div>
<p>donde:</p>
<p><span class="math notranslate nohighlight">\(n\)</span> es el exponente, <span class="math notranslate nohighlight">\(n \in [L,U] \cap \mathbb{Z}\)</span> con <span class="math notranslate nohighlight">\(L, U\)</span> fijos.</p>
<p><span class="math notranslate nohighlight">\(k\)</span> es la precisión.</p>
<p><span class="math notranslate nohighlight">\(\beta\)</span> es la base.</p>
<p><span class="math notranslate nohighlight">\(d_i \in \{0,1,\dots,\beta-1\} \forall i=1,\dots,k\)</span> son los dígitos.</p>
<div class="admonition-definicion admonition">
<p class="admonition-title">Definición</p>
<p>A la parte <span class="math notranslate nohighlight">\(\pm 0.d_1d_2 \dots d_k\)</span> se le llama <strong>mantisa</strong>. A la porción <span class="math notranslate nohighlight">\(d_2 \dots d_k\)</span> se le llama <strong>fracción</strong> <span class="math notranslate nohighlight">\(f\)</span>.</p>
</div>
<p>Los números reales que tienen una representación exacta en el <span class="math notranslate nohighlight">\(\mathcal{F}\mathcal{l}\)</span> se les conoce como <strong>números de máquina</strong>.</p>
<p><strong>Ejemplo:</strong></p>
<p>Supóngase un <span class="math notranslate nohighlight">\(\mathcal{F}\mathcal{l}\)</span> con <span class="math notranslate nohighlight">\(\beta = 10, k=4, n\in[-4,3]\cap \mathbb{Z}\)</span> entonces:</p>
<div class="math notranslate nohighlight">
\[0.3330 \times 10^{-1} , 0.3300 \times 10^{3} \in \mathcal{F}\mathcal{L}\]</div>
<p>pero: <span class="math notranslate nohighlight">\($\frac{1}{3} \notin \mathcal{F}\mathcal{l}\)</span>$</p>
<p>por lo que <span class="math notranslate nohighlight">\(0.333 \times 10^{-1} , 0.3300 \times 10^{3}\)</span> son números de máquina.</p>
</div>
<div class="section" id="spfn">
<h3>SPFN<a class="headerlink" href="#spfn" title="Permalink to this headline">¶</a></h3>
<p>Un Sistema de Punto Flotante Normalizado es aquel que cumple:</p>
<div class="math notranslate nohighlight">
\[d_1 \in \{1,2,\dots \beta -1\}\]</div>
<p>para números distintos de cero.</p>
<div class="tip admonition">
<p class="admonition-title">Observación</p>
<p>El número cero es el único que tiene dígitos de la mantisa y exponente iguales a cero.</p>
</div>
<p><strong>Ejemplos:</strong></p>
<ol class="simple">
<li><p><span class="math notranslate nohighlight">\(\beta = 10, k=3\)</span>, rango del exponente en <span class="math notranslate nohighlight">\([-3,3] \cap \mathbb{Z}\)</span>, entonces algunos números en el SPFN:</p></li>
</ol>
<table class="colwidths-auto docutils align-default">
<thead>
<tr class="row-odd"><th class="text-align:center head"><p>Notación de punto flotante</p></th>
<th class="text-align:center head"><p>Mantisa</p></th>
<th class="text-align:center head"><p>Exponente</p></th>
<th class="text-align:center head"><p>Valor de punto fijo</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:center"><p><span class="math notranslate nohighlight">\(0.153\times10^0\)</span></p></td>
<td class="text-align:center"><p><span class="math notranslate nohighlight">\(0.153\)</span></p></td>
<td class="text-align:center"><p><span class="math notranslate nohighlight">\(0\)</span></p></td>
<td class="text-align:center"><p><span class="math notranslate nohighlight">\(0.153\)</span></p></td>
</tr>
<tr class="row-odd"><td class="text-align:center"><p><span class="math notranslate nohighlight">\(-0.990\times10^2\)</span></p></td>
<td class="text-align:center"><p><span class="math notranslate nohighlight">\(-0.990\)</span></p></td>
<td class="text-align:center"><p><span class="math notranslate nohighlight">\(2\)</span></p></td>
<td class="text-align:center"><p><span class="math notranslate nohighlight">\(-99.0\)</span></p></td>
</tr>
<tr class="row-even"><td class="text-align:center"><p><span class="math notranslate nohighlight">\(0.343\times10^{-3}\)</span></p></td>
<td class="text-align:center"><p><span class="math notranslate nohighlight">\(0.343\)</span></p></td>
<td class="text-align:center"><p><span class="math notranslate nohighlight">\(-3\)</span></p></td>
<td class="text-align:center"><p><span class="math notranslate nohighlight">\(0.000343\)</span></p></td>
</tr>
</tbody>
</table>
<ol class="simple">
<li><p>En un SPFN con <span class="math notranslate nohighlight">\(\beta=2, k=3\)</span>, rango del exponente en <span class="math notranslate nohighlight">\([0,2] \cap \mathbb{Z}\)</span> se tiene:</p></li>
</ol>
<p>a) El número más grande positivo que es posible representar es:</p>
<div class="math notranslate nohighlight">
\[0.111 \times 2^2 = (11.1)_2 = 1*2^1 + 1*2^0 + 1*2^{-1} = (3.5)_{10}.\]</div>
<p>b) El más chico positivo es:</p>
<div class="math notranslate nohighlight">
\[0.100 \times 2^0 = (0.1)_2 = 1*2^{-1} = (0.5)_{10}.\]</div>
<div class="tip admonition">
<p class="admonition-title">Observación 1</p>
<p>Se utiliza <span class="math notranslate nohighlight">\((\cdot)_{10}\)</span> para representar un número en base 10 pero típicamente se omite escribir paréntesis y la base.</p>
</div>
<div class="tip admonition">
<p class="admonition-title">Observación 2</p>
<p>La representación normalizada permite una representación única de los números reales en el <span class="math notranslate nohighlight">\(\mathcal{F}{l}\)</span>:</p>
<p>el número <span class="math notranslate nohighlight">\(0.343 \times 10^{-3}\)</span> como se vio en el ejemplo <span class="math notranslate nohighlight">\(1)\)</span> está en <span class="math notranslate nohighlight">\(\mathcal{F}\mathcal{l}\)</span> pero ni <span class="math notranslate nohighlight">\(0.0343 \times 10^{-2}\)</span> ni <span class="math notranslate nohighlight">\(3.43 \times 10^{-4}\)</span> están en el <span class="math notranslate nohighlight">\(\mathcal{F}\mathcal{l}\)</span>.</p>
</div>
<div class="tip admonition">
<p class="admonition-title">Observación 3</p>
<p>Por la observación 2 en un SPFN con <span class="math notranslate nohighlight">\(\beta=2\)</span> no es necesario almacenar el primer bit pues siempre es <span class="math notranslate nohighlight">\(1\)</span> por lo que sólo se almacenará la parte fraccionaria de la forma <span class="math notranslate nohighlight">\(1.f\)</span> (más sobre esto en la siguiente sección).</p>
</div>
</div>
<div class="section" id="numeros-de-maquina-binarios">
<h3>Números de máquina binarios<a class="headerlink" href="#numeros-de-maquina-binarios" title="Permalink to this headline">¶</a></h3>
<p>Un SPF de doble precisión utiliza:</p>
<ul class="simple">
<li><p>64 bits para representar un número real. El primero es un indicador de signo denotado por <span class="math notranslate nohighlight">\(s\)</span>. Le siguen <span class="math notranslate nohighlight">\(11\)</span> bits para construir al exponente <span class="math notranslate nohighlight">\(n\)</span> y <span class="math notranslate nohighlight">\(52\)</span> bits que construyen a la parte fraccionaria <span class="math notranslate nohighlight">\(f\)</span> de la mantisa. La base es <span class="math notranslate nohighlight">\(\beta=2\)</span>.</p></li>
</ul>
<div class="admonition-nota-1 admonition">
<p class="admonition-title">Nota 1</p>
<p>Si es SPFN entonces aunque se tienen 52 bits, éstos se utilizan para almacenar un dígito más del número (ver observación 3 anterior). Así, en un SPF en general maneja 52 (o 53) dígitos binarios, que corresponden a aproximadamente 15 (o 16) dígitos decimales. Ver: <a class="reference external" href="https://en.wikipedia.org/wiki/Double-precision_floating-point_format#Implementations">Double-precision floating-point format</a>.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//%</span><span class="n">cflags</span><span class="p">:</span><span class="o">-</span><span class="n">lm</span>
<span class="c1">#include&lt;stdio.h&gt;</span>
<span class="c1">#include&lt;math.h&gt;</span>
<span class="nb">int</span> <span class="n">main</span><span class="p">(){</span>
    <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;52 bits corresponden aproximadamente a: </span><span class="si">%f</span><span class="s2"> dígitos decimales</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">log10</span><span class="p">(</span><span class="nb">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">52</span><span class="p">)));</span>
    <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;53 bits corresponden aproximadamente a: </span><span class="si">%f</span><span class="s2"> dígitos decimales</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">log10</span><span class="p">(</span><span class="nb">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">53</span><span class="p">)));</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>52 bits corresponden aproximadamente a: 15.653560 dígitos decimales
53 bits corresponden aproximadamente a: 15.954590 dígitos decimales
</pre></div>
</div>
</div>
</div>
<div class="admonition-nota-2 admonition">
<p class="admonition-title">Nota 2</p>
<p>Los 11 bits que se utilizan para construir al exponente producen un rango de <span class="math notranslate nohighlight">\(0\)</span> a <span class="math notranslate nohighlight">\(2^{11}-1=2047:\)</span></p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//%</span><span class="n">cflags</span><span class="p">:</span><span class="o">-</span><span class="n">lm</span>
<span class="c1">#include&lt;stdio.h&gt;</span>
<span class="c1">#include&lt;math.h&gt;</span>
<span class="nb">int</span> <span class="n">main</span><span class="p">(){</span>
    <span class="nb">int</span> <span class="nb">sum</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="nb">int</span> <span class="n">n</span><span class="o">=</span><span class="mi">10</span><span class="p">;</span>
    <span class="nb">int</span> <span class="n">i</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
        <span class="nb">sum</span><span class="o">+=</span><span class="nb">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">i</span><span class="p">);</span>
    <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;Suma de 2^0 + 2^1 + ... + 2^10: </span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nb">sum</span><span class="p">);</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>Suma de 2^0 + 2^1 + ... + 2^10: 2047
</pre></div>
</div>
</div>
</div>
<div class="admonition-continuacion-nota-2 admonition">
<p class="admonition-title">Continuación Nota 2</p>
<p>pero esto construye un exponente con signo positivo, por lo que se resta (<em>offset</em>) la cantidad de <span class="math notranslate nohighlight">\(-1023\)</span> y se tiene el rango del exponente en <span class="math notranslate nohighlight">\([-1023,1024] \cap \mathbb{Z}\)</span>:</p>
<div class="math notranslate nohighlight">
\[2^{n-1023}.\]</div>
<p>Y un valor de <span class="math notranslate nohighlight">\(n=1023\)</span> representa un exponente de <span class="math notranslate nohighlight">\(0\)</span>.</p>
</div>
<div class="admonition-nota-3 admonition">
<p class="admonition-title">Nota 3</p>
<p>Los valores <span class="math notranslate nohighlight">\(-1023\)</span> (todos los bits iguales a <span class="math notranslate nohighlight">\(0\)</span>) y <span class="math notranslate nohighlight">\(1024\)</span> (todos los bits iguales a <span class="math notranslate nohighlight">\(1\)</span>) para el exponente se reservan para números especiales. Por esto, el exponente corre en el rango de <span class="math notranslate nohighlight">\([-1022, 1023] \cap \mathbb{Z}\)</span>.</p>
</div>
<div class="admonition-nota-4 admonition">
<p class="admonition-title">Nota 4</p>
<p>Todos los bits iguales a 0 para el exponente se utiliza para representar al número 0 con signo (si su fracción <span class="math notranslate nohighlight">\(f\)</span> es <span class="math notranslate nohighlight">\(0\)</span>) y a los números subnormales (si su fracción <span class="math notranslate nohighlight">\(f\)</span> es <span class="math notranslate nohighlight">\(\neq0\)</span>). Todos los bits iguales a 1 se utiliza para representar <span class="math notranslate nohighlight">\(\infty\)</span> (si su fracción <span class="math notranslate nohighlight">\(f\)</span> es <span class="math notranslate nohighlight">\(0\)</span>) y NaNs (si su fracción <span class="math notranslate nohighlight">\(f\)</span> <span class="math notranslate nohighlight">\(\neq 0\)</span>).</p>
</div>
<p>Entonces un número de máquina binario en un SPFN se representa por:</p>
<div class="math notranslate nohighlight">
\[(-1)^s2^{n-1023}(1+f)\]</div>
<p>Y los subnormales como:</p>
<div class="math notranslate nohighlight">
\[(-1)^s2^{1-1023}(0+f)=(-1)^s2^{-1022}f.\]</div>
<div class="tip admonition">
<p class="admonition-title">Observación</p>
<p>Los números subnormales son todos aquellos números con magnitud menor al número más chico positivo normalizado. Con estos números se sacrifica precisión por representatividad alrededor del <span class="math notranslate nohighlight">\(0\)</span>. Para representar a estos números <span class="math notranslate nohighlight">\(d_1\)</span> no es igual a <span class="math notranslate nohighlight">\(1\)</span>.</p>
</div>
<div class="tip admonition">
<p class="admonition-title">Observación</p>
<p>Hay dos representaciones para el <span class="math notranslate nohighlight">\(0\)</span>, una con signo positivo (<span class="math notranslate nohighlight">\(s=0, n=0, f=0\)</span>) y otra con signo negativo (<span class="math notranslate nohighlight">\(s=1,n=0,f=0\)</span>).</p>
</div>
<p><strong>Ejemplos:</strong></p>
<ol class="simple">
<li><p>El valor del exponente más chico para los números normales es: <span class="math notranslate nohighlight">\(2^{1-1023} = 2^{-1022}\)</span>.</p></li>
<li><p>El valor del exponente más grande es: <span class="math notranslate nohighlight">\(2^{2046-1023} = 2^{1023}\)</span>.</p></li>
</ol>
<ol class="simple">
<li><p>Considérese el número formado por:</p></li>
</ol>
<p>primer bit: <span class="math notranslate nohighlight">\(0\)</span>.</p>
<p>bits del exponente: <span class="math notranslate nohighlight">\(10000000011\)</span>.</p>
<p>bits de la mantisa: <span class="math notranslate nohighlight">\(1011100100010\dots0\)</span>.</p>
<p>Entonces:</p>
<ol class="simple">
<li><p>El número es positivo pues <span class="math notranslate nohighlight">\(s=0\)</span>: <span class="math notranslate nohighlight">\((-1)^s = 1\)</span>.</p></li>
<li><p>Los bits del exponente generan al número decimal:</p></li>
</ol>
<div class="math notranslate nohighlight">
\[n = 1*2^{10} + 0*2^9+\dots+0*2^2+1*2^1+1*2^0=1024+2+1=1027\]</div>
<p>por lo que el exponente es <span class="math notranslate nohighlight">\(4\)</span>: <span class="math notranslate nohighlight">\(2^{1027-1023}=2^4\)</span>.</p>
<ol class="simple">
<li><p>Los bits de la mantisa generan al número decimal:</p></li>
</ol>
<div class="math notranslate nohighlight">
\[1*2^{-1} + 1*2^{-3}+1*2^{-4}+1*2^{-5}+1*2^{-8} + 1*2^{-12} = 0.7229.\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//%</span><span class="n">cflags</span><span class="p">:</span><span class="o">-</span><span class="n">lm</span>
<span class="c1">#include&lt;stdio.h&gt;</span>
<span class="c1">#include&lt;math.h&gt;</span>
<span class="nb">int</span> <span class="n">main</span><span class="p">(){</span>
    <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;Suma de 2^-1 + 2^-3 + 2^-4+2^-5+2^-8+2^-12: </span><span class="si">%f</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nb">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="nb">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span><span class="o">+</span><span class="nb">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">4</span><span class="p">)</span><span class="o">+</span><span class="nb">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span><span class="o">+</span><span class="nb">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">8</span><span class="p">)</span><span class="o">+</span><span class="nb">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">12</span><span class="p">));</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>Suma de 2^-1 + 2^-3 + 2^-4+2^-5+2^-8+2^-12: 0.722900
</pre></div>
</div>
</div>
</div>
<p>Entonces el número de máquina binario <span class="math notranslate nohighlight">\(0\)</span> <span class="math notranslate nohighlight">\(10000000011\)</span> <span class="math notranslate nohighlight">\(1011100100010\dots0\)</span> es el número decimal:</p>
<div class="math notranslate nohighlight">
\[(-1)^s2^{n-1023}(1+f)=(-1)^{0}2^{4}(1+0.7229) =27.5664 \]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//%</span><span class="n">cflags</span><span class="p">:</span><span class="o">-</span><span class="n">lm</span>
<span class="c1">#include&lt;stdio.h&gt;</span>
<span class="c1">#include&lt;math.h&gt;</span>
<span class="nb">int</span> <span class="n">main</span><span class="p">(){</span>
    <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;2^4(1.7229): </span><span class="si">%f</span><span class="s2">&quot;</span><span class="p">,</span><span class="nb">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="mf">1.7229</span><span class="p">);</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>2^4(1.7229): 27.566400
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="valores-interesantes-en-un-spfn-de-doble-precision">
<h3>Valores interesantes en un SPFN de doble precisión<a class="headerlink" href="#valores-interesantes-en-un-spfn-de-doble-precision" title="Permalink to this headline">¶</a></h3>
<p>El número de máquina más grande positivo normalizado es:</p>
<div class="math notranslate nohighlight">
\[2^{1023}(1+(2^{-1}+\dots+2^{-52}))=2^{1023}(1+(1-2^{-52})) = 2^{1023}(2-2^{-52}) \approx 1.7977 \times 10^{308}.\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#include&lt;stdio.h&gt;</span>
<span class="c1">#include&lt;float.h&gt;</span>
<span class="nb">int</span> <span class="n">main</span><span class="p">(){</span>
    <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;Numéro más grande positivo: </span><span class="si">%e</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">DBL_MAX</span><span class="p">);</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>Numéro más grande positivo: 1.797693e+308
</pre></div>
</div>
</div>
</div>
<p>Números que rebasen este límite superior resultan en un <strong>overflow</strong>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//%</span><span class="n">cflags</span><span class="p">:</span><span class="o">-</span><span class="n">lm</span>
<span class="c1">#include&lt;stdio.h&gt;</span>
<span class="c1">#include&lt;float.h&gt;</span>
<span class="c1">#include&lt;math.h&gt;</span>
<span class="nb">int</span> <span class="n">main</span><span class="p">(){</span>
    <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;overflow: </span><span class="si">%e</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">DBL_MAX</span> <span class="o">+</span> <span class="mf">0.0000000000000001</span><span class="o">*</span><span class="nb">pow</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">308</span><span class="p">));</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>overflow: inf
</pre></div>
</div>
</div>
</div>
<div class="admonition-ejercicio admonition">
<p class="admonition-title">Ejercicio</p>
<p>Da más ejemplos de ejecuciones como la anterior que resulten en overflow.</p>
</div>
<p>El número de máquina <strong>normalizado</strong> más pequeño positivo es:</p>
<div class="math notranslate nohighlight">
\[2^{-1022}(1+0) \approx 2.2251 \times 10^{-308}.\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#include&lt;stdio.h&gt;</span>
<span class="c1">#include&lt;float.h&gt;</span>
<span class="nb">int</span> <span class="n">main</span><span class="p">(){</span>
    <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;Numéro normalizado más chico positivo: </span><span class="si">%e</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">DBL_MIN</span><span class="p">);</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>Numéro normalizado más chico positivo: 2.225074e-308
</pre></div>
</div>
</div>
</div>
<p>El número de máquina no normalizado o <strong>subnormalizado</strong> más chico positivo es del orden de</p>
<div class="math notranslate nohighlight">
\[2^{-1022}(2^{-52})=2^{-1074} \approx 10^{-324}.\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//%</span><span class="n">cflags</span><span class="p">:</span><span class="o">-</span><span class="n">lm</span>
<span class="c1">#include&lt;stdio.h&gt;</span>
<span class="c1">#include&lt;float.h&gt;</span>
<span class="c1">#include&lt;math.h&gt;</span>
<span class="nb">int</span> <span class="n">main</span><span class="p">(){</span>
    <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;Numéro más chico positivo: </span><span class="si">%e</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nb">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">52</span><span class="p">)</span><span class="o">*</span><span class="n">DBL_MIN</span><span class="p">);</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>Numéro más chico positivo: 4.940656e-324
</pre></div>
</div>
</div>
</div>
<p>Números con magnitud más chica que el valor anterior resultan en un <strong>underflow</strong>:</p>
<div class="admonition-ejercicio admonition">
<p class="admonition-title">Ejercicio</p>
<p>Da más ejemplos de ejecuciones como la anterior que resulten en underflow.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//%</span><span class="n">cflags</span><span class="p">:</span><span class="o">-</span><span class="n">lm</span>
<span class="c1">#include&lt;stdio.h&gt;</span>
<span class="c1">#include&lt;float.h&gt;</span>
<span class="c1">#include&lt;math.h&gt;</span>
<span class="nb">int</span> <span class="n">main</span><span class="p">(){</span>
    <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;Underflow: </span><span class="si">%e</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,(</span><span class="mi">1</span><span class="o">-.</span><span class="mi">5</span><span class="p">)</span><span class="o">*</span><span class="nb">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">52</span><span class="p">)</span><span class="o">*</span><span class="n">DBL_MIN</span><span class="p">);</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>Underflow: 0.000000e+00
</pre></div>
</div>
</div>
</div>
<p><strong>Epsilon de la máquina <span class="math notranslate nohighlight">\(\epsilon_{maq}\)</span></strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//%</span><span class="n">cflags</span><span class="p">:</span><span class="o">-</span><span class="n">lm</span>
<span class="c1">#include&lt;stdio.h&gt;</span>
<span class="c1">#include&lt;float.h&gt;</span>
<span class="c1">#include&lt;math.h&gt;</span>
<span class="nb">int</span> <span class="n">main</span><span class="p">(){</span>
    <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;Epsilon de la máquina equivale aproximadamente a 2^(-53): </span><span class="si">%e</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">DBL_EPSILON</span><span class="o">/</span><span class="mi">2</span><span class="p">);</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>Epsilon de la máquina equivale aproximadamente a 2^(-53): 1.110223e-16
</pre></div>
</div>
</div>
</div>
<p>El valor anterior representa el máximo error relativo en la representación de un número real en su número de máquina. Como se observa en la ejecución anterior <span class="math notranslate nohighlight">\(\epsilon_{maq} \approx 2^{-53} \approx 1.11 \times 10 ^{-16}\)</span> por lo que tenemos alrededor de <span class="math notranslate nohighlight">\(15\)</span> o <span class="math notranslate nohighlight">\(16\)</span> dígitos de precisión para un número real en el SPFN de doble precisión.</p>
<div class="admonition-definicion admonition">
<p class="admonition-title">Definición</p>
<p>Si <code class="docutils literal notranslate"><span class="pre">aprox</span></code> es mi cantidad con la que aproximo a mi objetivo <code class="docutils literal notranslate"><span class="pre">obj</span></code> entonces el error absoluto de <code class="docutils literal notranslate"><span class="pre">aprox</span></code> y el error relativo de <code class="docutils literal notranslate"><span class="pre">aprox</span></code> es:</p>
<div class="math notranslate nohighlight">
\[ErrAbs(aprox) = |aprox - obj|.\]</div>
<div class="math notranslate nohighlight">
\[ErrRel(aprox) = \frac{ErrAbs(aprox)}{|obj|}.\]</div>
<p>Si <span class="math notranslate nohighlight">\(ErrRel(aprox) \approx 10^{-k}\)</span> se dice que <code class="docutils literal notranslate"><span class="pre">aprox</span></code> aproxima a <code class="docutils literal notranslate"><span class="pre">obj</span></code> con alrededor de <span class="math notranslate nohighlight">\(k\)</span> dígitos correctos.</p>
</div>
<div class="tip admonition">
<p class="admonition-title">Observación</p>
<p>Otras definiciones para <span class="math notranslate nohighlight">\(\epsilon_{maq}\)</span> son:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\epsilon_{maq}\)</span> es el número más chico positivo tal que: <span class="math notranslate nohighlight">\(1 + \epsilon_{maq} \neq 1\)</span> a precisión de la máquina.</p></li>
<li><p><span class="math notranslate nohighlight">\(\epsilon_{maq}\)</span> es la distancia del número <span class="math notranslate nohighlight">\(1\)</span> al siguiente número de máquina.</p></li>
</ul>
<p>Aunque las tres definiciones pueden diferir ligeramente, las tres pretenden dar la medida de granularidad de un SPF. Una representación gráfica para números positivos de un SPF es la siguiente:</p>
<img src="https://dl.dropboxusercontent.com/s/bkxfiqni0f8izhi/SPFN_graficamente.png?dl=0" heigth="500" width="500">
</div>
<p>Se tienen las siguientes afirmaciones:</p>
<ul class="simple">
<li><p>El intervalo <span class="math notranslate nohighlight">\([1,2]\)</span> en un SPFN de doble precisión está formado por la secuencia de números de máquina: <span class="math notranslate nohighlight">\(1, 1+ 2^{-52}, 1 + 2\times 2^{-52}, 1+ 3\times2^{-52}, \dots, 2\)</span>.</p></li>
<li><p>El intervalo <span class="math notranslate nohighlight">\([2,4]\)</span> en tal sistema está formado por: <span class="math notranslate nohighlight">\(2, 2+ 2^{-51}, 2 + 2\times 2^{-51}, 2+ 3\times2^{-51}, \dots, 4\)</span>.</p></li>
</ul>
<p>Por lo que el intervalo <span class="math notranslate nohighlight">\([2^j, 2^{j+1}]\)</span> se obtiene multiplicando <span class="math notranslate nohighlight">\(2^j\)</span> veces la secuencia en <span class="math notranslate nohighlight">\([1,2]\)</span> y los huecos entre un número de máquina y otro número de máquina no son en términos relativos más grandes que <span class="math notranslate nohighlight">\(2^{-52} \approx 2.22 \times 10^{-16}\)</span>.</p>
<p>Asimismo, el intervalo <span class="math notranslate nohighlight">\([\frac{1}{2}, 1]\)</span> en tal sistema está formado por: <span class="math notranslate nohighlight">\(\frac{1}{2}, \frac{1}{2}+2^{-53},\frac{1}{2}+2\times2^{-53},\frac{1}{2}+3\times2^{-53},\dots , 1\)</span>.</p>
<p>Entonces el espaciado entre cada número de máquina en el intervalo <span class="math notranslate nohighlight">\([2^j, 2^{j+1}]\)</span> siempre es menor o igual a <span class="math notranslate nohighlight">\(2^{-53} = \epsilon_{maq}\)</span>.</p>
<p>Una forma computacional de obtener al <span class="math notranslate nohighlight">\(\epsilon_{maq}\)</span> de forma sencilla es con el cálculo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#include&lt;stdio.h&gt;</span>
<span class="c1">#include&lt;float.h&gt;</span>
<span class="nb">int</span> <span class="n">main</span><span class="p">(){</span>
    <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;Epsilon de la máquina: </span><span class="si">%e</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="o">-</span><span class="mf">3.0</span><span class="o">*</span><span class="p">(</span><span class="mi">4</span><span class="o">/</span><span class="mf">3.0</span><span class="o">-</span><span class="mi">1</span><span class="p">));</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>Epsilon de la máquina: 2.220446e-16
</pre></div>
</div>
</div>
</div>
<div class="admonition-pregunta admonition">
<p class="admonition-title">Pregunta</p>
<p>¿Por qué funciona esto? tip: imprímase el cálculo <span class="math notranslate nohighlight">\(3.0*(4/3.0-1)\)</span> con el especificador de formato de la función <code class="docutils literal notranslate"><span class="pre">printf</span></code> <code class="docutils literal notranslate"><span class="pre">%.16f</span></code> o bien <code class="docutils literal notranslate"><span class="pre">%.15e</span></code>.</p>
</div>
</div>
<div class="section" id="reglas-de-corte-y-redondeo">
<h3>Reglas de corte y redondeo<a class="headerlink" href="#reglas-de-corte-y-redondeo" title="Permalink to this headline">¶</a></h3>
<p>Al ver el diagrama anterior de la representación gráfica de un SPF se observa que existen huecos entre cada número de máquina. Lo anterior implica que al ingresar un número real <span class="math notranslate nohighlight">\(x\)</span> en la computadora, ésta realiza una aproximación a <span class="math notranslate nohighlight">\(x\)</span> que se encuentre en el SPF. Esta aproximación genera errores conocidos con el nombre de <strong>errores por redondeo</strong>.</p>
<p>Entre las reglas que una computadora realiza para dar las aproximaciones a un número <span class="math notranslate nohighlight">\(x \in \mathbb{R}\)</span> están: la regla de corte y la de redondeo y se pueden representar con funciones matemáticas:</p>
<p><strong>Regla de corte:</strong> sea <span class="math notranslate nohighlight">\(fl_c : \mathbb{R} \rightarrow \mathcal{F}\mathcal{l}\)</span> una función cuya regla de correspondencia es: <span class="math notranslate nohighlight">\(x \in \mathbb{R}\)</span> con <span class="math notranslate nohighlight">\(x\)</span> en el rango de valores del SPF, entonces: <span class="math notranslate nohighlight">\(x = \pm 0.d_1d_2 \dots d_kd_{k+1}\dots \times \beta^n\)</span> y la regla de corte a <span class="math notranslate nohighlight">\(k\)</span> dígitos es: <span class="math notranslate nohighlight">\(fl_c(x) = \pm 0.d_1d_2 \dots d_k\)</span>.</p>
<p><strong>Regla de redondeo:</strong> sean <span class="math notranslate nohighlight">\(\beta=10\)</span> y <span class="math notranslate nohighlight">\(fl_r : \mathbb{R} \rightarrow \mathcal{F}\mathcal{l}\)</span> una función cuya regla de correspondencia es: <span class="math notranslate nohighlight">\(x \in \mathbb{R}\)</span> con <span class="math notranslate nohighlight">\(x\)</span> en el rango de valores del SPF, entonces: <span class="math notranslate nohighlight">\(x = \pm 0.d_1d_2 \dots d_kd_{k+1}\dots \times \beta^n\)</span> y la regla de redondeo es:</p>
<div class="math notranslate nohighlight">
\[\begin{split}f_r(x) = \begin{cases}
\text{sumar uno a } d_k &amp; \text{si } d_{k+1} \geq 5,\\
f_c(x) &amp; \text{en otro caso}
\end{cases}\end{split}\]</div>
<div class="tip admonition">
<p class="admonition-title">Observación</p>
<p>También la regla <span class="math notranslate nohighlight">\(fl_r(\cdot)\)</span> se define como antes pero se añade la restricción entre si es par o impar el último dígito en caso de empate, entonces se almacena el par</p>
</div>
<p><strong>Ejemplos:</strong></p>
<ol class="simple">
<li></li>
</ol>
<p><span class="math notranslate nohighlight">\(\pi=3.141592\dots = 0.3141592\dots \times 10^1\)</span>. Si un SPFN usa <span class="math notranslate nohighlight">\(k=5\)</span> entonces:</p>
<div class="math notranslate nohighlight">
\[fl_c(\pi) = 0.31415.\]</div>
<div class="math notranslate nohighlight">
\[fl_r(\pi) = 0.31416.\]</div>
<ol class="simple">
<li><p>Supóngase que <span class="math notranslate nohighlight">\(fl_r(\cdot)\)</span> hace diferencia entre el último dígito almacenado es par e impar. Entonces para <span class="math notranslate nohighlight">\(k=2\)</span>:</p></li>
</ol>
<table class="colwidths-auto docutils align-default">
<thead>
<tr class="row-odd"><th class="text-align:center head"><p>Número: x</p></th>
<th class="text-align:center head"><p>Corte: <span class="math notranslate nohighlight">\(fl_c(x)\)</span></p></th>
<th class="text-align:center head"><p>Redondeo: <span class="math notranslate nohighlight">\(fl_r(x)\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:center"><p>0.1649</p></td>
<td class="text-align:center"><p>0.16</p></td>
<td class="text-align:center"><p>0.16</p></td>
</tr>
<tr class="row-odd"><td class="text-align:center"><p>0.1650</p></td>
<td class="text-align:center"><p>0.16</p></td>
<td class="text-align:center"><p>0.16</p></td>
</tr>
<tr class="row-even"><td class="text-align:center"><p>0.1651</p></td>
<td class="text-align:center"><p>0.16</p></td>
<td class="text-align:center"><p>0.17</p></td>
</tr>
<tr class="row-odd"><td class="text-align:center"><p>0.1749</p></td>
<td class="text-align:center"><p>0.17</p></td>
<td class="text-align:center"><p>0.17</p></td>
</tr>
<tr class="row-even"><td class="text-align:center"><p>0.1750</p></td>
<td class="text-align:center"><p>0.17</p></td>
<td class="text-align:center"><p>0.18</p></td>
</tr>
<tr class="row-odd"><td class="text-align:center"><p>0.1751</p></td>
<td class="text-align:center"><p>0.17</p></td>
<td class="text-align:center"><p>0.18</p></td>
</tr>
</tbody>
</table>
<p>Por los ejemplos anteriores se puede comprobar que la regla de redondeo tiene más exactitud que la de corte:</p>
<img src="https://dl.dropboxusercontent.com/s/e8iqxqelkxj1y8r/regla_corte_redondeo.png?dl=0" heigth="500" width="500"><div class="admonition-definicion admonition">
<p class="admonition-title">Definición</p>
<p>Otra expresión utilizada para la regla <span class="math notranslate nohighlight">\(fl(\cdot)\)</span> es a partir de la definición de error relativo: <span class="math notranslate nohighlight">\(aprox = obj(1+ErrRel(aprox))\)</span> (si <span class="math notranslate nohighlight">\(aprox \geq obj\)</span> y <span class="math notranslate nohighlight">\(obj &gt; 0\)</span>):</p>
<div class="math notranslate nohighlight">
\[\forall{x}\in \mathbb{R} \exists \epsilon \in \mathbb{R} \text{ con } |\epsilon| \leq \epsilon_{maq} \text{ tal que: }.\]</div>
<div class="math notranslate nohighlight">
\[fl(x) = x(1+\epsilon), |\epsilon| \leq \epsilon_{maq}.\]</div>
<p>cuya interpretación es: la diferencia entre <span class="math notranslate nohighlight">\(x\)</span> con <span class="math notranslate nohighlight">\(fl(x)\)</span> es un término (en magnitud) de a lo más <span class="math notranslate nohighlight">\(\epsilon_{maq}\)</span> relativo a <span class="math notranslate nohighlight">\(|x|\)</span>.</p>
</div>
<div class="admonition-nota admonition">
<p class="admonition-title">Nota</p>
<p>Un resultado que se puede verificar es:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\epsilon_{maq} = \begin{cases}
\beta^{1-k} &amp;\text{ si se utiliza regla de corte},\\
\frac{1}{2}\beta^{1-k} &amp;\text{ si se utiliza la regla de redondeo}
\end{cases}\end{split}\]</div>
</div>
<p><strong>Ejemplo:</strong></p>
<p>Considérese un SPFN con <span class="math notranslate nohighlight">\(\beta=2, k=3\)</span> entonces si se utiliza la regla de corte:</p>
<div class="math notranslate nohighlight">
\[\epsilon_{maq} = \beta^{1-k} = \beta^{-2}=2^{-2}=0.25.\]</div>
<p>si se utiliza la regla de redondeo:</p>
<div class="math notranslate nohighlight">
\[\epsilon_{maq} = \frac{1}{2}\beta^{1-k} = \frac{1}{2}\beta^{-2}=\frac{1}{2}2^{-2}=0.125.\]</div>
</div>
<div class="section" id="aritmetica-de-maquina">
<h3>Aritmética de máquina.<a class="headerlink" href="#aritmetica-de-maquina" title="Permalink to this headline">¶</a></h3>
<p>Además de representar números reales en la máquina otro objetivo es el de realizar operaciones entre ellos. Si la representación de números tiene un error asociado (error por redondeo) entonces es natural pensar que las operaciones aritméticas también tendrán errores por redondeo. Las razones de los errores son nuevamente el uso de precisión finita y la conversión entre bases: al ingresar números a la computadora se convierte a base <span class="math notranslate nohighlight">\(2\)</span> (por ejemplo), se realizan operaciones y el resultado se presenta en base <span class="math notranslate nohighlight">\(10\)</span>.</p>
<p>Para analizar los errores por redondeo que se presentan en la aritmética de máquina es suficiente considerar la base <span class="math notranslate nohighlight">\(10\)</span>, no conversiones entre bases (por ejemplo de la base <span class="math notranslate nohighlight">\(2\)</span> a la base <span class="math notranslate nohighlight">\(10\)</span>)) y utilizar los siguientes operadores y suposiciones:</p>
<p>Supongamos que se tiene un SPFN y <span class="math notranslate nohighlight">\(fl(\cdot)\)</span> regla de corte o redondeo a una precisión <span class="math notranslate nohighlight">\(k\)</span> dada. Sean <span class="math notranslate nohighlight">\(a,b \in \mathbb{R}\)</span>, se definen los siguientes operadores en el SPFN:</p>
<div class="math notranslate nohighlight">
\[\oplus: \mathbb{R}^2 \rightarrow \mathcal{F}\mathcal{l} \quad a \oplus b = fl(fl(a) + fl(b)).\]</div>
<div class="math notranslate nohighlight">
\[\ominus: \mathbb{R}^2 \rightarrow \mathcal{F}\mathcal{l} \quad a \ominus b = fl(fl(a) - fl(b)).\]</div>
<div class="math notranslate nohighlight">
\[\otimes: \mathbb{R}^2 \rightarrow \mathcal{F}\mathcal{l} \quad a \otimes b = fl(fl(a) \cdot fl(b)).\]</div>
<div class="math notranslate nohighlight">
\[\oslash: \mathbb{R}^2 \rightarrow \mathcal{F}\mathcal{l} \quad a \oslash b = fl(fl(a) \div fl(b)).\]</div>
<div class="admonition-ejercicio admonition">
<p class="admonition-title">Ejercicio</p>
<p>Considérese <span class="math notranslate nohighlight">\(x = \frac{5}{7} \approx \overline{0.714285}\)</span>, <span class="math notranslate nohighlight">\(y=\frac{1}{3} = \overline{.3}\)</span>, <span class="math notranslate nohighlight">\(u=0.714251, v=98765.9, w=0.111111 \times 10^{-4}\)</span> y un SPFN con <span class="math notranslate nohighlight">\(\beta=10, k=5\)</span>. Entonces llenar la siguiente tabla de acuerdo a las instrucciones:</p>
<ol class="simple">
<li><p>En la columna “Aritmética de máquina con k=8” se realiza aritmética a <span class="math notranslate nohighlight">\(8\)</span> dígitos con las operaciones definidas previamente <span class="math notranslate nohighlight">\(\oplus, \ominus, \otimes, \oslash\)</span> con la regla de corte <span class="math notranslate nohighlight">\(fl_c(\cdot)\)</span>.</p></li>
<li><p>En la columna “Aritmética de máquina con k=5” se realiza aritmética a <span class="math notranslate nohighlight">\(5\)</span> dígitos con las operaciones definidas previamente <span class="math notranslate nohighlight">\(\oplus, \ominus, \otimes, \oslash\)</span> con la regla de corte <span class="math notranslate nohighlight">\(fl_c(\cdot)\)</span>.</p></li>
<li><p>Para el cálculo de errores absoluto y relativo tomar como valor real u objetivo el valor a <span class="math notranslate nohighlight">\(8\)</span> dígitos.</p></li>
</ol>
</div>
<table class="colwidths-auto docutils align-default">
<thead>
<tr class="row-odd"><th class="text-align:center head"><p>Operación</p></th>
<th class="text-align:center head"><p>Aritmética de máquina con k=8</p></th>
<th class="text-align:center head"><p>Aritmética de máquina con k=5</p></th>
<th class="text-align:center head"><p>Error Absoluto de aprox</p></th>
<th class="text-align:center head"><p>Error Relativo de aprox</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:center"><p>x <span class="math notranslate nohighlight">\(\oplus\)</span>y</p></td>
<td class="text-align:center"><p></p></td>
<td class="text-align:center"><p></p></td>
<td class="text-align:center"><p></p></td>
<td class="text-align:center"><p></p></td>
</tr>
<tr class="row-odd"><td class="text-align:center"><p>x<span class="math notranslate nohighlight">\(\ominus\)</span>y</p></td>
<td class="text-align:center"><p></p></td>
<td class="text-align:center"><p></p></td>
<td class="text-align:center"><p></p></td>
<td class="text-align:center"><p></p></td>
</tr>
<tr class="row-even"><td class="text-align:center"><p>x<span class="math notranslate nohighlight">\(\otimes\)</span>y</p></td>
<td class="text-align:center"><p></p></td>
<td class="text-align:center"><p></p></td>
<td class="text-align:center"><p></p></td>
<td class="text-align:center"><p></p></td>
</tr>
<tr class="row-odd"><td class="text-align:center"><p>x<span class="math notranslate nohighlight">\(\oslash\)</span>y</p></td>
<td class="text-align:center"><p></p></td>
<td class="text-align:center"><p></p></td>
<td class="text-align:center"><p></p></td>
<td class="text-align:center"><p></p></td>
</tr>
<tr class="row-even"><td class="text-align:center"><p>x<span class="math notranslate nohighlight">\(\ominus\)</span>u</p></td>
<td class="text-align:center"><p></p></td>
<td class="text-align:center"><p></p></td>
<td class="text-align:center"><p></p></td>
<td class="text-align:center"><p></p></td>
</tr>
<tr class="row-odd"><td class="text-align:center"><p>(x<span class="math notranslate nohighlight">\(\ominus\)</span>u)<span class="math notranslate nohighlight">\(\oslash\)</span>w</p></td>
<td class="text-align:center"><p></p></td>
<td class="text-align:center"><p></p></td>
<td class="text-align:center"><p></p></td>
<td class="text-align:center"><p></p></td>
</tr>
<tr class="row-even"><td class="text-align:center"><p>(x<span class="math notranslate nohighlight">\(\ominus\)</span>u)<span class="math notranslate nohighlight">\(\otimes\)</span> v</p></td>
<td class="text-align:center"><p></p></td>
<td class="text-align:center"><p></p></td>
<td class="text-align:center"><p></p></td>
<td class="text-align:center"><p></p></td>
</tr>
<tr class="row-odd"><td class="text-align:center"><p>u<span class="math notranslate nohighlight">\(\oplus\)</span>v</p></td>
<td class="text-align:center"><p></p></td>
<td class="text-align:center"><p></p></td>
<td class="text-align:center"><p></p></td>
<td class="text-align:center"><p></p></td>
</tr>
</tbody>
</table>
<p><strong>Ejemplo:</strong></p>
<p>El resultado del primer renglón con aritmética exacta es:</p>
<div class="math notranslate nohighlight">
\[x+y = \frac{5}{7} + \frac{1}{3} = \frac{22}{21} \approx 0.10476190.\]</div>
<p>Para el llenado de las columnas:</p>
<ol class="simple">
<li><p>Aritmética de máquina a <span class="math notranslate nohighlight">\(8\)</span> dígitos usamos <span class="math notranslate nohighlight">\(k=8\)</span>: <span class="math notranslate nohighlight">\(x \oplus_8 y = fl_c(0.71428571 + 0.33333333) = 0.10476190 \times 10^1\)</span>.</p></li>
<li><p>Aritmética de máquina usamos <span class="math notranslate nohighlight">\(k=5\)</span>: <span class="math notranslate nohighlight">\(x \oplus_5 y = fl_c(fl_c(x)+fl_c(y)) = fl_c(0.71428 + 0.33333) = fl_c(0.104761\times10^1) = 0.10476 \times10^1\)</span>.</p></li>
<li><p>Error absoluto de aprox: <span class="math notranslate nohighlight">\(ErrAbs(x \oplus_5 y) =  |(x \oplus_8) y - (x \oplus_5)| = |0.10476190 \times 10^1 - 0.10476 \times10^1| = |0.00000190| = .190 \times 10^{-5}\)</span>.</p></li>
<li><p>Error relativo de aprox: <span class="math notranslate nohighlight">\(ErrRel(x \oplus_5 y) = \frac{ErrAbs(x \oplus_5 y)}{|x \oplus_8|} =\frac{.190 \times 10^{-5}}{0.10476190 \times 10^1} \approx 1.81 \times 10^{-6} = 0.181 \times 10^{-5}\)</span>.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//%</span><span class="n">cflags</span><span class="p">:</span><span class="o">-</span><span class="n">lm</span>
<span class="c1">#include&lt;stdio.h&gt;</span>
<span class="c1">#include&lt;stdlib.h&gt;</span>
<span class="c1">#include&lt;math.h&gt;</span>

<span class="n">double</span> <span class="n">fl_c_k</span><span class="p">(</span><span class="n">double</span> <span class="n">a</span><span class="p">,</span> <span class="nb">int</span> <span class="n">k</span><span class="p">){</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">double</span><span class="p">)((</span><span class="nb">int</span><span class="p">)(</span><span class="nb">pow</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="nb">pow</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="o">-</span><span class="n">k</span><span class="p">));</span>
<span class="p">}</span>

<span class="n">double</span> <span class="n">err_abs</span><span class="p">(</span><span class="n">double</span> <span class="n">aprox</span><span class="p">,</span> <span class="n">double</span> <span class="n">obj</span><span class="p">){</span>   
    <span class="k">return</span> <span class="n">fabs</span><span class="p">(</span><span class="n">obj</span><span class="o">-</span><span class="n">aprox</span><span class="p">);</span>
<span class="p">}</span>

<span class="n">double</span> <span class="n">err_rel</span><span class="p">(</span><span class="n">double</span> <span class="n">errabs</span><span class="p">,</span> <span class="n">double</span> <span class="n">obj</span><span class="p">){</span>
    <span class="k">return</span> <span class="n">errabs</span><span class="o">/</span><span class="n">fabs</span><span class="p">(</span><span class="n">obj</span><span class="p">);</span>
<span class="p">}</span>

<span class="nb">int</span> <span class="n">main</span><span class="p">(){</span>
    <span class="n">double</span> <span class="n">x</span> <span class="o">=</span> <span class="mi">5</span><span class="o">/</span><span class="mf">7.0</span><span class="p">;</span>
    <span class="n">double</span> <span class="n">y</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mf">3.0</span><span class="p">;</span>
    <span class="n">double</span> <span class="n">res1</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
    <span class="n">double</span> <span class="n">res2</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
    <span class="nb">int</span> <span class="n">k</span><span class="p">;</span>

    <span class="n">k</span><span class="o">=</span><span class="mi">8</span><span class="p">;</span> <span class="o">//</span><span class="n">precisión</span> <span class="mi">8</span>
    <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;valor x a 8 dígitos: </span><span class="si">%0.7e</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">fl_c_k</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">k</span><span class="p">));</span>
    <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;valor y a 8 dígitos: </span><span class="si">%0.7e</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">fl_c_k</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">k</span><span class="p">));</span>
    <span class="n">res1</span> <span class="o">=</span> <span class="n">fl_c_k</span><span class="p">(</span><span class="n">fl_c_k</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="n">fl_c_k</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">k</span><span class="p">),</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span> <span class="o">//</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span> <span class="n">para</span> <span class="n">seguir</span> <span class="n">manteniendo</span> <span class="mi">5</span> <span class="n">dígitos</span> <span class="n">pues</span> <span class="n">la</span> <span class="n">suma</span> <span class="n">aumenta</span> <span class="n">un</span> <span class="n">dígito</span>
    <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;x+y a 8 dígitos </span><span class="si">%0.7e</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">res1</span><span class="p">);</span>
    
    <span class="n">k</span><span class="o">=</span><span class="mi">5</span><span class="p">;</span> <span class="o">//</span><span class="n">precisión</span> <span class="mi">5</span>
    <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;valor x a 5 dígitos: </span><span class="si">%0.4e</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">fl_c_k</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">k</span><span class="p">));</span>
    <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;valor y a 5 dígitos: </span><span class="si">%0.4e</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">fl_c_k</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">k</span><span class="p">));</span>
    <span class="n">res2</span> <span class="o">=</span> <span class="n">fl_c_k</span><span class="p">(</span><span class="n">fl_c_k</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="n">fl_c_k</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">k</span><span class="p">),</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span> <span class="o">//</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span> <span class="n">para</span> <span class="n">seguir</span> <span class="n">manteniendo</span> <span class="mi">5</span> <span class="n">dígitos</span> <span class="n">pues</span> <span class="n">la</span> <span class="n">suma</span> <span class="n">aumenta</span> <span class="n">un</span> <span class="n">dígito</span>
    <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;x+y a 5 dígitos </span><span class="si">%0.4e</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">res2</span><span class="p">);</span> 
    
    <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;--------</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span>
    <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;Error absoluto de aprox: </span><span class="si">%e</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="n">err_abs</span><span class="p">(</span><span class="n">res2</span><span class="p">,</span><span class="n">res1</span><span class="p">));</span>
    <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;Error relativo de aprox: </span><span class="si">%e</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="n">err_rel</span><span class="p">(</span><span class="n">err_abs</span><span class="p">(</span><span class="n">res2</span><span class="p">,</span><span class="n">res1</span><span class="p">),</span><span class="n">res1</span><span class="p">));</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>valor x a 8 dígitos: 7.1428571e-01
valor y a 8 dígitos: 3.3333333e-01
x+y a 8 dígitos 1.0476190e+00
valor x a 5 dígitos: 7.1428e-01
valor y a 5 dígitos: 3.3333e-01
x+y a 5 dígitos 1.0476e+00
--------
Error absoluto de aprox: 1.900000e-05
Error relativo de aprox: 1.813636e-05
</pre></div>
</div>
</div>
</div>
<div class="admonition-ejercicio admonition">
<p class="admonition-title">Ejercicio</p>
<p>Finalizar la tabla con un programa en C.</p>
<p><strong>Solución de la tabla:</strong> <a class="reference external" href="https://www.dropbox.com/scl/fi/oplgwf10lmve0fam0wvz8/respuestas.xlsx?dl=0&amp;rlkey=j3ro10hw9ptvirpn38fadvi7a">liga</a></p>
</div>
<div class="section" id="listando-algunos-problemas-tipicos-que-se-presentan-en-la-aritmetica-de-maquina-se-tienen">
<h4>Listando algunos problemas típicos que se presentan en la aritmética de máquina se tienen:<a class="headerlink" href="#listando-algunos-problemas-tipicos-que-se-presentan-en-la-aritmetica-de-maquina-se-tienen" title="Permalink to this headline">¶</a></h4>
<ol class="simple">
<li><p>Problema de cancelación: pérdida de cifras significativas a partir de la resta de números similares.</p></li>
<li><p>Suma entre un número de magnitud grande y un número de magnitud pequeña.</p></li>
<li><p>Sumas con términos que involucren signos alternados.</p></li>
<li><p>Multiplicación por un número de magnitud grande.</p></li>
<li><p>División por un número de magnitud pequeña.</p></li>
</ol>
</div>
<div class="section" id="posibles-soluciones">
<h4>Posibles soluciones:<a class="headerlink" href="#posibles-soluciones" title="Permalink to this headline">¶</a></h4>
<ol class="simple">
<li><p>Usar mayor precisión.</p></li>
<li><p>Reordenar operaciones.</p></li>
<li><p>Reescribir expresiones matemáticas para obtener expresiones equivalentes.</p></li>
<li><p>Escalar las variables. También funciona estandarizarlas.</p></li>
</ol>
<p><strong>Ejercicios</strong></p>
<ol class="simple">
<li><p>Resuelve los ejercicios y preguntas de la nota.</p></li>
<li><p>Utiliza la notación posicional para representar al número <span class="math notranslate nohighlight">\(86409\)</span> y <span class="math notranslate nohighlight">\((1001.1)_2\)</span> en base <span class="math notranslate nohighlight">\(10\)</span>.</p></li>
<li><p>¿Cuáles de los siguientes números son números de máquina en un SPFN con <span class="math notranslate nohighlight">\(\beta=2\)</span>?</p></li>
</ol>
<p>a. <span class="math notranslate nohighlight">\((2.125)_{10}\)</span>.</p>
<p>b. <span class="math notranslate nohighlight">\((3.1)_{10}\)</span>.</p>
<p><strong>tip: escribe los números anteriores como sumas de potencias de <span class="math notranslate nohighlight">\(2\)</span>.</strong></p>
<ol class="simple">
<li><p>Considérese un SPFN con <span class="math notranslate nohighlight">\(\beta=2, k=3\)</span>. En este sistema se tienen <span class="math notranslate nohighlight">\(7\)</span> bits para almacenar números. El primer bit se utiliza para el signo del número, el segundo bit se utiliza para el signo del exponente, los dos siguientes bits para construir al exponente y el último bit para construir a la mantisa. Entonces el número positivo normalizado más pequeño que es posible representar en este SPFN es:</p></li>
</ol>
<div class="math notranslate nohighlight">
\[(0111100)_2=(.5\times2^{-3})_{10}=.0625.\]</div>
<p>a. Escribe los siguientes números más grandes a este número que forman al SPFN hasta el valor más grande positivo que es posible representar en este SPFN.</p>
<p>b. Calcula las distancias entre los números con mismo valor de exponente.</p>
<p>c. Verifica que el error relativo para <span class="math notranslate nohighlight">\(x=0.156249\)</span> utilizando la regla de corte es menor o igual a <span class="math notranslate nohighlight">\(\epsilon_{maq}=.25\)</span> y el error relativo para <span class="math notranslate nohighlight">\(x=0.14\)</span> utilizando la regla de redondeo es menor o igual a <span class="math notranslate nohighlight">\(\epsilon_{maq}=0.125\)</span>.</p>
<p><strong>Preguntas de comprehensión</strong>.</p>
<p>1)¿Cuáles componentes definen  a un sistema de punto flotante?</p>
<p>2)Si un número tiene una representación exacta en la máquina, ¿qué nombre recibe?</p>
<p>3)¿Qué es un sistema de punto flotante normalizado?</p>
<p>4)Menciona algunas propiedades de un sistema de punto flotante normalizado.</p>
<p>5)¿Cuántos bits se utilizan en el hardware de una máquina para almacenar un número en un sistema de doble precisión?</p>
<p>6)¿Qué nombre reciben los errores que se generan por utilizar un sistema de punto flotante?</p>
<p>7)¿Cuáles reglas utiliza la máquina para dar aproximaciones a un número?</p>
<p>8)Explica con palabras la diferencia entre el epsilon de la máquina y el nivel de underflow:</p>
<p>a.¿Cuál de ellos depende únicamente del número de dígitos de la mantisa?</p>
<p>b.¿Cuál de ellos depende únicamente del número de dígitos del exponente?</p>
<p>c.¿Cuál de ellos no depende de la reglas usadas que se preguntaron en la pregunta 7?</p>
<p>9)Si calculamos un error relativo para una aproximación y resulta ser del orden de <span class="math notranslate nohighlight">\(10^{-8}\)</span> ¿alrededor de cuántos dígitos correctos tengo en mi aproximación?</p>
<p>10)Menciona algunos problemas típicos de la aritmética de máquina y algunas formas de resolverlos.</p>
<p><strong>Referencias:</strong></p>
<ol class="simple">
<li><p>R. L. Burden, J. D. Faires, Numerical Analysis, Brooks/Cole Cengage Learning, 2005.</p></li>
<li><p>M. T. Heath, Scientific Computing. An Introductory Survey, McGraw-Hill, 2002.</p></li>
<li><p><a class="reference external" href="https://github.com/palmoreck/programming-languages">Lenguaje C de programación</a>.</p></li>
</ol>
</div>
</div>
</div>
<span id="document-I.computo_cientifico/1.3/Normas_vectoriales_y_matriciales"></span><div class="admonition-notas-para-contenedor-de-docker admonition">
<p class="admonition-title">Notas para contenedor de docker:</p>
<p>Comando de docker para ejecución de la nota de forma local:</p>
<p>nota: cambiar <code class="docutils literal notranslate"><span class="pre">&lt;ruta</span> <span class="pre">a</span> <span class="pre">mi</span> <span class="pre">directorio&gt;</span></code> por la ruta de directorio que se desea mapear a <code class="docutils literal notranslate"><span class="pre">/datos</span></code> dentro del contenedor de docker.</p>
<p><code class="docutils literal notranslate"><span class="pre">docker</span> <span class="pre">run</span> <span class="pre">--rm</span> <span class="pre">-v</span> <span class="pre">&lt;ruta</span> <span class="pre">a</span> <span class="pre">mi</span> <span class="pre">directorio&gt;:/datos</span> <span class="pre">--name</span> <span class="pre">jupyterlab_optimizacion</span> <span class="pre">-p</span> <span class="pre">8888:8888</span> <span class="pre">-d</span> <span class="pre">palmoreck/jupyterlab_optimizacion:2.1.4</span></code></p>
<p>password para jupyterlab: <code class="docutils literal notranslate"><span class="pre">qwerty</span></code></p>
<p>Detener el contenedor de docker:</p>
<p><code class="docutils literal notranslate"><span class="pre">docker</span> <span class="pre">stop</span> <span class="pre">jupyterlab_optimizacion</span></code></p>
<p>Documentación de la imagen de docker <code class="docutils literal notranslate"><span class="pre">palmoreck/jupyterlab_optimizacion:2.1.4</span></code> en <a class="reference external" href="https://github.com/palmoreck/dockerfiles/tree/master/jupyterlab/optimizacion">liga</a>.</p>
</div>
<hr class="docutils" />
<p>Nota generada a partir de <a class="reference external" href="https://www.dropbox.com/s/5bc6tn39o0qqg35/1.3.Condicion_estabilidad_y_normas.pdf?dl=0">liga</a></p>
<div class="section" id="normas-vectoriales-y-matriciales">
<span id="nvm"></span><h2>1.3 Normas vectoriales y matriciales<a class="headerlink" href="#normas-vectoriales-y-matriciales" title="Permalink to this headline">¶</a></h2>
<p>Una norma define una medida de distancia en un conjunto y da nociones de tamaño, vecindad, convergencia y continuidad.</p>
<div class="section" id="normas-vectoriales">
<h3>Normas vectoriales<a class="headerlink" href="#normas-vectoriales" title="Permalink to this headline">¶</a></h3>
<p>Sea <span class="math notranslate nohighlight">\(\mathbb{R}^n\)</span> el conjunto de <span class="math notranslate nohighlight">\(n\)</span>-tuplas o vectores columna o <span class="math notranslate nohighlight">\(1\)</span>-arreglo de orden <span class="math notranslate nohighlight">\(1\)</span>, esto es:</p>
<div class="math notranslate nohighlight">
\[\begin{split}x \in \mathbb{R}^n \iff x = \left[\begin{array}{c}
    x_1\\
    x_2\\
    \vdots\\
    x_n
    \end{array} \right] \text{ con } x_i \in \mathbb{R}\end{split}\]</div>
<p>Una norma vectorial en <span class="math notranslate nohighlight">\(\mathbb{R}^n\)</span> es una función <span class="math notranslate nohighlight">\(g: \mathbb{R}^n \rightarrow \mathbb{R}\)</span> que satisface las siguientes propiedades:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(g\)</span> es no negativa: <span class="math notranslate nohighlight">\(g(x) \geq 0 \forall x \in \mathbb{R}^n\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(g\)</span> es definida: <span class="math notranslate nohighlight">\(g(x) = 0 \iff x = 0\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(g\)</span> satisface la desigualdad del triángulo: <span class="math notranslate nohighlight">\($g(x+y) \leq g(x) + g(y) \forall x,y \in \mathbb{R}^n.\)</span>$</p></li>
</ul>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(g\)</span> es homogénea: <span class="math notranslate nohighlight">\(g(\alpha x)=|\alpha|g(x), \forall \alpha \in \mathbb{R}, \forall x \in \mathbb{R}^n\)</span>.</p></li>
</ul>
<p>Notación: <span class="math notranslate nohighlight">\(g(x) = ||x||\)</span>.</p>
<div class="admonition-espacio-vectorial admonition">
<p class="admonition-title">Espacio Vectorial.</p>
<p>Un conjunto <span class="math notranslate nohighlight">\(V \neq \emptyset\)</span> en el que se le han definido las operaciones <span class="math notranslate nohighlight">\((+, \cdot)\)</span> se le nombra <strong>espacio vectorial</strong> sobre <span class="math notranslate nohighlight">\(\mathbb{R}\)</span> si satisface las siguientes propiedades <span class="math notranslate nohighlight">\(\forall x, y, z \in V\)</span>, <span class="math notranslate nohighlight">\(\forall a,b \in \mathbb{R}\)</span>:</p>
<ul class="simple">
<li><p>x + (y + z) = (x + y) + z</p></li>
<li><p>x + y = y + x</p></li>
<li><p><span class="math notranslate nohighlight">\(\exists 0 \in V\)</span> tal que <span class="math notranslate nohighlight">\(x + 0 = 0 + x = x\)</span> <span class="math notranslate nohighlight">\(\forall x \in V\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(\forall x \in V\)</span> <span class="math notranslate nohighlight">\(\exists -x \in V\)</span> tal que <span class="math notranslate nohighlight">\(x + (-x) = 0\)</span>.</p></li>
<li><p>a(bx) = (ab)x.</p></li>
<li><p><span class="math notranslate nohighlight">\(1x = x\)</span> con $ 1 \in \mathbb{R}$.</p></li>
<li><p><span class="math notranslate nohighlight">\(a(x + y) = ax + ay\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\((a+b)x = ax + bx\)</span>.</p></li>
</ul>
</div>
<div class="admonition-comentarios-y-propiedades admonition">
<p class="admonition-title">Comentarios y propiedades</p>
<ul class="simple">
<li><p>Una norma es una generalización del valor absoluto de <span class="math notranslate nohighlight">\(\mathbb{R}\)</span>: <span class="math notranslate nohighlight">\(|x|, x \in \mathbb{R}.\)</span></p></li>
<li><p>Un espacio vectorial con una norma definida en éste se le llama <strong>espacio vectorial normado</strong>.</p></li>
<li><p>Una norma es una medida de la longitud de un vector.</p></li>
<li><p>Con una norma es posible definir conceptos como distancia entre vectores: <span class="math notranslate nohighlight">\(x,y \in \mathbb{R}^n: \text{dist}(x,y) = ||x-y||\)</span>.</p></li>
<li><p>Existen varias normas en <span class="math notranslate nohighlight">\(\mathbb{R}^n\)</span> siendo las más comunes:</p></li>
<li><p>La norma <span class="math notranslate nohighlight">\(\mathcal{l}_2\)</span>, Euclidiana o norma <span class="math notranslate nohighlight">\(2\)</span>: <span class="math notranslate nohighlight">\(||x||_2\)</span>.</p></li>
<li><p>La norma <span class="math notranslate nohighlight">\(\mathcal{l}_1\)</span> o norma <span class="math notranslate nohighlight">\(1\)</span>: <span class="math notranslate nohighlight">\(||x||_1\)</span>.</p></li>
<li><p>La norma <span class="math notranslate nohighlight">\(\infty\)</span> o de Chebyshev o norma infinito: <span class="math notranslate nohighlight">\(||x||_\infty\)</span>.</p></li>
</ul>
<p>Las normas anteriores pertenecen a una familia parametrizada por una constante <span class="math notranslate nohighlight">\(p, p \geq 1\)</span> cuyo nombre es norma <span class="math notranslate nohighlight">\(\mathcal{l}_p\)</span>:</p>
<div class="math notranslate nohighlight">
\[ ||x||_p = \left(\displaystyle \sum_{i=1}^n|x_i|^p \right )^{1/p}.\]</div>
<ul class="simple">
<li><p>Un resultado para <span class="math notranslate nohighlight">\(x \in \mathbb{R}^n\)</span> es la <strong>equivalencia</strong> entre normas:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\exists \alpha, \beta &gt; 0  \text{ tales que }: \alpha||x||_a \leq ||x||_b \leq \beta ||x||_a \forall x \in \mathbb{R}^n\]</div>
<p>donde: <span class="math notranslate nohighlight">\(||\cdot||_a, ||\cdot||_b\)</span> son normas cualesquiera en <span class="math notranslate nohighlight">\(\mathbb{R}^n\)</span>. Por la propiedad anterior decimos que si se cumple convergencia en la norma <span class="math notranslate nohighlight">\(||\cdot||_a\)</span> entonces también se cumple convergencia en la norma <span class="math notranslate nohighlight">\(||\cdot||_b\)</span>.</p>
</div>
<p><strong>Ejemplos de gráficas en el plano:</strong></p>
<p>Norma <span class="math notranslate nohighlight">\(2\)</span>: <span class="math notranslate nohighlight">\(\{ x \in \mathbb{R}^2  \text{ tales que } ||x||_2 \leq 1\}\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="c1">#definición de norma2</span>
<span class="n">density</span><span class="o">=</span><span class="mf">1e-5</span>
<span class="n">density_p</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="mf">2.5</span><span class="o">*</span><span class="mi">10</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>
<span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">density</span><span class="p">)</span>
<span class="n">y1</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">y2</span><span class="o">=-</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">x_p</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,(</span><span class="n">density_p</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="n">ind</span><span class="o">=</span><span class="n">f</span><span class="p">(</span><span class="n">x_p</span><span class="p">)</span><span class="o">&lt;=</span><span class="mi">1</span>
<span class="n">x_p_subset</span><span class="o">=</span><span class="n">x_p</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y1</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y2</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_p_subset</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">x_p_subset</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Puntos en el plano que cumplen ||x||_2 &lt;= 1&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p>Norma <span class="math notranslate nohighlight">\(1\)</span>:  <span class="math notranslate nohighlight">\(\{ x \in \mathbb{R}^2  \text{ tales que } ||x||_1 \leq 1\}\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x</span><span class="p">[:,</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span> <span class="c1">#definición de norma1</span>
<span class="n">density</span><span class="o">=</span><span class="mf">1e-5</span>
<span class="n">density_p</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="mf">2.5</span><span class="o">*</span><span class="mi">10</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>
<span class="n">x1</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">density</span><span class="p">)</span>
<span class="n">x2</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">density</span><span class="p">)</span>
<span class="n">y1</span><span class="o">=</span><span class="mi">1</span><span class="o">-</span><span class="n">x1</span>
<span class="n">y2</span><span class="o">=</span><span class="mi">1</span><span class="o">+</span><span class="n">x2</span>
<span class="n">y3</span><span class="o">=</span><span class="n">x1</span><span class="o">-</span><span class="mi">1</span>
<span class="n">y4</span><span class="o">=-</span><span class="mi">1</span><span class="o">-</span><span class="n">x2</span>
<span class="n">x_p</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,(</span><span class="n">density_p</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="n">ind</span><span class="o">=</span><span class="n">f</span><span class="p">(</span><span class="n">x_p</span><span class="p">)</span><span class="o">&lt;=</span><span class="mi">1</span>
<span class="n">x_p_subset</span><span class="o">=</span><span class="n">x_p</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">y1</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">y2</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="n">x1</span><span class="p">,</span><span class="n">y3</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">y4</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_p_subset</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">x_p_subset</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Puntos en el plano que cumplen ||x||_1 &lt;= 1&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p>Norma <span class="math notranslate nohighlight">\(\infty\)</span>:  <span class="math notranslate nohighlight">\(\{ x \in \mathbb{R}^2  \text{ tales que } ||x||_\infty \leq 1\}\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="c1">#definición de norma infinito</span>
<span class="n">density_p</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="mf">2.5</span><span class="o">*</span><span class="mi">10</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>
<span class="n">x_p</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,(</span><span class="n">density_p</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="n">ind</span><span class="o">=</span><span class="n">f</span><span class="p">(</span><span class="n">x_p</span><span class="p">)</span><span class="o">&lt;=</span><span class="mi">1</span>
<span class="n">x_p_subset</span><span class="o">=</span><span class="n">x_p</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_p_subset</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">x_p_subset</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Puntos en el plano que cumplen ||x||_inf &lt;= 1&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p>-&gt;La norma <span class="math notranslate nohighlight">\(\infty\)</span> se encuentra en esta familia como límite:</p>
<div class="math notranslate nohighlight">
\[||x||_\infty = \displaystyle \lim_{p \rightarrow \infty} ||x||_p.\]</div>
<p>-&gt;En la norma <span class="math notranslate nohighlight">\(\mathcal{l}_2\)</span> o Euclidiana <span class="math notranslate nohighlight">\(||x||_2\)</span> tenemos una desigualdad muy importante, la desigualdad de <strong>Cauchy-Schwartz</strong>:</p>
<div class="math notranslate nohighlight">
\[|x^Ty| \leq ||x||_2||y||_2 \forall x,y \in \mathbb{R}^n\]</div>
<p>la cual relaciona el producto interno estándar para <span class="math notranslate nohighlight">\(x,y \in \mathbb{R}^n\)</span>: <span class="math notranslate nohighlight">\(&lt;x,y&gt; = x^Ty = \displaystyle \sum_{i=1}^nx_iy_i\)</span> con la norma <span class="math notranslate nohighlight">\(\mathcal{l}_2\)</span> de <span class="math notranslate nohighlight">\(x\)</span> y la norma <span class="math notranslate nohighlight">\(\mathcal{l}_2\)</span> de <span class="math notranslate nohighlight">\(y\)</span>. Además se utiliza lo anterior para definir el ángulo (sin signo) entre <span class="math notranslate nohighlight">\(x,y\)</span>:</p>
<div class="math notranslate nohighlight">
\[\measuredangle x,y = \cos ^{-1}\left(\frac{x^Ty}{||x||_2||y||_2} \right )\]</div>
<p>para <span class="math notranslate nohighlight">\(\cos^{-1}(u) \in [0,\pi]\)</span> y se nombra a <span class="math notranslate nohighlight">\(x,y\)</span> ortogonales si <span class="math notranslate nohighlight">\(x^Ty=0\)</span>. Obsérvese que <span class="math notranslate nohighlight">\(||x||_2 = \sqrt{x^Tx}\)</span>.</p>
<ul class="simple">
<li><p>También se utilizan matrices* para definir normas</p></li>
</ul>
<p>*Matriz: arreglo <span class="math notranslate nohighlight">\(2\)</span>-dimensional de datos o <span class="math notranslate nohighlight">\(2\)</span> arreglo de orden <span class="math notranslate nohighlight">\(2\)</span>. Se utiliza la notación <span class="math notranslate nohighlight">\(A \in \mathbb{R}^{m\times n}\)</span> para denotar:</p>
<div class="math notranslate nohighlight">
\[\begin{split}A = \left[\begin{array}{cccc}
a_{11} &amp;a_{12}&amp;\dots&amp;a_{1n}\\
a_{21} &amp;a_{22}&amp;\dots&amp;a_{2n}\\
\vdots &amp;\vdots&amp; \vdots&amp;\vdots\\
a_{n1} &amp;a_{n2}&amp;\dots&amp;a_{nn}\\
\vdots &amp;\vdots&amp; \vdots&amp;\vdots\\
a_{m-11} &amp;a_{m-12}&amp;\dots&amp;a_{m-1n}\\
a_{m1} &amp;a_{m2}&amp;\dots&amp;a_{mm}
\end{array}
\right] 
\end{split}\]</div>
<p>*<span class="math notranslate nohighlight">\(a_{ij} \mathbb{R} \forall i=1,\dots,m, j=1,\dots,n\)</span>.</p>
<p>*<span class="math notranslate nohighlight">\(A=(a_1,\dots a_n), a_j \in \mathbb{R}^m (=\mathbb{R}^{m\times1}) \forall j=1,\dots,n\)</span>.</p>
<p>*<span class="math notranslate nohighlight">\(A=\left ( \begin{array}{c}
a_1^T\\
\vdots\\
a_m^T
\end{array} \right ), a_i \in \mathbb{R}^n (=\mathbb{R}^{n\times1}) \forall i=1,\dots,m\)</span>.</p>
<p>Entonces un ejemplo de norma-<span class="math notranslate nohighlight">\(2\)</span> ponderada es: <span class="math notranslate nohighlight">\(\{x \in \mathbb{R}^2 \text{ tales que } ||x||_D \leq 1, ||x||_D = ||Dx||_2, \text{con matriz diagonal } D\}\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">d1</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="mi">5</span>
<span class="n">d2</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span>
<span class="n">f</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">d1</span><span class="o">*</span><span class="n">x</span><span class="p">[:,</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">d2</span><span class="o">*</span><span class="n">x</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="c1">#definición de norma2</span>
<span class="n">density</span><span class="o">=</span><span class="mf">1e-5</span>
<span class="n">density_p</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="mf">2.5</span><span class="o">*</span><span class="mi">10</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>
<span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">d1</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="n">d1</span><span class="p">,</span><span class="n">density</span><span class="p">)</span>
<span class="n">y1</span><span class="o">=</span><span class="mf">1.0</span><span class="o">/</span><span class="n">d2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="p">(</span><span class="n">d1</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">y2</span><span class="o">=-</span><span class="mf">1.0</span><span class="o">/</span><span class="n">d2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="p">(</span><span class="n">d1</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">x_p</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">d1</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="n">d1</span><span class="p">,(</span><span class="n">density_p</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="n">ind</span><span class="o">=</span><span class="n">f</span><span class="p">(</span><span class="n">x_p</span><span class="p">)</span><span class="o">&lt;=</span><span class="mi">1</span>
<span class="n">x_p_subset</span><span class="o">=</span><span class="n">x_p</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y1</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y2</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_p_subset</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">x_p_subset</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Puntos en el plano que cumplen ||x||_D &lt;= 1&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p>en este caso <span class="math notranslate nohighlight">\(D=\left[\begin{array}{cc}
\frac{1}{5} &amp;0\\
0 &amp;\frac{1}{3}
\end{array}\right ]\)</span></p>
</div>
<div class="section" id="normas-matriciales">
<h3>Normas matriciales<a class="headerlink" href="#normas-matriciales" title="Permalink to this headline">¶</a></h3>
<p>La multiplicación de una matriz de tamaño <span class="math notranslate nohighlight">\(m\times n\)</span> por un vector se define como:</p>
<div class="math notranslate nohighlight">
\[y=Ax=\displaystyle \sum_{j=1}^n \alpha_jx_j\]</div>
<p>con <span class="math notranslate nohighlight">\(a_j \in \mathbb{R}^m, x \in \mathbb{R}^n\)</span>. Obsérvese que <span class="math notranslate nohighlight">\(x \in \mathbb{R}^n, Ax \in \mathbb{R}^m\)</span>.</p>
<p><strong>Inducidas</strong></p>
<p>De las normas matriciales más importantes se encuentran las <strong>inducidas</strong> por normas vectoriales. Estas normas matriciales se definen en términos de los vectores en <span class="math notranslate nohighlight">\(\mathbb{R}^n\)</span> a los que se les aplica la multiplicación <span class="math notranslate nohighlight">\(Ax\)</span>:</p>
<p>Dadas las normas vectoriales <span class="math notranslate nohighlight">\(||\cdot||_{(n)}, ||\cdot||_{(m)}\)</span> en <span class="math notranslate nohighlight">\(\mathbb{R}^n\)</span> y <span class="math notranslate nohighlight">\(\mathbb{R}^m\)</span> respectivamente, la norma matricial inducida <span class="math notranslate nohighlight">\(||A||_{(m,n)}\)</span> para <span class="math notranslate nohighlight">\(A \in \mathbb{R}^{m \times n}\)</span> es el <strong>menor número</strong> <span class="math notranslate nohighlight">\(C\)</span> para el cual la desigualdad:</p>
<div class="math notranslate nohighlight">
\[||Ax||_{(m)} \leq C||x||_{(n)}\]</div>
<p>se cumple <span class="math notranslate nohighlight">\(\forall x \in \mathbb{R}^n\)</span>. Esto es:</p>
<div class="math notranslate nohighlight">
\[||A||_{(m,n)} = \displaystyle \sup_{x \in \mathbb{R}^n} \frac{||Ax||_{(m)}}{||x||_{(n)}}\]</div>
<p><strong>Comentarios:</strong></p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(||A||_{(m,n)}\)</span> representa el <strong>máximo</strong> factor por el cual <span class="math notranslate nohighlight">\(A\)</span> puede modificar el tamaño de <span class="math notranslate nohighlight">\(x\)</span> sobre todos los vectores <span class="math notranslate nohighlight">\(x \in \mathbb{R}^n\)</span>, es una medida de un tipo de <strong>worst case stretch factor</strong>.</p></li>
<li><p>Así definidas, la norma <span class="math notranslate nohighlight">\(||\cdot||_{(m,n)}\)</span> es la norma matricial inducida por las normas vectoriales <span class="math notranslate nohighlight">\(||\cdot||_{(m)}, ||\cdot||_{(n)}\)</span>.</p></li>
<li><p>Son definiciones equivalentes:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[||A||_{(m,n)} = \displaystyle \sup_{x \in \mathbb{R}^n} \frac{||Ax||_{(m)}}{||x||_{(n)}} = \displaystyle \sup_{||x||_{(n)} \leq 1} \frac{||Ax||_{(m)}}{||x||_{(n)}} = \displaystyle \sup_{||x||_{(n)}=1} ||Ax||_{(m)}\]</div>
<p><strong>Ejemplo:</strong></p>
<p>La matriz <span class="math notranslate nohighlight">\(A=\left[\begin{array}{cc}
1 &amp;2\\
0 &amp;2
\end{array}\right ]\)</span> mapea <span class="math notranslate nohighlight">\(\mathbb{R}^2\)</span> a <span class="math notranslate nohighlight">\(\mathbb{R}^2\)</span>, en particular se tiene:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(A\)</span> mapea <span class="math notranslate nohighlight">\(e_1 = \left[\begin{array}{c}
1 \\
0
\end{array}\right ]\)</span> a la columna <span class="math notranslate nohighlight">\(a_1 = \left[\begin{array}{c}
1 \\
0
\end{array}\right ]\)</span> de <span class="math notranslate nohighlight">\(A\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(A\)</span> mapea <span class="math notranslate nohighlight">\(e_2 = \left[\begin{array}{c}
0 \\
1
\end{array}\right ]\)</span> a la columna <span class="math notranslate nohighlight">\(a_2 = \left[\begin{array}{c}
2 \\
2
\end{array}\right ]\)</span> de <span class="math notranslate nohighlight">\(A\)</span>.</p></li>
</ul>
<p>Considerando <span class="math notranslate nohighlight">\(||A||_p := ||A||_{(p,p)}\)</span> con <span class="math notranslate nohighlight">\(p=1, p=2, p=\infty\)</span> se tiene:</p>
<img src="https://dl.dropboxusercontent.com/s/3fqz9uspfwdurjf/normas_matriciales.png?dl=0" heigth="500" width="500">
<p><strong>Comentario:</strong> al observar la segunda gráfica se tiene la siguiente afirmación: la acción de una matriz sobre una circunferencia es una elipse con longitudes de semiejes iguales a <span class="math notranslate nohighlight">\(|d_i|\)</span>. En general la acción de una matriz sobre una hiper esfera es una hiperelipse. Por lo que los vectores unitarios en <span class="math notranslate nohighlight">\(\mathbb{R}^n\)</span> que son más amplificados por la acción de una matriz diagonal <span class="math notranslate nohighlight">\(D \in \mathbb{R}^{m\times n}\)</span> con entradas iguales a <span class="math notranslate nohighlight">\(d_i\)</span> son aquellos que se mapean a los semiejes de una hiperelipse en <span class="math notranslate nohighlight">\(\mathbb{R}^m\)</span> de longitud  igual a <span class="math notranslate nohighlight">\(\max\{|d_i|\}\)</span> y así tenemos: si <span class="math notranslate nohighlight">\(D\)</span> es una matriz diagonal con entradas <span class="math notranslate nohighlight">\(|d_i|\)</span> entonces <span class="math notranslate nohighlight">\(||D||_2 = \displaystyle \max_{i=1,\dots,m}\{|d_i|\}\)</span>.</p>
<p><strong>Ejemplo con Python para la norma <span class="math notranslate nohighlight">\(1\)</span>:</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">A</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]])</span>
<span class="n">density</span><span class="o">=</span><span class="mf">1e-5</span>
<span class="n">x1</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">density</span><span class="p">)</span>
<span class="n">x2</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">density</span><span class="p">)</span>
<span class="n">x1_y1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">x1</span><span class="p">,</span><span class="mi">1</span><span class="o">-</span><span class="n">x1</span><span class="p">))</span>
<span class="n">x2_y2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">x2</span><span class="p">,</span><span class="mi">1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span>
<span class="n">x1_y3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">x1</span><span class="p">,</span><span class="n">x1</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
<span class="n">x2_y4</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">x2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">x2</span><span class="p">))</span>
<span class="n">apply_A</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">vec</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">A</span><span class="nd">@np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">vec</span><span class="p">))</span>
<span class="n">A_to_vector_1</span> <span class="o">=</span> <span class="n">apply_A</span><span class="p">(</span><span class="n">x1_y1</span><span class="p">)</span>
<span class="n">A_to_vector_2</span> <span class="o">=</span> <span class="n">apply_A</span><span class="p">(</span><span class="n">x2_y2</span><span class="p">)</span>
<span class="n">A_to_vector_3</span> <span class="o">=</span> <span class="n">apply_A</span><span class="p">(</span><span class="n">x1_y3</span><span class="p">)</span>
<span class="n">A_to_vector_4</span> <span class="o">=</span> <span class="n">apply_A</span><span class="p">(</span><span class="n">x2_y4</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1_y1</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">x1_y1</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;b&#39;</span><span class="p">,</span>
         <span class="n">x2_y2</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">x2_y2</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;b&#39;</span><span class="p">,</span>
         <span class="n">x1_y3</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">x1_y3</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;b&#39;</span><span class="p">,</span>
         <span class="n">x2_y4</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">x2_y4</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="n">e1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">x1</span><span class="p">)),</span><span class="n">x1</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">e1</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">e1</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;g&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Vectores con norma 1 menor o igual a 1&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">A_to_vector_1</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">A_to_vector_1</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;b&#39;</span><span class="p">,</span>
         <span class="n">A_to_vector_2</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">A_to_vector_2</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;b&#39;</span><span class="p">,</span>
         <span class="n">A_to_vector_3</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">A_to_vector_3</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;b&#39;</span><span class="p">,</span>
         <span class="n">A_to_vector_4</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">A_to_vector_4</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="n">A_to_vector_e1</span> <span class="o">=</span> <span class="n">apply_A</span><span class="p">(</span><span class="n">e1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">A_to_vector_e1</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">A_to_vector_e1</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;g&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Efecto de la matriz A sobre los vectores con norma 1 menor o igual a 1&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p><strong>Ejercicio:</strong> obtener las otras dos gráficas con Python usando norma <span class="math notranslate nohighlight">\(2\)</span> y norma <span class="math notranslate nohighlight">\(\infty\)</span>. Para el caso de la norma <span class="math notranslate nohighlight">\(2\)</span>  el vector en color azul está dado por la descomposición en valores singulares (SVD) de A. En específico la primer columna de la matriz <span class="math notranslate nohighlight">\(U\)</span> multiplicado por el primer valor singular. En el ejemplo resulta en:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\sigma_1U[:,0] \approx 2.9208*\left[ \begin{array}{c}
0.74967 \\
0.66180
\end{array} \right] \approx \left[\begin{array}{c}
2.189\\
1.932
\end{array}
\right]
\end{split}\]</div>
<p>y el vector <span class="math notranslate nohighlight">\(v\)</span> que será multiplicado por la matriz <span class="math notranslate nohighlight">\(A\)</span> es la primer columna de <span class="math notranslate nohighlight">\(V\)</span> dada por:</p>
<div class="math notranslate nohighlight">
\[\begin{split}V[:,0] \approx \left[
\begin{array}{c}
0.2566\\
0.9664
\end{array}
\right]
\end{split}\]</div>
<p><strong>Resultados computacionales que es posible probar:</strong></p>
<ol class="simple">
<li><p><span class="math notranslate nohighlight">\(||A||_1 = \displaystyle \max_{j=1,\dots,n}\sum_{i=1}^n|a_{ij}|\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(||A||_\infty = \displaystyle \max_{i=1,\dots,n}\sum_{j=1}^n|a_{ij}|\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(||A||_2 = \sqrt{\lambda_{max}(A^TA)} = \max \left \{\sqrt{\lambda}\in \mathbb{R} | \lambda \text{ es eigenvalor de } A^TA \right \} = max \left \{ \sigma \in \mathbb{R} | \sigma \text{ es valor singular de A } \right \} = \sigma_{max}(A)\)</span>.</p></li>
</ol>
<p>por ejemplo para la matriz anterior se tiene:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">_</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="n">_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">svd</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p><strong>Otras normas matriciales:</strong></p>
<ul class="simple">
<li><p>Norma de Frobenius: <span class="math notranslate nohighlight">\(||A||_F = \text{tr}(A^TA)^{1/2} = \left ( \displaystyle \sum_{i=1}^m \sum_{j=1}^n a_{ij}^2 \right ) ^{1/2}\)</span>.</p></li>
<li><p>Norma “sum-absolute-value”: <span class="math notranslate nohighlight">\(||A||_{sav} = \displaystyle \sum_{i=1}^m \sum_{j=1}^n |a_{ij}|\)</span>.</p></li>
<li><p>Norma “max-absolute-value”: <span class="math notranslate nohighlight">\(||A||_{mav} = \displaystyle \max \left\{|a_{ij}| \text{ para } i=1,\dots,m , j=1,\dots,n \right \}\)</span>.</p></li>
</ul>
<p><strong>Comentarios:</strong></p>
<ul class="simple">
<li><p>El producto interno estándar en <span class="math notranslate nohighlight">\(\mathbb{R}^{m\times n}\)</span> es: <span class="math notranslate nohighlight">\(&lt;A,B&gt; = tr(A^TB) = \displaystyle \sum_{i=1}^m \sum_{j=1}^n a_{ij}b_{ij}\)</span>.</p></li>
<li><p>La norma <span class="math notranslate nohighlight">\(2\)</span> (también llamada norma espectral o <span class="math notranslate nohighlight">\(\mathcal{l}_2\)</span>) y la norma de Frobenius cumplen la propiedad de <strong>consistencia</strong>:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[||Ax|| \leq ||A|| ||x|| \forall x \in \mathbb{R}^n, \forall A \in \mathbb{R}^{m\times n}.\]</div>
<div class="math notranslate nohighlight">
\[||AB|| \leq ||A|| ||B|| \forall A,B \text{ matrices con dimensiones correspondientes para su multiplicación}.\]</div>
<p><strong>Obs:</strong> de hecho esta propiedad de consistencia también es cumplida por las normas-<span class="math notranslate nohighlight">\(p\)</span> matriciales.</p>
</div>
<div class="section" id="nota-sobre-sup">
<h3>Nota sobre <span class="math notranslate nohighlight">\(\sup\)</span><a class="headerlink" href="#nota-sobre-sup" title="Permalink to this headline">¶</a></h3>
<p>Si <span class="math notranslate nohighlight">\(C \subseteq \mathbb{R}\)</span> entonces <span class="math notranslate nohighlight">\(a \subseteq \mathbb{R}\)</span> es una <strong>cota superior</strong> en <span class="math notranslate nohighlight">\(C\)</span> si</p>
<div class="math notranslate nohighlight">
\[ x \leq a, \forall x \in C.\]</div>
<p>En <span class="math notranslate nohighlight">\(\mathbb{R}\)</span> el conjunto de cotas superiores es <span class="math notranslate nohighlight">\(\emptyset, \mathbb{R}\)</span> ó un intervalo de la forma <span class="math notranslate nohighlight">\([b,\infty]\)</span>. En el último caso, <span class="math notranslate nohighlight">\(b\)</span> se llama <strong>mínima cota superior o supremo del conjunto</strong> <span class="math notranslate nohighlight">\(C\)</span> y se denota <span class="math notranslate nohighlight">\(\sup C\)</span>. Por convención <span class="math notranslate nohighlight">\(\sup\emptyset = -\infty\)</span> y <span class="math notranslate nohighlight">\(\sup C=\infty\)</span> si <span class="math notranslate nohighlight">\(C\)</span> no es acotado por arriba.</p>
<p><strong>Obs:</strong> si <span class="math notranslate nohighlight">\(C\)</span> es finito, <span class="math notranslate nohighlight">\(\sup C\)</span> es el máximo de los elementos de <span class="math notranslate nohighlight">\(C\)</span> y típicamente se denota como <span class="math notranslate nohighlight">\(\max C\)</span>.</p>
<p>Análogamente, <span class="math notranslate nohighlight">\(a \in \mathbb{R}\)</span> es una <strong>cota inferior</strong> en <span class="math notranslate nohighlight">\(C \subseteq \mathbb{R}\)</span> si
<span class="math notranslate nohighlight">\($a \leq x, \forall x \in C.\)</span>$</p>
<p>El <strong>ínfimo o máxima cota inferior</strong> de <span class="math notranslate nohighlight">\(C\)</span> es <span class="math notranslate nohighlight">\(\inf C = -\sup (-C)\)</span>. Por convención <span class="math notranslate nohighlight">\(\inf \emptyset = \infty\)</span> y si <span class="math notranslate nohighlight">\(C\)</span> no es acotado por debajo entonces <span class="math notranslate nohighlight">\(\inf C = -\infty\)</span>.</p>
<p><strong>Obs:</strong> si <span class="math notranslate nohighlight">\(C\)</span> es finito, <span class="math notranslate nohighlight">\(\inf C\)</span> es el mínimo de sus elementos y se denota como <span class="math notranslate nohighlight">\(\min C\)</span>.</p>
<p><strong>Ejercicios</strong></p>
<ol class="simple">
<li><p>Resuelve los ejercicios y preguntas de la nota.</p></li>
</ol>
<p><strong>Preguntas de comprehensión</strong></p>
<p>1)Menciona <span class="math notranslate nohighlight">\(5\)</span> propiedades que un conjunto debe cumplir para que sea considerado un espacio vectorial.</p>
<p>2)Menciona las propiedades que debe cumplir una función para que se considere una norma.</p>
<p>3)¿Qué es una norma matricial inducida?, ¿qué mide una norma matricial inducida?</p>
<p>4)¿La norma de Frobenius, es una norma matricial inducida?</p>
<p>5)¿A qué son iguales <span class="math notranslate nohighlight">\(\text{sup}(\emptyset)\)</span>, <span class="math notranslate nohighlight">\(\text{inf}(\emptyset)\)</span> ? (el conjunto <span class="math notranslate nohighlight">\(\emptyset\)</span> es el conjunto vacío)</p>
<p><strong>Referencias</strong></p>
<ol class="simple">
<li><p>L. Trefethen, D. Bau, Numerical linear algebra, SIAM, 1997.</p></li>
<li><p>G. H. Golub, C. F. Van Loan,Matrix Computations. John Hopkins University Press, 2013</p></li>
</ol>
</div>
</div>
<span id="document-I.computo_cientifico/1.4/Condicion_de_un_problema_y_estabilidad_de_un_algoritmo"></span><div class="admonition-notas-para-contenedor-de-docker admonition">
<p class="admonition-title">Notas para contenedor de docker:</p>
<p>Comando de docker para ejecución de la nota de forma local:</p>
<p>nota: cambiar <code class="docutils literal notranslate"><span class="pre">&lt;ruta</span> <span class="pre">a</span> <span class="pre">mi</span> <span class="pre">directorio&gt;</span></code> por la ruta de directorio que se desea mapear a <code class="docutils literal notranslate"><span class="pre">/datos</span></code> dentro del contenedor de docker.</p>
<p><code class="docutils literal notranslate"><span class="pre">docker</span> <span class="pre">run</span> <span class="pre">--rm</span> <span class="pre">-v</span> <span class="pre">&lt;ruta</span> <span class="pre">a</span> <span class="pre">mi</span> <span class="pre">directorio&gt;:/datos</span> <span class="pre">--name</span> <span class="pre">jupyterlab_optimizacion</span> <span class="pre">-p</span> <span class="pre">8888:8888</span> <span class="pre">-d</span> <span class="pre">palmoreck/jupyterlab_optimizacion:2.1.4</span></code></p>
<p>password para jupyterlab: <code class="docutils literal notranslate"><span class="pre">qwerty</span></code></p>
<p>Detener el contenedor de docker:</p>
<p><code class="docutils literal notranslate"><span class="pre">docker</span> <span class="pre">stop</span> <span class="pre">jupyterlab_optimizacion</span></code></p>
<p>Documentación de la imagen de docker <code class="docutils literal notranslate"><span class="pre">palmoreck/jupyterlab_optimizacion:2.1.4</span></code> en <a class="reference external" href="https://github.com/palmoreck/dockerfiles/tree/master/jupyterlab/optimizacion">liga</a>.</p>
</div>
<hr class="docutils" />
<p>Nota generada a partir de <a class="reference external" href="https://www.dropbox.com/s/5bc6tn39o0qqg35/1.3.Condicion_estabilidad_y_normas.pdf?dl=0">liga</a></p>
<p>Dos temas fundamentales en el análisis numérico son: la <strong>condición de un problema</strong> y <strong>estabilidad de un algoritmo</strong>. El condicionamiento tiene que ver con el comportamiento de un problema ante perturbaciones y la estabilidad con el comportamiento de un algoritmo (usado para resolver un problema) ante perturbaciones.</p>
<p>La exactitud de un cálculo dependerá finalmente de una combinación de estos términos:</p>
<p style="text-align: center;">Exactitud = Condición + Estabilidad</p>
<p>La falta de exactitud en un problema se presenta entonces por problemas mal condicionados (no importando si los algoritmos son estables o inestables) y algoritmos inestables (no importando si los problemas son mal o bien condicionados).</p>
<div class="section" id="condicion-de-un-problema-y-estabilidad-de-un-algoritmo">
<span id="cpea"></span><h2>1.4 Condición de un problema y estabilidad de un algoritmo<a class="headerlink" href="#condicion-de-un-problema-y-estabilidad-de-un-algoritmo" title="Permalink to this headline">¶</a></h2>
<div class="section" id="perturbaciones">
<h3>Perturbaciones<a class="headerlink" href="#perturbaciones" title="Permalink to this headline">¶</a></h3>
<p>La condición de un problema y estabilidad de un algoritmo hacen referencia al término <strong>perturbación</strong>. Tal término conduce a pensar en perturbaciones “chicas” o “grandes”. Para dar una medida de lo anterior se utiliza el concepto de <strong>norma</strong>. Ver final de esta nota para definición de norma y propiedades.</p>
</div>
<div class="section" id="condicion-de-un-problema">
<h3>Condición de un problema<a class="headerlink" href="#condicion-de-un-problema" title="Permalink to this headline">¶</a></h3>
<p>Pensemos a un problema como una función <span class="math notranslate nohighlight">\(f: \mathbb{X} \rightarrow \mathbb{Y}\)</span> donde <span class="math notranslate nohighlight">\(\mathbb{X}\)</span> es un espacio vectorial con norma definida y <span class="math notranslate nohighlight">\(\mathbb{Y}\)</span> es otro espacio vectorial de soluciones con una norma definida. Llamemos instancia de un problema a la combinación entre <span class="math notranslate nohighlight">\(x,f\)</span> y nos interesa el comportamiento de <span class="math notranslate nohighlight">\(f\)</span> en <span class="math notranslate nohighlight">\(x\)</span>. Usamos el nombre de “problema” para referirnos al de instancia del problema.</p>
<p>Un problema (instancia) bien condicionado tiene la propiedad de que todas las perturbaciones pequeñas en <span class="math notranslate nohighlight">\(x\)</span> conducen a pequeños cambios en <span class="math notranslate nohighlight">\(f(x)\)</span>. Y es mal condicionado si perturbaciones pequeñas en <span class="math notranslate nohighlight">\(x\)</span> conducen a grandes cambios en <span class="math notranslate nohighlight">\(f(x)\)</span>. El uso de los términos “pequeño” o “grande” dependen del problema mismo.</p>
<p>Sea <span class="math notranslate nohighlight">\(\hat{x} = x + \Delta x\)</span> con <span class="math notranslate nohighlight">\(\Delta x\)</span> una perturbación pequeña de <span class="math notranslate nohighlight">\(x\)</span>.</p>
<p>El <strong>número de condición relativo del problema <span class="math notranslate nohighlight">\(f\)</span> en <span class="math notranslate nohighlight">\(x\)</span></strong> es:</p>
<div class="math notranslate nohighlight">
\[\text{Cond}_f^R = \frac{\text{ErrRel}(f(\hat{x}))}{\text{ErrRel}(\hat{x})}  = \frac{\frac{||f(\hat{x})-f(x)||}{||f(x)||}}{\frac{||x-\hat{x}||}{||x||}}\]</div>
<p>considerando <span class="math notranslate nohighlight">\(x,f(x) \neq 0\)</span>.</p>
<p><strong>Obs:</strong> si <span class="math notranslate nohighlight">\(f\)</span> es una función diferenciable, podemos evaluar <span class="math notranslate nohighlight">\(\text{Cond}_f^R\)</span> con la derivada de <span class="math notranslate nohighlight">\(f\)</span>, pues a primer orden (usando teorema de Taylor): <span class="math notranslate nohighlight">\(f(\hat{x})-f(x) \approx \mathcal{J}_f(x)\Delta x\)</span> con igualdad para <span class="math notranslate nohighlight">\(\Delta x \rightarrow 0\)</span> y <span class="math notranslate nohighlight">\(\mathcal{J}_f\)</span> la Jacobiana de <span class="math notranslate nohighlight">\(f\)</span> definida como una matriz con entradas: <span class="math notranslate nohighlight">\((\mathcal{J}_f(x))_{ij} = \frac{\partial f_i(x)}{\partial x_j}\)</span>. Por tanto, se tiene:</p>
<div class="math notranslate nohighlight">
\[\text{Cond}_{f}^R = \frac{||\mathcal{J}_f(x)||||x||}{||f(x)||}\]</div>
<p>y <span class="math notranslate nohighlight">\(||\mathcal{J}_f(x)||\)</span> es una norma matricial inducida por las normas en <span class="math notranslate nohighlight">\(\mathbb{X}, \mathbb{Y}\)</span>. Ver final de esta nota para definición de norma y propiedades.</p>
<p><strong>Comentario:</strong> en la práctica se considera a un problema <strong>bien condicionado</strong> si <span class="math notranslate nohighlight">\(\text{Cond}_f^R\)</span> es “pequeño”: menor a <span class="math notranslate nohighlight">\(10\)</span>, <strong>medianamente condicionado</strong> si es de orden entre <span class="math notranslate nohighlight">\(10^1\)</span> y <span class="math notranslate nohighlight">\(10^2\)</span> y <strong>mal condicionado</strong> si es “grande”: mayor a <span class="math notranslate nohighlight">\(10^3\)</span>.</p>
<p><strong>Ejercicio:</strong></p>
<p>Calcular <span class="math notranslate nohighlight">\(\text{Cond}_f^R\)</span> de los siguientes problemas. Para <span class="math notranslate nohighlight">\(x \in \mathbb{R}\)</span> usa el valor absoluto y para <span class="math notranslate nohighlight">\(x \in \mathbb{R}^n\)</span> usa <span class="math notranslate nohighlight">\(||x||_\infty\)</span>.</p>
<ol class="simple">
<li><p><span class="math notranslate nohighlight">\(x \in \mathbb{R} - \{0\}\)</span>. Problema: realizar la operación <span class="math notranslate nohighlight">\(\frac{x}{2}\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(x \geq 0\)</span>. Problema: calcular <span class="math notranslate nohighlight">\(\sqrt{x}\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(x \approx \frac{\pi}{2}\)</span>. Problema: calcular <span class="math notranslate nohighlight">\(\cos(x)\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(x \in \mathbb{R}^2\)</span>. Problema: calcular <span class="math notranslate nohighlight">\(x_1-x_2\)</span>.</p></li>
</ol>
<p><strong>Comentario:</strong> las dificultades que pueden surgir al resolver un problema <strong>no</strong> siempre están relacionadas con una fórmula o un algoritmo mal diseñado sino con el problema en cuestión. En el ejercicio anterior, observamos que áun utilizando <strong>aritmética exacta</strong>, la solución del problema puede ser altamente sensible a perturbaciones a los datos de entrada. Por esto el número de condición relativo se define de acuerdo a perturbaciones en los datos de entrada y mide la perturbación en los datos de salida que uno espera:</p>
<div class="math notranslate nohighlight">
\[\text{Cond}_f^R = \frac{||\text{Cambios relativos en la solución}||}{||\text{Cambios relativos en los datos de entrada}||}.\]</div>
</div>
<div class="section" id="estabilidad-de-un-algoritmo">
<h3>Estabilidad de un algoritmo<a class="headerlink" href="#estabilidad-de-un-algoritmo" title="Permalink to this headline">¶</a></h3>
<p>Pensemos a un algoritmo <span class="math notranslate nohighlight">\(\hat{f}\)</span> como una función <span class="math notranslate nohighlight">\(\hat{f}:\mathbb{X}\rightarrow \mathbb{Y}\)</span> para resolver el problema <span class="math notranslate nohighlight">\(f\)</span> con datos <span class="math notranslate nohighlight">\(x \in \mathbb{X}\)</span>, donde <span class="math notranslate nohighlight">\(\mathbb{X}\)</span> es un espacio vectorial con norma definida y <span class="math notranslate nohighlight">\(\mathbb{Y}\)</span> es otro espacio vectorial con una norma definida.</p>
<p>La implementación del algoritmo <span class="math notranslate nohighlight">\(\hat{f}\)</span> en una máquina conduce a considerar:</p>
<ul class="simple">
<li><p>Errores por redondeo:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[fl(u) = u(1+\epsilon), |\epsilon| \leq \epsilon_{maq}, \forall u \in \mathbb{R}.\]</div>
<ul class="simple">
<li><p>Operaciones en un SPFN, <span class="math notranslate nohighlight">\(\mathcal{Fl}\)</span>. Por ejemplo para la suma:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[u \oplus v  = fl(u+v) = (u + v)(1+\epsilon), |\epsilon|\leq \epsilon_{maq} \forall u,v \in \mathcal{Fl}.\]</div>
<p>Esto es, <span class="math notranslate nohighlight">\(\hat{f}\)</span> depende de <span class="math notranslate nohighlight">\(x \in \mathbb{X}\)</span> y <span class="math notranslate nohighlight">\(\epsilon_{maq}\)</span>: representación de los números reales en una máquina y operaciones entre ellos o aritmética de máquina. Ver nota: <a class="reference internal" href="README.html#spf"><span class="std std-ref">Sistema de punto flotante</span></a>.</p>
<p>Al ejecutar <span class="math notranslate nohighlight">\(\hat{f}\)</span> obtenemos una colección de números en el SPFN que pertenecen a <span class="math notranslate nohighlight">\(\mathbb{Y}\)</span>: <span class="math notranslate nohighlight">\(\hat{f}(x)\)</span>.</p>
<p>Debido a las diferencias entre un problema con cantidades continuas y una máquina que trabaja con cantidades discretas, los algoritmos numéricos <strong>no</strong> son exactos para <strong>cualquier</strong> elección de datos <span class="math notranslate nohighlight">\(x \in \mathbb{X}\)</span>. Esto es, los algoritmos <strong>no</strong> cumplen que la cantidad:</p>
<div class="math notranslate nohighlight">
\[\frac{||\hat{f}(x)-f(x)||}{||f(x)||}\]</div>
<p>dependa únicamente de errores por redondeo al evaluar <span class="math notranslate nohighlight">\(f\)</span> <span class="math notranslate nohighlight">\(\forall x \in \mathbb{X}\)</span>. En notación matemática:</p>
<div class="math notranslate nohighlight">
\[\frac{||\hat{f}(x)-f(x)||}{||f(x)||} \leq K \epsilon_{maq} \forall x \in \mathbb{X}\]</div>
<p>con <span class="math notranslate nohighlight">\(K &gt; 0\)</span> no se cumple en general.</p>
<p>La razón de lo anterior tiene que ver con cuestiones en la implementación de <span class="math notranslate nohighlight">\(\hat{f}\)</span> como el número de iteraciones, la representación de <span class="math notranslate nohighlight">\(x\)</span> en un SPFN o el mal condicionamiento de <span class="math notranslate nohighlight">\(f\)</span>. Así, a los algoritmos en el análisis numérico, se les pide una condición menos estricta que la anterior y más bien satisfagan lo que se conoce como <strong>estabilidad</strong>. Se dice que un algoritmo <span class="math notranslate nohighlight">\(\hat{f}\)</span> para un problema <span class="math notranslate nohighlight">\(f\)</span> es <strong>estable</strong> si:</p>
<div class="math notranslate nohighlight">
\[\forall x \in \mathbb{X}, \frac{||\hat{f}(x)-f(\hat{x})||}{||f(\hat{x})||} \leq K_1\epsilon_{maq}, K_1&gt;0\]</div>
<p>para <span class="math notranslate nohighlight">\(\hat{x} \in \mathbb{X}\)</span> tal que <span class="math notranslate nohighlight">\(\frac{||x-\hat{x}||}{||x||} \leq K_2\epsilon_{maq}, K_2&gt;0\)</span>.</p>
<p>Esto es, <span class="math notranslate nohighlight">\(\hat{f}\)</span> resuelve un problema cercano para datos cercanos (cercano en el sentido del <span class="math notranslate nohighlight">\(\epsilon_{maq}\)</span>) independientemente de la elección de <span class="math notranslate nohighlight">\(x\)</span>.</p>
<p><strong>Obs:</strong> obsérvese que esta condición es más flexible y en general <span class="math notranslate nohighlight">\(K_1, K_2\)</span> dependen de las dimensiones de <span class="math notranslate nohighlight">\(\mathbb{X},\mathbb{Y}\)</span>.</p>
<p><strong>Comentarios:</strong></p>
<ul class="simple">
<li><p>Esta definición resulta apropiada para la mayoría de los problemas en el ánalisis numérico. Para otras áreas, por ejemplo en ecuaciones diferenciales, donde se tienen definiciones de sistemas dinámicos estables e inestables (cuyas definiciones no se deben confundir con las descritas para algoritmos), esta condición es muy estricta.</p></li>
<li><p>Tenemos algoritmos que satisfacen una condición más estricta y simple que la estabilidad: <strong>estabilidad hacia atrás</strong>:</p></li>
</ul>
<div class="section" id="estabilidad-hacia-atras">
<h4>Estabilidad hacia atrás<a class="headerlink" href="#estabilidad-hacia-atras" title="Permalink to this headline">¶</a></h4>
<p>Decimos que un algoritmo <span class="math notranslate nohighlight">\(\hat{f}\)</span> para el problema <span class="math notranslate nohighlight">\(f\)</span> es <strong>estable hacia atrás</strong> si:</p>
<div class="math notranslate nohighlight">
\[\forall x \in \mathbb{X}, \hat{f}(x) = f(\hat{x})\]</div>
<p>con <span class="math notranslate nohighlight">\(\hat{x} \in \mathbb{X}\)</span> tal que <span class="math notranslate nohighlight">\(\frac{||x-\hat{x}||}{||x||} \leq K\epsilon_{maq}, K&gt;0\)</span>.</p>
<p>Esto es, el algoritmo <span class="math notranslate nohighlight">\(\hat{f}\)</span> da la solución <strong>exacta</strong> para datos cercanos (cercano en el sentido de <span class="math notranslate nohighlight">\(\epsilon_{maq}\)</span>), independientemente de la elección de <span class="math notranslate nohighlight">\(x\)</span>.</p>
<p><strong>Ejemplo:</strong> Para entender la estabilidad hacia atrás de un algoritmo, considérese el ejemplo siguiente.</p>
<p><strong>Problema:</strong> evaluar <span class="math notranslate nohighlight">\(f(x) = e^x\)</span> en <span class="math notranslate nohighlight">\(x=1\)</span>.</p>
<p><strong>Resultado:</strong> <span class="math notranslate nohighlight">\(f(1) = e^1 = 2.718281...\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">math</span>
<span class="n">x</span><span class="o">=</span><span class="mi">1</span>
<span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p><strong>Algoritmo:</strong> truncar la serie $1 + x + \frac{x^2}{2} + \frac{x^3}{6} + \dots $ a cuatro términos: <span class="math notranslate nohighlight">\(\hat{f}(x) = 1 + x + \frac{x^2}{2} + \frac{x^3}{6}\)</span>.</p>
<p><strong>Resultado del algoritmo:</strong> <span class="math notranslate nohighlight">\(\hat{f}(1) = 2.\bar{6}\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">algoritmo</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mf">2.0</span> <span class="o">+</span> <span class="n">x</span><span class="o">**</span><span class="mi">3</span><span class="o">/</span><span class="mf">6.0</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">algoritmo</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p><strong>Pregunta:</strong> ¿Qué valor <span class="math notranslate nohighlight">\(\hat{x} \in \mathbb{R}\)</span> hace que el valor calculado por el algoritmo <span class="math notranslate nohighlight">\(\hat{f}(1)\)</span> sea igual a <span class="math notranslate nohighlight">\(f(\hat{x})\)</span>?</p>
<p>-&gt; <strong>Solución:</strong></p>
<p>Resolver la ecuación: <span class="math notranslate nohighlight">\(e^{\hat{x}} = 2.\bar{6}\)</span>, esto es: <span class="math notranslate nohighlight">\(\hat{x} = log(2.\bar{6}) = 0.980829...\)</span>. Entonces <span class="math notranslate nohighlight">\(f(\hat{x}) = 2.\bar{6} = \hat{f}(x)\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x_hat</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">algoritmo</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="n">x_hat</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p>Entonces, el algoritmo es estable hacia atrás sólo si la diferencia entre <span class="math notranslate nohighlight">\(x\)</span> y <span class="math notranslate nohighlight">\(\hat{x}\)</span> en términos relativos es menor a <span class="math notranslate nohighlight">\(K \epsilon_{maq}\)</span> con <span class="math notranslate nohighlight">\(K &gt;0\)</span>. Además, podemos calcular <strong>errores hacia delante</strong> y <strong>errores hacia atrás</strong>:</p>
<p>error hacia delante: <span class="math notranslate nohighlight">\(\hat{f}(x) - f(x) = -0.05161...\)</span>, error hacia atrás: <span class="math notranslate nohighlight">\(\hat{x}-x = -0.01917...\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">err_delante</span> <span class="o">=</span> <span class="n">algoritmo</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">err_delante</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">err_atras</span> <span class="o">=</span> <span class="n">x_hat</span><span class="o">-</span><span class="n">x</span>
<span class="n">err_atras</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p>Dependiendo del problema, estos errores son pequeños o grandes, por ejemplo si consideramos tener una cifra correcta como suficiente para determinar que es una buena aproximación entonces podemos concluir: <span class="math notranslate nohighlight">\(\hat{f}\)</span> obtiene una respuesta correcta y cercana al valor de <span class="math notranslate nohighlight">\(f\)</span> (error hacia delante) y la respuesta que obtuvimos con <span class="math notranslate nohighlight">\(\hat{f}\)</span> es correcta para datos ligeramente perturbados (error hacia atrás).</p>
<p><strong>Obs:</strong></p>
<ul class="simple">
<li><p>Obsérvese que el error hacia delante requiere resolver el problema <span class="math notranslate nohighlight">\(f\)</span> (para calcular <span class="math notranslate nohighlight">\(f(x)\)</span>) y también información sobre <span class="math notranslate nohighlight">\(f\)</span>.</p></li>
<li><p>En el ejemplo anterior se calcularon <span class="math notranslate nohighlight">\(\hat{f}(x)\)</span> y también qué tan larga debe ser la modificación en los datos <span class="math notranslate nohighlight">\(x\)</span>, esto es: <span class="math notranslate nohighlight">\(\hat{x}\)</span>, para que <span class="math notranslate nohighlight">\(\hat{f}(x) = f(\hat{x})\)</span> (error hacia atrás).</p></li>
</ul>
<ul class="simple">
<li><p>Dibujo que ayuda a ver errores hacia atrás y hacia delante:</p></li>
</ul>
<img src="https://dl.dropboxusercontent.com/s/b30awajxvl3u8qe/error_hacia_delante_hacia_atras.png?dl=0" heigth="500" width="500"><p>En resumen, algunas características de un método <strong>estable</strong> numéricamente respecto al redondeo son:</p>
<ul class="simple">
<li><p>Variaciones “pequeñas” en los datos de entrada del método generan variaciones “pequeñas” en la solución del problema.</p></li>
<li><p>No amplifican errores de redondeo en los cálculos involucrados.</p></li>
<li><p>Resuelven problemas “cercanos” para datos ligeramente modificados.</p></li>
</ul>
</div>
</div>
<div class="section" id="numero-de-condicion-de-una-matriz">
<h3>Número de condición de una matriz<a class="headerlink" href="#numero-de-condicion-de-una-matriz" title="Permalink to this headline">¶</a></h3>
<p>En el curso trabajaremos con algoritmos matriciales que son numéricamente estables (o estables hacia atrás) ante errores por redondeo, sin embargo la exactitud que obtengamos con tales algoritmos dependerán de qué tan bien (o mal) condicionado esté el problema. En el caso de matrices la condición de un problema puede ser cuantificada con el <strong>número de condición</strong> de la matriz del problema. Aunque haciendo uso de definiciones como la pseudoinversa de una matriz es posible definir el número de condición para una matriz en general rectangular <span class="math notranslate nohighlight">\(A \in \mathbb{R}^{m\times n}\)</span>, en esta primera definición consideramos matrices cuadradas no singulares <span class="math notranslate nohighlight">\(A \in \mathbb{R}^{n\times n}\)</span>:</p>
<div class="math notranslate nohighlight">
\[\text{cond}(A) = ||A|| ||A^{-1}||.\]</div>
<p><strong>Obs:</strong> obsérvese que la norma anterior es una <strong>norma matricial</strong> y cond<span class="math notranslate nohighlight">\((\cdot)\)</span> puede calcularse para diferentes normas matriciales. Ver final de esta nota para definición de norma y propiedades.</p>
</div>
<div class="section" id="por-que-se-utiliza-la-expresion-a-a-1-para-definir-el-numero-de-condicion-de-una-matriz">
<h3>¿Por qué se utiliza la expresión <span class="math notranslate nohighlight">\(||A|| ||A^{-1}||\)</span> para definir el número de condición de una matriz?<a class="headerlink" href="#por-que-se-utiliza-la-expresion-a-a-1-para-definir-el-numero-de-condicion-de-una-matriz" title="Permalink to this headline">¶</a></h3>
<p>Esta pregunta tiene que ver con el hecho que tal expresión aparece frecuentemente en problemas típicos de matrices. Para lo anterior considérese los siguientes problemas <span class="math notranslate nohighlight">\(f\)</span>:</p>
<p>1.Sean <span class="math notranslate nohighlight">\(A \in \mathbb{R}^{n\times n}\)</span> no singular, <span class="math notranslate nohighlight">\(x \in \mathbb{R}^n\)</span> y <span class="math notranslate nohighlight">\(f\)</span> el problema de realizar la multiplicación <span class="math notranslate nohighlight">\(Ax\)</span> para <span class="math notranslate nohighlight">\(x\)</span> fijo, esto es: <span class="math notranslate nohighlight">\(f: \mathbb{R}^n \rightarrow \mathbb{R}^n\)</span> dada por <span class="math notranslate nohighlight">\(f(x) = Ax\)</span>. Considérese una perturbación en <span class="math notranslate nohighlight">\(x: \hat{x} = x + \Delta x\)</span>, entonces:</p>
<div class="math notranslate nohighlight">
\[\text{Cond}_f^R = \frac{\text{ErrRel}(f(\hat{x}))}{\text{ErrRel}(\hat{x})} = \frac{\frac{||f(\hat{x})-f(x)||}{||f(x)||}}{\frac{||x-\hat{x}||}{||x||}} \approx \frac{||\mathcal{J}_f(x)||||x||}{||f(x)||}.\]</div>
<p>Para este problema tenemos:</p>
<div class="math notranslate nohighlight">
\[\frac{||\mathcal{J}_f(x)||||x||}{||f(x)||} = \frac{||A|| ||x||}{||Ax||}.\]</div>
<p>Si las normas matriciales utilizadas en el número de condición son consistentes (ver final de esta nota para definición de norma y propiedades) entonces:</p>
<div class="math notranslate nohighlight">
\[||x|| = ||A^{-1}Ax|| \leq ||A^{-1}||||Ax|| \therefore \frac{||x||}{||Ax||} \leq ||A^{-1}||\]</div>
<p>y se tiene:</p>
<div class="math notranslate nohighlight">
\[\text{Cond}_f^R \leq ||A|| ||A^{-1}||.\]</div>
<p>2.Sean <span class="math notranslate nohighlight">\(f: \mathbb{R}^n \rightarrow \mathbb{R}, A \in \mathbb{R}^{n\times n}\)</span> no singular. Considérese el problema de calcular <span class="math notranslate nohighlight">\(f(b) = A^{-1}b\)</span> para <span class="math notranslate nohighlight">\(b \in \mathbb{R}^n\)</span> fijo y la perturbación <span class="math notranslate nohighlight">\(\hat{b} = b + \Delta b\)</span> entonces bajo las suposiciones del ejemplo anterior:</p>
<div class="math notranslate nohighlight">
\[\text{Cond}_f^R \approx \frac{||A^{-1}|| ||b||}{||A^{-1}b||}.\]</div>
<p>Si las normas matriciales utilizadas en el número de condición son consistentes (ver final de esta nota para definición de norma y propiedades) entonces:</p>
<div class="math notranslate nohighlight">
\[||b|| = ||AA^{-1}b|| \leq ||A|| ||A^{-1}b|| \therefore \text{Cond}_f^R \leq ||A^{-1}|| ||A||.\]</div>
<p>3.Sean <span class="math notranslate nohighlight">\(f: \mathbb{R}^{n\times n} \rightarrow \mathbb{R}^n, A \in \mathbb{R}^{n\times n}\)</span> no singular <span class="math notranslate nohighlight">\(b \in \mathbb{R}^n\)</span> fijo. Considérese el problema de calcular la solución <span class="math notranslate nohighlight">\(x\)</span> del sistema <span class="math notranslate nohighlight">\(Az=b\)</span>, esto es, calcular: <span class="math notranslate nohighlight">\(x = f(A) = A^{-1}b.\)</span> Además, considérese la perturbación <span class="math notranslate nohighlight">\(\hat{A} = A + \Delta A\)</span> en el sistema <span class="math notranslate nohighlight">\(Az = b\)</span>. Se tiene:</p>
<div class="math notranslate nohighlight">
\[\hat{x} = \hat{A}^{-1}b,\]</div>
<p>donde: <span class="math notranslate nohighlight">\(\hat{x} = x + \Delta x\)</span> (si se perturba <span class="math notranslate nohighlight">\(A\)</span> entonces se perturba también <span class="math notranslate nohighlight">\(x\)</span>).</p>
<p>De la ecuación anterior como <span class="math notranslate nohighlight">\(\hat{x} = \hat{A}^{-1}b\)</span> se tiene:</p>
<div class="math notranslate nohighlight">
\[\hat{A}\hat{x} = b\]</div>
<div class="math notranslate nohighlight">
\[(A+\Delta A)(x+\Delta x) = b\]</div>
<div class="math notranslate nohighlight">
\[Ax + A \Delta x + \Delta Ax + \Delta A \Delta x = b\]</div>
<div class="math notranslate nohighlight">
\[b + A \Delta x + \Delta A x = b\]</div>
<p>Donde en esta última ecuación se supuso que <span class="math notranslate nohighlight">\(\Delta A \Delta x \approx 0\)</span> y de aquí:</p>
<div class="math notranslate nohighlight">
\[A \Delta x + \Delta A x  \approx 0 \therefore \Delta x \approx - A^{-1} \Delta A x.\]</div>
<p>Entonces se tiene que la condición del problema <span class="math notranslate nohighlight">\(f\)</span>: calcular la solución de sistema de ecuaciones lineales <span class="math notranslate nohighlight">\(Az=b\)</span> con <span class="math notranslate nohighlight">\(A\)</span> no singular ante perturbaciones en <span class="math notranslate nohighlight">\(A\)</span> es:</p>
<div class="math notranslate nohighlight">
\[\text{Cond}_f^R = \frac{\frac{||x-\hat{x}||}{||x||}}{\frac{||A-\hat{A}||}{||A||}}=\frac{\frac{||\Delta x||}{||x||}}{\frac{||\Delta A||}{||A||}} \leq \frac{\frac{||A^{-1}||||\Delta Ax||}{||x||}}{\frac{||\Delta A||}{||A||}} \leq ||A^{-1}||||A||.\]</div>
</div>
<div class="section" id="que-esta-midiendo-el-numero-de-condicion-de-una-matriz-respecto-a-un-sistema-de-ecuaciones-lineales">
<h3>¿Qué está midiendo el número de condición de una matriz respecto a un sistema de ecuaciones lineales?<a class="headerlink" href="#que-esta-midiendo-el-numero-de-condicion-de-una-matriz-respecto-a-un-sistema-de-ecuaciones-lineales" title="Permalink to this headline">¶</a></h3>
<p>El número de condición de una matriz mide la <strong>sensibilidad</strong> de la solución de un sistema de ecuaciones lineales ante perturbaciones en los datos de entrada (en la matriz del sistema <span class="math notranslate nohighlight">\(A\)</span> o en el lado derecho <span class="math notranslate nohighlight">\(b\)</span>). Si pequeños cambios en los datos de entrada generan grandes cambios en la solución tenemos un <strong>sistema mal condicionado</strong>. Si pequeños cambios en los datos de entrada generan pequeños cambios en la solución tenemos un sistema <strong>bien condicionado</strong>. Lo anterior puede apreciarse con los siguientes ejemplos y gráficas:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">scipy</span>
<span class="kn">import</span> <span class="nn">pprint</span>
</pre></div>
</div>
</div>
</div>
<p>1.Resolver los siguientes sistemas:</p>
<div class="math notranslate nohighlight">
\[\begin{split}a) \begin{array}{ccc} x_1 +2x_2   &amp;= &amp; 10 \\ 1.1x_1 + 2x_2 &amp;= &amp; 10.4 \end{array} \end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}b)\begin{array}{ccc} 1.05x_1 +2x_2  &amp;= &amp; 10 \\ 1.1x_1 + 2x_2 &amp;= &amp; 10.4\end{array} \end{split}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;inciso a&#39;</span><span class="p">)</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span><span class="mf">10.4</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;matriz A:&#39;</span><span class="p">)</span>
<span class="n">pprint</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;lado derecho b:&#39;</span><span class="p">)</span>
<span class="n">pprint</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>inciso a
matriz A:
array([[1. , 2. ],
       [1.1, 2. ]])
lado derecho b:
array([10. , 10.4])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">b</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;solución x:&#39;</span><span class="p">)</span>
<span class="n">pprint</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>solución x:
array([4., 3.])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="o">.</span><span class="mi">5</span><span class="p">)</span>
<span class="n">recta1</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="mf">2.0</span><span class="o">*</span><span class="p">(</span><span class="mi">10</span><span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
<span class="n">recta2</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="mf">2.0</span><span class="o">*</span><span class="p">(</span><span class="mf">10.4</span><span class="o">-</span><span class="mf">1.1</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">recta1</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="s1">&#39;o-&#39;</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">recta2</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="s1">&#39;^-&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Sistema mal condicionado&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">((</span><span class="s1">&#39;x1+2x2=10&#39;</span><span class="p">,</span><span class="s1">&#39;1.1x1+2x2=10.4&#39;</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p><strong>Obs:</strong> obsérvese que las dos rectas anteriores tienen una inclinación (pendiente) similar por lo que no se ve claramente el punto en el que intersectan.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;inciso b&#39;</span><span class="p">)</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.05</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span><span class="mf">10.4</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;matriz A ligeramente modificada:&#39;</span><span class="p">)</span>
<span class="n">pprint</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;lado derecho b:&#39;</span><span class="p">)</span>
<span class="n">pprint</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>inciso b
matriz A ligeramente modificada:
array([[1.05, 2.  ],
       [1.1 , 2.  ]])
lado derecho b:
array([10. , 10.4])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">b</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;solución x:&#39;</span><span class="p">)</span>
<span class="n">pprint</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>solución x:
array([8. , 0.8])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="o">.</span><span class="mi">5</span><span class="p">)</span>
<span class="n">recta1</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="mf">2.0</span><span class="o">*</span><span class="p">(</span><span class="mi">10</span><span class="o">-</span><span class="mf">1.05</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
<span class="n">recta2</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="mf">2.0</span><span class="o">*</span><span class="p">(</span><span class="mf">10.4</span><span class="o">-</span><span class="mf">1.1</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">recta1</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="s1">&#39;o-&#39;</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">recta2</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="s1">&#39;^-&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Sistema mal condicionado&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">((</span><span class="s1">&#39;1.05x1+2x2=10&#39;</span><span class="p">,</span><span class="s1">&#39;1.1x1+2x2=10.4&#39;</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p><strong>Obs:</strong> al modificar un poco las entradas de la matriz <span class="math notranslate nohighlight">\(A\)</span> la solución del sistema cambia drásticamente.</p>
<p><strong>Comentario:</strong> otra forma de describir a un sistema mal condicionado es que un amplio rango de valores en un SPFN satisfacen tal sistema de forma aproximada.</p>
<p>2.Resolver los siguientes sistemas:</p>
<div class="math notranslate nohighlight">
\[\begin{split}a) \begin{array}{ccc} .03x_1 + 58.9x_2   &amp;= &amp; 59.2 \\ 5.31x_1 -6.1x_2 &amp;= &amp; 47 \end{array} \end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}a) \begin{array}{ccc} .03x_1 + 58.9x_2   &amp;= &amp; 59.2 \\ 5.31x_1 -6.05x_2 &amp;= &amp; 47 \end{array} \end{split}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;inciso a&#39;</span><span class="p">)</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="o">.</span><span class="mi">03</span><span class="p">,</span> <span class="mf">58.9</span><span class="p">],</span> <span class="p">[</span><span class="mf">5.31</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.1</span><span class="p">]])</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">59.2</span><span class="p">,</span><span class="mi">47</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;matriz A:&#39;</span><span class="p">)</span>
<span class="n">pprint</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;lado derecho b:&#39;</span><span class="p">)</span>
<span class="n">pprint</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>inciso a
matriz A:
array([[ 3.00e-02,  5.89e+01],
       [ 5.31e+00, -6.10e+00]])
lado derecho b:
array([59.2, 47. ])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">b</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;solución x:&#39;</span><span class="p">)</span>
<span class="n">pprint</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>solución x:
array([10.,  1.])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span><span class="o">.</span><span class="mi">5</span><span class="p">)</span>
<span class="n">recta1</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="mf">58.9</span><span class="o">*</span><span class="p">(</span><span class="mf">59.2</span><span class="o">-.</span><span class="mi">03</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
<span class="n">recta2</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="mf">6.1</span><span class="o">*</span><span class="p">(</span><span class="mf">5.31</span><span class="o">*</span><span class="n">x</span><span class="o">-</span><span class="mi">47</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">recta1</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="s1">&#39;o-&#39;</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">recta2</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="s1">&#39;^-&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Sistema bien condicionado&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">((</span><span class="s1">&#39;.03x1+58.9x2=59.2&#39;</span><span class="p">,</span><span class="s1">&#39;5.31x1-6.1x2=47&#39;</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p><strong>Obs:</strong> obsérvese que la solución del sistema de ecuaciones (intersección entre las dos rectas) está claramente definido.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;inciso b&#39;</span><span class="p">)</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="o">.</span><span class="mi">03</span><span class="p">,</span> <span class="mf">58.9</span><span class="p">],</span> <span class="p">[</span><span class="mf">5.31</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.05</span><span class="p">]])</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">59.2</span><span class="p">,</span><span class="mi">47</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;matriz A ligeramente modificada:&#39;</span><span class="p">)</span>
<span class="n">pprint</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;lado derecho b:&#39;</span><span class="p">)</span>
<span class="n">pprint</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>inciso b
matriz A ligeramente modificada:
array([[ 3.00e-02,  5.89e+01],
       [ 5.31e+00, -6.05e+00]])
lado derecho b:
array([59.2, 47. ])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">b</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;solución x:&#39;</span><span class="p">)</span>
<span class="n">pprint</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>solución x:
array([9.99058927, 1.00000479])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span><span class="o">.</span><span class="mi">5</span><span class="p">)</span>
<span class="n">recta1</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="mf">58.9</span><span class="o">*</span><span class="p">(</span><span class="mf">59.2</span><span class="o">-.</span><span class="mi">03</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
<span class="n">recta2</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="mf">6.05</span><span class="o">*</span><span class="p">(</span><span class="mf">5.31</span><span class="o">*</span><span class="n">x</span><span class="o">-</span><span class="mi">47</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">recta1</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="s1">&#39;o-&#39;</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">recta2</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="s1">&#39;^-&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Sistema bien condicionado&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">((</span><span class="s1">&#39;.03x1+58.9x2=59.2&#39;</span><span class="p">,</span><span class="s1">&#39;5.31x1-6.05x2=47&#39;</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p><strong>Obs:</strong> al modificar un poco las entradas de la matriz <span class="math notranslate nohighlight">\(A\)</span> la solución <strong>no</strong> cambia mucho.</p>
<p><strong>Comentarios:</strong></p>
<p>1.¿Por qué nos interesa considerar perturbaciones en los datos de entrada? -&gt; recuérdese que los números reales se representan en la máquina mediante el sistema de punto flotante (SPF), entonces al ingresar datos a la máquina tenemos perturbaciones y por tanto errores de redondeo. Ver nota: <a class="reference internal" href="README.html#spf"><span class="std std-ref">Sistema de punto flotante</span></a>.</p>
<p>2.Las matrices anteriores tienen número de condición distinto:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;matriz del ejemplo 1&#39;</span><span class="p">)</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>
<span class="n">pprint</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>matriz del ejemplo 1
array([[1. , 2. ],
       [1.1, 2. ]])
</pre></div>
</div>
</div>
</div>
<p>su número de condición es:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">cond</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;matriz del ejemplo 2&#39;</span><span class="p">)</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="o">.</span><span class="mi">03</span><span class="p">,</span> <span class="mf">58.9</span><span class="p">],</span> <span class="p">[</span><span class="mf">5.31</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.1</span><span class="p">]])</span>
<span class="n">pprint</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>matriz del ejemplo 2
array([[ 3.00e-02,  5.89e+01],
       [ 5.31e+00, -6.10e+00]])
</pre></div>
</div>
</div>
</div>
<p>su número de condición es:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">cond</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p>Las matrices del ejemplo <span class="math notranslate nohighlight">\(1\)</span> y <span class="math notranslate nohighlight">\(2\)</span> son <strong>medianamente</strong> condicionadas. Una matriz se dice <strong>bien condicionada</strong> si cond<span class="math notranslate nohighlight">\((A)\)</span> es cercano a <span class="math notranslate nohighlight">\(1\)</span>.</p>
</div>
<div class="section" id="algunas-propiedades-del-numero-de-condicion-de-una-matriz">
<h3>Algunas propiedades del número de condición de una matriz<a class="headerlink" href="#algunas-propiedades-del-numero-de-condicion-de-una-matriz" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Si <span class="math notranslate nohighlight">\(A \in \mathbb{R}^{n\times n}\)</span> es no singular entonces:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\frac{1}{\text{cond}(A)} = \min \left\{ \frac{||A-B||}{||A||} \text{tal que} B \text{ es singular}, ||\cdot|| \text{ es una norma inducida} \right\}.\]</div>
<p>esto es, una matriz mal condicionada (número de condición grande) se le puede aproximar muy bien por una matriz singular. Sin embargo, el mal condicionamiento no necesariamente se relaciona con singularidad. Una matriz singular es mal condicionada pero una matriz mal condicionada no necesariamente es singular. Considérese por ejemplo la matriz de <strong>Hilbert</strong>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.linalg</span> <span class="kn">import</span> <span class="n">hilbert</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">hilbert</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">cond</span><span class="p">(</span><span class="n">hilbert</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p>la cual es una matriz mal condicionada pero es no singular:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">hilbert</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="nd">@hilbert</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p>y otro ejemplo de una matriz singular:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;matriz singular&#39;</span><span class="p">)</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>
<span class="n">pprint</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>matriz singular
array([[1, 2],
       [1, 2]])
</pre></div>
</div>
</div>
</div>
<div class="cell tag_raises-exception docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">LinAlgError</span><span class="g g-Whitespace">                               </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">29</span><span class="o">-</span><span class="n">ae645f97e1f8</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>

<span class="nn">&lt;__array_function__ internals&gt;</span> in <span class="ni">inv</span><span class="nt">(*args, **kwargs)</span>

<span class="nn">~/.local/lib/python3.7/site-packages/numpy/linalg/linalg.py</span> in <span class="ni">inv</span><span class="nt">(a)</span>
<span class="g g-Whitespace">    </span><span class="mi">544</span>     <span class="n">signature</span> <span class="o">=</span> <span class="s1">&#39;D-&gt;D&#39;</span> <span class="k">if</span> <span class="n">isComplexType</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="k">else</span> <span class="s1">&#39;d-&gt;d&#39;</span>
<span class="g g-Whitespace">    </span><span class="mi">545</span>     <span class="n">extobj</span> <span class="o">=</span> <span class="n">get_linalg_error_extobj</span><span class="p">(</span><span class="n">_raise_linalgerror_singular</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">546</span>     <span class="n">ainv</span> <span class="o">=</span> <span class="n">_umath_linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">signature</span><span class="o">=</span><span class="n">signature</span><span class="p">,</span> <span class="n">extobj</span><span class="o">=</span><span class="n">extobj</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">547</span>     <span class="k">return</span> <span class="n">wrap</span><span class="p">(</span><span class="n">ainv</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">result_t</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
<span class="g g-Whitespace">    </span><span class="mi">548</span> 

<span class="nn">~/.local/lib/python3.7/site-packages/numpy/linalg/linalg.py</span> in <span class="ni">_raise_linalgerror_singular</span><span class="nt">(err, flag)</span>
<span class="g g-Whitespace">     </span><span class="mi">86</span> 
<span class="g g-Whitespace">     </span><span class="mi">87</span> <span class="k">def</span> <span class="nf">_raise_linalgerror_singular</span><span class="p">(</span><span class="n">err</span><span class="p">,</span> <span class="n">flag</span><span class="p">):</span>
<span class="ne">---&gt; </span><span class="mi">88</span>     <span class="k">raise</span> <span class="n">LinAlgError</span><span class="p">(</span><span class="s2">&quot;Singular matrix&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">89</span> 
<span class="g g-Whitespace">     </span><span class="mi">90</span> <span class="k">def</span> <span class="nf">_raise_linalgerror_nonposdef</span><span class="p">(</span><span class="n">err</span><span class="p">,</span> <span class="n">flag</span><span class="p">):</span>

<span class="ne">LinAlgError</span>: Singular matrix
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">cond</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<ul class="simple">
<li><p>Para las normas matriciales inducidas se tiene:</p>
<ul>
<li><p>cond<span class="math notranslate nohighlight">\((A)\geq 1, \forall A \in \mathbb{R}^{n\times n}\)</span>.</p></li>
<li><p>cond<span class="math notranslate nohighlight">\((\gamma A) = \text{cond}(A), \forall \gamma \in \mathbb{R}-\{0\}, \forall A \in \mathbb{R}^{n\times n}\)</span>.</p></li>
<li><p>cond<span class="math notranslate nohighlight">\(_2(A) = ||A||_2||A^{-1}||_2 = \frac{\sigma_{\max}}{\sigma_{\min}}, \sigma_{\min} \neq 0\)</span>.</p></li>
</ul>
</li>
</ul>
<ul class="simple">
<li><p>En el problema: resolver <span class="math notranslate nohighlight">\(Ax = b\)</span> se cumple:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\text{ErrRel}(\hat{x}) = \frac{||x^*-\hat{x}||}{||x^*||} \leq \text{cond}(A) \left ( \frac{||\Delta A||}{||A||} + \frac{||\Delta b||}{||b||} \right ), b \neq 0.\]</div>
<p>donde: <span class="math notranslate nohighlight">\(x^*\)</span> es solución de <span class="math notranslate nohighlight">\(Ax=b\)</span> y <span class="math notranslate nohighlight">\(\hat{x}\)</span> es solución aproximada que se obtiene por algún método numérico (por ejemplo factorización LU). <span class="math notranslate nohighlight">\(\frac{||\Delta A||}{||A||}, \frac{||\Delta b||}{||b||}\)</span> son los errores relativos en las entradas de <span class="math notranslate nohighlight">\(A\)</span> y <span class="math notranslate nohighlight">\(b\)</span> respectivamente.</p>
<p><strong>Comentario:</strong> la desigualdad anterior se puede interpretar como sigue: si sólo tenemos perturbaciones en <span class="math notranslate nohighlight">\(A\)</span> de modo que se tienen errores por redondeo del orden de <span class="math notranslate nohighlight">\(10^{-k}\)</span> y por lo tanto <span class="math notranslate nohighlight">\(k\)</span> dígitos de precisión en <span class="math notranslate nohighlight">\(A\)</span> y cond<span class="math notranslate nohighlight">\((A)\)</span> es del orden de <span class="math notranslate nohighlight">\(10^c\)</span> entonces <span class="math notranslate nohighlight">\(\text{ErrRel}(\hat{x})\)</span> puede llegar a tener errores de redondeo de a lo más del orden de <span class="math notranslate nohighlight">\(10^{c-k}\)</span> y por tanto <span class="math notranslate nohighlight">\(k-c\)</span> dígitos de precisión:</p>
<div class="math notranslate nohighlight">
\[\text{ErrRel}(\hat{x}) \leq \text{cond}(A) \frac{||\Delta A||}{||A||}.\]</div>
<ul class="simple">
<li><p>Supongamos que <span class="math notranslate nohighlight">\(x^*\)</span> es solución del sistema <span class="math notranslate nohighlight">\(Ax=b\)</span> y obtenemos <span class="math notranslate nohighlight">\(\hat{x}\)</span> por algún método numérico (por ejemplo factorización LU) entonces ¿qué condiciones garantizan que <span class="math notranslate nohighlight">\(||x^*-\hat{x}||\)</span> sea cercano a cero (del orden de $ \epsilon_{maq}= 10^{-16}$), ¿de qué depende esto?</p></li>
</ul>
<p>Para responder las preguntas anteriores definimos el residual de <span class="math notranslate nohighlight">\(Ax=b\)</span> como <span class="math notranslate nohighlight">\($r=A\hat{x}-b\)</span>$ con <span class="math notranslate nohighlight">\(\hat{x}\)</span> aproximación a <span class="math notranslate nohighlight">\(x^*\)</span> obtenida por algún método numérico. Asimismo, el residual relativo a la norma de <span class="math notranslate nohighlight">\(b\)</span> como:</p>
<div class="math notranslate nohighlight">
\[\frac{||r||}{||b||}.\]</div>
<p><strong>Obs:</strong> típicamente <span class="math notranslate nohighlight">\(x^*\)</span> (solución exacta) es desconocida y por ello no podríamos calcular <span class="math notranslate nohighlight">\(||x^*-\hat{x}||\)</span>, sin embargo sí podemos calcular el residual relativo a la norma de <span class="math notranslate nohighlight">\(b\)</span>: <span class="math notranslate nohighlight">\(\frac{||r||}{||b||}\)</span>. ¿Se cumple que <span class="math notranslate nohighlight">\(\frac{||r||}{||b||}\)</span> pequeño implica <span class="math notranslate nohighlight">\(\text{ErrRel}(\hat{x})\)</span> pequeño? El siguiente resultado nos ayuda a responder esta y las preguntas anteriores:</p>
<p>Sea <span class="math notranslate nohighlight">\(A \in \mathbb{R}^{n\times n}\)</span> no singular, <span class="math notranslate nohighlight">\(x^*\)</span> solución de <span class="math notranslate nohighlight">\(Ax=b\)</span>, <span class="math notranslate nohighlight">\(\hat{x}\)</span> aproximación a <span class="math notranslate nohighlight">\(x^*\)</span>, entonces para las normas matriciales inducidas se cumple:</p>
<div class="math notranslate nohighlight">
\[\frac{||r||}{||b||} \frac{1}{\text{cond}(A)} \leq \frac{||x^*-\hat{x}||}{||x^*||}\leq \text{cond}(A)\frac{||r||}{||b||}.\]</div>
<p>Por la desigualdad anterior, si <span class="math notranslate nohighlight">\(\text{cond}(A) \approx 1\)</span> entonces <span class="math notranslate nohighlight">\(\frac{||r||}{||b||}\)</span> es una buena estimación de <span class="math notranslate nohighlight">\(\text{ErrRel}(\hat{x}) = \frac{||x^*-\hat{x}||}{||x^*||}\)</span> por lo que <span class="math notranslate nohighlight">\(\hat{x}\)</span> es una buena estimación de <span class="math notranslate nohighlight">\(x^*\)</span>. Si <span class="math notranslate nohighlight">\(\text{cond}(A)\)</span> es grande no podemos decir <strong>nada</strong> acerca de <span class="math notranslate nohighlight">\(\text{ErrRel}(\hat{x})\)</span> ni de <span class="math notranslate nohighlight">\(\hat{x}\)</span>.</p>
<p><strong>Ejemplos:</strong></p>
<ol class="simple">
<li></li>
</ol>
<div class="math notranslate nohighlight">
\[\begin{split}a) \begin{array}{ccc} x_1 + x_2   &amp;= &amp; 2 \\ 10.05x_1 + 10x_2 &amp;= &amp; 21 \end{array} \end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}b) \begin{array}{ccc} x_1 + x_2   &amp;= &amp; 2 \\ 10.1x_1 + 10x_2 &amp;= &amp; 21 \end{array} \end{split}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;inciso a&#39;</span><span class="p">)</span>
<span class="n">A_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mf">10.05</span><span class="p">,</span> <span class="mi">10</span><span class="p">]])</span>
<span class="n">b_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">21</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;matriz A_1:&#39;</span><span class="p">)</span>
<span class="n">pprint</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">A_1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;lado derecho b_1:&#39;</span><span class="p">)</span>
<span class="n">pprint</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">b_1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>inciso a
matriz A_1:
array([[ 1.  ,  1.  ],
       [10.05, 10.  ]])
lado derecho b_1:
array([ 2, 21])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x_est</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">A_1</span><span class="p">,</span><span class="n">b_1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;solución x_est:&#39;</span><span class="p">)</span>
<span class="n">pprint</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">x_est</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>solución x_est:
array([ 20., -18.])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;inciso b&#39;</span><span class="p">)</span>
<span class="n">A_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mf">10.1</span><span class="p">,</span> <span class="mi">10</span><span class="p">]])</span>
<span class="n">b_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">21</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;matriz A_2:&#39;</span><span class="p">)</span>
<span class="n">pprint</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">A_2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;lado derecho b_2:&#39;</span><span class="p">)</span>
<span class="n">pprint</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">b_2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>inciso b
matriz A_2:
array([[ 1. ,  1. ],
       [10.1, 10. ]])
lado derecho b_2:
array([ 2, 21])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x_hat</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">A_2</span><span class="p">,</span><span class="n">b_2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;solución x_hat:&#39;</span><span class="p">)</span>
<span class="n">pprint</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">x_hat</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>solución x_hat:
array([10., -8.])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;residual relativo:&#39;</span><span class="p">)</span>
<span class="n">r_rel</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">A_1</span><span class="nd">@x_hat</span><span class="o">-</span><span class="n">b_1</span><span class="p">)</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">b_1</span><span class="p">)</span>
<span class="n">r_rel</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>residual relativo:
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;error relativo:&#39;</span><span class="p">)</span>
<span class="n">err_rel</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">x_hat</span><span class="o">-</span><span class="n">x_est</span><span class="p">)</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">x_est</span><span class="p">)</span>
<span class="n">pprint</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">err_rel</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>error relativo:
0.5255883312276278
</pre></div>
</div>
</div>
</div>
<p><strong>no tenemos una buena estimación del error relativo a partir del residual relativo pues:</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">cond</span><span class="p">(</span><span class="n">A_1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p>De acuerdo a la cota del resultado el error relativo se encuentra en el intervalo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">r_rel</span><span class="o">*</span><span class="mi">1</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">cond</span><span class="p">(</span><span class="n">A_1</span><span class="p">),</span> <span class="n">r_rel</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">cond</span><span class="p">(</span><span class="n">A_1</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<ol class="simple">
<li></li>
</ol>
<div class="math notranslate nohighlight">
\[\begin{split}a) \begin{array}{ccc} 4.1x_1 + 2.8x_2   &amp;= &amp; 4.1 \\ 9.7x_1 + 6.6x_2 &amp;= &amp; 9.7 \end{array}\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}b) \begin{array}{ccc} 4.1x_1 + 2.8x_2   &amp;= &amp; 4.11 \\ 9.7x_1 + 6.6x_2 &amp;= &amp; 9.7 \end{array}\end{split}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;inciso a&#39;</span><span class="p">)</span>
<span class="n">A_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">4.1</span><span class="p">,</span> <span class="mf">2.8</span><span class="p">],</span> <span class="p">[</span><span class="mf">9.7</span><span class="p">,</span> <span class="mf">6.6</span><span class="p">]])</span>
<span class="n">b_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">4.1</span><span class="p">,</span><span class="mf">9.7</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;matriz A_1:&#39;</span><span class="p">)</span>
<span class="n">pprint</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">A_1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;lado derecho b_1:&#39;</span><span class="p">)</span>
<span class="n">pprint</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">b_1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>inciso a
matriz A_1:
array([[4.1, 2.8],
       [9.7, 6.6]])
lado derecho b_1:
array([4.1, 9.7])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x_est</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">A_1</span><span class="p">,</span><span class="n">b_1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;solución x_est:&#39;</span><span class="p">)</span>
<span class="n">pprint</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">x_est</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>solución x_est:
array([1., 0.])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;inciso b&#39;</span><span class="p">)</span>
<span class="n">A_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">4.1</span><span class="p">,</span> <span class="mf">2.8</span><span class="p">],</span> <span class="p">[</span><span class="mf">9.7</span><span class="p">,</span> <span class="mf">6.6</span><span class="p">]])</span>
<span class="n">b_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">4.11</span><span class="p">,</span><span class="mf">9.7</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;matriz A_2:&#39;</span><span class="p">)</span>
<span class="n">pprint</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">A_2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;lado derecho b_2:&#39;</span><span class="p">)</span>
<span class="n">pprint</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">b_2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>inciso b
matriz A_2:
array([[4.1, 2.8],
       [9.7, 6.6]])
lado derecho b_2:
array([4.11, 9.7 ])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x_hat</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">A_2</span><span class="p">,</span><span class="n">b_2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;solución x_hat:&#39;</span><span class="p">)</span>
<span class="n">pprint</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">x_hat</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>solución x_hat:
array([0.34, 0.97])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;residual relativo:&#39;</span><span class="p">)</span>
<span class="n">r_rel</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">A_1</span><span class="nd">@x_hat</span><span class="o">-</span><span class="n">b_1</span><span class="p">)</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">b_1</span><span class="p">)</span>
<span class="n">r_rel</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>residual relativo:
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;error relativo:&#39;</span><span class="p">)</span>
<span class="n">err_rel</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">x_hat</span><span class="o">-</span><span class="n">x_est</span><span class="p">)</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">x_est</span><span class="p">)</span>
<span class="n">pprint</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">err_rel</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>error relativo:
1.1732433677631406
</pre></div>
</div>
</div>
</div>
<p><strong>no tenemos una buena estimación del error relativo a partir del residual relativo pues:</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">cond</span><span class="p">(</span><span class="n">A_1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">r_rel</span><span class="o">*</span><span class="mi">1</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">cond</span><span class="p">(</span><span class="n">A_1</span><span class="p">),</span> <span class="n">r_rel</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">cond</span><span class="p">(</span><span class="n">A_1</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<ol class="simple">
<li></li>
</ol>
<div class="math notranslate nohighlight">
\[\begin{split}a) \begin{array}{ccc} 3.9x_1 + 11.6x_2   &amp;= &amp; 5.5 \\ 12.8x_1 + 2.9x_2 &amp;= &amp; 9.7 \end{array}\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}b) \begin{array}{ccc} 3.95x_1 + 11.6x_2   &amp;= &amp; 5.5 \\ 12.8x_1 + 2.9x_2 &amp;= &amp; 9.7 \end{array}\end{split}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;inciso a&#39;</span><span class="p">)</span>
<span class="n">A_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">3.9</span><span class="p">,</span> <span class="mf">11.6</span><span class="p">],</span> <span class="p">[</span><span class="mf">12.8</span><span class="p">,</span> <span class="mf">2.9</span><span class="p">]])</span>
<span class="n">b_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">5.5</span><span class="p">,</span><span class="mf">9.7</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;matriz A_1:&#39;</span><span class="p">)</span>
<span class="n">pprint</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">A_1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;lado derecho b_1:&#39;</span><span class="p">)</span>
<span class="n">pprint</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">b_1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>inciso a
matriz A_1:
array([[ 3.9, 11.6],
       [12.8,  2.9]])
lado derecho b_1:
array([5.5, 9.7])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x_est</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">A_1</span><span class="p">,</span><span class="n">b_1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;solución x_est:&#39;</span><span class="p">)</span>
<span class="n">pprint</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">x_est</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>solución x_est:
array([0.70401691, 0.23744259])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;inciso b&#39;</span><span class="p">)</span>
<span class="n">A_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">3.95</span><span class="p">,</span> <span class="mf">11.6</span><span class="p">],</span> <span class="p">[</span><span class="mf">12.8</span><span class="p">,</span> <span class="mf">2.9</span><span class="p">]])</span>
<span class="n">b_2</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">5.5</span><span class="p">,</span><span class="mf">9.7</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;matriz A_2:&#39;</span><span class="p">)</span>
<span class="n">pprint</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">A_2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;lado derecho b_2:&#39;</span><span class="p">)</span>
<span class="n">pprint</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">b_2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>inciso b
matriz A_2:
array([[ 3.95, 11.6 ],
       [12.8 ,  2.9 ]])
lado derecho b_2:
array([5.5, 9.7])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x_hat</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">A_2</span><span class="p">,</span><span class="n">b_2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;solución x_hat:&#39;</span><span class="p">)</span>
<span class="n">pprint</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">x_hat</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>solución x_hat:
array([0.7047619 , 0.23415435])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;residual relativo:&#39;</span><span class="p">)</span>
<span class="n">r_rel</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">A_1</span><span class="nd">@x_hat</span><span class="o">-</span><span class="n">b_1</span><span class="p">)</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">b_1</span><span class="p">)</span>
<span class="n">r_rel</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>residual relativo:
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;error relativo:&#39;</span><span class="p">)</span>
<span class="n">err_rel</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">x_hat</span><span class="o">-</span><span class="n">x_est</span><span class="p">)</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">x_est</span><span class="p">)</span>
<span class="n">pprint</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">err_rel</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>error relativo:
0.004537910940159858
</pre></div>
</div>
</div>
</div>
<p><strong>sí tenemos una buena estimación del error relativo a partir del residual relativo pues:</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">cond</span><span class="p">(</span><span class="n">A_1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">r_rel</span><span class="o">*</span><span class="mi">1</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">cond</span><span class="p">(</span><span class="n">A_1</span><span class="p">),</span> <span class="n">r_rel</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">cond</span><span class="p">(</span><span class="n">A_1</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<ol class="simple">
<li></li>
</ol>
<p><span class="math notranslate nohighlight">\(\theta=\frac{\pi}{3}\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">theta_1</span><span class="o">=</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">3</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta_1</span><span class="p">),</span><span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta_1</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">theta_2</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">3</span> <span class="o">+</span> <span class="o">.</span><span class="mi">00005</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">theta_2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta_2</span><span class="p">),</span><span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta_2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<div class="math notranslate nohighlight">
\[\begin{split}a) \begin{array}{ccc} \cos(\theta_1)x_1 - \sin(\theta_1)x_2   &amp;= &amp; -1.5 \\ \sin(\theta_1)x_1 + \cos(\theta_1)x_2 &amp;= &amp; 2.4 \end{array}\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}b) \begin{array}{ccc} \cos(\theta_2)x_1 - \sin(\theta_2)x_2   &amp;= &amp; -1.5 \\ \sin(\theta_2)x_1 + \cos(\theta_2)x_2 &amp;= &amp; 2.4 \end{array}\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}c) \begin{array}{ccc} \cos(\theta_2)x_1 - \sin(\theta_2)x_2   &amp;= &amp; -1.7 \\ \sin(\theta_2)x_1 + \cos(\theta_2)x_2 &amp;= &amp; 2.4 \end{array}\end{split}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;inciso a&#39;</span><span class="p">)</span>
<span class="n">A_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta_1</span><span class="p">),</span> <span class="o">-</span><span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta_1</span><span class="p">)],</span> <span class="p">[</span><span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta_1</span><span class="p">),</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta_1</span><span class="p">)]])</span>
<span class="n">b_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span><span class="mf">2.4</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;matriz A_1:&#39;</span><span class="p">)</span>
<span class="n">pprint</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">A_1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;lado derecho b_1:&#39;</span><span class="p">)</span>
<span class="n">pprint</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">b_1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>inciso a
matriz A_1:
array([[ 0.5      , -0.8660254],
       [ 0.8660254,  0.5      ]])
lado derecho b_1:
array([-1.5,  2.4])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x_est</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">A_1</span><span class="p">,</span><span class="n">b_1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;solución x_est:&#39;</span><span class="p">)</span>
<span class="n">pprint</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">x_est</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>solución x_est:
array([1.32846097, 2.49903811])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;inciso b&#39;</span><span class="p">)</span>
<span class="n">A_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta_2</span><span class="p">),</span> <span class="o">-</span><span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta_2</span><span class="p">)],</span> <span class="p">[</span><span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta_2</span><span class="p">),</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta_2</span><span class="p">)]])</span>
<span class="n">b_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span><span class="mf">2.4</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;matriz A_2:&#39;</span><span class="p">)</span>
<span class="n">pprint</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">A_2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;lado derecho b_2:&#39;</span><span class="p">)</span>
<span class="n">pprint</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">b_2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>inciso b
matriz A_2:
array([[ 0.4999567, -0.8660504],
       [ 0.8660504,  0.4999567]])
lado derecho b_2:
array([-1.5,  2.4])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x_hat</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">A_2</span><span class="p">,</span><span class="n">b_2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;solución x_hat:&#39;</span><span class="p">)</span>
<span class="n">pprint</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">x_hat</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>solución x_hat:
array([1.32858592, 2.49897168])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;residual relativo:&#39;</span><span class="p">)</span>
<span class="n">r_rel</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">A_1</span><span class="nd">@x_hat</span><span class="o">-</span><span class="n">b_1</span><span class="p">)</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">b_1</span><span class="p">)</span>
<span class="s1">&#39;</span><span class="si">{:0.10e}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">r_rel</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>residual relativo:
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;error relativo:&#39;</span><span class="p">)</span>
<span class="n">err_rel</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">x_hat</span><span class="o">-</span><span class="n">x_est</span><span class="p">)</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">x_est</span><span class="p">)</span>
<span class="s1">&#39;</span><span class="si">{:0.10e}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">err_rel</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>error relativo:
</pre></div>
</div>
</div>
</div>
<p><strong>sí tenemos una buena estimación del error relativo a partir del residual relativo pues:</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">cond</span><span class="p">(</span><span class="n">A_1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:0.10e}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">r_rel</span><span class="o">*</span><span class="mi">1</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">cond</span><span class="p">(</span><span class="n">A_1</span><span class="p">)),</span> <span class="s1">&#39;</span><span class="si">{:0.10e}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">r_rel</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">cond</span><span class="p">(</span><span class="n">A_1</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;inciso c&#39;</span><span class="p">)</span>
<span class="n">A_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta_2</span><span class="p">),</span> <span class="o">-</span><span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta_2</span><span class="p">)],</span> <span class="p">[</span><span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta_2</span><span class="p">),</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta_2</span><span class="p">)]])</span>
<span class="n">b_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">1.7</span><span class="p">,</span><span class="mf">2.4</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;matriz A_2:&#39;</span><span class="p">)</span>
<span class="n">pprint</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">A_2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;lado derecho b_2:&#39;</span><span class="p">)</span>
<span class="n">pprint</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">b_2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>inciso c
matriz A_2:
array([[ 0.4999567, -0.8660504],
       [ 0.8660504,  0.4999567]])
lado derecho b_2:
array([-1.7,  2.4])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x_hat</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">A_2</span><span class="p">,</span><span class="n">b_2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;solución x_hat:&#39;</span><span class="p">)</span>
<span class="n">pprint</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">x_hat</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>solución x_hat:
array([1.22859458, 2.67218176])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;residual relativo:&#39;</span><span class="p">)</span>
<span class="n">r_rel</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">A_1</span><span class="nd">@x_hat</span><span class="o">-</span><span class="n">b_1</span><span class="p">)</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">b_1</span><span class="p">)</span>
<span class="s1">&#39;</span><span class="si">{:0.14e}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">r_rel</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>residual relativo:
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;error relativo:&#39;</span><span class="p">)</span>
<span class="n">err_rel</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">x_hat</span><span class="o">-</span><span class="n">x_est</span><span class="p">)</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">x_est</span><span class="p">)</span>
<span class="s1">&#39;</span><span class="si">{:0.14e}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">err_rel</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>error relativo:
</pre></div>
</div>
</div>
</div>
<p><strong>sí tenemos una buena estimación del error relativo a partir del residual relativo pues:</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">cond</span><span class="p">(</span><span class="n">A_1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:0.14e}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">r_rel</span><span class="o">*</span><span class="mi">1</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">cond</span><span class="p">(</span><span class="n">A_1</span><span class="p">)),</span> <span class="s1">&#39;</span><span class="si">{:0.14e}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">r_rel</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">cond</span><span class="p">(</span><span class="n">A_1</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p>Así, <span class="math notranslate nohighlight">\(\text{cond}(A)\)</span> nos da una calidad (mediante <span class="math notranslate nohighlight">\(\frac{||r||}{||b||}\)</span>) de la solución <span class="math notranslate nohighlight">\(\hat{x}\)</span> en el problema inicial (resolver <span class="math notranslate nohighlight">\(Ax=b\)</span>) obtenida por algún método numérico respecto a la solución <span class="math notranslate nohighlight">\(x^*\)</span> de <span class="math notranslate nohighlight">\(Ax=b\)</span>.</p>
<p><strong>Obs:</strong> Por último obsérvese que la condición del problema inicial (resolver <span class="math notranslate nohighlight">\(Ax=b\)</span>) <strong>no depende del método númerico</strong> que se elige para resolverlo.</p>
<p><strong>Ejercicio:</strong> proponer sistemas de ecuaciones lineales con distinto número de condición, perturbar matriz del sistema o lado derecho (o ambos) y revisar números de condición y residuales relativos de acuerdo a la cota:</p>
<div class="math notranslate nohighlight">
\[\frac{||r||}{||b||} \frac{1}{\text{cond}(A)} \leq \frac{||x^*-\hat{x}||}{||x^*||}\leq \text{cond}(A)\frac{||r||}{||b||}.\]</div>
<p>Verificar que si el número de condición del sistema es pequeño entonces el residual relativo estima bien al error relativo.</p>
</div>
<div class="section" id="numero-de-condicion-de-una-matriz-a-in-mathbb-r-m-times-n">
<h3>Número de condición de una matriz <span class="math notranslate nohighlight">\(A \in \mathbb{R}^{m\times n}\)</span><a class="headerlink" href="#numero-de-condicion-de-una-matriz-a-in-mathbb-r-m-times-n" title="Permalink to this headline">¶</a></h3>
<p>Para este caso se utiliza la <strong>pseudoinversa</strong> de <span class="math notranslate nohighlight">\(A\)</span> definida a partir de la descomposición en valores singulares compacta (compact SVD, ver <a class="reference external" href="https://www.dropbox.com/s/s4ch0ww1687pl76/3.2.2.Factorizaciones_matriciales_SVD_Cholesky_QR.pdf?dl=0">Factorizaciones matriciales SVD, Cholesky, QR</a>) y denotada como <span class="math notranslate nohighlight">\(A^{\dagger}\)</span>:</p>
<div class="math notranslate nohighlight">
\[A^{\dagger} = V \Sigma^{\dagger} U^T\]</div>
<p>donde: <span class="math notranslate nohighlight">\(\Sigma ^{\dagger}\)</span> es la matriz transpuesta de <span class="math notranslate nohighlight">\(\Sigma\)</span> y tiene entradas <span class="math notranslate nohighlight">\(\sigma_i^{+}:\)</span></p>
<div class="math notranslate nohighlight">
\[\begin{split}\sigma_i^+ = \begin{cases}
\frac{1}{\sigma_i} &amp;\text{ si } \sigma_i \neq 0,\\
0 &amp;\text{ en otro caso}
\end{cases}
\end{split}\]</div>
<p><span class="math notranslate nohighlight">\(\forall i=1,\dots, r\)</span> con <span class="math notranslate nohighlight">\(r=rank(A)\)</span>.</p>
<p><strong>Comentarios y propiedades:</strong></p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(A^{\dagger}\)</span> se le conoce como pseudoinversa de <span class="math notranslate nohighlight">\(Moore-Penrose\)</span>.</p></li>
<li><p>Si <span class="math notranslate nohighlight">\(rank(A)=n\)</span> entonces <span class="math notranslate nohighlight">\(A^{\dagger} = (A^TA)^{-1}A^T\)</span>, si <span class="math notranslate nohighlight">\(rank(A)=m\)</span>, <span class="math notranslate nohighlight">\(A^\dagger = A^T(AA^T)^{-1}\)</span>, si <span class="math notranslate nohighlight">\(A\in \mathbb{R}^{n\times n}\)</span> no singular, entonces <span class="math notranslate nohighlight">\(A^\dagger=A^{-1}\)</span>.</p></li>
<li><p>Con <span class="math notranslate nohighlight">\(A^\dagger\)</span> se define <span class="math notranslate nohighlight">\(\text{cond}(A)\)</span> para <span class="math notranslate nohighlight">\(A \in \mathbb{R}^{m\times n}\)</span>:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\text{cond}(A) = ||A||||A^\dagger||\]</div>
<p>de hecho, se tiene:</p>
<div class="math notranslate nohighlight">
\[\text{cond}_2(A) = \frac{\sigma_{max}}{\sigma_{min}}=\frac{\sigma_1}{\sigma_r}.\]</div>
<p><strong>Ejercicios</strong></p>
<ol class="simple">
<li><p>Resuelve los ejercicios y preguntas de la nota.</p></li>
</ol>
<p><strong>Preguntas de comprehensión</strong></p>
<p>1)¿Qué factores influyen en la falta de exactitud de un cálculo?</p>
<p>2)Si f es un problema mal condicionado, ¿a qué nos referimos? Da ejemplos de problemas bien y mal condicionados.</p>
<p>3)Si f es un problema que resolvemos con un algoritmo g, ¿qué significa:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>a. que g sea estable?

b. que g sea estable hacia atrás?

c. que g sea inestable?
</pre></div>
</div>
<p>4)¿Qué ventaja(s) se tiene(n) al calcular un error hacia atrás vs calcular un error hacia delante?</p>
<p><strong>Referencias</strong></p>
<ol class="simple">
<li><p>Nota <a class="reference internal" href="README.html#spf"><span class="std std-ref">Sistema de punto flotante</span></a>.</p></li>
<li><p>L. Trefethen, D. Bau, Numerical linear algebra, SIAM, 1997.</p></li>
<li><p>G. H. Golub, C. F. Van Loan,Matrix Computations. John Hopkins University Press, 2013</p></li>
</ol>
</div>
</div>
<span id="document-I.computo_cientifico/1.5/Definicion_de_funcion_derivada_de_una_funcion"></span><div class="admonition-notas-para-contenedor-de-docker admonition">
<p class="admonition-title">Notas para contenedor de docker:</p>
<p>Comando de docker para ejecución de la nota de forma local:</p>
<p>nota: cambiar <code class="docutils literal notranslate"><span class="pre">&lt;ruta</span> <span class="pre">a</span> <span class="pre">mi</span> <span class="pre">directorio&gt;</span></code> por la ruta de directorio que se desea mapear a <code class="docutils literal notranslate"><span class="pre">/datos</span></code> dentro del contenedor de docker.</p>
<p><code class="docutils literal notranslate"><span class="pre">docker</span> <span class="pre">run</span> <span class="pre">--rm</span> <span class="pre">-v</span> <span class="pre">&lt;ruta</span> <span class="pre">a</span> <span class="pre">mi</span> <span class="pre">directorio&gt;:/datos</span> <span class="pre">--name</span> <span class="pre">jupyterlab_optimizacion</span> <span class="pre">-p</span> <span class="pre">8888:8888</span> <span class="pre">-d</span> <span class="pre">palmoreck/jupyterlab_optimizacion:2.1.4</span></code></p>
<p>password para jupyterlab: <code class="docutils literal notranslate"><span class="pre">qwerty</span></code></p>
<p>Detener el contenedor de docker:</p>
<p><code class="docutils literal notranslate"><span class="pre">docker</span> <span class="pre">stop</span> <span class="pre">jupyterlab_optimizacion</span></code></p>
<p>Documentación de la imagen de docker <code class="docutils literal notranslate"><span class="pre">palmoreck/jupyterlab_optimizacion:2.1.4</span></code> en <a class="reference external" href="https://github.com/palmoreck/dockerfiles/tree/master/jupyterlab/optimizacion">liga</a>.</p>
</div>
<hr class="docutils" />
<p>Nota generada a partir de la <a class="reference external" href="https://www.dropbox.com/s/jfrxanjls8kndjp/Diferenciacion_e_Integracion.pdf?dl=0">liga1</a>, <a class="reference external" href="https://www.dropbox.com/s/mmd1uzvwhdwsyiu/4.3.2.Teoria_de_convexidad_Funciones_convexas.pdf?dl=0">liga2</a> e inicio de <a class="reference external" href="https://www.dropbox.com/s/ko86cce1olbtsbk/4.3.1.Teoria_de_convexidad_Conjuntos_convexos.pdf?dl=0">liga3</a>.</p>
<div class="section" id="definicion-de-funcion-y-derivada-de-una-funcion">
<span id="dfdf"></span><h2>1.5 Definición de función y derivada de una función<a class="headerlink" href="#definicion-de-funcion-y-derivada-de-una-funcion" title="Permalink to this headline">¶</a></h2>
<p>Notación: <span class="math notranslate nohighlight">\(f: A \rightarrow B\)</span> es una función de un conjunto <span class="math notranslate nohighlight">\(\text{dom}f \subseteq A\)</span> en un conjunto <span class="math notranslate nohighlight">\(B\)</span>.</p>
<div class="tip admonition">
<p class="admonition-title">Observación</p>
<p><span class="math notranslate nohighlight">\(\text{dom}f\)</span> (el dominio de <span class="math notranslate nohighlight">\(f\)</span>) podría ser un subconjunto propio de <span class="math notranslate nohighlight">\(A\)</span>, esto es, algunos elementos de <span class="math notranslate nohighlight">\(A\)</span> y otros no, son mapeados a elementos de <span class="math notranslate nohighlight">\(B\)</span>.</p>
</div>
<p>En lo que sigue se considera al espacio <span class="math notranslate nohighlight">\(\mathbb{R}^n\)</span> y se asume que conjuntos y subconjuntos están en este espacio.</p>
<p>Un punto <span class="math notranslate nohighlight">\(x\)</span> se nombra <strong>punto límite</strong> de un conjunto <span class="math notranslate nohighlight">\(X\)</span>, si existe una sucesión <span class="math notranslate nohighlight">\(\{x_k\} \subset X\)</span> que converge a <span class="math notranslate nohighlight">\(x\)</span>. El conjunto de puntos límites se nombra <strong>cerradura</strong> o <em>closure</em> de <span class="math notranslate nohighlight">\(X\)</span> y se denota como <span class="math notranslate nohighlight">\(\text{cl}X\)</span>.</p>
<p>Un conjunto <span class="math notranslate nohighlight">\(X\)</span> se nombra <strong>cerrado</strong> si es igual a su cerradura.</p>
<p>En lo siguiente <span class="math notranslate nohighlight">\(\text{intdom}f\)</span> es el <strong>interior</strong>* del dominio de <span class="math notranslate nohighlight">\(f\)</span>.</p>
<p>*El interior es el conjunto de <strong>puntos interiores</strong>: un punto <span class="math notranslate nohighlight">\(x\)</span> de un conjunto <span class="math notranslate nohighlight">\(X\)</span> se llama interior si existe una <strong>vecindad</strong> de <span class="math notranslate nohighlight">\(x\)</span> (conjunto abierto* que contiene a <span class="math notranslate nohighlight">\(x\)</span>) contenida en <span class="math notranslate nohighlight">\(X\)</span>.</p>
<p>*Un conjunto <span class="math notranslate nohighlight">\(X\)</span> se dice que es <strong>abierto</strong> si <span class="math notranslate nohighlight">\(\forall x \in X\)</span> existe una bola abierta* centrada en <span class="math notranslate nohighlight">\(x\)</span> y contenida en <span class="math notranslate nohighlight">\(X\)</span>. Es equivalente escribir que <span class="math notranslate nohighlight">\(X\)</span> es <strong>abierto</strong> si su complemento <span class="math notranslate nohighlight">\(\mathbb{R}^n \ X\)</span> es cerrado.</p>
<p>*Una <strong>bola abierta</strong> con radio <span class="math notranslate nohighlight">\(\epsilon&gt;0\)</span> y centrada en <span class="math notranslate nohighlight">\(x\)</span> es el conjunto: <span class="math notranslate nohighlight">\(B_\epsilon(x) =\{y \in \mathbb{R}^n : ||y-x|| &lt; \epsilon\}\)</span>.</p>
<div class="section" id="continuidad">
<h3>Continuidad<a class="headerlink" href="#continuidad" title="Permalink to this headline">¶</a></h3>
<p><span class="math notranslate nohighlight">\(f: \mathbb{R}^n \rightarrow \mathbb{R}^m\)</span> es continua en <span class="math notranslate nohighlight">\(x \in \text{dom}f\)</span> si $\forall \epsilon &gt;0 \exists \delta &gt; 0 $ tal que:</p>
<div class="math notranslate nohighlight">
\[y \in \text{dom}f, ||y-x||_2 \leq \delta \implies ||f(y)-f(x)||_2 \leq \epsilon\]</div>
<div class="admonition-comentarios admonition">
<p class="admonition-title">Comentarios</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(f\)</span> continua en un punto <span class="math notranslate nohighlight">\(x\)</span> del dominio de <span class="math notranslate nohighlight">\(f\)</span> entonces <span class="math notranslate nohighlight">\(f(y)\)</span> es arbitrariamente cercana a <span class="math notranslate nohighlight">\(f(x)\)</span> para <span class="math notranslate nohighlight">\(y\)</span> en el dominio de <span class="math notranslate nohighlight">\(f\)</span> cercana a <span class="math notranslate nohighlight">\(x\)</span>.</p></li>
<li><p>Otra forma de definir que <span class="math notranslate nohighlight">\(f\)</span> sea continua en <span class="math notranslate nohighlight">\(x \in \text{dom}f\)</span> es con sucesiones y límites: si <span class="math notranslate nohighlight">\(\{x_i\}_{i \in \mathbb{N}} \subseteq \text{dom}f\)</span> es una sucesión de puntos en el dominio de <span class="math notranslate nohighlight">\(f\)</span> que converge a <span class="math notranslate nohighlight">\(x \in \text{dom}f\)</span>, <span class="math notranslate nohighlight">\(\displaystyle \lim_{i \rightarrow \infty}x_i = x\)</span>, y <span class="math notranslate nohighlight">\(f\)</span> es continua en <span class="math notranslate nohighlight">\(x\)</span> entonces la sucesión <span class="math notranslate nohighlight">\(\{f(x_i)\}_{i \in \mathbb{N}}\)</span> converge a <span class="math notranslate nohighlight">\(f(x)\)</span>: <span class="math notranslate nohighlight">\(\displaystyle \lim_{i \rightarrow \infty}f(x_i) = f(x) = f \left(\displaystyle \lim_{i \rightarrow \infty} x_i \right )\)</span>.</p></li>
</ul>
</div>
<p><strong>Notación:</strong> <span class="math notranslate nohighlight">\(\mathcal{C}([a,b])=\{\text{funciones } f:\mathbb{R} \rightarrow \mathbb{R} \text{ continuas en el intervalo [a,b]}\}\)</span> y <span class="math notranslate nohighlight">\(\mathcal{C}(\text{dom}f) = \{\text{funciones } f:\mathbb{R}^n \rightarrow \mathbb{R}^m \text{ continuas en su dominio}\}\)</span>.</p>
</div>
<div class="section" id="funcion-diferenciable">
<h3>Función Diferenciable<a class="headerlink" href="#funcion-diferenciable" title="Permalink to this headline">¶</a></h3>
<div class="section" id="caso-f-mathbb-r-rightarrow-mathbb-r">
<h4>Caso <span class="math notranslate nohighlight">\(f: \mathbb{R} \rightarrow \mathbb{R}\)</span><a class="headerlink" href="#caso-f-mathbb-r-rightarrow-mathbb-r" title="Permalink to this headline">¶</a></h4>
<p><span class="math notranslate nohighlight">\(f\)</span> es diferenciable en <span class="math notranslate nohighlight">\(x_0 \in (a,b)\)</span> si <span class="math notranslate nohighlight">\(\displaystyle \lim_{x \rightarrow x_0} \frac{f(x)-f(x_0)}{x-x_0}\)</span> existe y escribimos:</p>
<div class="math notranslate nohighlight">
\[f^{(1)}(x_0) = \displaystyle \lim_{x \rightarrow x_0} \frac{f(x)-f(x_0)}{x-x_0}.\]</div>
<p><span class="math notranslate nohighlight">\(f\)</span> es diferenciable en <span class="math notranslate nohighlight">\([a,b]\)</span> si es diferenciable en cada punto de <span class="math notranslate nohighlight">\([a,b]\)</span>. Análogamente definiendo la variable <span class="math notranslate nohighlight">\(h=x-x_0\)</span> se tiene:</p>
<p><span class="math notranslate nohighlight">\(f^{(1)}(x_0) = \displaystyle \lim_{h \rightarrow 0} \frac{f(x_0+h)-f(x_0)}{h}\)</span> que típicamente se escribe como:</p>
<div class="math notranslate nohighlight">
\[f^{(1)}(x) = \displaystyle \lim_{h \rightarrow 0} \frac{f(x+h)-f(x)}{h}.\]</div>
<div class="admonition-comentario admonition">
<p class="admonition-title">Comentario</p>
<p>Si <span class="math notranslate nohighlight">\(f\)</span> es diferenciable en <span class="math notranslate nohighlight">\(x_0\)</span> entonces <span class="math notranslate nohighlight">\(f(x) \approx f(x_0) + f^{(1)}(x_0)(x-x_0)\)</span>. Gráficamente:</p>
<img src="https://dl.dropboxusercontent.com/s/3t13ku6pk1pjwxo/f_diferenciable.png?dl=0" heigth="500" width="500">
</div>
<p><strong>Notación:</strong> <span class="math notranslate nohighlight">\(\mathcal{C}^n([a,b])=\{\text{funciones } f:\mathbb{R} \rightarrow \mathbb{R} \text{ con } n \text{ derivadas continuas en el intervalo [a,b]}\}\)</span>.</p>
<p><strong>Ejemplo:</strong></p>
<p>En Python podemos utilizar el paquete <a class="reference external" href="https://www.sympy.org/en/index.html">SymPy</a> para calcular límites y derivadas:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sympy</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Límite de <span class="math notranslate nohighlight">\(\frac{\cos(x+h) - \cos(x)}{h}\)</span> para <span class="math notranslate nohighlight">\(h \rightarrow 0\)</span>:</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s2">&quot;x, h&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">quotient</span> <span class="o">=</span> <span class="p">(</span><span class="n">sympy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">h</span><span class="p">)</span> <span class="o">-</span> <span class="n">sympy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">/</span><span class="n">h</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="n">quotient</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p><strong>Derivada de <span class="math notranslate nohighlight">\(\cos(x)\)</span>:</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">Symbol</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p><strong>Si queremos evaluar la derivada podemos usar:</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">sympy</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">Derivative</span><span class="p">(</span><span class="n">sympy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">doit_numerically</span><span class="p">(</span><span class="n">sympy</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
</div>
<div class="section" id="caso-f-mathbb-r-n-rightarrow-mathbb-r-m">
<h4>Caso <span class="math notranslate nohighlight">\(f: \mathbb{R}^n \rightarrow \mathbb{R}^m\)</span><a class="headerlink" href="#caso-f-mathbb-r-n-rightarrow-mathbb-r-m" title="Permalink to this headline">¶</a></h4>
<p><span class="math notranslate nohighlight">\(f\)</span> es diferenciable en <span class="math notranslate nohighlight">\(x \in \text{intdom}f\)</span> si existe una matriz <span class="math notranslate nohighlight">\(Df(x) \in \mathbb{R}^{m\times n}\)</span> tal que:</p>
<div class="math notranslate nohighlight">
\[\displaystyle \lim_{z \rightarrow x, z \neq x} \frac{||f(z)-f(x)-Df(x)(z-x)||_2}{||z-x||_2} = 0, z \in \text{dom}f\]</div>
<p>en este caso <span class="math notranslate nohighlight">\(Df(x)\)</span> se llama la derivada de <span class="math notranslate nohighlight">\(f\)</span> en <span class="math notranslate nohighlight">\(x\)</span>.</p>
<div class="tip admonition">
<p class="admonition-title">Observación</p>
<p>Sólo puede existir a lo más una matriz que satisfaga el límite anterior.</p>
</div>
<p><strong>Comentarios:</strong></p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(Df(x)\)</span> también es llamada la <strong>Jacobiana</strong> de <span class="math notranslate nohighlight">\(f\)</span>.</p></li>
<li><p>Se dice que <span class="math notranslate nohighlight">\(f\)</span> es diferenciable si <span class="math notranslate nohighlight">\(\text{dom}f\)</span> es abierto y es diferenciable en cada punto de <span class="math notranslate nohighlight">\(domf.\)</span></p></li>
<li><p>La función: <span class="math notranslate nohighlight">\(f(x) + Df(x)(z-x)\)</span> es afín y se le llama <strong>aproximación de orden <span class="math notranslate nohighlight">\(1\)</span></strong> de <span class="math notranslate nohighlight">\(f\)</span> en <span class="math notranslate nohighlight">\(x\)</span> (o también cerca de <span class="math notranslate nohighlight">\(x\)</span>). Para <span class="math notranslate nohighlight">\(z\)</span> cercana a <span class="math notranslate nohighlight">\(x\)</span> ésta aproximación es cercana a <span class="math notranslate nohighlight">\(f(z)\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(Df(x)\)</span> puede encontrarse con la definición de límite anterior o con las derivadas parciales: <span class="math notranslate nohighlight">\(Df(x)_{ij} = \frac{\partial f_i(x)}{\partial x_j}, i=1,\dots,m, j=1,\dots,n\)</span> definidas como:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\frac{\partial f_i(x)}{\partial x_j} = \displaystyle \lim_{h \rightarrow 0} \frac{f_i(x+he_j)-f_i(x)}{h}\]</div>
<p>donde: <span class="math notranslate nohighlight">\(f_i : \mathbb{R}^n \rightarrow \mathbb{R}\)</span>, <span class="math notranslate nohighlight">\(i=1,\dots,m,j=1,\dots,n\)</span> y <span class="math notranslate nohighlight">\(e_j\)</span> <span class="math notranslate nohighlight">\(j\)</span>-ésimo vector canónico que tiene un número <span class="math notranslate nohighlight">\(1\)</span> en la posición <span class="math notranslate nohighlight">\(j\)</span> y <span class="math notranslate nohighlight">\(0\)</span> en las entradas restantes.</p>
<ul class="simple">
<li><p>Si <span class="math notranslate nohighlight">\(f: \mathbb{R}^n \rightarrow \mathbb{R}, Df(x) \in \mathbb{R}^{1\times n}\)</span>, su transpuesta se llama <strong>gradiente</strong>, el cual es un vector columna, se denota <span class="math notranslate nohighlight">\(\nabla f(x)\)</span> y sus componentes son derivadas parciales:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}\nabla f(x) = Df(x)^T = 
    \left[ \begin{array}{c}
    \frac{\partial f(x)}{\partial x_1}\\
    \vdots\\
    \frac{\partial f(x)}{\partial x_n}
    \end{array}
    \right] = \left[ 
    \begin{array}{c} 
    \displaystyle \lim_{h \rightarrow 0} \frac{f(x+he_1) - f(x)}{h}\\
    \vdots\\
    \displaystyle \lim_{h \rightarrow 0} \frac{f(x+he_n) - f(x)}{h}
    \end{array}
    \right] \in \mathbb{R}^{n\times 1}.\end{split}\]</div>
<div class="admonition-comentarios admonition">
<p class="admonition-title">Comentarios</p>
<ul class="simple">
<li><p>En este contexto, la aproximación de primer orden a <span class="math notranslate nohighlight">\(f\)</span> en <span class="math notranslate nohighlight">\(x\)</span> es: <span class="math notranslate nohighlight">\(f(x) + \nabla f(x)^T(z-x)\)</span> para <span class="math notranslate nohighlight">\(z\)</span> cercana a <span class="math notranslate nohighlight">\(x\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(\mathcal{C}^n(\text{dom}f) = \{\text{funciones } f:\mathbb{R}^n \rightarrow \mathbb{R}^m \text{ con } n \text{ derivadas continuas en su dominio}\}\)</span>.</p></li>
</ul>
</div>
<p><strong>Ejemplo:</strong></p>
<p><span class="math notranslate nohighlight">\(f : \mathbb{R}^2 \rightarrow \mathbb{R}^2\)</span> dada por:</p>
<div class="math notranslate nohighlight">
\[\begin{split}f(x) = 
\left [ 
\begin{array}{c}
x_1x_2 + x_2^2\\
x_1^2 + 2x_1x_2 + x_2^2\\
\end{array}
\right ]
\end{split}\]</div>
<p>con <span class="math notranslate nohighlight">\(x = (x_1, x_2)^T\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s2">&quot;x1, x2&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">f1</span> <span class="o">=</span> <span class="n">x1</span><span class="o">*</span><span class="n">x2</span> <span class="o">+</span> <span class="n">x2</span><span class="o">**</span><span class="mi">2</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">f1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">f2</span> <span class="o">=</span> <span class="n">x1</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x2</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">x1</span><span class="o">*</span><span class="n">x2</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">f2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p><strong>Derivadas parciales:</strong></p>
<p>Para <span class="math notranslate nohighlight">\(f_1(x) = x_1x_2 + x_2^2\)</span>:</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p><strong>Derivada parcial de <span class="math notranslate nohighlight">\(f_1\)</span> respecto a <span class="math notranslate nohighlight">\(x_1\)</span>.</strong></p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df1_x1</span> <span class="o">=</span> <span class="n">f1</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df1_x1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p><strong>Derivada parcial de <span class="math notranslate nohighlight">\(f_1\)</span> respecto a <span class="math notranslate nohighlight">\(x_2\)</span>.</strong></p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df1_x2</span> <span class="o">=</span> <span class="n">f1</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df1_x2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p>Para <span class="math notranslate nohighlight">\(f_2(x) = x_1^2 + 2x_1 x_2 + x_2^2\)</span>:</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p><strong>Derivada parcial de <span class="math notranslate nohighlight">\(f_2\)</span> respecto a <span class="math notranslate nohighlight">\(x_1\)</span>.</strong></p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df2_x1</span> <span class="o">=</span> <span class="n">f2</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df2_x1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p><strong>Derivada parcial de <span class="math notranslate nohighlight">\(f_2\)</span> respecto a <span class="math notranslate nohighlight">\(x_2\)</span>.</strong></p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df2_x2</span> <span class="o">=</span> <span class="n">f2</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df2_x2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p><strong>Entonces la derivada es:</strong></p>
<div class="math notranslate nohighlight">
\[\begin{split}Df(x) = 
\left [
\begin{array}{cc}
x_2 &amp; x_1+2x_2\\
2x_1 + 2x_2 &amp; 2x_1+2x_2
\end{array}
\right ]
\end{split}\]</div>
<p><strong>Otra opción más fácil:</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">Matrix</span><span class="p">([</span><span class="n">f1</span><span class="p">,</span> <span class="n">f2</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">f</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="o">.</span><span class="n">jacobian</span><span class="p">([</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p><strong>Para evaluar por ejemplo en <span class="math notranslate nohighlight">\((x_1, x_2)^T = (0, 1)^T\)</span>:</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">d</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">jacobian</span><span class="p">([</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">d</span><span class="o">.</span><span class="n">subs</span><span class="p">([(</span><span class="n">x1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
</div>
<div class="section" id="regla-de-la-cadena">
<h4>Regla de la cadena<a class="headerlink" href="#regla-de-la-cadena" title="Permalink to this headline">¶</a></h4>
<p>Si <span class="math notranslate nohighlight">\(f:\mathbb{R}^n \rightarrow \mathbb{R}^m\)</span> es diferenciable en <span class="math notranslate nohighlight">\(x\in \text{intdom}f\)</span> y <span class="math notranslate nohighlight">\(g:\mathbb{R}^m \rightarrow \mathbb{R}^p\)</span> es diferenciable en <span class="math notranslate nohighlight">\(f(x)\in \text{intdom}g\)</span>, se define la composición <span class="math notranslate nohighlight">\(h:\mathbb{R}^n \rightarrow \mathbb{R}^p\)</span> por <span class="math notranslate nohighlight">\(h(z) = g(f(z))\)</span>, la cual es diferenciable en <span class="math notranslate nohighlight">\(x\)</span>, con derivada:</p>
<div class="math notranslate nohighlight">
\[Dh(x)=Dg(f(x))Df(x)\in \mathbb{R}^{p\times n}.\]</div>
<p><strong>Ejemplo:</strong> Sean <span class="math notranslate nohighlight">\(g:\mathbb{R} \rightarrow \mathbb{R}\)</span>, <span class="math notranslate nohighlight">\(f:\mathbb{R}^n \rightarrow \mathbb{R}\)</span>, <span class="math notranslate nohighlight">\(h:\mathbb{R}^n \rightarrow \mathbb{R}\)</span> con <span class="math notranslate nohighlight">\(h(z) = g(f(z))\)</span> entonces:</p>
<div class="math notranslate nohighlight">
\[Dh(x) = Dg(f(x))Df(x) = \frac{dg(f(x))}{dx}(\nabla f(x))^T \in \mathbb{R}^{1\times n}\]</div>
<p>y la transpuesta de <span class="math notranslate nohighlight">\(Dh(x)\)</span> es: <span class="math notranslate nohighlight">\(\nabla h(x) = (Dh(x))^T = \frac{dg(f(x))}{dx} \nabla f(x) \in \mathbb{R}^{n\times 1}\)</span>.</p>
<p><strong>Ejemplo:</strong></p>
<ol class="simple">
<li><p><span class="math notranslate nohighlight">\(f(x) = \cos(x), g(x)=\sin(x)\)</span> por lo que <span class="math notranslate nohighlight">\(h(x) = \sin(\cos(x))\)</span>:</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">Symbol</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">f</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">g</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">h</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">h</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">h</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p><strong>Otras formas:</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">sin</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">h</span> <span class="o">=</span> <span class="n">g</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">h</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">h</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">h</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<ol class="simple">
<li><p><span class="math notranslate nohighlight">\(f(x) = x_1 + \frac{1}{x_2}, g(x) = e^x\)</span> por lo que <span class="math notranslate nohighlight">\(h(x) = e^{x_1 + \frac{1}{x_2}}\)</span>:</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s2">&quot;x1, x2&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="n">x1</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="n">x2</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">f</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">exp</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">g</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">h</span> <span class="o">=</span> <span class="n">g</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">h</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p><strong>Derivada parcial de <span class="math notranslate nohighlight">\(f\)</span> respecto a <span class="math notranslate nohighlight">\(x_1\)</span>.</strong></p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">h</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p><strong>Derivada parcial de <span class="math notranslate nohighlight">\(f\)</span> respecto a <span class="math notranslate nohighlight">\(x_2\)</span>.</strong></p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">h</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p>Lo siguiente basado en <a class="reference external" href="https://stackoverflow.com/questions/39558515/how-to-get-the-gradient-and-hessian-sympy">how-to-get-the-gradient-and-hessian-sympy</a>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sympy.tensor.array</span> <span class="kn">import</span> <span class="n">derive_by_array</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">derive_by_array</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
</div>
<div class="section" id="caso-particular">
<h4>Caso particular:<a class="headerlink" href="#caso-particular" title="Permalink to this headline">¶</a></h4>
<p>Si <span class="math notranslate nohighlight">\(f: \mathbb{R}^n \rightarrow \mathbb{R}^m\)</span>, <span class="math notranslate nohighlight">\(f(x) = Ax +b\)</span> con <span class="math notranslate nohighlight">\(A \in \mathbb{R}^{m\times n},b \in \mathbb{R}^m\)</span>, <span class="math notranslate nohighlight">\(g:\mathbb{R}^m \rightarrow \mathbb{R}^p\)</span> y <span class="math notranslate nohighlight">\(h(z)=g(f(z))=g(Az+b)\)</span> con <span class="math notranslate nohighlight">\(\text{dom}h=\{x \in \mathbb{R}^n | Ax+b \in \text{dom}g\}\)</span> entonces la derivada de <span class="math notranslate nohighlight">\(h\)</span> en <span class="math notranslate nohighlight">\(x\)</span> es: <span class="math notranslate nohighlight">\(Dh(x) = Dg(f(x))Df(x)=Dg(Ax+b)A\)</span></p>
<p><strong>Obs:</strong> Si <span class="math notranslate nohighlight">\(f:\mathbb{R}^n \rightarrow \mathbb{R}^m, g:\mathbb{R}^m \rightarrow \mathbb{R}, h:\mathbb{R}^n \rightarrow \mathbb{R}\)</span> entonces: <span class="math notranslate nohighlight">\(\nabla h(x) = (Dh(x))^T = A^T(Dg(Ax+b))^T=A^T\nabla g(Ax+b) \in \mathbb{R}^{n\times 1}\)</span>.</p>
<p><strong>Ejemplo:</strong></p>
<ol class="simple">
<li><p>Sean <span class="math notranslate nohighlight">\(g:\mathbb{R}^n \rightarrow \mathbb{R}, x, v \in \mathbb{R}^n\)</span> y <span class="math notranslate nohighlight">\(\hat{g}: \mathbb{R} \rightarrow \mathbb{R}\)</span> con <span class="math notranslate nohighlight">\(\hat{g}(t)=g(x+tv)\)</span>, esto es, <span class="math notranslate nohighlight">\(\hat{g}\)</span> es <span class="math notranslate nohighlight">\(g\)</span> restringida a la línea <span class="math notranslate nohighlight">\(\{x+tv |t \in \mathbb{R} \}\)</span>, entonces:</p></li>
</ol>
<div class="math notranslate nohighlight">
\[(\nabla \hat{g}(t))^T = D\hat{g}(t) = \hat{g}^{(1)}(t) = (\nabla g(x+tv))^Tv.\]</div>
<p><strong>Comentario:</strong> el escalar <span class="math notranslate nohighlight">\(\hat{g}^{(1)}(0) = (\nabla g(x))^Tv\)</span> se llama <strong>derivada direccional</strong> de <span class="math notranslate nohighlight">\(g\)</span> en <span class="math notranslate nohighlight">\(x\)</span> en la dirección <span class="math notranslate nohighlight">\(v\)</span>.</p>
<ol class="simple">
<li><p>Sea <span class="math notranslate nohighlight">\(h: \mathbb{R}^n \rightarrow \mathbb{R}, h(x) = \log \left( \displaystyle \sum_{i=1}^m \exp(a_i^Tx+b_i) \right)\)</span> con <span class="math notranslate nohighlight">\(x\in \mathbb{R}^n,a_i\in \mathbb{R}^n \forall i=1,\dots,m\)</span> y <span class="math notranslate nohighlight">\(b_i \in \mathbb{R} \forall i=1,\dots,m\)</span> entonces: <span class="math notranslate nohighlight">\(Dh(x)=Dg(f(x))Df(x)\)</span> con <span class="math notranslate nohighlight">\(g: \mathbb{R}^m \rightarrow \mathbb{R}\)</span> dada por <span class="math notranslate nohighlight">\(g(y)=\log \left( \displaystyle \sum_{i=1}^m \exp(y_i) \right ), f(x)=Ax+b, A=(a_i)_{i=1}^m \in \mathbb{R}^{m\times n}, b \in \mathbb{R}^m.\)</span> y <span class="math notranslate nohighlight">\(h(x)=g(f(x))\)</span>. Entonces:</p></li>
</ol>
<div class="math notranslate nohighlight">
\[\begin{split}
Dh(x)=\left(\displaystyle \sum_{i=1}^m\exp(a_i^Tx+b_i) \right)^{-1}\left[ \begin{array}{c}
    \exp(a_1^Tx+b_1)\\
    \vdots\\
    \exp(a_m^Tx+b_m)
    \end{array}
    \right]A=(1^Tz)^{-1}z^TA
\end{split}\]</div>
<p>donde: <span class="math notranslate nohighlight">\(z=\left[ \begin{array}{c}
    \exp(a_1^Tx+b_1)\\
    \vdots\\
    \exp(a_m^Tx+b_m)
    \end{array}\right]\)</span>. Por lo tanto <span class="math notranslate nohighlight">\(\nabla h(x) = (1^Tz)^{-1}A^Tz\)</span>.</p>
</div>
</div>
<div class="section" id="segunda-derivada-de-una-funcion-f-mathbb-r-n-rightarrow-mathbb-r">
<h3>Segunda derivada de una función <span class="math notranslate nohighlight">\(f: \mathbb{R}^n \rightarrow \mathbb{R}\)</span>.<a class="headerlink" href="#segunda-derivada-de-una-funcion-f-mathbb-r-n-rightarrow-mathbb-r" title="Permalink to this headline">¶</a></h3>
<p>Sea <span class="math notranslate nohighlight">\(f:\mathbb{R}^n \rightarrow \mathbb{R}\)</span>. La segunda derivada o matriz <strong>Hessiana</strong> de <span class="math notranslate nohighlight">\(f\)</span> en <span class="math notranslate nohighlight">\(x \in \text{intdom}f\)</span> existe si <span class="math notranslate nohighlight">\(f\)</span> es dos veces diferenciable en <span class="math notranslate nohighlight">\(x\)</span>, se denota <span class="math notranslate nohighlight">\(\nabla^2f(x)\)</span> y sus componentes son segundas derivadas parciales:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\nabla^2f(x) = \left[\begin{array}{cccc}
\frac{\partial^2f(x)}{\partial x_1^2} &amp;\frac{\partial^2f(x)}{\partial x_2 \partial x_1}&amp;\dots&amp;\frac{\partial^2f(x)}{\partial x_n \partial x_1}\\
\frac{\partial^2f(x)}{\partial x_1 \partial x_2} &amp;\frac{\partial^2f(x)}{\partial x_2^2} &amp;\dots&amp;\frac{\partial^2f(x)}{\partial x_n \partial x_2}\\
\vdots &amp;\vdots&amp; \ddots&amp;\vdots\\
\frac{\partial^2f(x)}{\partial x_1 \partial x_n} &amp;\frac{\partial^2f(x)}{\partial x_2 \partial x_n}&amp;\dots&amp;\frac{\partial^2f(x)}{\partial x_n^2} \\
\end{array}
\right]
\end{split}\]</div>
<p><strong>Comentarios:</strong></p>
<ul class="simple">
<li><p>La aproximación de segundo orden a <span class="math notranslate nohighlight">\(f\)</span> en <span class="math notranslate nohighlight">\(x\)</span> (o también para puntos cercanos a <span class="math notranslate nohighlight">\(x\)</span>) es la función cuadrática:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[f(x) + (\nabla f(x))^T(z-x)+\frac{1}{2}(z-x)^T\nabla^2f(x)(z-x)\]</div>
<p>la cual es una función de <span class="math notranslate nohighlight">\(z\)</span>.</p>
<ul class="simple">
<li><p>Se cumple:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\displaystyle \lim_{z \rightarrow x, z \neq x} \frac{|f(z)-[f(x)+(\nabla f(x))^T(z-x)+\frac{1}{2}(z-x)^T\nabla^2f(x)(z-x)]|}{||z-x||_2} = 0, z \in \text{dom}f\]</div>
<ul class="simple">
<li><p>Se tiene lo siguiente:</p>
<ul>
<li><p><span class="math notranslate nohighlight">\(\nabla f\)</span> es una función llamada gradient mapping (o simplemente gradiente).</p></li>
<li><p><span class="math notranslate nohighlight">\(\nabla f:\mathbb{R}^n \rightarrow \mathbb{R}^n\)</span> tiene regla de correspondencia <span class="math notranslate nohighlight">\(\nabla f(x)\)</span> (evaluar en <span class="math notranslate nohighlight">\(x\)</span> la matriz <span class="math notranslate nohighlight">\((Df(\cdot))^T\)</span>).</p></li>
<li><p>Si <span class="math notranslate nohighlight">\(f\)</span> es dos veces diferenciable entonces: <span class="math notranslate nohighlight">\(D\nabla f(x) = \nabla^2f(x)\)</span>.</p></li>
<li><p><strong>Importante:</strong> si <span class="math notranslate nohighlight">\(f \in \mathcal{C}^2(\text{dom}f)\)</span> entonces la Hessiana es una matriz simétrica.</p></li>
</ul>
</li>
</ul>
<div class="section" id="regla-de-la-cadena-para-la-segunda-derivada">
<h4>Regla de la cadena para la segunda derivada<a class="headerlink" href="#regla-de-la-cadena-para-la-segunda-derivada" title="Permalink to this headline">¶</a></h4>
<p><strong>Caso 1:</strong> Sean <span class="math notranslate nohighlight">\(f:\mathbb{R}^n \rightarrow \mathbb{R}, g:\mathbb{R} \rightarrow \mathbb{R}, h:\mathbb{R}^n \rightarrow \mathbb{R}\)</span> con  <span class="math notranslate nohighlight">\(h(x) = g(f(x))\)</span>, entonces: <span class="math notranslate nohighlight">\(\nabla^2h(x) = D\nabla h(x)\)</span> y <span class="math notranslate nohighlight">\(\nabla h(x)=(Dh(x))^T = (Dg(f(x))Df(x))^T=\frac{dg(x)}{dx}\nabla f(x)\)</span> por lo que:</p>
<p><span class="math notranslate nohighlight">\(\nabla^2 h(x) = D\nabla h(x)=D \left(\frac{dg(f(x))}{dx}\nabla f(x)\right) = \frac{dg(f(x))}{dx}\nabla^2 f(x)+\left(\frac{d^2g(f(x))}{dx}\nabla f(x) (\nabla f(x))^T \right)^T=\frac{dg(f(x))}{dx}\nabla^2 f(x)+\frac{d^2g(f(x))}{dx} \nabla f(x) (\nabla f(x))^T\)</span></p>
<p><strong>Caso 2:</strong> Sean <span class="math notranslate nohighlight">\(f:\mathbb{R}^n \rightarrow \mathbb{R}^m, f(x) = Ax+b, A \in \mathbb{R}^{m\times n}, b \in \mathbb{R}^m\)</span> y <span class="math notranslate nohighlight">\(h(x) = g(f(x))\)</span> con <span class="math notranslate nohighlight">\(g:\mathbb{R}^m \rightarrow \mathbb{R}^p, h:\mathbb{R}^n \rightarrow \mathbb{R}^p\)</span>, entonces:</p>
<div class="math notranslate nohighlight">
\[\nabla h(x) = (Dh(x))^T = (Dg(f(x))Df(x))^T = (Dg(Ax+b)A)^T = A^TDg(Ax+b).\]</div>
<p><strong>Obs:</strong> si <span class="math notranslate nohighlight">\(p=1\)</span> se tiene: <span class="math notranslate nohighlight">\(\nabla^2h(x) = D \nabla h(x) = A^T \nabla^2g(Ax+b)A.\)</span></p>
<p><strong>Ejemplos:</strong></p>
<ul class="simple">
<li><p>Sea <span class="math notranslate nohighlight">\(\hat{g}(t) = g(x+tv)\)</span> con <span class="math notranslate nohighlight">\(x,v \in \mathbb{R}^n, t \in \mathbb{R}\)</span> y <span class="math notranslate nohighlight">\(g:\mathbb{R}^n \rightarrow \mathbb{R}\)</span>, <span class="math notranslate nohighlight">\(\hat{g}: \mathbb{R} \rightarrow \mathbb{R}\)</span> es decir, <span class="math notranslate nohighlight">\(\hat{g}\)</span> es <span class="math notranslate nohighlight">\(g\)</span> restringida a la línea <span class="math notranslate nohighlight">\(\{x+tv|t \in \mathbb{R}\}\)</span>, entonces:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[(\nabla \hat{g}(t))^T = D\hat{g}(t) = \frac{\hat{g}(t)}{dt} = Dg(x+tv)v = \nabla g(x+tv)^Tv\]</div>
<p>y:</p>
<div class="math notranslate nohighlight">
\[\nabla^2 \hat{g}(t) = \frac{d^2\hat{g}(t)}{dt^2} = D\nabla g(x+tv)v=v^T\nabla^2g(x+tv)v.\]</div>
<ul class="simple">
<li><p>Sean <span class="math notranslate nohighlight">\(h: \mathbb{R}^n \rightarrow \mathbb{R}, h(x) = \log \left( \displaystyle \sum_{i=1}^m \exp(a_i^Tx+b_i)\right)\)</span> con <span class="math notranslate nohighlight">\(x \in \mathbb{R}^n, a_i \in \mathbb{R}^n \forall i=1,\dots,m\)</span> y <span class="math notranslate nohighlight">\(b_i \in \mathbb{R} \forall i=1,\dots,m\)</span>. Entonces: <span class="math notranslate nohighlight">\(Dh(x)=Dg(f(x))Df(x)\)</span> con <span class="math notranslate nohighlight">\(g(y) = \log \left( \displaystyle \sum_{i=1}^m \exp(y_i)\right ), f(x) = Ax+b, A=(a_i)_{i=1}^m \in \mathbb{R}^{m\times n}, b \in \mathbb{R}^m, h(x) = g(f(x))\)</span>.</p></li>
</ul>
<p>Como se desarrolló anteriormente <span class="math notranslate nohighlight">\(\nabla h(x) = (1^Tz)^{-1}A^Tz\)</span> con <span class="math notranslate nohighlight">\(z=\left[ \begin{array}{c}
    \exp(a_1^Tx+b_1)\\
    \vdots\\
    \exp(a_m^Tx+b_m)
    \end{array}\right]\)</span>.</p>
<div class="math notranslate nohighlight">
\[\therefore \nabla^2 h(x) = D\nabla h(x) = A^T \nabla^2g(Ax+b)A\text{ (por caso }2)\]</div>
<p>donde: $\nabla^2g(y)=(1^Ty)^{-1}\text{diag}(y)-(1^Ty)^{-2}yy^T $ (por caso <span class="math notranslate nohighlight">\(1\)</span> tomando <span class="math notranslate nohighlight">\(\log:\mathbb{R} \rightarrow \mathbb{R}, \sum \exp: \mathbb{R}^m \rightarrow \mathbb{R}\)</span>)</p>
<div class="math notranslate nohighlight">
\[\therefore  \nabla^2 h(x) = A^T\left[(1^Tz)^{-1}\text{diag}(z)-(1^Tz)^{-2}zz^T \right]A\]</div>
<p>con <span class="math notranslate nohighlight">\(\text{diag}(c)\)</span> matriz diagonal con elementos en su diagonal iguales a las entradas del vector <span class="math notranslate nohighlight">\(c\)</span>.</p>
<p><strong>Referencias</strong></p>
<ol class="simple">
<li><p>S. P. Boyd, L. Vandenberghe, Convex Optimization. Cambridge University Press, 2004.</p></li>
</ol>
</div>
</div>
</div>
<span id="document-I.computo_cientifico/1.6/Polinomios_de_Taylor_y_diferenciacion_numerica"></span><div class="admonition-notas-para-contenedor-de-docker admonition">
<p class="admonition-title">Notas para contenedor de docker:</p>
<p>Comando de docker para ejecución de la nota de forma local:</p>
<p>nota: cambiar <code class="docutils literal notranslate"><span class="pre">&lt;ruta</span> <span class="pre">a</span> <span class="pre">mi</span> <span class="pre">directorio&gt;</span></code> por la ruta de directorio que se desea mapear a <code class="docutils literal notranslate"><span class="pre">/datos</span></code> dentro del contenedor de docker.</p>
<p><code class="docutils literal notranslate"><span class="pre">docker</span> <span class="pre">run</span> <span class="pre">--rm</span> <span class="pre">-v</span> <span class="pre">&lt;ruta</span> <span class="pre">a</span> <span class="pre">mi</span> <span class="pre">directorio&gt;:/datos</span> <span class="pre">--name</span> <span class="pre">jupyterlab_optimizacion</span> <span class="pre">-p</span> <span class="pre">8888:8888</span> <span class="pre">-d</span> <span class="pre">palmoreck/jupyterlab_optimizacion:2.1.4</span></code></p>
<p>password para jupyterlab: <code class="docutils literal notranslate"><span class="pre">qwerty</span></code></p>
<p>Detener el contenedor de docker:</p>
<p><code class="docutils literal notranslate"><span class="pre">docker</span> <span class="pre">stop</span> <span class="pre">jupyterlab_optimizacion</span></code></p>
<p>Documentación de la imagen de docker <code class="docutils literal notranslate"><span class="pre">palmoreck/jupyterlab_optimizacion:2.1.4</span></code> en <a class="reference external" href="https://github.com/palmoreck/dockerfiles/tree/master/jupyterlab/optimizacion">liga</a>.</p>
</div>
<hr class="docutils" />
<p>Nota generada a partir de la <a class="reference external" href="https://www.dropbox.com/s/jfrxanjls8kndjp/Diferenciacion_e_Integracion.pdf?dl=0">liga1</a>, <a class="reference external" href="https://www.dropbox.com/s/mmd1uzvwhdwsyiu/4.3.2.Teoria_de_convexidad_Funciones_convexas.pdf?dl=0">liga2</a> e inicio de <a class="reference external" href="https://www.dropbox.com/s/ko86cce1olbtsbk/4.3.1.Teoria_de_convexidad_Conjuntos_convexos.pdf?dl=0">liga3</a>.</p>
<div class="section" id="polinomios-de-taylor-y-diferenciacion-numerica">
<span id="ptdn"></span><h2>1.6 Polinomios de Taylor y diferenciación numérica<a class="headerlink" href="#polinomios-de-taylor-y-diferenciacion-numerica" title="Permalink to this headline">¶</a></h2>
<div class="section" id="problema-como-aproximar-una-funcion-f-en-un-punto-x-1">
<h3>Problema: ¿Cómo aproximar una función <span class="math notranslate nohighlight">\(f\)</span> en un punto <span class="math notranslate nohighlight">\(x_1\)</span>?<a class="headerlink" href="#problema-como-aproximar-una-funcion-f-en-un-punto-x-1" title="Permalink to this headline">¶</a></h3>
<p>Si <span class="math notranslate nohighlight">\(f\)</span> es continuamente diferenciable en <span class="math notranslate nohighlight">\(x_0\)</span> y <span class="math notranslate nohighlight">\(f^{(1)}, f^{(2)}\)</span> existen y están acotadas en <span class="math notranslate nohighlight">\(x_0\)</span> entonces:</p>
<div class="math notranslate nohighlight">
\[f(x_1) \approx f(x_0) + f^{(1)}(x_0)(x_1-x_0)\]</div>
<p>y se llama <strong>aproximación de orden 1</strong>. Ver <a class="reference internal" href="README.html#dfdf"><span class="std std-ref">Definición de función, derivada de una función</span></a> para definición de continuidad, diferenciabilidad y propiedades</p>
<p><strong>Obs:</strong> obsérvese que lo anterior requiere de los valores: <span class="math notranslate nohighlight">\(x_0, x_1, f(x_0), f^{(1)}(x_0)\)</span>. Esta aproximación tiene un error de <strong>orden</strong> <span class="math notranslate nohighlight">\(2\)</span> pues su error es <strong>proporcional</strong> al cuadrado del ancho del intervalo: <span class="math notranslate nohighlight">\(h=x_1-x_0\)</span>, esto es, si reducimos a la mitad <span class="math notranslate nohighlight">\(h\)</span> entonces el error se reduce en una cuarta parte.</p>
<p>Otra aproximación más simple sería:</p>
<div class="math notranslate nohighlight">
\[f(x_1) \approx f(x_0)\]</div>
<p>lo cual sólo requiere del conocimiento de <span class="math notranslate nohighlight">\(f(x_0)\)</span> y se llama aproximación de <strong>orden</strong> <span class="math notranslate nohighlight">\(0\)</span>, sin embargo esta aproximación tiene un error de <strong>orden</strong> <span class="math notranslate nohighlight">\(1\)</span> pues este es proporcional a <span class="math notranslate nohighlight">\(h\)</span> , esto es, al reducir a la mitad <span class="math notranslate nohighlight">\(h\)</span> se reduce a la mitad el error.</p>
<p>Estos errores los llamamos errores por <strong>truncamiento</strong>. Utilizamos la notación “O grande” <span class="math notranslate nohighlight">\(\mathcal{O}(\cdot)\)</span> para escribir lo anterior:</p>
<div class="math notranslate nohighlight">
\[f(x)-f(x_0)=\mathcal{O}(h)\]</div>
<p>con la variable <span class="math notranslate nohighlight">\(h=x-x_0\)</span>. Análogamente:</p>
<div class="math notranslate nohighlight">
\[f(x)-(f(x_0)+f^{(1)}(x_0)(x-x_0)) = \mathcal{O}(h^2).\]</div>
<p><strong>Obs:</strong> no confundir órdenes de  una aproximación con órdenes de error.</p>
<p>Otras aproximaciones a una función se pueden realizar con:</p>
<ul class="simple">
<li><p>Interpoladores polinomiales (representación por Vandermonde, Newton, Lagrange).</p></li>
</ul>
</div>
<div class="section" id="aproximacion-a-una-funcion-por-el-teorema-de-taylor">
<h3>Aproximación a una función por el teorema de Taylor<a class="headerlink" href="#aproximacion-a-una-funcion-por-el-teorema-de-taylor" title="Permalink to this headline">¶</a></h3>
<p>En esta sección se presenta el teorema de Taylor, el cual, bajo ciertas hipótesis nos proporciona una expansión de una función alrededor de un punto. Este teorema será utilizado en <strong>diferenciación e integración numérica</strong>. El teorema es el siguiente:</p>
<p>Sea <span class="math notranslate nohighlight">\(f: \mathbb{R} \rightarrow \mathbb{R}\)</span>, <span class="math notranslate nohighlight">\(f \in \mathcal{C}^n([a,b])\)</span> tal que <span class="math notranslate nohighlight">\(f^{(n+1)}\)</span> existe en [a,b]. Si <span class="math notranslate nohighlight">\(x_0 \in [a,b]\)</span> entonces <span class="math notranslate nohighlight">\(\forall x \in [a,b]\)</span> se tiene: <span class="math notranslate nohighlight">\(f(x) = P_n(x) + R_n(x)\)</span> donde:</p>
<div class="math notranslate nohighlight">
\[P_n(x) = \displaystyle \sum_{k=0}^n \frac{f^{(k)}(x_0)(x-x_0)^k}{k!} \quad (f^{(0)} = f)\]</div>
<p><strong>Comentarios:</strong></p>
<ul class="simple">
<li><p>El teorema de Taylor nos dice que cualquier función suave (función en <span class="math notranslate nohighlight">\(\mathcal{C}^n)\)</span> se le puede aproximar por un polinomio en el intervalo <span class="math notranslate nohighlight">\([a,b]\)</span>, de hecho <span class="math notranslate nohighlight">\(f(x) \approx P_n(x)\)</span>.</p></li>
<li><p>El teorema de Taylor es una generalización del <a class="reference external" href="https://en.wikipedia.org/wiki/Mean_value_theorem">teorema del valor medio para derivadas</a></p></li>
<li><p><span class="math notranslate nohighlight">\(P_n(x)\)</span> se le llama polinomio de Taylor alrededor de <span class="math notranslate nohighlight">\(x_0\)</span> de orden <span class="math notranslate nohighlight">\(n\)</span> y <span class="math notranslate nohighlight">\(R_n(x)\)</span> es llamado residuo de Taylor alrededor de <span class="math notranslate nohighlight">\(x_0\)</span> de orden <span class="math notranslate nohighlight">\(n+1\)</span>, tiene otras expresiones para representarlo y la que se utiliza en el enunciado anterior es en su forma de Lagrange (ver <a class="reference external" href="https://en.wikipedia.org/wiki/Taylor%27s_theorem">liga</a> para otras expresiones del residuo).</p></li>
<li><p><span class="math notranslate nohighlight">\(\xi_x\)</span> es un punto entre <span class="math notranslate nohighlight">\(x_0, x\)</span> desconocido y está en función de <span class="math notranslate nohighlight">\(x\)</span> (por eso se le escribe un subíndice).</p></li>
<li><p>Una forma del teorema de Taylor es escribirlo definiendo a la variable <span class="math notranslate nohighlight">\(h=x-x_0\)</span>:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[f(x) = f(x_0+h) = P_n(h) + R_n(h) = \displaystyle \sum_{k=0}^n \frac{f^{(k)}(x_0)h^k}{k!} + \frac{f^{(n+1)}(\xi_h)h^{n+1}}{(n+1)!}\]</div>
<p>y si <span class="math notranslate nohighlight">\(f^{(n+1)}\)</span> es acotada, escribimos: <span class="math notranslate nohighlight">\(R_n(h) = \mathcal{O}(h^{n+1})\)</span>.</p>
<p><strong>Ejemplo: graficar la función y los polinomios de Taylor constante, lineal y cuadrático en una sola gráfica con <code class="docutils literal notranslate"><span class="pre">ggplot2</span></code> en el intervalo [1,2] para la función <span class="math notranslate nohighlight">\(\frac{1}{x}\)</span> con centro en <span class="math notranslate nohighlight">\(x_0=1.5\)</span>. ¿Cuánto es la aproximación de los polinomios en x=1.9? (para esta pregunta calcula el error relativo de tus aproximaciones).</strong></p>
<p>Obtengamos los polinomios de Taylor de orden <span class="math notranslate nohighlight">\(n\)</span> con <span class="math notranslate nohighlight">\(n \in \{0,1,2\}\)</span> y centro en <span class="math notranslate nohighlight">\(x_0=1.5\)</span> para la función <span class="math notranslate nohighlight">\(\frac{1}{x}\)</span> en el intervalo <span class="math notranslate nohighlight">\([1,2]\)</span>. Los polinomios de Taylor son:</p>
<div class="math notranslate nohighlight">
\[P_0(x) = f(x_0) = \frac{2}{3} \quad \text{(constante)}\]</div>
<div class="math notranslate nohighlight">
\[P_1(x) = f(x_0) + f^{(1)}(x_0)(x-x_0) = \frac{2}{3} - \frac{1}{x_0^2}(x-x_0) \quad \text{(lineal)}\]</div>
<div class="math notranslate nohighlight">
\[P_2(x) = f(x_0) + f^{(1)}(x_0)(x-x_0) + \frac{f^{(2)}(x_0)(x-x_0)^2}{2} = \frac{2}{3} - \frac{1}{x_0^2}(x-x_0) + \frac{2}{x_0^3}(x-x_0)^2 \quad \text{(cuadrático)}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">library</span><span class="p">(</span><span class="n">ggplot2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">options</span><span class="p">(</span><span class="nb">repr</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">width</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="nb">repr</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">height</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span> <span class="c1">#esta línea sólo se ejecuta para jupyterlab con R</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Aprox_Taylor</span> <span class="o">&lt;-</span> <span class="n">function</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">centro</span><span class="p">,</span><span class="n">n</span><span class="p">){</span>
    <span class="n">length_x</span> <span class="o">=</span> <span class="n">length</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">evaluacion</span> <span class="o">=</span> <span class="n">rep</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">length_x</span><span class="p">)</span>
    <span class="k">for</span><span class="p">(</span><span class="n">j</span> <span class="ow">in</span> <span class="mi">1</span><span class="p">:</span><span class="n">length_x</span><span class="p">){</span>
        <span class="n">constante</span> <span class="o">=</span> <span class="n">centro</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">evaluacion</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">constante</span>
        <span class="k">for</span><span class="p">(</span><span class="n">k</span> <span class="ow">in</span> <span class="mi">1</span><span class="p">:</span><span class="n">n</span><span class="p">)</span>
            <span class="n">constante</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="n">centro</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">-</span><span class="n">centro</span><span class="p">)</span><span class="o">*</span><span class="n">constante</span>
            <span class="n">evaluacion</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">evaluacion</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">+</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">constante</span>
    <span class="p">}</span>
    <span class="n">evaluacion</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x0</span><span class="o">&lt;-</span><span class="mf">1.5</span>
<span class="n">x</span><span class="o">&lt;-</span> <span class="n">seq</span><span class="p">(</span><span class="n">from</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">to</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">by</span><span class="o">=.</span><span class="mi">005</span><span class="p">)</span>
<span class="n">n</span><span class="o">&lt;-</span><span class="n">c</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">f</span><span class="o">&lt;-</span><span class="n">function</span><span class="p">(</span><span class="n">z</span><span class="p">)</span><span class="mi">1</span><span class="o">/</span><span class="n">z</span>
<span class="n">y</span><span class="o">&lt;-</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">y_Taylor_0</span><span class="o">&lt;-</span><span class="mi">1</span><span class="o">/</span><span class="n">x0</span><span class="o">*</span><span class="n">rep</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">length</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="n">y_Taylor_1</span><span class="o">&lt;-</span><span class="n">Aprox_Taylor</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">x0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">y_Taylor_2</span><span class="o">&lt;-</span><span class="n">Aprox_Taylor</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">x0</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gg</span> <span class="o">&lt;-</span> <span class="n">ggplot</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gg</span><span class="o">+</span>
<span class="n">geom_line</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;f(x)&#39;</span><span class="p">))</span> <span class="o">+</span> 
<span class="n">geom_line</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">y_Taylor_0</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;constante&#39;</span><span class="p">))</span><span class="o">+</span>
<span class="n">geom_line</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">y_Taylor_1</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;lineal&#39;</span><span class="p">))</span> <span class="o">+</span> 
<span class="n">geom_line</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">y_Taylor_2</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;cuadratico&#39;</span><span class="p">))</span> <span class="o">+</span> 
<span class="n">geom_point</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x0</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">f</span><span class="p">(</span><span class="n">x0</span><span class="p">)),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">err_relativo</span><span class="o">&lt;-</span><span class="n">function</span><span class="p">(</span><span class="n">aprox</span><span class="p">,</span><span class="n">obj</span><span class="p">){</span>
    <span class="nb">abs</span><span class="p">(</span><span class="n">aprox</span><span class="o">-</span><span class="n">obj</span><span class="p">)</span><span class="o">/</span><span class="nb">abs</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x_obj</span><span class="o">=</span><span class="mf">1.9</span>
<span class="n">f_x_obj</span><span class="o">=</span><span class="n">f</span><span class="p">(</span><span class="n">x_obj</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;error relativo polinomio constante&#39;</span><span class="p">)</span>
<span class="n">err_relativo</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">x0</span><span class="p">,</span><span class="n">f_x_obj</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;error relativo polinomio lineal&#39;</span><span class="p">)</span>
<span class="n">err_relativo</span><span class="p">(</span><span class="n">Aprox_Taylor</span><span class="p">(</span><span class="n">x_obj</span><span class="p">,</span><span class="n">x0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">f_x_obj</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;error relativo polinomio cuadrático&#39;</span><span class="p">)</span>
<span class="n">err_relativo</span><span class="p">(</span><span class="n">Aprox_Taylor</span><span class="p">(</span><span class="n">x_obj</span><span class="p">,</span><span class="n">x0</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">f_x_obj</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[1] &quot;error relativo polinomio constante&quot;
</pre></div>
</div>
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[1] &quot;error relativo polinomio lineal&quot;
</pre></div>
</div>
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[1] &quot;error relativo polinomio cuadrático&quot;
</pre></div>
</div>
</div>
</div>
<p><strong>Pregunta:</strong> ¿por qué se tiene mejor aproximación con un polinomio constante o lineal que con un polinomio cuadrático? ¿no deberíamos tener menor error al añadir más y más términos en el polinomio de Taylor? ¿de qué depende tener una buena aproximación al utilizar polinomios de Taylor para una función <span class="math notranslate nohighlight">\(f\)</span> en general?.</p>
<p><strong>Ejercicio:</strong> Aproximar <span class="math notranslate nohighlight">\(f(1)\)</span> con polinomios de Taylor de orden <span class="math notranslate nohighlight">\(0,1,2,3,4\)</span> si <span class="math notranslate nohighlight">\(f(x)=-0.1x^4-0.15x^3-0.5x^2-0.25x+1.2\)</span> con centro en <span class="math notranslate nohighlight">\(x0=0\)</span>. Calcula errores relativos de tus aproximaciones. Realiza las gráficas de cada polinomio en el intervalo <span class="math notranslate nohighlight">\([0,1]\)</span> con <code class="docutils literal notranslate"><span class="pre">ggplot2</span></code>. Observa que <span class="math notranslate nohighlight">\(R_5(x)\)</span> es cero.</p>
<div class="section" id="teorema-de-taylor-para-una-funcion-f-mathbb-r-n-rightarrow-mathbb-r">
<h4>Teorema de Taylor para una función <span class="math notranslate nohighlight">\(f: \mathbb{R}^n \rightarrow \mathbb{R}\)</span><a class="headerlink" href="#teorema-de-taylor-para-una-funcion-f-mathbb-r-n-rightarrow-mathbb-r" title="Permalink to this headline">¶</a></h4>
<p>Sea <span class="math notranslate nohighlight">\(f: \mathbb{R}^n \rightarrow \mathbb{R}\)</span> diferenciable en <span class="math notranslate nohighlight">\(\text{dom}f\)</span>. Si <span class="math notranslate nohighlight">\(x_0, x \in \text{dom}f\)</span> y <span class="math notranslate nohighlight">\(x_0+t(x-x_0) \in \text{dom}f, \forall t \in (0,1),\)</span>  entonces <span class="math notranslate nohighlight">\(\forall x \in \text{dom}f\)</span> se tiene <span class="math notranslate nohighlight">\(f(x) = P_0(x) + R_0(x)\)</span> donde:</p>
<div class="math notranslate nohighlight">
\[P_0(x) = f(x_0)\]</div>
<div class="math notranslate nohighlight">
\[R_0(x) = \nabla f(x_0+t_x(x-x_0))^T(x-x_0)\]</div>
<p>para alguna <span class="math notranslate nohighlight">\(t_x \in (0,1)\)</span> y <span class="math notranslate nohighlight">\(\nabla f(\cdot)\)</span> gradiente de <span class="math notranslate nohighlight">\(f\)</span> (ver al final de esta nota la definición de gradiente). Esta se llama <strong>aproximación de orden <span class="math notranslate nohighlight">\(0\)</span></strong> para <span class="math notranslate nohighlight">\(f\)</span> con centro en <span class="math notranslate nohighlight">\(x_0\)</span>. Si <span class="math notranslate nohighlight">\(\nabla f(\cdot)\)</span> es acotado en <span class="math notranslate nohighlight">\(\text{dom}f\)</span> entonces se escribe: <span class="math notranslate nohighlight">\(R_0(x)=\mathcal{O}(||x-x_0||)\)</span>.</p>
<p>Si además <span class="math notranslate nohighlight">\(f\)</span> es continuamente diferenciable en <span class="math notranslate nohighlight">\(\text{dom}f\)</span>(su derivada es continua, ver al final de esta nota definición de continuidad), <span class="math notranslate nohighlight">\(f^{(2)}\)</span> existe en <span class="math notranslate nohighlight">\(\text{dom}f\)</span>, se tiene <span class="math notranslate nohighlight">\(f(x) = P_1(x) + R_1(x)\)</span> donde:</p>
<div class="math notranslate nohighlight">
\[P_1(x) = f(x_0) + \nabla f(x_0)^T(x-x_0)\]</div>
<div class="math notranslate nohighlight">
\[R_1(x) = \frac{1}{2}(x-x_0)^T \nabla ^2f(x_0+t_x(x-x_0))(x-x_0)\]</div>
<p>para alguna <span class="math notranslate nohighlight">\(t_x \in (0,1)\)</span> y <span class="math notranslate nohighlight">\(\nabla^2 f(\cdot)\)</span> Hessiana de <span class="math notranslate nohighlight">\(f\)</span> (ver al final de esta nota definición de la matriz Hessiana). Esta se llama <strong>aproximación de orden <span class="math notranslate nohighlight">\(1\)</span></strong> para <span class="math notranslate nohighlight">\(f\)</span> con centro en <span class="math notranslate nohighlight">\(x_0\)</span>. Si <span class="math notranslate nohighlight">\(\nabla^2f(\cdot)\)</span> es acotada en <span class="math notranslate nohighlight">\(\text{dom}f\)</span> entonces se escribe: <span class="math notranslate nohighlight">\(R_1(x) = \mathcal{O}(||x-x_0||^2)\)</span>.</p>
<p>Si <span class="math notranslate nohighlight">\(f^{(2)}\)</span> es continuamente diferenciable y <span class="math notranslate nohighlight">\(f^{(3)}\)</span> existe y es acotada en <span class="math notranslate nohighlight">\(\text{dom}f\)</span>, se tiene <span class="math notranslate nohighlight">\(f(x)=P_2(x) + R_2(x)\)</span> donde:</p>
<div class="math notranslate nohighlight">
\[P_2(x) = f(x_0) + \nabla f(x_0)^T(x-x_0) + \frac{1}{2}(x-x_0)^T \nabla ^2f(x_0)(x-x_0)\]</div>
<div class="math notranslate nohighlight">
\[R_2(x)= \mathcal{O}(||x-x_0||^3).\]</div>
<p>Esta se llama <strong>aproximación de orden <span class="math notranslate nohighlight">\(2\)</span></strong> para <span class="math notranslate nohighlight">\(f\)</span> con centro en <span class="math notranslate nohighlight">\(x_0\)</span>.</p>
<p><strong>Obs:</strong> en este caso <span class="math notranslate nohighlight">\(f^{(3)}\)</span> es un tensor.</p>
<p><strong>Comentarios:</strong></p>
<ul class="simple">
<li><p>Tomando <span class="math notranslate nohighlight">\(h=x-x_0\)</span>, se reescribe el teorema como sigue, por ejemplo para la aproximación de orden <span class="math notranslate nohighlight">\(1\)</span> incluyendo su residuo:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[f(x) = f(x_0 + h) = \underbrace{f(x_0) + \nabla f(x_0)^Th}_{\textstyle P_1(h)} + \underbrace{\frac{1}{2}h^T \nabla ^2f(x_0+t_xh)h}_{\textstyle R_1(h)}.\]</div>
<p>Si <span class="math notranslate nohighlight">\(f^{(2)}\)</span> es acotada en <span class="math notranslate nohighlight">\(\text{dom}f\)</span>, escribimos: <span class="math notranslate nohighlight">\(R_1(h)=\mathcal{O}(||h||^2)\)</span>.</p>
</div>
</div>
<div class="section" id="diferenciacion-numerica-por-diferencias-finitas">
<h3>Diferenciación numérica por diferencias finitas<a class="headerlink" href="#diferenciacion-numerica-por-diferencias-finitas" title="Permalink to this headline">¶</a></h3>
<p>Las fórmulas de aproximación a las derivadas por diferencias finitas pueden obtenerse con los polinomios de Taylor, presentes en el teorema del mismo autor, por ejemplo:</p>
<p>Sea <span class="math notranslate nohighlight">\(f \in \mathcal{C}^1([a,b])\)</span> y <span class="math notranslate nohighlight">\(f^{(2)}\)</span> existe y está acotada <span class="math notranslate nohighlight">\(\forall x \in [a,b]\)</span> entonces, si <span class="math notranslate nohighlight">\(x+h \in [a,b]\)</span> con <span class="math notranslate nohighlight">\(h&gt;0\)</span> por el teorema de Taylor:</p>
<div class="math notranslate nohighlight">
\[f(x+h) = f(x) + f^{(1)}(x)h + f^{(2)}(\xi_{x+h})\frac{h^2}{2}\]</div>
<div class="math notranslate nohighlight">
\[f^{(1)}(x) = \frac{f(x+h)-f(x)}{h} - f^{(2)}(\xi_{x+h})\frac{h}{2}.\]</div>
<p>y escribimos:</p>
<div class="math notranslate nohighlight">
\[f^{(1)}(x) = \frac{f(x+h)-f(x)}{h} + \mathcal{O}(h).\]</div>
<p>La aproximación <span class="math notranslate nohighlight">\(\frac{f(x+h)-f(x)}{h}\)</span> es una fórmula por diferencias hacia delante con error de orden <span class="math notranslate nohighlight">\(1\)</span>. Gráficamente se tiene:</p>
<img src="https://dl.dropboxusercontent.com/s/r1ypkxkwa9g3pmk/dif_hacia_delante.png?dl=0" heigth="500" width="500"><p>Con las mismas suposiciones es posible obtener la fórmula para la aproximación por diferencias hacia atrás:</p>
<div class="math notranslate nohighlight">
\[f^{(1)}(x) = \frac{f(x)-f(x-h)}{h} + \mathcal{O}(h), h &gt;0.\]</div>
<img src="https://dl.dropboxusercontent.com/s/mxmc8kohurlu9sp/dif_hacia_atras.png?dl=0" heigth="500" width="500"><p>Considerando <span class="math notranslate nohighlight">\(f \in \mathcal{C}^2([a,b]), f^{(3)}\)</span> existe y está acotada <span class="math notranslate nohighlight">\(\forall x \in [a,b]\)</span> si <span class="math notranslate nohighlight">\(x-h, x+h \in [a,b]\)</span> y <span class="math notranslate nohighlight">\(h&gt;0\)</span> entonces:</p>
<div class="math notranslate nohighlight">
\[f^{(1)}(x) = \frac{f(x+h)-f(x-h)}{2h} + \mathcal{O}(h^2), h &gt;0.\]</div>
<p>y el cociente <span class="math notranslate nohighlight">\(\frac{f(x+h)-f(x-h)}{2h}\)</span> es la aproximación por diferencias centradas con error de orden <span class="math notranslate nohighlight">\(2\)</span>. Gráficamente:</p>
<img src="https://dl.dropboxusercontent.com/s/jwi0y1t5z58pydz/dif_centradas.png?dl=0" heigth="500" width="500"><p><strong>Obs:</strong> la aproximación por diferencias finitas a la primer derivada de la función tiene un error de orden <span class="math notranslate nohighlight">\(\mathcal{O}(h)\)</span> por lo que una elección de <span class="math notranslate nohighlight">\(h\)</span> igual a <span class="math notranslate nohighlight">\(.1 = 10^{-1}\)</span> generará aproximaciones con alrededor de un dígito correcto.</p>
<p><strong>Obs:</strong> la diferenciación numérica por diferencias finitas no es un proceso con una alta exactitud pues los problemas del redondeo de la aritmética en la máquina se hacen presentes en el mismo (ver nota <a class="reference internal" href="README.html#spf"><span class="std std-ref">Sistema de punto flotante</span></a>). Como ejemplo de esta situación realicemos el siguiente ejemplo.</p>
<p><strong>Ejemplo: realizar una gráfica de log(error relativo) vs log(h) (h en el eje horizontal) con <code class="docutils literal notranslate"><span class="pre">ggplot2</span></code> para aproximar la primera derivada de <span class="math notranslate nohighlight">\(f(x)=e^{-x}\)</span> en <span class="math notranslate nohighlight">\(x=1\)</span> con <span class="math notranslate nohighlight">\(h \in \{10^{-16}, 10^{-14}, \dots , 10^{-1}\}\)</span> y diferencias hacia delante. Valor a aproximar: <span class="math notranslate nohighlight">\(f^{(1)}(1) = -e^{-1}\)</span></strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="o">&lt;-</span><span class="n">function</span><span class="p">(</span><span class="n">x</span><span class="p">){</span>
    <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">)</span>
<span class="p">}</span>
<span class="n">aprox_1a_derivada</span><span class="o">&lt;-</span><span class="n">function</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">h</span><span class="p">){</span>
    <span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">h</span><span class="p">)</span><span class="o">-</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">/</span><span class="n">h</span>
<span class="p">}</span>

<span class="n">df</span><span class="o">&lt;-</span><span class="n">function</span><span class="p">(</span><span class="n">x</span><span class="p">){</span>
    <span class="o">-</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">err_absoluto</span><span class="o">&lt;-</span><span class="n">function</span><span class="p">(</span><span class="n">aprox</span><span class="p">,</span><span class="n">obj</span><span class="p">){</span>
    <span class="nb">abs</span><span class="p">(</span><span class="n">aprox</span><span class="o">-</span><span class="n">obj</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">err_relativo</span><span class="o">&lt;-</span><span class="n">function</span><span class="p">(</span><span class="n">aprox</span><span class="p">,</span><span class="n">obj</span><span class="p">){</span>
    <span class="nb">abs</span><span class="p">(</span><span class="n">aprox</span><span class="o">-</span><span class="n">obj</span><span class="p">)</span><span class="o">/</span><span class="nb">abs</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">x</span><span class="o">&lt;-</span><span class="mi">1</span>

<span class="n">h</span><span class="o">&lt;-</span><span class="mi">10</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">16</span><span class="p">))</span>

<span class="n">err_absoluto_res</span><span class="o">&lt;-</span><span class="n">err_absoluto</span><span class="p">(</span><span class="n">aprox_1a_derivada</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">h</span><span class="p">),</span><span class="n">df</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="n">err_relativo_res</span><span class="o">&lt;-</span><span class="n">err_relativo</span><span class="p">(</span><span class="n">aprox_1a_derivada</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">h</span><span class="p">),</span><span class="n">df</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>


<span class="n">gf</span><span class="o">&lt;-</span><span class="n">ggplot</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gf</span><span class="o">+</span>
<span class="n">geom_line</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">log</span><span class="p">(</span><span class="n">h</span><span class="p">),</span><span class="n">y</span><span class="o">=</span><span class="n">log</span><span class="p">(</span><span class="n">err_absoluto_res</span><span class="p">)))</span><span class="o">+</span>
<span class="n">ggtitle</span><span class="p">(</span><span class="s1">&#39;Aproximación a la primera derivada por diferencias finitas&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gf</span><span class="o">+</span>
<span class="n">geom_line</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">log</span><span class="p">(</span><span class="n">h</span><span class="p">),</span><span class="n">y</span><span class="o">=</span><span class="n">log</span><span class="p">(</span><span class="n">err_relativo_res</span><span class="p">)))</span><span class="o">+</span>
<span class="n">ggtitle</span><span class="p">(</span><span class="s1">&#39;Aproximación a la primera derivada por diferencias finitas&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p><strong>Ejercicio: realizar una gráfica de log(error relativo) vs log(h) (h en el eje horizontal) con <code class="docutils literal notranslate"><span class="pre">ggplot2</span></code> para aproximar la segunda derivada de <span class="math notranslate nohighlight">\(f(x)=e^{-x}\)</span> en <span class="math notranslate nohighlight">\(x=1\)</span> con <span class="math notranslate nohighlight">\(h \in \{10^{-16}, 10^{-14}, \dots , 10^{-1}\}\)</span> y diferencias hacia delante. Valor a aproximar: <span class="math notranslate nohighlight">\(f^{(2)}(1) = e^{-1}\)</span></strong>. Usar:</p>
<div class="math notranslate nohighlight">
\[\frac{d^2f(x)}{dx} = \frac{f(x+2h)-2f(x+h)+f(x)}{h^2} + \mathcal{O}(h)\]</div>
<p><strong>Encontrar valor(es) de <span class="math notranslate nohighlight">\(h\)</span> que minimiza(n) al error absoluto y relativo.</strong></p>
<p>La aproximación anterior es una aproximación a la segunda derivada por diferencias hacia delante. Las versiones hacia atrás y centradas en general para una función <span class="math notranslate nohighlight">\(f: \mathbb{R} \rightarrow \mathbb{R}\)</span> son respectivamente:</p>
<div class="math notranslate nohighlight">
\[\frac{d^2f(x)}{dx} \approx \frac{f(x)-2f(x-h)+f(x-2h)}{h^2} + \mathcal{O}(h)\]</div>
<div class="math notranslate nohighlight">
\[\frac{d^2f(x)}{dx} \approx \frac{f(x+h)-2f(x)+f(x-h)}{h^2} + \mathcal{O}(h^2)\]</div>
<div class="section" id="analisis-del-error-por-redondeo-y-truncamiento-en-aproximacion-por-diferencias-finitas-hacia-delante">
<h4>Análisis del error por redondeo y truncamiento en aproximación por diferencias finitas hacia delante<a class="headerlink" href="#analisis-del-error-por-redondeo-y-truncamiento-en-aproximacion-por-diferencias-finitas-hacia-delante" title="Permalink to this headline">¶</a></h4>
<p>El ejemplo anterior muestra (vía una gráfica) que el método numérico de diferenciación numérica no es estable numéricamente respecto al redondeo (ver nota <a class="reference internal" href="README.html#cpea"><span class="std std-ref">Condición de un problema y estabilidad de un algoritmo</span></a> para definición de estabilidad de un algoritmo) y también se puede corroborar realizando un análisis del error. En esta sección consideramos la aproximación a la primer derivada por diferencias finitas hacia delante:</p>
<div class="math notranslate nohighlight">
\[\frac{f(x+h)-f(x)}{h}\]</div>
<p>Suponemos que <span class="math notranslate nohighlight">\(\hat{f}(x)\)</span> aproxima a <span class="math notranslate nohighlight">\(f(x)\)</span> y por errores de redondeo <span class="math notranslate nohighlight">\(\hat{f}(x) = f(x)(1 + \epsilon_{f(x)})\)</span> con <span class="math notranslate nohighlight">\(|\epsilon_{f(x)}| \leq \epsilon_{maq}\)</span> error de redondeo al evaluar <span class="math notranslate nohighlight">\(f\)</span> en <span class="math notranslate nohighlight">\(x\)</span>. <span class="math notranslate nohighlight">\(\hat{f}(x)\)</span> es la aproximación en un SPFN (ver nota <a class="reference internal" href="README.html#spf"><span class="std std-ref">Sistema de punto flotante</span></a>). Además supóngase que <span class="math notranslate nohighlight">\(x,x+h,h \in \mathcal{Fl}\)</span> . Entonces en la aproximación a la primer derivada por diferencias  hacia delante:</p>
<p><span class="math notranslate nohighlight">\(f^{(1)}(x) = \frac{f(x+h)-f(x)}{h} + \mathcal{O}(h)\)</span> y calculando el error absoluto:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
\text{ErrAbs}\left ( \frac{\hat{f}(x+h)-\hat{f}(x)}{h} \right ) &amp;=&amp;  \left |f^{(1)}(x) - \frac{\hat{f}(x+h)-\hat{f}(x)}{h} \right | \nonumber \\
&amp;=&amp; \left | \frac{f(x+h)-f(x)}{h} + \mathcal{O}(h) - \left ( \frac{f(x+h)(1+\epsilon_{f(x+h)})-f(x)(1+\epsilon_{f(x)})}{h} \right ) \right | \nonumber \\
&amp;=&amp; \left |\mathcal{O}(h) - \frac{f(x+h)\epsilon_{f(x+h)}-f(x)\epsilon_{f(x)}}{h} \right | \nonumber \\
&amp;\leq&amp; \mathcal{O}(h) + \frac{C\epsilon_{maq}}{h}
\end{eqnarray}
\end{split}\]</div>
<p>suponiendo en el último paso que <span class="math notranslate nohighlight">\(|f(x+h)\epsilon_{f(x+h)} - f(x)\epsilon_{f(x)}| \leq C \epsilon_{maq}\)</span> con <span class="math notranslate nohighlight">\(C&gt;0\)</span> constante que acota a la función <span class="math notranslate nohighlight">\(f\)</span> en el intervalo <span class="math notranslate nohighlight">\([a,b]\)</span>. Obsérvese que <span class="math notranslate nohighlight">\(\frac{\hat{f}(x+h)-\hat{f}(x)}{h}\)</span> es la aproximación a la primer derivada por diferencias hacia delante que se obtiene en la computadora, por lo que la cantidad <span class="math notranslate nohighlight">\(\left |f^{(1)}(x) - \frac{\hat{f}(x+h)-\hat{f}(x)}{h} \right |\)</span> es el error absoluto de la aproximación por diferencias hacia delante.</p>
<p>El error relativo es:</p>
<div class="math notranslate nohighlight">
\[\text{ErrRel}\left (\frac{\hat{f}(x+h)-\hat{f}(x)}{h} \right) = \frac{\text{ErrAbs}\left ( \frac{\hat{f}(x+h)-\hat{f}(x)}{h} \right )}{|f^{(1)}(x)|} \leq \frac{\mathcal{O}(h) + \frac{C\epsilon_{maq}}{h}}{|f^{(1)}(x)|} = K_1h + K_2\frac{1}{h}\]</div>
<p>con <span class="math notranslate nohighlight">\(K_1, K_2 &gt;0\)</span> constantes.</p>
<p>Entonces la función <span class="math notranslate nohighlight">\(g(h) = \mathcal{O}(h) + \mathcal{O}\left (\frac{1}{h} \right)\)</span> acota al error absoluto y al error relativo y se tiene:</p>
<ul class="simple">
<li><p>Si <span class="math notranslate nohighlight">\(h \rightarrow 0\)</span> la componente <span class="math notranslate nohighlight">\(\mathcal{O} \left ( \frac{1}{h} \right )\)</span> domina a la componente <span class="math notranslate nohighlight">\(\mathcal{O}(h)\)</span>, la cual tiende a <span class="math notranslate nohighlight">\(0\)</span>.</p></li>
<li><p>Si <span class="math notranslate nohighlight">\(h \rightarrow \infty\)</span> la componente <span class="math notranslate nohighlight">\(\mathcal{O}(h)\)</span> domina a <span class="math notranslate nohighlight">\(\mathcal{O} \left ( \frac{1}{h} \right )\)</span>, la cual tiende a <span class="math notranslate nohighlight">\(0\)</span>.</p></li>
</ul>
<p>Por las dos observaciones anteriores, existe un valor de <span class="math notranslate nohighlight">\(h\)</span> que minimiza a los errores. Tal valor se observa en las gráficas anteriores y es igual a:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">c</span><span class="p">(</span><span class="n">h</span><span class="p">[</span><span class="n">which</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">err_absoluto_res</span><span class="p">)],</span><span class="n">h</span><span class="p">[</span><span class="n">which</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">err_relativo_res</span><span class="p">)]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[1] 1e-08 1e-08
</pre></div>
</div>
</div>
</div>
<p><strong>Ejercicio:</strong> obtener de forma analítica el valor de <span class="math notranslate nohighlight">\(h\)</span> que minimiza la función <span class="math notranslate nohighlight">\(g(h)\)</span> anterior. Tip: utilizar criterio de primera y segunda derivada para encontrar mínimo global.</p>
<p><strong>Conclusiones y comentarios:</strong></p>
<ul class="simple">
<li><p>La componente <span class="math notranslate nohighlight">\(\mathcal{O}(h)\)</span> es el error por truncamiento, la cual resulta del teorema de Taylor. El teorema de Taylor nos indica que añadir términos en el polinomio de Taylor si la <span class="math notranslate nohighlight">\(x\)</span> a aproximar es cercana al centro, las derivadas de <span class="math notranslate nohighlight">\(f\)</span> son acotadas y <span class="math notranslate nohighlight">\(h \rightarrow 0\)</span> entonces el error por truncamiento debe tender a <span class="math notranslate nohighlight">\(0\)</span>. Lo anterior no ocurre en la implementación numérica (corroborado de forma analítica y visual) del método por diferenciación numérica para la primer derivada por la presencia de la componente <span class="math notranslate nohighlight">\(\mathcal{O}\left(\frac{1}{h}\right)\)</span> en los errores. Tal componente proviene del error por redondeo.</p></li>
<li><p>Obsérvese que el error relativo máximo es del <span class="math notranslate nohighlight">\(100\%\)</span> lo que indica que no se tiene ninguna cifra correcta en la aproximación:</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">max</span><span class="p">(</span><span class="n">err_relativo_res</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p>y esto ocurre para un valor de <span class="math notranslate nohighlight">\(h\)</span> igual a:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">h</span><span class="p">[</span><span class="n">which</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">err_relativo_res</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p><strong>pregunta:</strong> ¿por qué se alcanza el máximo error relativo en el valor de <span class="math notranslate nohighlight">\(h=10^{-16}\)</span>?.</p>
<p>Con esto se tiene que la diferenciación numérica es un método <strong>inestable numéricamente respecto al redondeo</strong>. Ver nota <a class="reference internal" href="README.html#cpea"><span class="std std-ref">Condición de un problema y estabilidad de un algoritmo</span></a>.</p>
<ul class="simple">
<li><p>Un análisis de error similar se utiliza para el método de diferencias finitas por diferencias centradas para aproximar la primera derivada. En este caso el valor de <span class="math notranslate nohighlight">\(h\)</span> que minimiza a los errores es del orden <span class="math notranslate nohighlight">\(h^* = 10^{-6}\)</span>.</p></li>
</ul>
</div>
<div class="section" id="diferenciacion-numerica-para-una-funcion-f-mathbb-r-n-rightarrow-mathbb-r">
<h4>Diferenciación numérica para una función <span class="math notranslate nohighlight">\(f: \mathbb{R}^n \rightarrow \mathbb{R}\)</span><a class="headerlink" href="#diferenciacion-numerica-para-una-funcion-f-mathbb-r-n-rightarrow-mathbb-r" title="Permalink to this headline">¶</a></h4>
<p>Supongamos <span class="math notranslate nohighlight">\(f\)</span> es dos veces diferenciable en <span class="math notranslate nohighlight">\(\text{dom}f\)</span>. Si <span class="math notranslate nohighlight">\(f: \mathbb{R}^n \rightarrow \mathbb{R}\)</span> entonces su derivada se llama <strong>gradiente</strong>, el cual es una función <span class="math notranslate nohighlight">\(\nabla f: \mathbb{R}^n \rightarrow \mathbb{R}^n\)</span> y su segunda derivada se llama <strong>Hessiana</strong>, la cual es una función <span class="math notranslate nohighlight">\(f: \mathbb{R}^n \rightarrow \mathbb{R}^{n\times n}\)</span> (ver <a class="reference internal" href="README.html#dfdf"><span class="std std-ref">Definición de función, derivada de una función</span></a> para definición de derivadas en funciones <span class="math notranslate nohighlight">\(f: \mathbb{R}^n \rightarrow \mathbb{R}^m\)</span>). Ambas funciones al evaluarse resultan en un vector en <span class="math notranslate nohighlight">\(\mathbb{R}^n\)</span> y en una matriz en <span class="math notranslate nohighlight">\(\mathbb{R}^{n\times n}\)</span> respectivamente.</p>
<p>Podemos utilizar las fórmulas de aproximación en diferenciación numérica con diferencias finitas para el caso <span class="math notranslate nohighlight">\(f: \mathbb{R} \rightarrow \mathbb{R}\)</span> revisadas anteriormente para aproximar al gradiente y a la Hessiana.</p>
<p>Para el caso del gradiente se tiene por <strong>diferenciación hacia delante</strong>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\nabla f(x) = 
\begin{array}{l}
\left[ \begin{array}{c}
\frac{\partial f(x)}{\partial x_1}\\
\vdots\\
\frac{\partial f(x)}{\partial x_n}
\end{array}
\right] \approx, \nabla \hat{f}(x) =\left[ 
\begin{array}{c} 
\frac{f(x+he_1) - f(x)}{h}\\
\vdots\\
\frac{f(x+he_n) - f(x)}{h}
\end{array}
\right]
\end{array} \in \mathbb{R}^n\end{split}\]</div>
<p>con <span class="math notranslate nohighlight">\(e_j\)</span> <span class="math notranslate nohighlight">\(j\)</span>-ésimo vector canónico que tiene un número <span class="math notranslate nohighlight">\(1\)</span> en la posición <span class="math notranslate nohighlight">\(j\)</span> y <span class="math notranslate nohighlight">\(0\)</span> en las entradas restantes para <span class="math notranslate nohighlight">\(j=1,\dots,n\)</span>. Se cumple <span class="math notranslate nohighlight">\(||\nabla f(x) - \nabla \hat{f}(x)|| = \mathcal{O}(h)\)</span>. Y para el caso de la Hessiana:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\nabla^2f(x) = \left[\begin{array}{cccc}
\frac{\partial^2f(x)}{\partial x_1^2} &amp;\frac{\partial^2f(x)}{\partial x_2 \partial x_1}&amp;\dots&amp;\frac{\partial^2f(x)}{\partial x_n \partial x_1}\\
\frac{\partial^2f(x)}{\partial x_1 \partial x_2} &amp;\frac{\partial^2f(x)}{\partial x_2^2} &amp;\dots&amp;\frac{\partial^2f(x)}{\partial x_n \partial x_2}\\
\vdots &amp;\vdots&amp; \ddots&amp;\vdots\\
\frac{\partial^2f(x)}{\partial x_1 \partial x_n} &amp;\frac{\partial^2f(x)}{\partial x_2 \partial x_n}&amp;\dots&amp;\frac{\partial^2f(x)}{\partial x_n^2} \\
\end{array}
\right],
\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}
\nabla^2 \hat{f}(x) = \left[\begin{array}{cccc}
\frac{f(x+2he_1)-2f(x+he_1)+f(x)}{h^2} &amp;\frac{f(x+he_1+he_2)-f(x+he_1)-f(x+he_2)+f(x)}{h^2}&amp;\dots&amp;\frac{f(x+he_1+he_n)-f(x+he_1)-f(x+he_n)+f(x)}{h^2}\\
\frac{f(x+he_1+he_2)-f(x+he_2)-f(x+he_1)+f(x)}{h^2}&amp;\frac{f(x+2he_2)-2f(x+he_2)+f(x)}{h^2}  &amp;\dots&amp;\frac{f(x+he_2+he_n)-f(x+he_2)-f(x+he_n)+f(x)}{h^2}\\
\vdots &amp;\vdots&amp; \ddots&amp;\vdots\\
\frac{f(x+he_1+he_n)-f(x+he_n)-f(x+he_1)+f(x)}{h^2}&amp;\frac{f(x+he_2+he_n)-f(x+he_n)-f(x+he_2)+f(x)}{h^2}&amp;\dots&amp;\frac{f(x+2he_n)-2f(x+he_n)+f(x)}{h^2}\\
\end{array}
\right]
\end{split}\]</div>
<p>Se cumple: <span class="math notranslate nohighlight">\(||\nabla^2f(x)-\nabla\hat{f}^2(x)||=\mathcal{O}(h)\)</span>.</p>
<p><strong>Ejemplo:</strong></p>
<p>Aproximar <span class="math notranslate nohighlight">\(\nabla f(x), \nabla^2f(x)\)</span> con diferencias hacia delante y <span class="math notranslate nohighlight">\(h \in \{10^{-16}, 10^{-14}, \dots , 10^{-1}\}\)</span> para <span class="math notranslate nohighlight">\(f: \mathbb{R}^4 \rightarrow \mathbb{R}\)</span>, dada por <span class="math notranslate nohighlight">\(f(x) = (x_1^2-x_2^2)^2+x_1^2+(x_3^2-x_4^2)^2+x_3^2\)</span> en el punto <span class="math notranslate nohighlight">\(x_0=(1.5,1.5,1.5,1.5)^T\)</span>. Realizar una gráfica de <span class="math notranslate nohighlight">\(\log(\)</span>Err_rel) vs <span class="math notranslate nohighlight">\(\log(\)</span>h)</p>
<p>Para esta función se tiene:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\nabla f(x) = 
\left[ \begin{array}{c}
4x_1(x_1^2-x_2^2) + 2x_1\\
-4x_2(x_1^2-x_2^2)\\
4x_3(x_3^2-x_4^2)+2x_3\\
-4x_4(x_3^2-x_4^2)
\end{array}
\right] ,
\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}\nabla^2f(x)=
 \left[\begin{array}{cccc}
12x_1^2-4x_2^2+2 &amp;-8x_1x_2&amp;0&amp;0\\
-8x_1x_2 &amp;-4x_1^2+12x_2^2&amp;0&amp;0\\
0 &amp;0&amp;12x_3^2-4x_4^2+2&amp;-8x_3x_4\\
0&amp;0&amp;-8x_3x_4&amp;-4x_3^2+12x_4^2\\
\end{array}
\right]
\end{split}\]</div>
<p>Y evaluando en <span class="math notranslate nohighlight">\(x_0\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#gradiente de f calculado de forma simbólica</span>
<span class="n">gf</span><span class="o">&lt;-</span><span class="n">function</span><span class="p">(</span><span class="n">x</span><span class="p">){</span>
    <span class="n">c</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
      <span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">^</span><span class="mi">2</span><span class="p">),</span>
      <span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
      <span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">^</span><span class="mi">2</span><span class="p">))</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x_0</span><span class="o">&lt;-</span><span class="n">c</span><span class="p">(</span><span class="mf">1.5</span><span class="p">,</span><span class="mf">1.5</span><span class="p">,</span><span class="mf">1.5</span><span class="p">,</span><span class="mf">1.5</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">gf</span><span class="p">(</span><span class="n">x_0</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[1] 3 0 3 0
</pre></div>
</div>
</div>
</div>
<div class="math notranslate nohighlight">
\[\begin{split}\nabla f(x_0) = 
\left[ \begin{array}{c}
3\\
0\\
3\\
0
\end{array}
\right],
\end{split}\]</div>
<p>para la Hessiana:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#Hessiana de f calculada de forma simbólica</span>
<span class="n">gf2</span><span class="o">&lt;-</span><span class="n">function</span><span class="p">(</span><span class="n">x</span><span class="p">){</span>
    <span class="n">matrix</span><span class="p">(</span><span class="n">c</span><span class="p">(</span><span class="mi">12</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">8</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span>
             <span class="o">-</span><span class="mi">8</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">12</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span>
             <span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">12</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">8</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span>
             <span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">8</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">12</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">^</span><span class="mi">2</span><span class="p">),</span><span class="n">nrow</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">ncol</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">gf2</span><span class="p">(</span><span class="n">x_0</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>     [,1] [,2] [,3] [,4]
[1,]   20  -18    0    0
[2,]  -18   18    0    0
[3,]    0    0   20  -18
[4,]    0    0  -18   18
</pre></div>
</div>
</div>
</div>
<div class="math notranslate nohighlight">
\[\begin{split}\nabla^2f(x_0)=
 \left[\begin{array}{cccc}
20 &amp;-18&amp;0&amp;0\\
-18&amp;18&amp;0&amp;0\\
0 &amp;0&amp;20&amp;-18\\
0&amp;0&amp;-18&amp;18\\
\end{array}
\right]
\end{split}\]</div>
<p>Calculando el gradiente y la Hessiana de forma numérica con la aproximación por diferencias hacia delante:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#definición de función y punto en el que se calculan las aproximaciones</span>
<span class="n">f_ej</span><span class="o">&lt;-</span><span class="n">function</span><span class="p">(</span><span class="n">x</span><span class="p">){</span>
    <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">^</span><span class="mi">2</span>
<span class="p">}</span>
<span class="n">x0</span><span class="o">&lt;-</span><span class="n">rep</span><span class="p">(</span><span class="mf">1.5</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#Función auxiliar para incrementar una entrada de un vector</span>
<span class="c1">#por una cantidad h</span>
<span class="n">inc_index</span><span class="o">&lt;-</span><span class="n">function</span><span class="p">(</span><span class="n">vec</span><span class="p">,</span><span class="n">index</span><span class="p">,</span><span class="n">h</span><span class="p">){</span>
    <span class="n">vec</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">&lt;-</span><span class="n">vec</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">+</span><span class="n">h</span>
    <span class="n">vec</span><span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#Función para aproximar el gradiente de f</span>
<span class="c1">#f: función a la que se le aproximará su gradiente</span>
<span class="c1">#x: punto en el que se aproximará el gradiente de f</span>
<span class="c1">#h: valor de h para diferencias hacia delante</span>
<span class="c1">#gf: aproximación al gradiente de f por diferencias hacia delante</span>
<span class="n">gf_numeric</span><span class="o">&lt;-</span><span class="n">function</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">h</span><span class="p">){</span>
    <span class="n">n</span><span class="o">&lt;-</span><span class="n">length</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">gf</span><span class="o">&lt;-</span><span class="n">rep</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
    <span class="k">for</span><span class="p">(</span><span class="n">i</span> <span class="ow">in</span> <span class="mi">1</span><span class="p">:</span><span class="n">n</span><span class="p">){</span>
        <span class="n">gf</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">inc_index</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">h</span><span class="p">))</span><span class="o">-</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
    <span class="p">}</span>
    <span class="n">gf</span><span class="o">/</span><span class="n">h</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#Función para aproximar la Hessiana de f</span>
<span class="c1">#f: función a la que se le aproximará su Hessiana</span>
<span class="c1">#x: punto en el que se aproximará la Hessiana de f</span>
<span class="c1">#h: valor de h para diferencias hacia delante</span>
<span class="c1">#Hf: aproximación a la Hessiana de f por diferencias hacia delante</span>
<span class="n">gf2_numeric</span><span class="o">&lt;-</span><span class="n">function</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">h</span><span class="p">){</span>
    <span class="n">n</span><span class="o">&lt;-</span><span class="n">length</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">Hf</span><span class="o">&lt;-</span><span class="n">matrix</span><span class="p">(</span><span class="n">rep</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">n</span><span class="o">^</span><span class="mi">2</span><span class="p">),</span><span class="n">nrow</span><span class="o">=</span><span class="n">n</span><span class="p">,</span><span class="n">ncol</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
    <span class="n">f_x</span><span class="o">&lt;-</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">for</span><span class="p">(</span><span class="n">i</span> <span class="ow">in</span> <span class="mi">1</span><span class="p">:</span><span class="n">n</span><span class="p">){</span>
        <span class="n">x_inc_in_i</span><span class="o">&lt;-</span><span class="n">inc_index</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">h</span><span class="p">)</span>
        <span class="n">f_x_inc_in_i</span><span class="o">&lt;-</span><span class="n">f</span><span class="p">(</span><span class="n">x_inc_in_i</span><span class="p">)</span>
        <span class="k">for</span><span class="p">(</span><span class="n">j</span> <span class="ow">in</span> <span class="n">i</span><span class="p">:</span><span class="n">n</span><span class="p">){</span>
            <span class="c1">#otra forma para dif:</span>
            <span class="c1">#dif&lt;-f(inc_index(inc_index(x,j,h),i,h))-f_x_inc_in_i-f(inc_index(x,j,h))+f_x</span>
            <span class="n">dif</span><span class="o">&lt;-</span><span class="n">f</span><span class="p">(</span><span class="n">inc_index</span><span class="p">(</span><span class="n">x_inc_in_i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">h</span><span class="p">))</span><span class="o">-</span><span class="n">f_x_inc_in_i</span><span class="o">-</span><span class="n">f</span><span class="p">(</span><span class="n">inc_index</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">h</span><span class="p">))</span><span class="o">+</span><span class="n">f_x</span>
            <span class="n">Hf</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">&lt;-</span><span class="n">dif</span>
            <span class="k">if</span><span class="p">(</span><span class="n">j</span><span class="o">!=</span><span class="n">i</span><span class="p">)</span>
                <span class="n">Hf</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">]</span><span class="o">&lt;-</span><span class="n">dif</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="n">Hf</span><span class="o">/</span><span class="n">h</span><span class="o">^</span><span class="mi">2</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">h</span><span class="o">&lt;-</span><span class="mi">10</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">16</span><span class="p">))</span><span class="c1">#un conjunto de valores de h para diferencias hacia delante</span>
<span class="n">err_absoluto</span><span class="o">&lt;-</span><span class="n">function</span><span class="p">(</span><span class="n">aprox</span><span class="p">,</span><span class="n">obj</span><span class="p">){</span>
    <span class="n">norm</span><span class="p">(</span><span class="n">aprox</span><span class="o">-</span><span class="n">obj</span><span class="p">,</span><span class="s2">&quot;2&quot;</span><span class="p">)</span> <span class="c1">#cálculo de norma vectorial o matricial, depende de lo que recibe</span>
                        <span class="c1">#la función en sus parámetros aprox y obj</span>
<span class="p">}</span>

<span class="n">err_relativo</span><span class="o">&lt;-</span><span class="n">function</span><span class="p">(</span><span class="n">aprox</span><span class="p">,</span><span class="n">obj</span><span class="p">){</span>
    <span class="n">norm</span><span class="p">(</span><span class="n">aprox</span><span class="o">-</span><span class="n">obj</span><span class="p">,</span><span class="s2">&quot;2&quot;</span><span class="p">)</span><span class="o">/</span><span class="n">norm</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span><span class="s2">&quot;2&quot;</span><span class="p">)</span><span class="c1">#cálculo de norma vectorial o matricial, depende de lo que recibe</span>
                                     <span class="c1">#la función en sus parámetros aprox y obj</span>
<span class="p">}</span>

<span class="n">gf_numeric_list</span><span class="o">&lt;-</span><span class="n">lapply</span><span class="p">(</span><span class="n">h</span><span class="p">,</span><span class="n">gf_numeric</span><span class="p">,</span><span class="n">f</span><span class="o">=</span><span class="n">f_ej</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="n">x0</span><span class="p">)</span>
<span class="n">gf2_numeric_list</span><span class="o">&lt;-</span><span class="n">lapply</span><span class="p">(</span><span class="n">h</span><span class="p">,</span><span class="n">gf2_numeric</span><span class="p">,</span><span class="n">f</span><span class="o">=</span><span class="n">f_ej</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="n">x0</span><span class="p">)</span>


<span class="n">err_absoluto_gf_res</span><span class="o">&lt;-</span><span class="n">sapply</span><span class="p">(</span><span class="n">gf_numeric_list</span><span class="p">,</span><span class="n">err_absoluto</span><span class="p">,</span><span class="n">obj</span><span class="o">=</span><span class="n">gf</span><span class="p">(</span><span class="n">x_0</span><span class="p">))</span>
<span class="n">err_relativo_gf_res</span><span class="o">&lt;-</span><span class="n">sapply</span><span class="p">(</span><span class="n">gf_numeric_list</span><span class="p">,</span><span class="n">err_relativo</span><span class="p">,</span><span class="n">obj</span><span class="o">=</span><span class="n">gf</span><span class="p">(</span><span class="n">x_0</span><span class="p">))</span>

<span class="n">err_absoluto_gf2_res</span><span class="o">&lt;-</span><span class="n">sapply</span><span class="p">(</span><span class="n">gf2_numeric_list</span><span class="p">,</span><span class="n">err_absoluto</span><span class="p">,</span><span class="n">obj</span><span class="o">=</span><span class="n">gf2</span><span class="p">(</span><span class="n">x_0</span><span class="p">))</span>
<span class="n">err_relativo_gf2_res</span><span class="o">&lt;-</span><span class="n">sapply</span><span class="p">(</span><span class="n">gf2_numeric_list</span><span class="p">,</span><span class="n">err_relativo</span><span class="p">,</span><span class="n">obj</span><span class="o">=</span><span class="n">gf2</span><span class="p">(</span><span class="n">x_0</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gg</span><span class="o">&lt;-</span><span class="n">ggplot</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gg</span><span class="o">+</span>
<span class="n">geom_line</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">log</span><span class="p">(</span><span class="n">h</span><span class="p">),</span><span class="n">y</span><span class="o">=</span><span class="n">log</span><span class="p">(</span><span class="n">err_relativo_gf_res</span><span class="p">)))</span><span class="o">+</span>
<span class="n">ggtitle</span><span class="p">(</span><span class="s1">&#39;Aproximación al gradiente por diferencias finitas&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">c</span><span class="p">(</span><span class="n">h</span><span class="p">[</span><span class="n">which</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">err_relativo_gf_res</span><span class="p">)],</span><span class="n">h</span><span class="p">[</span><span class="n">which</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">err_absoluto_gf_res</span><span class="p">)]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[1] 1e-08 1e-08
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gg</span><span class="o">+</span>
<span class="n">geom_line</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">log</span><span class="p">(</span><span class="n">h</span><span class="p">),</span><span class="n">y</span><span class="o">=</span><span class="n">log</span><span class="p">(</span><span class="n">err_relativo_gf2_res</span><span class="p">)))</span><span class="o">+</span>
<span class="n">ggtitle</span><span class="p">(</span><span class="s1">&#39;Aproximación a la Hessiana por diferencias finitas&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">c</span><span class="p">(</span><span class="n">h</span><span class="p">[</span><span class="n">which</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">err_relativo_gf2_res</span><span class="p">)],</span><span class="n">h</span><span class="p">[</span><span class="n">which</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">err_absoluto_gf2_res</span><span class="p">)]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>[1] 1e-06 1e-06
</pre></div>
</div>
</div>
</div>
<p><strong>Ejercicio: aproximar <span class="math notranslate nohighlight">\(\nabla f(x), \nabla^2f(x)\)</span> con diferencias hacia delante y <span class="math notranslate nohighlight">\(h \in \{10^{-16}, 10^{-14}, \dots , 10^{-1}\}\)</span> para <span class="math notranslate nohighlight">\(f: \mathbb{R}^3 \rightarrow \mathbb{R}\)</span>, dada por <span class="math notranslate nohighlight">\(f(x) = x_1x_2\exp(x_1^2+x_3^2-5)\)</span> en el punto <span class="math notranslate nohighlight">\(x_0=(1,3,-2)^T\)</span> Realizar una gráfica de <span class="math notranslate nohighlight">\(\log(\)</span>Err_rel) vs <span class="math notranslate nohighlight">\(\log(\)</span>h).</strong></p>
<p><strong>Ejercicios</strong></p>
<ol class="simple">
<li><p>Resuelve los ejercicios y preguntas de la nota.</p></li>
</ol>
<p><strong>Referencias</strong></p>
<ol class="simple">
<li><p>R. L. Burden, J. D. Faires, Numerical Analysis, Brooks/Cole Cengage Learning, 2005.</p></li>
<li><p>M. T. Heath, Scientific Computing. An Introductory Survey, McGraw-Hill, 2002.</p></li>
<li><p>S. P. Boyd, L. Vandenberghe, Convex Optimization. Cambridge University Press, 2004.</p></li>
<li><p>Nota <a class="reference internal" href="README.html#spf"><span class="std std-ref">Sistema de punto flotante</span></a>.</p></li>
<li><p>Nota <a class="reference internal" href="README.html#dfdf"><span class="std std-ref">Definición de función, derivada de una función</span></a>.</p></li>
<li><p>Nota <a class="reference internal" href="README.html#cpea"><span class="std std-ref">Condición de un problema y estabilidad de un algoritmo</span></a>.</p></li>
</ol>
</div>
</div>
</div>
<span id="document-I.computo_cientifico/1.7/Integracion_numerica"></span><div class="admonition-notas-para-contenedor-de-docker admonition">
<p class="admonition-title">Notas para contenedor de docker:</p>
<p>Comando de docker para ejecución de la nota de forma local:</p>
<p>nota: cambiar <code class="docutils literal notranslate"><span class="pre">&lt;ruta</span> <span class="pre">a</span> <span class="pre">mi</span> <span class="pre">directorio&gt;</span></code> por la ruta de directorio que se desea mapear a <code class="docutils literal notranslate"><span class="pre">/datos</span></code> dentro del contenedor de docker.</p>
<p><code class="docutils literal notranslate"><span class="pre">docker</span> <span class="pre">run</span> <span class="pre">--rm</span> <span class="pre">-v</span> <span class="pre">&lt;ruta</span> <span class="pre">a</span> <span class="pre">mi</span> <span class="pre">directorio&gt;:/datos</span> <span class="pre">--name</span> <span class="pre">jupyterlab_optimizacion</span> <span class="pre">-p</span> <span class="pre">8888:8888</span> <span class="pre">-d</span> <span class="pre">palmoreck/jupyterlab_optimizacion:2.1.4</span></code></p>
<p>password para jupyterlab: <code class="docutils literal notranslate"><span class="pre">qwerty</span></code></p>
<p>Detener el contenedor de docker:</p>
<p><code class="docutils literal notranslate"><span class="pre">docker</span> <span class="pre">stop</span> <span class="pre">jupyterlab_optimizacion</span></code></p>
<p>Documentación de la imagen de docker <code class="docutils literal notranslate"><span class="pre">palmoreck/jupyterlab_optimizacion:2.1.4</span></code> en <a class="reference external" href="https://github.com/palmoreck/dockerfiles/tree/master/jupyterlab/optimizacion">liga</a>.</p>
</div>
<hr class="docutils" />
<p>Nota generada a partir de la <a class="reference external" href="https://www.dropbox.com/s/jfrxanjls8kndjp/Diferenciacion_e_Integracion.pdf?dl=0">liga1</a> y <a class="reference external" href="https://www.dropbox.com/s/k3y7h9yn5d3yf3t/Integracion_por_Monte_Carlo.pdf?dl=0">liga2</a>.</p>
<p>Los métodos revisados en esta nota de integración numérica serán utilizados más adelante para revisión de herramientas en Python para <strong>perfilamiento de código: uso de cpu y memoria</strong>. También serán referidos en el capítulo de <strong>cómputo en paralelo</strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">quad</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="integracion-numerica">
<span id="in"></span><h2>1.7 Integración Numérica<a class="headerlink" href="#integracion-numerica" title="Permalink to this headline">¶</a></h2>
<p>En lo siguiente consideramos que las funciones del integrando están en <span class="math notranslate nohighlight">\(\mathcal{C}^2\)</span> en el conjunto de integración (ver <a class="reference internal" href="README.html#dfdf"><span class="std std-ref">Definición de función, derivada de una función</span></a> para definición de <span class="math notranslate nohighlight">\(\mathcal{C}^2\)</span>).</p>
<p>Las reglas o métodos por cuadratura nos ayudan a aproximar integrales con sumas de la forma:</p>
<div class="math notranslate nohighlight">
\[\displaystyle \int_a^bf(x)dx \approx \displaystyle \sum_{i=0}^nw_if(x_i)\]</div>
<p>donde: <span class="math notranslate nohighlight">\(w_i\)</span> es el peso para el nodo <span class="math notranslate nohighlight">\(x_i\)</span>, <span class="math notranslate nohighlight">\(f\)</span> se llama integrando y <span class="math notranslate nohighlight">\([a,b]\)</span> intervalo de integración. Los valores <span class="math notranslate nohighlight">\(f(x_i)\)</span> se asumen conocidos.</p>
<p>Todas las reglas o métodos por cuadratura se obtienen con interpoladores polinomiales del integrando (por ejemplo usando la representación de Lagrange) o también con el teorema Taylor (ver nota <a class="reference internal" href="README.html#ptdn"><span class="std std-ref">Polinomios de Taylor y diferenciación numérica</span></a> para éste teorema).</p>
<p>Se realizan aproximaciones numéricas por:</p>
<ul class="simple">
<li><p>Desconocimiento de la función en todo el intervalo <span class="math notranslate nohighlight">\([a,b]\)</span> y sólo se conoce en los nodos su valor.</p></li>
<li><p>Inexistencia de antiderivada o primitiva del integrando. Por ejemplo:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\displaystyle \int_a^be^{-\frac{x^2}{2}}dx\]</div>
<p>Dependiendo de la ubicación de los nodos y pesos es el método de cuadratura que resulta:</p>
<ul class="simple">
<li><p>Newton-Cotes si los nodos y pesos son equidistantes como la regla del rectángulo, trapecio y Simpson (con el teorema de Taylor o interpolación es posible obtener tales fórmulas).</p></li>
<li><p>Cuadratura Gaussiana si se desea obtener reglas o fórmulas que tengan la mayor exactitud posible. Ejemplos de este tipo de cuadratura se tiene la regla por cuadratura Gauss-Legendre en [-1,1] o Gauss-Hermite para el caso de integrales en <span class="math notranslate nohighlight">\([-\infty, \infty]\)</span> con integrando <span class="math notranslate nohighlight">\(e^{-x^2}f(x)\)</span>.</p></li>
</ul>
<p><strong>Comentario:</strong></p>
<p>Los métodos de integración numérica por Newton-Cotes o cuadratura Gaussiana pueden extenderse a más dimensiones, sin embargo incurren en lo que se conoce como la <strong>maldición de la dimensionalidad</strong> que para el caso de integración numérica consiste en la gran cantidad de evaluaciones que deben realizarse de la función del integrando para tener una exactitud pequeña, por ejemplo con un número de nodos igual a <span class="math notranslate nohighlight">\(10^4\)</span>, una distancia entre ellos de <span class="math notranslate nohighlight">\(.1\)</span> y una integral en <span class="math notranslate nohighlight">\(4\)</span> dimensiones para la regla por Newton Cotes del rectángulo, se obtiene una exactitud de <span class="math notranslate nohighlight">\(2\)</span> dígitos. Como alternativa a los métodos por cuadratura anteriores para las integrales de más dimensiones se tienen los <strong>métodos de integración por el método Monte Carlo</strong> que generan aproximaciones con una exactitud moderada (del orden de <span class="math notranslate nohighlight">\(\mathcal{O}(n^{-1/2})\)</span> con <span class="math notranslate nohighlight">\(n\)</span> número de nodos) para un número de puntos moderado independiente de la dimensión.</p>
<div class="section" id="newton-cotes">
<h3>Newton-Cotes<a class="headerlink" href="#newton-cotes" title="Permalink to this headline">¶</a></h3>
<p>Si el conjunto de nodos <span class="math notranslate nohighlight">\(x_i, i=0,1,\dots,n\)</span> cumple <span class="math notranslate nohighlight">\(x_{i+1}-x_i=h, \forall i=0,1,\dots,n-1\)</span> con <span class="math notranslate nohighlight">\(h\)</span> (espaciado) constante y se aproxima la función del integrando <span class="math notranslate nohighlight">\(f\)</span> con un polinomio en <span class="math notranslate nohighlight">\((x_i,f(x_i)) \forall i=0,1,\dots,n\)</span> entonces se tiene un método de integración numérica por Newton-Cotes (o reglas o fórmulas por Newton-Cotes).</p>
<img src="https://dl.dropboxusercontent.com/s/baf7eauuwm347zk/integracion_numerica.png?dl=0" heigth="500" width="500"><p>En el dibujo: a),b) y c) se integra numéricamente por Newton-Cotes. d) es por cuadratura Gaussiana.</p>
<p><strong>Comentario:</strong> si la fórmula por Newton-Cotes involucra el valor de la función en los extremos se llama cerrada, si no los involucra se les llama abiertas. En el dibujo d) es abierta.</p>
<p>El dibujo anterior muestra que puede subdivirse el intervalo de integración en una mayor cantidad de subintervalos, lo cual para la función <span class="math notranslate nohighlight">\(f\)</span> mostrada es benéfico pues se tiene mejor aproximación (¿en la práctica esto será bueno? recuérdese los errores de redondeo de la nota <a class="reference internal" href="README.html#spf"><span class="std std-ref">Sistema de punto flotante</span></a>). Los métodos que utilizan la idea anterior de dividir en subintervalos se les conoce como <strong>métodos de integración numérica compuestos</strong> en contraste con los simples.</p>
<p><strong>Comentario:</strong> Para las reglas compuestas se divide el intervalo <span class="math notranslate nohighlight">\([a,b]\)</span> en <span class="math notranslate nohighlight">\(n\)</span> subinteralos <span class="math notranslate nohighlight">\([x_{i-1},x_i], i=1,\dots,n\)</span> con <span class="math notranslate nohighlight">\(x_0=a&lt;x_1&lt;\dots&lt;x_{n-1}&lt;x_n=b\)</span> y se considera una partición regular, esto es: <span class="math notranslate nohighlight">\(x_i-x_{i-1}=\hat{h}\)</span> con <span class="math notranslate nohighlight">\(\hat{h}=\frac{h}{n}\)</span> y <span class="math notranslate nohighlight">\(h=b-a\)</span>. En este contexto se realiza la aproximación:</p>
<div class="math notranslate nohighlight">
\[\displaystyle \int_a^bf(x)dx = \sum_{i=1}^n\int_{x_{i-1}}^{x_i}f(x)dx.\]</div>
<p>Para las siguientes reglas se considerará la función <span class="math notranslate nohighlight">\(f(x)=e^{-x^2}\)</span> la cual tiene una forma:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">.</span><span class="mi">01</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;f(x)=exp(-x^2)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p>El valor de la integral <span class="math notranslate nohighlight">\(\int_0^1e^{-x^2}dx\)</span> es:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">obj</span><span class="p">,</span> <span class="n">err</span> <span class="o">=</span> <span class="n">quad</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">obj</span><span class="p">,</span><span class="n">err</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p><strong>Obs:</strong> el segundo valor regresado <code class="docutils literal notranslate"><span class="pre">err</span></code>, es una cota superior del error.</p>
<div class="section" id="regla-simple-del-rectangulo">
<h4>Regla simple del rectángulo<a class="headerlink" href="#regla-simple-del-rectangulo" title="Permalink to this headline">¶</a></h4>
<p>Denotaremos a esta regla como <span class="math notranslate nohighlight">\(Rf\)</span>. En este caso se aproxima el integrando <span class="math notranslate nohighlight">\(f\)</span> por un polinomio de grado <strong>cero</strong> con nodo en <span class="math notranslate nohighlight">\(x_1 = \frac{a+b}{2}\)</span>. Entonces:</p>
<div class="math notranslate nohighlight">
\[\displaystyle \int_a^bf(x)dx \approx \int_a^bf(x_1)dx = (b-a)f(x_1)=(b-a)f\left( \frac{a+b}{2} \right ) = hf(x_1)\]</div>
<p>con <span class="math notranslate nohighlight">\(h=b-a, x_1=\frac{a+b}{2}\)</span>.</p>
<img src="https://dl.dropboxusercontent.com/s/mzlmnvgnltqamz3/rectangulo_simple.png?dl=0" heigth="200" width="200">
<p><strong>Ejemplo de implementación de regla simple de rectángulo: usando math</strong></p>
<p>Utilizar la regla simple del rectángulo para aproximar la integral <span class="math notranslate nohighlight">\(\displaystyle \int_0^1e^{-x^2}dx\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="c1">#using math library</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">Rf</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">):</span>
    <span class="n">nodo</span><span class="o">=</span><span class="n">a</span><span class="o">+</span><span class="p">(</span><span class="n">b</span><span class="o">-</span><span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0</span> <span class="c1">#mid point formula to minimize rounding errors</span>
    <span class="k">return</span> <span class="n">f</span><span class="p">(</span><span class="n">nodo</span><span class="p">)</span> <span class="c1">#polinomio de grado cero</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Rf</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
</div>
<div class="section" id="regla-compuesta-del-rectangulo">
<h4>Regla compuesta del rectángulo<a class="headerlink" href="#regla-compuesta-del-rectangulo" title="Permalink to this headline">¶</a></h4>
<p>En cada subintervalo construído como <span class="math notranslate nohighlight">\([a_{i-1},a_i]\)</span> con <span class="math notranslate nohighlight">\(i=1,\dots,n\)</span> se aplica la regla simple <span class="math notranslate nohighlight">\(Rf\)</span>, esto es:</p>
<div class="math notranslate nohighlight">
\[\displaystyle \int_{a_{i-1}}^{a_i}f(x)dx \approx R_i(f) \forall i=1,\dots,n.\]</div>
<p>De forma sencilla se puede ver que la regla compuesta del rectángulo <span class="math notranslate nohighlight">\(R_c(f)\)</span> se escribe:</p>
<div class="math notranslate nohighlight">
\[R_c(f) = \displaystyle \sum_{i=1}^n(a_i-a_{i-1})f\left( \frac{a_i+a_{i-1}}{2}\right) = \frac{h}{n}\sum_{i=1}^nf\left( \frac{a_i+a_{i-1}}{2}\right)\]</div>
<p>con <span class="math notranslate nohighlight">\(h=b-a\)</span> y <span class="math notranslate nohighlight">\(n\)</span> número de subintervalos.</p>
<img src="https://dl.dropboxusercontent.com/s/j2wmiyoms7gxrzp/rectangulo_compuesto.png?dl=0" heigth="200" width="200">
<p><strong>Nota:</strong> Los nodos para el caso del rectángulo se obtienen con la fórmula: <span class="math notranslate nohighlight">\(x_i = a +(i+\frac{1}{2})\hat{h}, \forall i=0,\dots,n-1, \hat{h}=\frac{h}{n}\)</span>.</p>
<p><strong>Ejemplo de implementación de regla compuesta de rectángulo: usando math</strong></p>
<p>Utilizar la regla compuesta del rectángulo para aproximar la integral <span class="math notranslate nohighlight">\(\int_0^1e^{-x^2}dx\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="c1">#using math library</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">Rcf</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">n</span><span class="p">):</span> <span class="c1">#Rcf: rectángulo compuesto para f</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute numerical approximation using rectangle or mid-point method in </span>
<span class="sd">    an interval.</span>
<span class="sd">    Nodes are generated via formula: x_i = a+(i+1/2)h_hat for i=0,1,...,n-1 and h_hat=(b-a)/n</span>
<span class="sd">    Args:</span>
<span class="sd">        f (lambda expression): lambda expression of integrand</span>
<span class="sd">        a (int): left point of interval</span>
<span class="sd">        b (int): right point of interval</span>
<span class="sd">        n (int): number of subintervals</span>
<span class="sd">    Returns:</span>
<span class="sd">        Rcf (float) </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">h_hat</span><span class="o">=</span><span class="p">(</span><span class="n">b</span><span class="o">-</span><span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="n">n</span>
    <span class="n">nodes</span><span class="o">=</span><span class="p">[</span><span class="n">a</span><span class="o">+</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">h_hat</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">n</span><span class="p">)]</span>
    <span class="n">sum_res</span><span class="o">=</span><span class="mi">0</span>
    <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">nodes</span><span class="p">:</span>
        <span class="n">sum_res</span><span class="o">=</span><span class="n">sum_res</span><span class="o">+</span><span class="n">f</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">h_hat</span><span class="o">*</span><span class="n">sum_res</span> 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">aprox_1</span><span class="o">=</span><span class="n">Rcf</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">aprox_1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">aprox_2</span><span class="o">=</span><span class="n">Rcf</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">aprox_2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">aprox_2</span><span class="o">=</span><span class="n">Rcf</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">aprox_2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">aprox_3</span><span class="o">=</span><span class="n">Rcf</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>
<span class="n">aprox_3</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p>Y se puede evaluar el error de aproximación con el error relativo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">err_relativo</span><span class="p">(</span><span class="n">aprox</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">fabs</span><span class="p">(</span><span class="n">aprox</span><span class="o">-</span><span class="n">obj</span><span class="p">)</span><span class="o">/</span><span class="n">math</span><span class="o">.</span><span class="n">fabs</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span> <span class="c1">#obsérvese el uso de la librería math</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">obj</span><span class="p">,</span> <span class="n">err</span> <span class="o">=</span> <span class="n">quad</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="p">(</span><span class="n">err_relativo</span><span class="p">(</span><span class="n">aprox_1</span><span class="p">,</span><span class="n">obj</span><span class="p">),</span> <span class="n">err_relativo</span><span class="p">(</span><span class="n">aprox_2</span><span class="p">,</span><span class="n">obj</span><span class="p">),</span> <span class="n">err_relativo</span><span class="p">(</span><span class="n">aprox_3</span><span class="p">,</span><span class="n">obj</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p><strong>Pregunta: será el método del rectángulo un método estable numéricamente bajo el redondeo?</strong> Ver nota <a class="reference internal" href="README.html#cpea"><span class="std std-ref">Condición de un problema y estabilidad de un algoritmo</span></a> para definición de estabilidad numérica de un algoritmo.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">aprox_4</span><span class="o">=</span><span class="n">Rcf</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="o">**</span><span class="mi">5</span><span class="p">)</span>
<span class="n">aprox_4</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">err_relativo</span><span class="p">(</span><span class="n">aprox_4</span><span class="p">,</span><span class="n">obj</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p>Al menos para este ejemplo con <span class="math notranslate nohighlight">\(10^5\)</span> nodos parece ser numéricamente estable…</p>
</div>
<div class="section" id="regla-compuesta-del-trapecio">
<h4>Regla compuesta del trapecio<a class="headerlink" href="#regla-compuesta-del-trapecio" title="Permalink to this headline">¶</a></h4>
<img src="https://dl.dropboxusercontent.com/s/4dl2btndrftdorp/trapecio_compuesto.png?dl=0" heigth="200" width="200">
<p>En cada subintervalo se aplica la regla simple <span class="math notranslate nohighlight">\(Tf\)</span>, esto es:</p>
<div class="math notranslate nohighlight">
\[\displaystyle \int_{x_{i-1}}^{x_i}f(x)dx \approx T_i(f) \forall i=1,\dots,n.\]</div>
<p>Con <span class="math notranslate nohighlight">\(T_i(f) = \frac{(x_i-x_{i-1})}{2}(f(x_i)+f(x_{i-1}))\)</span> para <span class="math notranslate nohighlight">\(i=1,\dots,n\)</span>.</p>
<p>De forma sencilla se puede ver que la regla compuesta del trapecio <span class="math notranslate nohighlight">\(T_c(f)\)</span> se escribe como:</p>
<div class="math notranslate nohighlight">
\[T_c(f) = \displaystyle \frac{h}{2n}\left[f(x_0)+f(x_n)+2\displaystyle\sum_{i=1}^{n-1}f(x_i)\right]\]</div>
<p>con <span class="math notranslate nohighlight">\(h=b-a\)</span> y <span class="math notranslate nohighlight">\(n\)</span> número de subintervalos.</p>
<p><strong>Nota:</strong> Los nodos para el caso del trapecio se obtienen con la fórmula: <span class="math notranslate nohighlight">\(x_i = a +i\hat{h}, \forall i=0,\dots,n, \hat{h}=\frac{h}{n}\)</span>.</p>
<p><strong>Ejemplo de implementación de regla compuesta del trapecio: usando numpy</strong></p>
<p>Con la regla compuesta del trapecio se aproximará la integral <span class="math notranslate nohighlight">\(\int_0^1e^{-x^2}dx\)</span>. Se calculará el error relativo y  graficará <span class="math notranslate nohighlight">\(n\)</span> vs Error relativo para <span class="math notranslate nohighlight">\(n=1,10,100,1000,10000\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="c1">#using numpy library</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">Tcf</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">f</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">):</span> <span class="c1">#Tcf: trapecio compuesto para f</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute numerical approximation using trapezoidal rule in </span>
<span class="sd">    an interval.</span>
<span class="sd">    Nodes are generated via numpy</span>
<span class="sd">    Args:</span>
<span class="sd">        f (lambda expression): lambda expression of integrand</span>
<span class="sd">        a (int): left point of interval</span>
<span class="sd">        b (int): right point of interval</span>
<span class="sd">        n (int): number of subintervals</span>
<span class="sd">    Returns:</span>
<span class="sd">        Tcf (float) </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">h</span><span class="o">=</span><span class="n">b</span><span class="o">-</span><span class="n">a</span>
    <span class="n">nodes</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">sum_res</span><span class="o">=</span><span class="nb">sum</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">nodes</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
    <span class="k">return</span> <span class="n">h</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">n</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">nodes</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="n">f</span><span class="p">(</span><span class="n">nodes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">sum_res</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Graficamos:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">numb_of_subintervals</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">1000</span><span class="p">,</span><span class="mi">10000</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">approx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">Tcf</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">f</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">numb_of_subintervals</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">err_relativo</span><span class="p">(</span><span class="n">aprox</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">aprox</span><span class="o">-</span><span class="n">obj</span><span class="p">)</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span> <span class="c1">#obsérvese el uso de la librería numpy</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">err_relativo_res</span> <span class="o">=</span> <span class="n">err_relativo</span><span class="p">(</span><span class="n">approx</span><span class="p">,</span><span class="n">obj</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">err_relativo_res</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">numb_of_subintervals</span><span class="p">,</span><span class="n">err_relativo_res</span><span class="p">,</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;number of subintervals&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Relative error&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Error relativo en la regla del Trapecio&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p>Si no nos interesa el valor de los errores relativos y sólo la gráfica podemos utilizar la siguiente opción:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">partial</span>
</pre></div>
</div>
</div>
</div>
<p>Ver <a class="reference external" href="https://docs.python.org/2/library/functools.html#functools.partial">functools.partial</a> para documentación, <a class="reference external" href="https://stackoverflow.com/questions/15331726/how-does-functools-partial-do-what-it-does">liga</a> para una explicación de <code class="docutils literal notranslate"><span class="pre">partial</span></code> y <a class="reference external" href="https://stackoverflow.com/questions/10834960/how-to-do-multiple-arguments-to-map-function-where-one-remains-the-same-in-pytho">liga2</a>, <a class="reference external" href="https://stackoverflow.com/questions/47859209/how-to-map-over-a-function-with-multiple-arguments-in-python">liga3</a> para ejemplos de uso.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">approx</span><span class="o">=</span><span class="nb">map</span><span class="p">(</span><span class="n">partial</span><span class="p">(</span><span class="n">Tcf</span><span class="p">,</span><span class="n">f</span><span class="o">=</span><span class="n">f</span><span class="p">,</span><span class="n">a</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">b</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span><span class="n">numb_of_subintervals</span><span class="p">)</span> <span class="c1">#map regresa un iterator</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">err_relativo</span><span class="p">(</span><span class="n">aprox_map</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">ap</span> <span class="ow">in</span> <span class="n">aprox_map</span><span class="p">:</span>
        <span class="k">yield</span> <span class="n">math</span><span class="o">.</span><span class="n">fabs</span><span class="p">(</span><span class="n">ap</span><span class="o">-</span><span class="n">obj</span><span class="p">)</span><span class="o">/</span><span class="n">math</span><span class="o">.</span><span class="n">fabs</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span> <span class="c1">#obsérvese el uso de la librería math</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Obs:</strong> la función <code class="docutils literal notranslate"><span class="pre">err_relativo</span></code> anterior es un <a class="reference external" href="https://wiki.python.org/moin/Generators">generator</a>, ver <a class="reference external" href="https://stackoverflow.com/questions/231767/what-does-the-yield-keyword-do">liga</a> para conocer el uso de <code class="docutils literal notranslate"><span class="pre">yield</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">err_relativo_res</span> <span class="o">=</span> <span class="n">err_relativo</span><span class="p">(</span><span class="n">approx</span><span class="p">,</span><span class="n">obj</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">numb_of_subintervals</span><span class="p">,</span><span class="nb">list</span><span class="p">(</span><span class="n">err_relativo_res</span><span class="p">),</span><span class="s1">&#39;*&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;number of subintervals&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Relative error&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Error relativo en la regla del Trapecio&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p><strong>usando scatter:</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">approx</span><span class="o">=</span><span class="nb">map</span><span class="p">(</span><span class="n">partial</span><span class="p">(</span><span class="n">Tcf</span><span class="p">,</span><span class="n">f</span><span class="o">=</span><span class="n">f</span><span class="p">,</span><span class="n">a</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">b</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span><span class="n">numb_of_subintervals</span><span class="p">)</span> <span class="c1">#map regresa un iterator</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">err_relativo_res</span> <span class="o">=</span> <span class="n">err_relativo</span><span class="p">(</span><span class="n">approx</span><span class="p">,</span><span class="n">obj</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">err_rel</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span><span class="p">,</span><span class="n">err_rel</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">numb_of_subintervals</span><span class="p">,</span><span class="n">err_relativo_res</span><span class="p">)]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;number of subintervals&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Relative error&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Error relativo en la regla del Trapecio&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
</div>
<div class="section" id="regla-compuesta-de-simpson">
<h4>Regla compuesta de Simpson<a class="headerlink" href="#regla-compuesta-de-simpson" title="Permalink to this headline">¶</a></h4>
<img src="https://dl.dropboxusercontent.com/s/8rx32vdtulpdflm/Simpson_compuesto.png?dl=0" heigth="200" width="200">
<p>En cada subintervalo se aplica la regla simple <span class="math notranslate nohighlight">\(Sf\)</span>, esto es:</p>
<div class="math notranslate nohighlight">
\[\displaystyle \int_{a_{i-1}}^{a_i}f(x)dx \approx S_i(f) \forall i=1,\dots,n\]</div>
<p>con <span class="math notranslate nohighlight">\(S_i(f) = \frac{h}{6}\left[f(x_{2i}+f(x_{2i-2})+4f(x_{2i-1})\right]\)</span> para el subintervalo <span class="math notranslate nohighlight">\([a_{i-1},a_i]\)</span> con <span class="math notranslate nohighlight">\(i=1,\dots,n\)</span>.</p>
<p>De forma sencilla se puede ver que la regla compuesta de Simpson compuesta <span class="math notranslate nohighlight">\(S_c(f)\)</span> se escribe como:</p>
<div class="math notranslate nohighlight">
\[S_c(f) = \displaystyle \frac{h}{3(2n)} \left [ f(x_0) + f(x_{2n}) + 2 \sum_{i=1}^{n-1}f(x_{2i}) + 4 \sum_{i=1}^{n}f(x_{2i-1})\right ] \]</div>
<p>con <span class="math notranslate nohighlight">\(h=b-a\)</span> y <span class="math notranslate nohighlight">\(n\)</span> número de subintervalos.</p>
<p><strong>Nota:</strong> Los nodos para el caso de Simpson se obtienen con la fórmula: <span class="math notranslate nohighlight">\(x_i = a +\frac{i}{2}\hat{h}, \forall i=0,\dots,2n, \hat{h}=\frac{h}{n}\)</span>.</p>
<p><strong>En esta <a class="reference external" href="https://www.dropbox.com/s/qrbcs5n57kp5150/Simpson-6-subintervalos.pdf?dl=0">liga</a> está un apoyo visual para la regla Scf.</strong></p>
<p><strong>Ejercicio: implementar la regla compuesta de Simpson para aproximar la integral <span class="math notranslate nohighlight">\(\int_0^1e^{-x^2}dx\)</span>. Calcular error relativo y realizar una gráfica de <span class="math notranslate nohighlight">\(n\)</span> vs Error relativo para <span class="math notranslate nohighlight">\(n=1,10,100,1000,10000\)</span> utilizando numpy e iterators.</strong></p>
<p>La forma de los errores de las reglas del rectángulo, trapecio y Simpson se pueden obtener con interpolación o con el teorema de Taylor. Ver <a class="reference external" href="https://www.dropbox.com/s/jfrxanjls8kndjp/Diferenciacion_e_Integracion.pdf?dl=0">Diferenciación e Integración</a> para detalles y <a class="reference internal" href="README.html#ptdn"><span class="std std-ref">Polinomios de Taylor y diferenciación numérica</span></a> para el teorema. Suponiendo que <span class="math notranslate nohighlight">\(f\)</span> cumple con condiciones sobre sus derivadas, tales errores son:</p>
<div class="math notranslate nohighlight">
\[\text{Err}Rc(f) = \frac{b-a}{6}f^{(2)}(\xi_r)\hat{h}^2, \xi_r \in [a,b]\]</div>
<div class="math notranslate nohighlight">
\[\text{Err}Tc(f)=-\frac{b-a}{12}f^{(2)}(\xi_t)\hat{h}^2, \xi_t \in [a,b]\]</div>
<div class="math notranslate nohighlight">
\[\text{Err}Sc(f)=-\frac{b-a}{180}f^{(4)}(\xi_S)\hat{h}^4, \xi_S \in [a,b].\]</div>
</div>
</div>
<div class="section" id="integracion-por-el-metodo-de-monte-carlo">
<h3>Integración por el método de Monte Carlo<a class="headerlink" href="#integracion-por-el-metodo-de-monte-carlo" title="Permalink to this headline">¶</a></h3>
<p>Los métodos de integración numérica por Monte Carlo son similares a los métodos por cuadratura en el sentido que se eligen puntos en los que se evaluará el integrando para sumar sus valores. La diferencia esencial con los métodos por cuadratura es que en el método de integración por Monte Carlo los puntos son seleccionados de una forma <em>aleatoria</em> (de hecho es pseudo-aleatoria pues se generan con un programa de computadora) en lugar de generarse con una fórmula.</p>
<p><strong>Problema:</strong> Aproximar numéricamente la integral <span class="math notranslate nohighlight">\(\displaystyle \int_{\Omega}f(x)dx\)</span> para <span class="math notranslate nohighlight">\(x \in \mathbb{R}^N, \Omega \subseteq \mathbb{R}^N, f: \mathbb{R}^N \rightarrow \mathbb{R}\)</span> función tal que la integral esté bien definida en <span class="math notranslate nohighlight">\(\Omega\)</span>.</p>
<p>Por ejemplo para <span class="math notranslate nohighlight">\(N=2:\)</span></p>
<img src="https://dl.dropboxusercontent.com/s/xktwjmgbf8aiekw/integral_2_dimensiones.png?dl=0" heigth="500" width="500">
<p>Para resolver el problema anterior con <span class="math notranslate nohighlight">\(\Omega\)</span> un rectángulo, podemos utilizar las reglas por cuadratura por Newton-Cotes o cuadratura Gaussiana en una dimensión manteniendo fija la otra dimensión. Sin embargo considérese la siguiente situación:</p>
<p>La regla del rectángulo (o del punto medio) y del trapecio tienen un error de orden <span class="math notranslate nohighlight">\(\mathcal{O}(h^2)\)</span> independientemente de si se está aproximando integrales de una o más dimensiones. Supóngase que se utilizan <span class="math notranslate nohighlight">\(n\)</span> nodos para tener un valor de espaciado igual a <span class="math notranslate nohighlight">\(h\)</span>, entonces para <span class="math notranslate nohighlight">\(N\)</span> dimensiones se requerirían <span class="math notranslate nohighlight">\(P=n^N\)</span> evaluaciones del integrando, o bien, si se tiene un valor de <span class="math notranslate nohighlight">\(P\)</span> igual a <span class="math notranslate nohighlight">\(10, 000\)</span> y <span class="math notranslate nohighlight">\(N=4\)</span> dimensiones el error sería del orden <span class="math notranslate nohighlight">\(\mathcal{O}(P^{-2/N})\)</span> lo que implicaría un valor de <span class="math notranslate nohighlight">\(h=.1\)</span> para aproximadamente sólo <strong>dos dígitos</strong> correctos en la aproximación (para el enunciado anterior recuérdese que <span class="math notranslate nohighlight">\(h\)</span> es proporcional a <span class="math notranslate nohighlight">\(n^{-1}\)</span> y <span class="math notranslate nohighlight">\(n\)</span> = <span class="math notranslate nohighlight">\(P^{1/N}\)</span>). Este esfuerzo enorme de evaluar <span class="math notranslate nohighlight">\(P\)</span> veces el integrando para una exactitud pequeña se debe al problema de generar puntos para <em>llenar</em> un espacio <span class="math notranslate nohighlight">\(N\)</span>-dimensional y se conoce con el nombre de la maldición de la dimensionalidad, <strong>the curse of dimensionality</strong>.</p>
<p>Una opción para resolver la situación anterior si no se desea una exactitud grande (por ejemplo con una precisión de <span class="math notranslate nohighlight">\(10^{-4}\)</span> o <span class="math notranslate nohighlight">\(4\)</span> dígitos es suficiente) es con el método de integración por Monte Carlo (tal nombre por el uso de números aleatorios). La integración por el método de Monte Carlo está basada en la interpretación geométrica de las integrales: calcular la integral del problema inicial implica calcular el <strong>hipervolumen</strong> de <span class="math notranslate nohighlight">\(\Omega\)</span>.</p>
<p><strong>Ejemplo:</strong></p>
<p>Supóngase que se desea aproximar el área de un círculo centrado en el origen de radio igual a <span class="math notranslate nohighlight">\(1\)</span>:</p>
<img src="https://dl.dropboxusercontent.com/s/xmtcxw3wntfxuau/monte_carlo_1.png?dl=0" heigth="300" width="300">
<p>entonces el área de este círculo es <span class="math notranslate nohighlight">\(\pi r^2 = \pi\)</span>.</p>
<p>Para lo anterior <strong>encerramos</strong> al círculo con un cuadrado de lado <span class="math notranslate nohighlight">\(2\)</span>:</p>
<img src="https://dl.dropboxusercontent.com/s/igsn57vuahem0il/monte_carlo_2.png?dl=0" heigth="200" width="200"><p>Si tenemos <span class="math notranslate nohighlight">\(n\)</span> puntos en el cuadrado:</p>
<img src="https://dl.dropboxusercontent.com/s/a4krdneo0jaerqz/monte_carlo_3.png?dl=0" heigth="200" width="200">
<p>y consideramos los <span class="math notranslate nohighlight">\(m\)</span> puntos que están dentro del círculo:</p>
<img src="https://dl.dropboxusercontent.com/s/pr4c5e57r4fawdt/monte_carlo_4.png?dl=0" heigth="200" width="200"><p>Entonces: <span class="math notranslate nohighlight">\(\frac{\text{Área del círculo}}{\text{Área del cuadrado}} \approx \frac{m}{n}\)</span> y se tiene: Área del círculo <span class="math notranslate nohighlight">\(\approx\)</span>Área del cuadrado<span class="math notranslate nohighlight">\(\frac{m}{n}\)</span> y si <span class="math notranslate nohighlight">\(n\)</span> crece entonces la aproximación es mejor.</p>
<p>prueba numérica:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">density_p</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="mf">2.5</span><span class="o">*</span><span class="mi">10</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>
<span class="n">x_p</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,(</span><span class="n">density_p</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_p</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">x_p</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">)</span>
<span class="n">density</span><span class="o">=</span><span class="mf">1e-5</span>
<span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">density</span><span class="p">)</span>
<span class="n">y1</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">y2</span><span class="o">=-</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y1</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y2</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Integración por Monte Carlo&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="c1">#definición de norma2</span>
<span class="n">ind</span><span class="o">=</span><span class="n">f</span><span class="p">(</span><span class="n">x_p</span><span class="p">)</span><span class="o">&lt;=</span><span class="mi">1</span>
<span class="n">x_p_subset</span><span class="o">=</span><span class="n">x_p</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_p_subset</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">x_p_subset</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Integración por Monte Carlo&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p>Área del círculo es aproximadamente:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Area_cuadrado</span><span class="o">=</span><span class="mi">4</span>
<span class="n">Area_cuadrado</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">x_p_subset</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">x_p</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p>Si aumentamos el número de puntos…</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">density_p</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span>
<span class="n">x_p</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,(</span><span class="n">density_p</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="n">ind</span><span class="o">=</span><span class="n">f</span><span class="p">(</span><span class="n">x_p</span><span class="p">)</span><span class="o">&lt;=</span><span class="mi">1</span>
<span class="n">x_p_subset</span><span class="o">=</span><span class="n">x_p</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>
<span class="n">Area_cuadrado</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">x_p_subset</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">x_p</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">density_p</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="mi">5</span><span class="p">)</span>
<span class="n">x_p</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,(</span><span class="n">density_p</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="n">ind</span><span class="o">=</span><span class="n">f</span><span class="p">(</span><span class="n">x_p</span><span class="p">)</span><span class="o">&lt;=</span><span class="mi">1</span>
<span class="n">x_p_subset</span><span class="o">=</span><span class="n">x_p</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>
<span class="n">Area_cuadrado</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">x_p_subset</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">x_p</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p><strong>Comentarios:</strong></p>
<ul class="simple">
<li><p>El método de Monte Carlo revisado en el ejemplo anterior nos indica que debemos encerrar a la región de integración <span class="math notranslate nohighlight">\(\Omega\)</span>. Por ejemplo para una región <span class="math notranslate nohighlight">\(\Omega\)</span> más general:</p></li>
</ul>
<img src="https://dl.dropboxusercontent.com/s/ke6hngwue3ovpaz/monte_carlo_5.png?dl=0" heigth="300" width="300">
<p>entonces la integración por el método de Monte Carlo será:</p>
<div class="math notranslate nohighlight">
\[\displaystyle \int_\Omega f d\Omega \approx V \overline{f}\]</div>
<p>donde: <span class="math notranslate nohighlight">\(V\)</span> es el hipervolumen de <span class="math notranslate nohighlight">\(\Omega_E\)</span> que encierra a <span class="math notranslate nohighlight">\(\Omega\)</span>, esto es <span class="math notranslate nohighlight">\(\Omega \subseteq \Omega_E\)</span>, <span class="math notranslate nohighlight">\(\{x_1,\dots,x_n\}\)</span> es un conjunto de puntos distribuidos uniformemente en <span class="math notranslate nohighlight">\(\Omega_E\)</span> y <span class="math notranslate nohighlight">\(\overline{f}=\frac{1}{n}\displaystyle \sum_{i=1}^nf(x_i)\)</span></p>
<ul class="simple">
<li><p>Consideramos <span class="math notranslate nohighlight">\(\overline{f}\)</span> pues <span class="math notranslate nohighlight">\(\displaystyle \sum_{i=1}^nf(x_i)\)</span> representa el valor de <span class="math notranslate nohighlight">\(m\)</span> si pensamos a <span class="math notranslate nohighlight">\(f\)</span> como una restricción que deben cumplir los <span class="math notranslate nohighlight">\(n\)</span> puntos en el ejemplo de aproximación al área del círculo: Área del círculo <span class="math notranslate nohighlight">\(\approx\)</span>Área del cuadrado<span class="math notranslate nohighlight">\(\frac{m}{n}\)</span> (en este caso Área del cuadrado es el hipervolumen <span class="math notranslate nohighlight">\(V\)</span>).</p></li>
</ul>
<ul class="simple">
<li><p>Algunas características para regiones que encierren a <span class="math notranslate nohighlight">\(\Omega\)</span> es que:</p>
<ul>
<li><p>Sea sencillo generar números aleatorios uniformes.</p></li>
<li><p>Sea sencillo obtener su hipervolumen.</p></li>
</ul>
</li>
</ul>
<p><strong>Ejemplos:</strong> aproximar las siguientes integrales:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">density_p</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\displaystyle \int_0^1\frac{4}{1+x^2}dx = \pi\)</span></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">4</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">x_p</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">density_p</span><span class="p">)</span>
<span class="n">obj</span><span class="o">=</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span>
<span class="n">a</span><span class="o">=</span><span class="mi">0</span>
<span class="n">b</span><span class="o">=</span><span class="mi">1</span>
<span class="n">vol</span><span class="o">=</span><span class="n">b</span><span class="o">-</span><span class="n">a</span>
<span class="n">approx</span><span class="o">=</span><span class="n">vol</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x_p</span><span class="p">))</span>
<span class="n">err_rel</span><span class="o">=</span><span class="k">lambda</span> <span class="n">ap</span><span class="p">,</span><span class="n">ob</span><span class="p">:</span> <span class="n">math</span><span class="o">.</span><span class="n">fabs</span><span class="p">(</span><span class="n">ap</span><span class="o">-</span><span class="n">ob</span><span class="p">)</span><span class="o">/</span><span class="n">math</span><span class="o">.</span><span class="n">fabs</span><span class="p">(</span><span class="n">ob</span><span class="p">)</span>
<span class="s2">&quot;error relativo: </span><span class="si">{:0.4e}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">err_rel</span><span class="p">(</span><span class="n">approx</span><span class="p">,</span><span class="n">obj</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\displaystyle \int_1^2 \frac{1}{x}dx = \log{2}\)</span>.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="n">x</span>
<span class="n">x_p</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">density_p</span><span class="p">)</span>
<span class="n">obj</span><span class="o">=</span><span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">a</span><span class="o">=</span><span class="mi">1</span>
<span class="n">b</span><span class="o">=</span><span class="mi">2</span>
<span class="n">vol</span><span class="o">=</span><span class="n">b</span><span class="o">-</span><span class="n">a</span>
<span class="n">approx</span><span class="o">=</span><span class="n">vol</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x_p</span><span class="p">))</span>
<span class="s2">&quot;error relativo: </span><span class="si">{:0.4e}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">err_rel</span><span class="p">(</span><span class="n">approx</span><span class="p">,</span><span class="n">obj</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\displaystyle \int_{-1}^1 \int_0^1x^2+y^2dxdy = \frac{4}{3}\)</span>.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">:</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">y</span><span class="o">**</span><span class="mi">2</span>
<span class="n">a1</span><span class="o">=-</span><span class="mi">1</span>
<span class="n">b1</span><span class="o">=</span><span class="mi">1</span>
<span class="n">a2</span><span class="o">=</span><span class="mi">0</span>
<span class="n">b2</span><span class="o">=</span><span class="mi">1</span>
<span class="n">x_p</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span><span class="n">b1</span><span class="p">,</span><span class="n">density_p</span><span class="p">)</span>
<span class="n">y_p</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">a2</span><span class="p">,</span><span class="n">b2</span><span class="p">,</span><span class="n">density_p</span><span class="p">)</span>
<span class="n">obj</span><span class="o">=</span><span class="mi">4</span><span class="o">/</span><span class="mi">3</span>
<span class="n">vol</span><span class="o">=</span><span class="p">(</span><span class="n">b1</span><span class="o">-</span><span class="n">a1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">b2</span><span class="o">-</span><span class="n">a2</span><span class="p">)</span>
<span class="n">approx</span><span class="o">=</span><span class="n">vol</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x_p</span><span class="p">,</span><span class="n">y_p</span><span class="p">))</span>
<span class="s2">&quot;error relativo: </span><span class="si">{:0.4e}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">err_rel</span><span class="p">(</span><span class="n">approx</span><span class="p">,</span><span class="n">obj</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\displaystyle \int_0^{\frac{\pi}{2}} \int_0^{\frac{\pi}{2}}\cos(x)\sin(y)dxdy=1\)</span>.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="n">a1</span><span class="o">=</span><span class="mi">0</span>
<span class="n">b1</span><span class="o">=</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span>
<span class="n">a2</span><span class="o">=</span><span class="mi">0</span>
<span class="n">b2</span><span class="o">=</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span>
<span class="n">x_p</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span><span class="n">b1</span><span class="p">,</span><span class="n">density_p</span><span class="p">)</span>
<span class="n">y_p</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">a2</span><span class="p">,</span><span class="n">b2</span><span class="p">,</span><span class="n">density_p</span><span class="p">)</span>
<span class="n">obj</span><span class="o">=</span><span class="mi">1</span>
<span class="n">vol</span><span class="o">=</span><span class="p">(</span><span class="n">b1</span><span class="o">-</span><span class="n">a1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">b2</span><span class="o">-</span><span class="n">a2</span><span class="p">)</span>
<span class="n">approx</span><span class="o">=</span><span class="n">vol</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x_p</span><span class="p">,</span><span class="n">y_p</span><span class="p">))</span>
<span class="s2">&quot;error relativo: </span><span class="si">{:0.4e}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">err_rel</span><span class="p">(</span><span class="n">approx</span><span class="p">,</span><span class="n">obj</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\displaystyle \int_0^1\int_{\frac{-1}{2}}^0\int_0^{\frac{1}{3}}(x+2y+3z)^2dxdydz =\frac{1}{12}\)</span>.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">:(</span><span class="n">x</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">z</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
<span class="n">a1</span><span class="o">=</span><span class="mi">0</span>
<span class="n">b1</span><span class="o">=</span><span class="mi">1</span>
<span class="n">a2</span><span class="o">=-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span>
<span class="n">b2</span><span class="o">=</span><span class="mi">0</span>
<span class="n">a3</span><span class="o">=</span><span class="mi">0</span>
<span class="n">b3</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span>
<span class="n">x_p</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span><span class="n">b1</span><span class="p">,</span><span class="n">density_p</span><span class="p">)</span>
<span class="n">y_p</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">a2</span><span class="p">,</span><span class="n">b2</span><span class="p">,</span><span class="n">density_p</span><span class="p">)</span>
<span class="n">z_p</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">a3</span><span class="p">,</span><span class="n">b3</span><span class="p">,</span><span class="n">density_p</span><span class="p">)</span>
<span class="n">obj</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="mi">12</span>
<span class="n">vol</span><span class="o">=</span><span class="p">(</span><span class="n">b1</span><span class="o">-</span><span class="n">a1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">b2</span><span class="o">-</span><span class="n">a2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">b3</span><span class="o">-</span><span class="n">a3</span><span class="p">)</span>
<span class="n">approx</span><span class="o">=</span><span class="n">vol</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x_p</span><span class="p">,</span><span class="n">y_p</span><span class="p">,</span><span class="n">z_p</span><span class="p">))</span>
<span class="s2">&quot;error relativo: </span><span class="si">{:0.4e}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">err_rel</span><span class="p">(</span><span class="n">approx</span><span class="p">,</span><span class="n">obj</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
</div>
<div class="section" id="cual-es-el-error-en-la-aproximacion-por-el-metodo-de-integracion-por-monte-carlo">
<h3>Cuál es el error en la aproximación por el método de integración por Monte Carlo?<a class="headerlink" href="#cual-es-el-error-en-la-aproximacion-por-el-metodo-de-integracion-por-monte-carlo" title="Permalink to this headline">¶</a></h3>
<p>Para obtener la expresión del error en esta aproximación supóngase que <span class="math notranslate nohighlight">\(x_1, x_2,\dots x_n\)</span> son variables aleatorias independientes uniformemente distribuidas. Entonces:</p>
<div class="math notranslate nohighlight">
\[\text{Err}(\overline{f})=\sqrt{\text{Var}(\overline{f})}=\sqrt{\text{Var}\left( \frac{1}{n} \displaystyle \sum_{i=1}^nf(x_i)\right)}=\dots=\sqrt{\frac{\text{Var}(f(x))}{n}}\]</div>
<p>con <span class="math notranslate nohighlight">\(x\)</span> variable aleatoria uniformemente distribuida.</p>
<p>Un estimador de <span class="math notranslate nohighlight">\(\text{Var}(f(x))\)</span> es: <span class="math notranslate nohighlight">\(\frac{1}{n}\displaystyle \sum_{i=1}^n(f(x_i)-\overline{f})^2=\overline{f^2}-\overline{f}^2\)</span> por lo que <span class="math notranslate nohighlight">\(\hat{\text{Err}}(\overline{f}) = \sqrt{\frac{\overline{f^2}-\overline{f}^2}{n}}\)</span>.</p>
<p>Se tiene entonces:</p>
<div class="math notranslate nohighlight">
\[\displaystyle \int_\Omega f d\Omega \approx V(\overline{f} \pm \text{Err}(\overline{f})) \approx V(\overline{f} \pm \hat{\text{Err}}(\overline{f}))=V\overline{f} \pm V\sqrt{\frac{\overline{f^2}-\overline{f}^2}{n}}\]</div>
<p><strong>Ejemplo:</strong></p>
<p>Para el ejemplo anterior <span class="math notranslate nohighlight">\(\displaystyle \int_0^1\frac{4}{1+x^2}dx = \pi\)</span> se tiene:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">4</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">x_p</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">density_p</span><span class="p">)</span>
<span class="n">obj</span><span class="o">=</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span>
<span class="n">a</span><span class="o">=</span><span class="mi">0</span>
<span class="n">b</span><span class="o">=</span><span class="mi">1</span>
<span class="n">vol</span><span class="o">=</span><span class="n">b</span><span class="o">-</span><span class="n">a</span>
<span class="n">f_barra</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x_p</span><span class="p">))</span>
<span class="n">approx</span><span class="o">=</span><span class="n">vol</span><span class="o">*</span><span class="n">f_barra</span>
<span class="n">err_rel</span><span class="o">=</span><span class="k">lambda</span> <span class="n">ap</span><span class="p">,</span><span class="n">ob</span><span class="p">:</span> <span class="n">math</span><span class="o">.</span><span class="n">fabs</span><span class="p">(</span><span class="n">ap</span><span class="o">-</span><span class="n">ob</span><span class="p">)</span><span class="o">/</span><span class="n">math</span><span class="o">.</span><span class="n">fabs</span><span class="p">(</span><span class="n">ob</span><span class="p">)</span>
<span class="s2">&quot;error relativo: </span><span class="si">{:0.4e}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">err_rel</span><span class="p">(</span><span class="n">approx</span><span class="p">,</span><span class="n">obj</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">error_est</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">sum</span><span class="p">((</span><span class="n">f</span><span class="p">(</span><span class="n">x_p</span><span class="p">)</span><span class="o">-</span><span class="n">f_barra</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">density_p</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">error_est</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p>intervalo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">approx</span><span class="o">-</span><span class="n">vol</span><span class="o">*</span><span class="n">error_est</span><span class="p">,</span> <span class="n">approx</span><span class="o">+</span><span class="n">vol</span><span class="o">*</span><span class="n">error_est</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p><strong>Ejercicios:</strong> Aproximar, reportar errores relativos e intervalo de estimación en una tabla:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\displaystyle \int_0^1\int_0^1\sqrt{x+y}dydx=\frac{2}{3}\left(\frac{2}{5}2^{5/2}-\frac{4}{5}\right)\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(\displaystyle \int_D \int \sqrt{x+y}dydx=8\frac{\sqrt{2}}{15}\)</span> donde: <span class="math notranslate nohighlight">\(D=\{(x,y) \in \mathbb{R}^2 | 0 \leq x \leq 1, -x \leq y \leq x\}\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(\displaystyle \int_D \int \exp{(x^2+y^2)}dydx = \pi(e^9-1)\)</span> donde <span class="math notranslate nohighlight">\(D=\{(x,y) \in \mathbb{R}^2 | x^2+y^2 \leq 9\}\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(\displaystyle \int_0^2 \int_{-1}^1 \int_0^1 (2x+3y+z)dzdydx = 10\)</span>.</p></li>
</ul>
<p><strong>Comentarios:</strong></p>
<ul class="simple">
<li><p>Los signos <span class="math notranslate nohighlight">\(\pm\)</span> en el error de aproximación <strong>no</strong> representan una cota rigurosa, es una desviación estándar.</p></li>
<li><p>A diferencia de la aproximación por las reglas por cuadratura tenemos una precisión con <span class="math notranslate nohighlight">\(n\)</span> puntos independientemente de la dimensión <span class="math notranslate nohighlight">\(N\)</span>.</p></li>
<li><p>Si <span class="math notranslate nohighlight">\(N \rightarrow \infty\)</span> entonces <span class="math notranslate nohighlight">\(\hat{\text{Err}}(\overline{f}) = \mathcal{O}\left(\frac{1}{\sqrt{n}} \right)\)</span> por lo que para ganar un decimal extra de precisión en la integración por el método de Monte Carlo se requiere incrementar el número de puntos por un factor de <span class="math notranslate nohighlight">\(10^2\)</span>.</p></li>
</ul>
<p><strong>Obs:</strong> obsérvese que si <span class="math notranslate nohighlight">\(f\)</span> es constante entonces <span class="math notranslate nohighlight">\(\hat{\text{Err}}(\overline{f})=0\)</span>. Esto implica que si <span class="math notranslate nohighlight">\(f\)</span> es casi constante y <span class="math notranslate nohighlight">\(\Omega_E\)</span> encierra muy bien a <span class="math notranslate nohighlight">\(\Omega\)</span> entonces se tendrá una estimación muy precisa de <span class="math notranslate nohighlight">\(\displaystyle \int_\Omega f d\Omega\)</span>, por esto en la integración por el método de Monte Carlo se realizan cambios de variable de modo que transformen a <span class="math notranslate nohighlight">\(f\)</span> en aproximadamente constante y que esto resulte además en regiones <span class="math notranslate nohighlight">\(\Omega_E\)</span> que encierren a <span class="math notranslate nohighlight">\(\Omega\)</span> casi de manera exacta (y que además sea sencillo generar números pseudo aleatorios en ellas!).</p>
<p><strong>Comentario:</strong></p>
<p>La integración por el método de Monte Carlo se utiliza para aproximar características de variables aleatorias continuas. Por ejemplo, si <span class="math notranslate nohighlight">\(x\)</span> es variable aleatoria continua, entonces su media está dada por:</p>
<div class="math notranslate nohighlight">
\[E_f[h(X)] = \displaystyle \int_{S_X}h(x)f(x)dx\]</div>
<p>donde <span class="math notranslate nohighlight">\(f\)</span> es función de densidad de <span class="math notranslate nohighlight">\(X\)</span>, <span class="math notranslate nohighlight">\(S_X\)</span> es el soporte de <span class="math notranslate nohighlight">\(X\)</span> y <span class="math notranslate nohighlight">\(h\)</span> es una transformación. Entonces:</p>
<div class="math notranslate nohighlight">
\[E_f[h(X)] \approx \frac{1}{n} \displaystyle \sum_{i=1}^nh(x_i)=\overline{h}_n\]</div>
<p>con <span class="math notranslate nohighlight">\(\{x_1,x_2,\dots,x_n\}\)</span> muestra de <span class="math notranslate nohighlight">\(f\)</span>. Y por la ley de los grandes números se tiene:</p>
<div class="math notranslate nohighlight">
\[\overline{h}_n \xrightarrow{n \rightarrow \infty} E_f[h(X)]\]</div>
<div class="math notranslate nohighlight">
\[\frac{\overline{h}_n-E_f[h(X)]}{\hat{\text{Err}}(\overline{h})} \xrightarrow{n \rightarrow \infty} N(0,1)\]</div>
<p>con <span class="math notranslate nohighlight">\(N(0,1)\)</span> una distribución Normal con <span class="math notranslate nohighlight">\(\mu=0,\sigma=1\)</span> <span class="math notranslate nohighlight">\(\therefore\)</span> si <span class="math notranslate nohighlight">\(n \rightarrow \infty\)</span> un intervalo de confianza al <span class="math notranslate nohighlight">\(95\%\)</span> para <span class="math notranslate nohighlight">\(E_f[h(X)]\)</span> es: <span class="math notranslate nohighlight">\((\overline{h}_n \pm z_{.975} \hat{\text{Err}}(\overline{h}))\)</span>.</p>
<p><strong>Obs:</strong> uno de los pasos complicados en el desarrollo anterior es obtener una muestra de <span class="math notranslate nohighlight">\(f\)</span> que para el caso de variables continuas se puede utilizar el teorema de transformación inversa o integral de probabilidad.</p>
<p><strong>Ejercicios</strong></p>
<ol class="simple">
<li><p>Resuelve los ejercicios y preguntas de la nota.</p></li>
</ol>
<p><strong>Referencias</strong></p>
<ol class="simple">
<li><p>R. L. Burden, J. D. Faires, Numerical Analysis, Brooks/Cole Cengage Learning, 2005.</p></li>
<li><p>M. T. Heath, Scientific Computing. An Introductory Survey, McGraw-Hill, 2002.</p></li>
<li><p>Nota <a class="reference internal" href="README.html#spf"><span class="std std-ref">Sistema de punto flotante</span></a>.</p></li>
<li><p>Nota <a class="reference internal" href="README.html#dfdf"><span class="std std-ref">Definición de función, derivada de una función</span></a>.</p></li>
<li><p>Nota <a class="reference internal" href="README.html#ptdn"><span class="std std-ref">Polinomios de Taylor y diferenciación numérica</span></a>.</p></li>
<li><p>Nota <a class="reference internal" href="README.html#cpea"><span class="std std-ref">Condición de un problema y estabilidad de un algoritmo</span></a>.</p></li>
</ol>
</div>
</div>
</div>
<div class="toctree-wrapper compound">
<span id="document-II.computo_matricial/2.1/Operaciones_y_transformaciones_basicas_del_Algebra_Lineal_Numerica"></span><div class="admonition-notas-para-contenedor-de-docker admonition">
<p class="admonition-title">Notas para contenedor de docker:</p>
<p>Comando de docker para ejecución de la nota de forma local:</p>
<p>nota: cambiar <code class="docutils literal notranslate"><span class="pre">&lt;ruta</span> <span class="pre">a</span> <span class="pre">mi</span> <span class="pre">directorio&gt;</span></code> por la ruta de directorio que se desea mapear a <code class="docutils literal notranslate"><span class="pre">/datos</span></code> dentro del contenedor de docker.</p>
<p><code class="docutils literal notranslate"><span class="pre">docker</span> <span class="pre">run</span> <span class="pre">--rm</span> <span class="pre">-v</span> <span class="pre">&lt;ruta</span> <span class="pre">a</span> <span class="pre">mi</span> <span class="pre">directorio&gt;:/datos</span> <span class="pre">--name</span> <span class="pre">jupyterlab_optimizacion</span> <span class="pre">-p</span> <span class="pre">8888:8888</span> <span class="pre">-d</span> <span class="pre">palmoreck/jupyterlab_optimizacion:2.1.4</span></code></p>
<p>password para jupyterlab: <code class="docutils literal notranslate"><span class="pre">qwerty</span></code></p>
<p>Detener el contenedor de docker:</p>
<p><code class="docutils literal notranslate"><span class="pre">docker</span> <span class="pre">stop</span> <span class="pre">jupyterlab_optimizacion</span></code></p>
<p>Documentación de la imagen de docker <code class="docutils literal notranslate"><span class="pre">palmoreck/jupyterlab_optimizacion:2.1.4</span></code> en <a class="reference external" href="https://github.com/palmoreck/dockerfiles/tree/master/jupyterlab/optimizacion">liga</a>.</p>
</div>
<hr class="docutils" />
<p>Nota generada a partir de <a class="reference external" href="https://www.dropbox.com/s/fyqwiqasqaa3wlt/3.1.1.Multiplicacion_de_matrices_y_estructura_de_datos.pdf?dl=0">liga1</a>, <a class="reference external" href="https://www.dropbox.com/s/jwu8lu4r14pb7ut/3.2.1.Sistemas_de_ecuaciones_lineales_eliminacion_Gaussiana_y_factorizacion_LU.pdf?dl=0">liga2</a> y <a class="reference external" href="https://www.dropbox.com/s/s4ch0ww1687pl76/3.2.2.Factorizaciones_matriciales_SVD_Cholesky_QR.pdf?dl=0">liga3</a>.</p>
<div class="section" id="operaciones-y-transformaciones-basicas-del-algebra-lineal-numerica">
<h2>2.1 Operaciones y transformaciones básicas del Álgebra Lineal Numérica<a class="headerlink" href="#operaciones-y-transformaciones-basicas-del-algebra-lineal-numerica" title="Permalink to this headline">¶</a></h2>
<p>Las operaciones básicas del Álgebra Lineal Numérica podemos dividirlas en vectoriales y matriciales.</p>
<div class="section" id="vectoriales">
<h3>Vectoriales<a class="headerlink" href="#vectoriales" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p><strong>Transponer:</strong> <span class="math notranslate nohighlight">\(\mathbb{R}^{n \times 1}  \rightarrow \mathbb{R} ^{1 \times n}\)</span>: <span class="math notranslate nohighlight">\(y = x^T\)</span> entonces</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}x = 
\left[
\begin{array}{c}
x_1 \\
x_2 \\
\vdots \\
x_n
\end{array}
\right ]
\end{split}\]</div>
<p>y se tiene:</p>
<div class="math notranslate nohighlight">
\[ y = x^T = [x_1, x_2, \dots, x_n].\]</div>
<ul class="simple">
<li><p><strong>Suma:</strong> <span class="math notranslate nohighlight">\(\mathbb{R}^n  \times \mathbb{R} ^n \rightarrow \mathbb{R}^n\)</span>: $z = x + y $ entonces <span class="math notranslate nohighlight">\(z_i = x_i + y_i\)</span></p></li>
<li><p><strong>Multiplicación por un escalar:</strong> <span class="math notranslate nohighlight">\(\mathbb{R} \times \mathbb{R} ^n \rightarrow \mathbb{R}^n\)</span>: <span class="math notranslate nohighlight">\(y = \alpha x\)</span> entonces <span class="math notranslate nohighlight">\(y_i = \alpha x_i\)</span>.</p></li>
<li><p><strong>Producto interno estándar o producto punto:</strong> <span class="math notranslate nohighlight">\(\mathbb{R}^n \times \mathbb{R} ^n \rightarrow \mathbb{R}\)</span>: <span class="math notranslate nohighlight">\(c = x^Ty\)</span> entonces <span class="math notranslate nohighlight">\(c = \displaystyle \sum_{i=1}^n x_i y_i\)</span>.</p></li>
<li><p><strong>Multiplicación <em>point wise:</em></strong> <span class="math notranslate nohighlight">\(\mathbb{R}^n \times \mathbb{R} ^n \rightarrow \mathbb{R}^n\)</span>: <span class="math notranslate nohighlight">\(z = x.*y\)</span> entonces <span class="math notranslate nohighlight">\(z_i = x_i y_i\)</span>.</p></li>
<li><p><strong>División <em>point wise:</em></strong> <span class="math notranslate nohighlight">\(\mathbb{R}^n \times \mathbb{R} ^n \rightarrow \mathbb{R}^n\)</span>: <span class="math notranslate nohighlight">\(z = x./y\)</span> entonces <span class="math notranslate nohighlight">\(z_i = x_i /y_i\)</span> con <span class="math notranslate nohighlight">\(y_i \neq 0\)</span>.</p></li>
<li><p><strong>Producto exterior o <em>outer product</em>:</strong> <span class="math notranslate nohighlight">\(\mathbb{R}^n \times \mathbb{R} ^n \rightarrow \mathbb{R}^{n \times n}\)</span>: <span class="math notranslate nohighlight">\(A = xy^T\)</span> entonces <span class="math notranslate nohighlight">\(A[i, :] = x_i y^T\)</span> con <span class="math notranslate nohighlight">\(A[i,:]\)</span> es el <span class="math notranslate nohighlight">\(i\)</span>-ésimo renglón de <span class="math notranslate nohighlight">\(A\)</span>.</p></li>
</ul>
</div>
<div class="section" id="matriciales">
<h3>Matriciales<a class="headerlink" href="#matriciales" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p><strong>Transponer:</strong> <span class="math notranslate nohighlight">\(\mathbb{R}^{m \times n} \rightarrow \mathbb{R}^{n \times m}\)</span>: <span class="math notranslate nohighlight">\(C = A^T\)</span> entonces <span class="math notranslate nohighlight">\(c_{ij} = a_{ij}\)</span>.</p></li>
<li><p><strong>Sumar:</strong> <span class="math notranslate nohighlight">\(\mathbb{R}^{m \times n} \times \mathbb{R}^{m \times n} \rightarrow \mathbb{R}^{m \times n}\)</span>: <span class="math notranslate nohighlight">\(C = A + B\)</span> entonces <span class="math notranslate nohighlight">\(c_{ij} = a_{ij} + b_{ij}\)</span>.</p></li>
<li><p><strong>Multiplicación por un escalar:</strong> <span class="math notranslate nohighlight">\(\mathbb{R} \times \mathbb{R}^{m \times n} \rightarrow \mathbb{R}^{m \times n}\)</span>: <span class="math notranslate nohighlight">\(C = \alpha A\)</span> entonces <span class="math notranslate nohighlight">\(c_{ij} = \alpha a_{ij}\)</span></p></li>
<li><p><strong>Multiplicación por un vector:</strong> <span class="math notranslate nohighlight">\(\mathbb{R}^{m \times n} \times \mathbb{R}^{n} \rightarrow \mathbb{R}^{m}\)</span>: <span class="math notranslate nohighlight">\(y = Ax\)</span> entonces <span class="math notranslate nohighlight">\(y_i = \displaystyle \sum_{j=1}^n a_{ij}x_j\)</span>.</p></li>
<li><p><strong>Multiplicación entre matrices:</strong> <span class="math notranslate nohighlight">\(\mathbb{R}^{m \times k} \times \mathbb{R}^{k \times n} \rightarrow \mathbb{R}^{m \times n}\)</span>: <span class="math notranslate nohighlight">\(C = AB\)</span> entonces <span class="math notranslate nohighlight">\(c_{ij} = \displaystyle \sum_{r=1}^k a_{ir}b_{rj}\)</span>.</p></li>
<li><p><strong>Multiplicación <em>point wise</em>:</strong> <span class="math notranslate nohighlight">\(\mathbb{R}^{m \times n} \times \mathbb{R}^{m \times n} \rightarrow \mathbb{R}^{m \times n}\)</span>: <span class="math notranslate nohighlight">\(C = A.*B\)</span> entonces <span class="math notranslate nohighlight">\(c_{ij} = a_{ij}b_{ij}\)</span>.</p></li>
<li><p><strong>División <em>point wise</em>:</strong> <span class="math notranslate nohighlight">\(\mathbb{R}^{m \times n} \times \mathbb{R}^{m \times n} \rightarrow \mathbb{R}^{m \times n}\)</span>: <span class="math notranslate nohighlight">\(C = A./B\)</span> entonces <span class="math notranslate nohighlight">\(c_{ij} = a_{ij}/b_{ij}\)</span> con <span class="math notranslate nohighlight">\(b_{ij} \neq 0\)</span>.</p></li>
</ul>
<p>Como ejemplos de transformaciones básicas del Álgebra Lineal Numérica se encuentran:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="transformaciones-de-gauss">
<h3>Transformaciones de Gauss<a class="headerlink" href="#transformaciones-de-gauss" title="Permalink to this headline">¶</a></h3>
<p>En esta sección suponemos que <span class="math notranslate nohighlight">\(A \in \mathbb{R}^{n \times n}\)</span> y <span class="math notranslate nohighlight">\(A\)</span> es una matriz con entradas <span class="math notranslate nohighlight">\(a_{ij} \in \mathbb{R}^{n \times n} \forall i,j=1,2,\dots,n\)</span>.</p>
<p>Considérese al vector <span class="math notranslate nohighlight">\(a \in \mathbb{R}^{n}\)</span> y <span class="math notranslate nohighlight">\(e_k \in \mathbb{R}^n\)</span> el <span class="math notranslate nohighlight">\(k\)</span>-ésimo vector canónico: vector con un <span class="math notranslate nohighlight">\(1\)</span> en la posición <span class="math notranslate nohighlight">\(k\)</span> y ceros en las entradas restantes.</p>
<p>Una transformación de Gauss está definida de forma general como <span class="math notranslate nohighlight">\(L_k = I_n - \ell_ke_k^T\)</span> con <span class="math notranslate nohighlight">\(\ell_k = (0,0,\dots,\ell_{k+1,k},\dots,\ell_{n,k})^T\)</span> y <span class="math notranslate nohighlight">\(\ell_{i,k}=\frac{a_{ik}}{a_{kk}} \forall i=k+1,\dots,n\)</span>.</p>
<p>Las transformaciones de Gauss se utilizan para hacer ceros por debajo del <strong>pivote</strong>.</p>
<div class="section" id="ejemplo-aplicando-transformaciones-de-gauss-a-un-vector">
<h4>Ejemplo aplicando transformaciones de Gauss a un vector<a class="headerlink" href="#ejemplo-aplicando-transformaciones-de-gauss-a-un-vector" title="Permalink to this headline">¶</a></h4>
<p>Considérese al vector <span class="math notranslate nohighlight">\(a=(-2,3,4)^T\)</span>. Definir una transformación de Gauss para hacer ceros por debajo de <span class="math notranslate nohighlight">\(a_1\)</span> y otra transformación de Gauss para hacer cero la entrada <span class="math notranslate nohighlight">\(a_3\)</span></p>
<p><strong>Solución:</strong></p>
<p>a)Para hacer ceros por debajo del <strong>pivote</strong> <span class="math notranslate nohighlight">\(a_1 = -2\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pivote</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title">Recuerda</p>
<p>La definición de <span class="math notranslate nohighlight">\(l_1=(0, \frac{a_2}{a_1}, \frac{a_3}{a_1})^T\)</span></p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">l1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">pivote</span><span class="p">,</span> <span class="n">a</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">/</span><span class="n">pivote</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">e1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p><strong>Observa que por la definición de la transformación de Gauss, no necesitamos construir a la matriz <span class="math notranslate nohighlight">\(L_1\)</span>, directamente se tiene <span class="math notranslate nohighlight">\(L_1a = a - \ell_1 e_1^Ta\)</span>.</strong></p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">L1_a</span> <span class="o">=</span> <span class="n">a</span><span class="o">-</span><span class="n">l1</span><span class="o">*</span><span class="p">(</span><span class="n">e1</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">L1_a</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p>A continuación se muestra que el producto <span class="math notranslate nohighlight">\(L_1 a\)</span> si se construye <span class="math notranslate nohighlight">\(L_1\)</span> es equivalente a lo anterior:</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p><span class="math notranslate nohighlight">\(L_1 = I_3 - \ell_1 e_1^T\)</span>.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">L1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">l1</span><span class="p">,</span><span class="n">e1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">L1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">L1</span><span class="nd">@a</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p>b) Para hacer ceros por debajo del <strong>pivote</strong> <span class="math notranslate nohighlight">\(a_2 = 3\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pivote</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title">Recuerda</p>
<p>La definición de <span class="math notranslate nohighlight">\(l_2=(0, 0, \frac{a_3}{a_2})^T\)</span></p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">l2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="n">a</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">/</span><span class="n">pivote</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">e2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p><strong>Observa que por la definición de la transformación de Gauss, no necesitamos construir a la matriz <span class="math notranslate nohighlight">\(L_2\)</span>, directamente se tiene <span class="math notranslate nohighlight">\(L_2a = a - \ell_2 e_2^Ta\)</span>.</strong></p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">L2_a</span> <span class="o">=</span> <span class="n">a</span><span class="o">-</span><span class="n">l2</span><span class="o">*</span><span class="p">(</span><span class="n">e2</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">L2_a</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p>A continuación se muestra que el producto <span class="math notranslate nohighlight">\(L_2 a\)</span> si se construye <span class="math notranslate nohighlight">\(L_2\)</span> es equivalente a lo anterior:</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p><span class="math notranslate nohighlight">\(L_2 = I_3 - \ell_2 e_2^T\)</span>.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">L2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">l2</span><span class="p">,</span><span class="n">e2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">L2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">L2</span><span class="nd">@a</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
</div>
<div class="section" id="ejemplo-aplicando-transformaciones-de-gauss-a-una-matriz">
<h4>Ejemplo aplicando transformaciones de Gauss a una matriz<a class="headerlink" href="#ejemplo-aplicando-transformaciones-de-gauss-a-una-matriz" title="Permalink to this headline">¶</a></h4>
<p>Si tenemos una matriz <span class="math notranslate nohighlight">\(A \in \mathbb{R}^{3 \times 3}\)</span> y queremos hacer ceros por debajo de su diagonal, realizamos los productos matriciales:</p>
<div class="math notranslate nohighlight">
\[L_2 L_1 A\]</div>
<p>donde: <span class="math notranslate nohighlight">\(L_1, L_2\)</span> son transformaciones de Gauss.</p>
<p><strong>Ejemplo:</strong></p>
<p>a) Utilizando <span class="math notranslate nohighlight">\(L_1\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">7</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">]])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">A</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p>Para hacer ceros por debajo del <strong>pivote</strong> <span class="math notranslate nohighlight">\(a_{11} = -1\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pivote</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title">Recuerda</p>
<p>La definición de <span class="math notranslate nohighlight">\(l_1=(0, \frac{a_{21}}{a_{11}}, \frac{a_{31}}{a_{11}})^T\)</span></p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">l1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">pivote</span><span class="p">,</span> <span class="n">A</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">pivote</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">e1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p><strong>Observa que por la definición de la transformación de Gauss, no necesitamos construir a la matriz <span class="math notranslate nohighlight">\(L_1\)</span>, directamente se tiene <span class="math notranslate nohighlight">\(L_1 A[:,1] = A[:,1] - \ell_1 e_1^T A[:,1]\)</span>.</strong></p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">L1_A_1</span> <span class="o">=</span> <span class="n">A</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">l1</span><span class="o">*</span><span class="p">(</span><span class="n">e1</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">A</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">L1_A_1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p><strong>Y se debe aplicar <span class="math notranslate nohighlight">\(\ell_1\)</span> a las columnas número 2 y 3 de <span class="math notranslate nohighlight">\(A\)</span>:</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">L1_A_2</span> <span class="o">=</span> <span class="n">A</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">l1</span><span class="o">*</span><span class="p">(</span><span class="n">e1</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">A</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">L1_A_2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">L1_A_3</span> <span class="o">=</span> <span class="n">A</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="n">l1</span><span class="o">*</span><span class="p">(</span><span class="n">e1</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">A</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">L1_A_3</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p>A continuación se muestra que el producto <span class="math notranslate nohighlight">\(L_1 A\)</span> si se construye <span class="math notranslate nohighlight">\(L_1\)</span> es equivalente a lo anterior:</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p><span class="math notranslate nohighlight">\(L_1 = I_3 - \ell_1 e_1^T\)</span>.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">L1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">l1</span><span class="p">,</span><span class="n">e1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">L1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">L1</span> <span class="o">@</span> <span class="n">A</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<div class="tip admonition">
<p class="admonition-title">Observación 1</p>
<p>Al aplicar <span class="math notranslate nohighlight">\(\ell_1\)</span> a la primer columna de <span class="math notranslate nohighlight">\(A\)</span> <strong>siempre</strong> obtenemos ceros por debajo del pivote que en este caso es <span class="math notranslate nohighlight">\(a_{11}\)</span>.</p>
</div>
<div class="tip admonition">
<p class="admonition-title">Observación 2</p>
<p>Después de hacer la multiplicación <span class="math notranslate nohighlight">\(L_1A\)</span> en cualquiera de los dos casos (construyendo o no explícitamente <span class="math notranslate nohighlight">\(L_1\)</span>) no se modifica el primer renglón de <span class="math notranslate nohighlight">\(A\)</span>:</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">A</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">L1</span> <span class="o">@</span> <span class="n">A</span><span class="p">)[</span><span class="mi">0</span><span class="p">,:]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<div class="tip admonition">
<p class="admonition-title">Continuación observación 2</p>
<p>por lo que la multiplicación <span class="math notranslate nohighlight">\(L_1A\)</span> entonces modifica del segundo renglón de <span class="math notranslate nohighlight">\(A\)</span> en adelante y de la segunda columna de <span class="math notranslate nohighlight">\(A\)</span> en adelante.</p>
</div>
<div class="tip admonition">
<p class="admonition-title">Observación 3</p>
<p>Dada la forma de <span class="math notranslate nohighlight">\(L_1 = I_n - \ell_1e_1^T\)</span>, al hacer la multiplicación por la segunda y tercer columna de <span class="math notranslate nohighlight">\(A\)</span> se tiene:</p>
</div>
<div class="math notranslate nohighlight">
\[e_1^T A[:,1] = A[0,1]\]</div>
<div class="math notranslate nohighlight">
\[e_1^T A[:,2] = A[0,2]\]</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p><strong>El resultado de este producto es un escalar.</strong></p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">e1</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">A</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p><strong>El resultado de este producto es un escalar.</strong></p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">e1</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">A</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p>y puede escribirse de forma compacta:</p>
<div class="math notranslate nohighlight">
\[e_1^T A[:,1:2] = A[0, 1:2]\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span> <span class="c1">#observe that we have to use 2+1=3 as the second number in 1:3</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">:]</span> <span class="c1">#also we could have use this statement</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p>Entonces los productos <span class="math notranslate nohighlight">\(\ell_1 e_1^T A[:,1]\)</span> y <span class="math notranslate nohighlight">\(\ell_1 e_1^T A[:,2]\)</span> quedan respectivamente como:</p>
<div class="math notranslate nohighlight">
\[\ell_1A[0, 1]\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">l1</span><span class="o">*</span><span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<div class="math notranslate nohighlight">
\[\ell_1A[0,2]\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">l1</span><span class="o">*</span><span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<div class="admonition-observacion-4 admonition">
<p class="admonition-title">Observación 4</p>
<p>En los dos cálculos anteriores, las primeras entradas son iguales a <span class="math notranslate nohighlight">\(0\)</span> por lo que es consistente con el hecho que únicamente se modifican dos entradas de la segunda y tercer columna de <span class="math notranslate nohighlight">\(A\)</span>.</p>
</div>
<p>De forma compacta se puede calcular lo anterior como:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">l1</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">],</span><span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">l1</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span><span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">:])</span> <span class="c1">#also we could have use this statement</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p>Y finalmente la aplicación de <span class="math notranslate nohighlight">\(L_1\)</span> al segundo renglón y segunda columna en adelante de <span class="math notranslate nohighlight">\(A\)</span> queda:</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p><strong>Observa que por la definición de la transformación de Gauss, no necesitamos construir a la matriz <span class="math notranslate nohighlight">\(L_1\)</span>, directamente se tiene <span class="math notranslate nohighlight">\(L_1 A = A - \ell_1 e_1^T A\)</span>.</strong></p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">l1</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">],</span><span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p>Practicando combinar columnas y renglones en <em>numpy</em> con <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.vstack.html">column_stack</a> y <em>row_stack</em>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">A_aux</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">l1</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">],</span><span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">m</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">shape</span>
<span class="n">number_of_zeros</span> <span class="o">=</span> <span class="n">m</span><span class="o">-</span><span class="mi">1</span>
<span class="n">A_aux_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">number_of_zeros</span><span class="p">),</span> <span class="n">A_aux</span><span class="p">))</span> <span class="c1"># stack two zeros</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">A_aux_2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">A_aux_3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">row_stack</span><span class="p">((</span><span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">A_aux_2</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">A_aux_3</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p>que es el resultado de:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">L1</span> <span class="o">@</span> <span class="n">A</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<div class="admonition-ejercicio admonition">
<p class="admonition-title">Ejercicio</p>
<p>Calcular el producto <span class="math notranslate nohighlight">\(L_2 L_1 A\)</span> para la matriz anterior y para la matriz:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
A = \left [
\begin{array}{ccc}
1 &amp; 4 &amp; -2 \\
-3 &amp; 9 &amp; 8 \\
5 &amp; 1 &amp; -6
\end{array}
\right]
\end{split}\]</div>
</div>
<div class="admonition-comentario admonition">
<p class="admonition-title">Comentario</p>
<p>Las transformaciones de Gauss se utilizan para la fase de eliminación del método de eliminación Gaussiana o también llamada factorización LU. Ver <a class="reference external" href="https://en.wikipedia.org/wiki/Gaussian_elimination">Gaussian elimination</a>.</p>
</div>
</div>
</div>
<div class="section" id="transformaciones-de-reflexion">
<h3>Transformaciones de reflexión<a class="headerlink" href="#transformaciones-de-reflexion" title="Permalink to this headline">¶</a></h3>
<div class="section" id="matriz-ortogonal-y-matriz-con-columnas-ortonormales">
<h4>Matriz ortogonal y matriz con columnas ortonormales<a class="headerlink" href="#matriz-ortogonal-y-matriz-con-columnas-ortonormales" title="Permalink to this headline">¶</a></h4>
<p>Un conjunto de vectores <span class="math notranslate nohighlight">\(\{x_1, \dots, x_p\}\)</span> en <span class="math notranslate nohighlight">\(\mathbb{R}^m\)</span> (<span class="math notranslate nohighlight">\(x_i \in \mathbb{R}^m\)</span>)es ortogonal si <span class="math notranslate nohighlight">\(x_i^Tx_j=0\)</span> <span class="math notranslate nohighlight">\(\forall i\neq j\)</span>. Por ejemplo, para un conjunto de <span class="math notranslate nohighlight">\(2\)</span> vectores <span class="math notranslate nohighlight">\(x_1,x_2\)</span> en <span class="math notranslate nohighlight">\(\mathbb{R}^3\)</span> esto se visualiza:</p>
<img src="https://dl.dropboxusercontent.com/s/cekagqnxe0grvu4/vectores_ortogonales.png?dl=0" heigth="550" width="550">
<div class="admonition-comentarios admonition">
<p class="admonition-title">Comentarios</p>
<ul class="simple">
<li><p>Si el conjunto <span class="math notranslate nohighlight">\(\{x_1,\dots,x_p\}\)</span> en <span class="math notranslate nohighlight">\(\mathbb{R}^m\)</span> satisface <span class="math notranslate nohighlight">\(x_i^Tx_j= \delta_{ij}= \begin{cases}
1 &amp;\text{ si } i=j,\\
0 &amp;\text{ si } i\neq j
\end{cases}\)</span> se le nombra conjunto <strong>ortonormal</strong>, esto es, constituye un conjunto ortogonal y cada elemento del conjunto tiene norma Euclidiana igual a <span class="math notranslate nohighlight">\(1\)</span>: <span class="math notranslate nohighlight">\(||x_i||_2 = 1, \forall i=1,\dots,p\)</span>.</p></li>
<li><p>Si definimos a la matriz <span class="math notranslate nohighlight">\(X\)</span> con columnas dadas por cada uno de los vectores del conjunto <span class="math notranslate nohighlight">\(\{x_1,\dots, x_p\}\)</span>: <span class="math notranslate nohighlight">\(X=(x_1, \dots , x_p) \in \mathbb{R}^{m \times p}\)</span> entonces la propiedad de que cada par de columnas satisfaga <span class="math notranslate nohighlight">\(x_i^Tx_j=\delta_{ij}\)</span> se puede escribir en notación matricial como <span class="math notranslate nohighlight">\(X^TX = I_p\)</span> con <span class="math notranslate nohighlight">\(I_p\)</span> la matriz identidad de tamaño <span class="math notranslate nohighlight">\(p\)</span> o bien <span class="math notranslate nohighlight">\(XX^T=I_m\)</span>. A la matriz <span class="math notranslate nohighlight">\(X\)</span> se le nombra <strong>matriz con columnas ortonormales</strong>.</p></li>
<li><p>Si cada <span class="math notranslate nohighlight">\(x_i\)</span> está en <span class="math notranslate nohighlight">\(\mathbb{R}^p\)</span> (en lugar de <span class="math notranslate nohighlight">\(\mathbb{R}^m\)</span>) entonces construímos a la matriz <span class="math notranslate nohighlight">\(X\)</span> como el punto anterior con la diferencia que <span class="math notranslate nohighlight">\(X \in \mathbb{R}^{p \times p}\)</span>. En este caso <span class="math notranslate nohighlight">\(X\)</span> se le nombra <strong>matriz ortogonal</strong>.</p></li>
</ul>
</div>
</div>
<div class="section" id="reflectores-de-householder">
<h4>Reflectores de Householder<a class="headerlink" href="#reflectores-de-householder" title="Permalink to this headline">¶</a></h4>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p><span class="math notranslate nohighlight">\(span\{v\}\)</span> es el conjunto generado por <span class="math notranslate nohighlight">\(v\)</span>. Se define como el conjunto de combinaciones lineales de <span class="math notranslate nohighlight">\(v\)</span>: <span class="math notranslate nohighlight">\(span\{v\} = \left \{\displaystyle \sum_{i=1}^m k_i v_i | k_i \in \mathbb{R} \forall i =1,\dots,m \right \}\)</span>.</p>
</div>
<p>Las reflexiones de Householder son <strong>matrices</strong> simétricas, ortogonales y se construyen a partir de un vector <span class="math notranslate nohighlight">\(v \neq 0\)</span> definiendo:</p>
<div class="math notranslate nohighlight">
\[R = I_m-\beta v v^T\]</div>
<p>con <span class="math notranslate nohighlight">\(v \in \mathbb{R}^m - \{0\}\)</span> y <span class="math notranslate nohighlight">\(\beta = \frac{2}{v^Tv}\)</span>. El vector <span class="math notranslate nohighlight">\(v\)</span> se llama <strong>vector de Householder</strong>. La multiplicación <span class="math notranslate nohighlight">\(Rx\)</span> representa la reflexión del vector <span class="math notranslate nohighlight">\(x \in \mathbb{R}^m\)</span> a través del hiperplano <span class="math notranslate nohighlight">\(span\{v\}^\perp\)</span>.</p>
<p>Algunas propiedades de las reflexiones de Householder son: <span class="math notranslate nohighlight">\(R^TR = R^2 = I_m\)</span>, <span class="math notranslate nohighlight">\(R^{-1}=R\)</span>, <span class="math notranslate nohighlight">\(det(R)=-1\)</span>.</p>
<div class="sidebar">
<p class="sidebar-title">Proyector ortogonal elemental</p>
<p>En este dibujo se utiliza el <strong>proyector ortogonal elemental</strong> sobre el complemento ortogonal de u: <span class="math notranslate nohighlight">\(u^\perp = \{x \in \mathbb{R}^m| u^Tx=0\}\)</span> (que es un subespacio de <span class="math notranslate nohighlight">\(\mathbb{R}^m\)</span> de dimensión <span class="math notranslate nohighlight">\(m-1\)</span>) definido como: <span class="math notranslate nohighlight">\(P=I_m- u u^T\)</span> y <span class="math notranslate nohighlight">\(Px\)</span> es la proyección ortogonal de <span class="math notranslate nohighlight">\(x\)</span> sobre <span class="math notranslate nohighlight">\(u^\perp\)</span> . Los proyectores ortogonales elementales <strong>no</strong> son matrices ortogonales, son singulares, son simétricas y <span class="math notranslate nohighlight">\(P^2=P\)</span>. El proyector ortogonal elemental de <span class="math notranslate nohighlight">\(x\)</span> sobre <span class="math notranslate nohighlight">\(u^\perp\)</span> tienen <span class="math notranslate nohighlight">\(rank\)</span> igual a <span class="math notranslate nohighlight">\(m-1\)</span> y el proyector ortogonal de <span class="math notranslate nohighlight">\(x\)</span> sobre <span class="math notranslate nohighlight">\(span\{u\}\)</span> definido por <span class="math notranslate nohighlight">\(I_m-P=uu^T\)</span> tienen <span class="math notranslate nohighlight">\(rank\)</span> igual a <span class="math notranslate nohighlight">\(1\)</span>.</p>
<img src="https://dl.dropboxusercontent.com/s/itjn9edajx4g2ql/elementary_projector_drawing.png?dl=0" heigth="350" width="350">
</div>
<p>Un dibujo que representa lo anterior es el siguiente en el que se utiliza <span class="math notranslate nohighlight">\(u \in \mathbb{R}^m - \{0\}\)</span> , <span class="math notranslate nohighlight">\(||u||_2 = 1\)</span> y  <span class="math notranslate nohighlight">\(R=I_m-2 u u^T\)</span>, el reflector elemental alrededor de <span class="math notranslate nohighlight">\(u^\perp\)</span>:</p>
<img src="https://dl.dropboxusercontent.com/s/o3oht181nm8lfit/householder_drawing.png?dl=0" heigth="350" width="350">
<p>Las reflexiones de Householder pueden utilizarse para hacer ceros por debajo de una entrada de un vector. Por ejemplo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p>Utilizamos la definición <span class="math notranslate nohighlight">\(v=x-||x||_2e_1\)</span> con <span class="math notranslate nohighlight">\(e_1=(1,0,0)^T\)</span> vector canónico para construir al vector de Householder:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">v</span> <span class="o">=</span> <span class="n">x</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span> <span class="c1">#uno en la primer entrada pues se desea</span>
                                          <span class="c1">#hacer ceros en las entradas restantes</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">beta</span> <span class="o">=</span> <span class="mi">2</span><span class="o">/</span><span class="n">v</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Hacemos ceros por debajo de la primera entrada de <span class="math notranslate nohighlight">\(x\)</span> haciendo la multiplicación matriz-vector <span class="math notranslate nohighlight">\(Rx\)</span>. Pero para aplicar <span class="math notranslate nohighlight">\(Rx\)</span> <strong>no</strong> construímos <span class="math notranslate nohighlight">\(R = I_3 -\beta vv^T\)</span>, en lugar de eso hacemos <span class="math notranslate nohighlight">\(Rx = x - \beta v v^Tx\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="o">-</span><span class="n">beta</span><span class="o">*</span><span class="n">v</span><span class="o">*</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p>obsérvese que el resultado de <span class="math notranslate nohighlight">\(Rx\)</span> es <span class="math notranslate nohighlight">\((||x||_2,0,0)^T\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p>Sólo para mostrar que <span class="math notranslate nohighlight">\(Rx\)</span> construyendo <span class="math notranslate nohighlight">\(R\)</span> es equivalente a lo anterior, se construye a continuación <span class="math notranslate nohighlight">\(R\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">R</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">-</span><span class="n">beta</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">R</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">R</span><span class="nd">@x</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p><strong>Comentario:</strong></p>
<ul class="simple">
<li><p>Otra opción para definir al vector de Householder es <span class="math notranslate nohighlight">\(v=x+||x||_2e_1\)</span> con <span class="math notranslate nohighlight">\(e_1=(1,0,0)^T\)</span>:</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">v</span> <span class="o">=</span> <span class="n">x</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span> <span class="c1">#uno en la primer entrada pues se desea</span>
                                          <span class="c1">#hacer ceros en las entradas restantes</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">beta</span> <span class="o">=</span> <span class="mi">2</span><span class="o">/</span><span class="n">v</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="o">-</span><span class="n">beta</span><span class="o">*</span><span class="n">v</span><span class="o">*</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p><strong>¿Cuál definición del vector de Householder usar?</strong></p>
<p>La respuesta a la pregunta tiene que ver con que en cualquiera de las dos definiciones del vector de Householder <span class="math notranslate nohighlight">\(v=x \pm ||x||_2 e_1\)</span>, la multiplicación <span class="math notranslate nohighlight">\(Rx\)</span> refleja <span class="math notranslate nohighlight">\(x\)</span> en el primer eje coordenado:</p>
<img src="https://dl.dropboxusercontent.com/s/bfk7gojxm93ah5s/householder_2_posibilites.png?dl=0" heigth="400" width="400">
<p>El vector <span class="math notranslate nohighlight">\(v^+ = - u_0^+ = x-||x||_2e_1\)</span> refleja <span class="math notranslate nohighlight">\(x\)</span> respecto al subespacio <span class="math notranslate nohighlight">\(H^+\)</span>. El vector <span class="math notranslate nohighlight">\(v^- = -u_0^- = x+||x||_2e_1\)</span> refleja <span class="math notranslate nohighlight">\(x\)</span> respecto al subespacio <span class="math notranslate nohighlight">\(H^-\)</span>. Para disminuir los errores por redondeo y evitar el problema de cancelación en la aritmética de punto flotante (ver <a class="reference external" href="https://itam-ds.github.io/analisis-numerico-computo-cientifico/I.computo_cientifico/1.2/Sistema_de_punto_flotante.html">Sistema de punto flotante</a>) se utiliza <span class="math notranslate nohighlight">\(v = x+signo(x_1)||x||_2e_1\)</span> donde <span class="math notranslate nohighlight">\(signo(x_1) = \begin{cases}
1 &amp;\text{ si } x_1 \geq 0 ,\\
-1 &amp;\text{ si } x_1 &lt; 0
\end{cases}\)</span>. La idea de la definción anterior con la función <span class="math notranslate nohighlight">\(signo(\cdot)\)</span> es que la reflexión (en el dibujo anterior <span class="math notranslate nohighlight">\(-||x||_2e_1\)</span> o <span class="math notranslate nohighlight">\(||x||_2e_1\)</span>) sea lo más alejada posible de <span class="math notranslate nohighlight">\(x\)</span>. En el dibujo anterior como <span class="math notranslate nohighlight">\(x_1, x_2&gt;0\)</span> entonces se refleja respecto al subespacio <span class="math notranslate nohighlight">\(H^-\)</span> quedando su reflexión igual a <span class="math notranslate nohighlight">\(-||x||_2e_1\)</span>.</p>
<p><strong>Comentarios:</strong></p>
<ul class="simple">
<li><p>Otra forma de lidiar con el problema de cancelación es definiendo a la primera componente del vector de Householder <span class="math notranslate nohighlight">\(v_1\)</span> como <span class="math notranslate nohighlight">\(v_1=x_1-||x||_2\)</span> y haciendo una manipulación algebraica como sigue:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[v_1=x_1-||x||_2 = \frac{x_1^2-||x||_2^2}{x_1+||x||_2} = -\frac{x_2^2+x_3^2+\dots + x_m^2}{x_1+||x||_2}.\]</div>
<ul class="simple">
<li><p>En la implementación del cálculo del vector de Householder, es útil que <span class="math notranslate nohighlight">\(v_1=1\)</span> y así únicamente se almacenará <span class="math notranslate nohighlight">\(v(2:m)\)</span>. Al vector <span class="math notranslate nohighlight">\(v(2:m)\)</span> se le nombra <strong>parte esencial del vector de Householder</strong>.</p></li>
</ul>
</div>
</div>
<div class="section" id="transformaciones-de-rotacion">
<h3>Transformaciones de rotación<a class="headerlink" href="#transformaciones-de-rotacion" title="Permalink to this headline">¶</a></h3>
<p><strong>Referencias:</strong></p>
<ul class="simple">
<li><p>G. H. Golub, C. F. Van Loan, Matrix Computations, John Hopkins University Press, 2013.</p></li>
</ul>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "palmoreck/dockerfiles-for-binder",
            ref: "jupyterlab_optimizacion",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Erick Palacios Moreno<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    <script src="_static/js/index.js"></script>
    
  </body>
</html>